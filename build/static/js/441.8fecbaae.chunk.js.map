{"version":3,"file":"static/js/441.8fecbaae.chunk.js","mappings":"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","sources":["SomaLux/Books/Admin/pages/UsersAnalytics.jsx","SomaLux/Books/Admin/pages/UserTierModal.jsx","SomaLux/Books/Admin/pages/Users.jsx"],"sourcesContent":["import React, { useState, useMemo } from 'react';\r\nimport { ResponsiveContainer, BarChart, Bar, XAxis, YAxis, Tooltip, Legend } from 'recharts';\r\n\r\nconst UsersAnalytics = ({ rows }) => {\r\n  const [range, setRange] = useState('month');\r\n\r\n  const {\r\n    kpiActive,\r\n    kpiSignedOut,\r\n    totalActiveNow,\r\n    totalUsers,\r\n    totalSignedOut,\r\n    chartData,\r\n    rangeLabel,\r\n  } = useMemo(() => {\r\n    const now = new Date();\r\n    let from;\r\n    if (range === 'week') {\r\n      from = new Date(now.getTime() - 7 * 24 * 60 * 60 * 1000);\r\n    } else if (range === 'year') {\r\n      from = new Date(now.getFullYear() - 1, now.getMonth(), now.getDate());\r\n    } else {\r\n      from = new Date(now.getTime() - 30 * 24 * 60 * 60 * 1000);\r\n    }\r\n\r\n    const totalUsersLocal = rows.length;\r\n    let totalActiveNowLocal = 0;\r\n    let totalSignedOutLocal = 0;\r\n    let activePeriod = 0;\r\n    let signedOutPeriod = 0;\r\n\r\n    const ONLINE_WINDOW_MINUTES = 5;\r\n    const onlineWindowMs = ONLINE_WINDOW_MINUTES * 60 * 1000;\r\n\r\n    rows.forEach((u) => {\r\n      const createdAt = u.created_at ? new Date(u.created_at) : null;\r\n      const lastActiveAt = u.last_active_at ? new Date(u.last_active_at) : createdAt;\r\n      const deactivatedAt = u.deactivated_at ? new Date(u.deactivated_at) : null;\r\n\r\n      const isOnlineNow = !!(lastActiveAt && now.getTime() - lastActiveAt.getTime() <= onlineWindowMs);\r\n      const isSignedOutByTimestamp = !!deactivatedAt && deactivatedAt <= now;\r\n      const isSignedIn = !isSignedOutByTimestamp;\r\n\r\n      if (isOnlineNow) totalActiveNowLocal += 1;\r\n      if (isSignedOutByTimestamp) totalSignedOutLocal += 1;\r\n\r\n      if (isSignedIn) {\r\n        const activityTime = lastActiveAt || createdAt;\r\n        if (activityTime && activityTime >= from && activityTime <= now) {\r\n          activePeriod += 1;\r\n        }\r\n      } else if (isSignedOutByTimestamp && deactivatedAt && deactivatedAt >= from && deactivatedAt <= now) {\r\n        signedOutPeriod += 1;\r\n      }\r\n    });\r\n\r\n    const chartDataLocal = [\r\n      // Removed graph data for active and signed out users\r\n    ];\r\n\r\n    const rangeLabelLocal = range === 'week' ? 'Last 7 days' : range === 'year' ? 'Last 12 months' : 'Last 30 days';\r\n\r\n    return {\r\n      kpiActive: activePeriod,\r\n      kpiSignedOut: signedOutPeriod,\r\n      totalActiveNow: totalActiveNowLocal,\r\n      totalUsers: totalUsersLocal,\r\n      totalSignedOut: totalSignedOutLocal,\r\n      chartData: chartDataLocal,\r\n      rangeLabel: rangeLabelLocal,\r\n    };\r\n  }, [rows, range]);\r\n\r\n  // Only graph removed, box counts remain\r\n  return (\r\n    <div style={{ marginBottom: 8 }}>\r\n      <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', gap: 8, flexWrap: 'wrap' }}>\r\n        <div style={{ display: 'flex', gap: 4, flexWrap: 'wrap' }}>\r\n          {['week', 'month', 'year'].map((key) => (\r\n            <button\r\n              key={key}\r\n              className=\"btn\"\r\n              style={{\r\n                padding: '4px 12px',\r\n                borderRadius: 999,\r\n                background: range === key ? '#005c4b' : '#202c33',\r\n                color: '#e9edef',\r\n                border: 'none',\r\n                fontSize: 12,\r\n                textTransform: 'capitalize',\r\n              }}\r\n              onClick={() => setRange(key)}\r\n            >\r\n              {key}\r\n            </button>\r\n          ))}\r\n        </div>\r\n        <div style={{ color: '#8696a0', fontSize: 12 }}>{rangeLabel}</div>\r\n      </div>\r\n\r\n      <div style={{ display: 'grid', gridTemplateColumns: 'repeat(auto-fit, minmax(140px, 1fr))', gap: 6, marginTop: 8 }}>\r\n        <div style={{ background: '#111b21', borderRadius: 6, padding: 8, border: '1px solid #202c33' }}>\r\n          <div style={{ fontSize: 11, color: '#8696a0', marginBottom: 2 }}>Active users ({rangeLabel})</div>\r\n          <div style={{ fontSize: 22, fontWeight: 600, color: '#e9edef' }}>{kpiActive}</div>\r\n        </div>\r\n        <div style={{ background: '#111b21', borderRadius: 6, padding: 8, border: '1px solid #202c33' }}>\r\n          <div style={{ fontSize: 11, color: '#8696a0', marginBottom: 2 }}>Signed-out users ({rangeLabel})</div>\r\n          <div style={{ fontSize: 22, fontWeight: 600, color: '#e9edef' }}>{kpiSignedOut}</div>\r\n        </div>\r\n        <div style={{ background: '#111b21', borderRadius: 12, padding: 12, border: '1px solid #202c33' }}>\r\n          <div style={{ fontSize: 12, color: '#8696a0', marginBottom: 4 }}>Total active now</div>\r\n          <div style={{ fontSize: 22, fontWeight: 600, color: '#e9edef' }}>{totalActiveNow}</div>\r\n          <div style={{ fontSize: 11, color: '#8696a0', marginTop: 2 }}>of {totalUsers} users</div>\r\n        </div>\r\n        <div style={{ background: '#111b21', borderRadius: 12, padding: 12, border: '1px solid #202c33' }}>\r\n          <div style={{ fontSize: 12, color: '#8696a0', marginBottom: 4 }}>Total signed-out</div>\r\n          <div style={{ fontSize: 22, fontWeight: 600, color: '#e9edef' }}>{totalSignedOut}</div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default UsersAnalytics;","import React, { useState, useEffect } from 'react';\r\nimport { supabase } from '../../supabaseClient';\r\nimport { fetchUserSearchHistoryAdmin } from '../api';\r\n\r\nconst UserTierModal = ({ user, onClose }) => {\r\n  const [tierMetrics, setTierMetrics] = useState(null);\r\n  const [tierMetricsLoading, setTierMetricsLoading] = useState(false);\r\n  const [tierMetricsError, setTierMetricsError] = useState(null);\r\n\r\n  useEffect(() => {\r\n    loadTierMetrics();\r\n  }, [user.id]);\r\n\r\n  const loadTierMetrics = async () => {\r\n    setTierMetrics(null);\r\n    setTierMetricsError(null);\r\n    setTierMetricsLoading(true);\r\n\r\n    try {\r\n      const userId = user.id;\r\n      const now = new Date();\r\n      const cutoff = new Date(now.getTime() - 30 * 24 * 60 * 60 * 1000);\r\n      const cutoffIso = cutoff.toISOString();\r\n\r\n      const [\r\n        viewsRes,\r\n        downloadsRes,\r\n        likesRes,\r\n        commentsRes,\r\n        uploadsBooksRes,\r\n        uploadsPastPapersRes,\r\n        uploadsUniversitiesRes,\r\n        sessionsRes,\r\n        goalsRes,\r\n        statsRes,\r\n        streakRes,\r\n        subsRes,\r\n        searchEvents,\r\n      ] = await Promise.all([\r\n        supabase\r\n          .from('book_views')\r\n          .select('id', { count: 'exact', head: true })\r\n          .eq('user_id', userId)\r\n          .gte('viewed_at', cutoffIso),\r\n        supabase\r\n          .from('book_downloads')\r\n          .select('id', { count: 'exact', head: true })\r\n          .eq('user_id', userId)\r\n          .gte('downloaded_at', cutoffIso),\r\n        supabase\r\n          .from('book_likes')\r\n          .select('id', { count: 'exact', head: true })\r\n          .eq('user_id', userId)\r\n          .gte('created_at', cutoffIso),\r\n        supabase\r\n          .from('book_comments')\r\n          .select('id', { count: 'exact', head: true })\r\n          .eq('user_id', userId)\r\n          .gte('created_at', cutoffIso),\r\n        supabase\r\n          .from('books')\r\n          .select('id', { count: 'exact', head: true })\r\n          .eq('uploaded_by', userId)\r\n          .gte('created_at', cutoffIso),\r\n        supabase\r\n          .from('past_papers')\r\n          .select('id', { count: 'exact', head: true })\r\n          .eq('uploaded_by', userId)\r\n          .gte('created_at', cutoffIso),\r\n        supabase\r\n          .from('universities')\r\n          .select('id', { count: 'exact', head: true })\r\n          .eq('uploaded_by', userId)\r\n          .gte('created_at', cutoffIso),\r\n        supabase\r\n          .from('reading_sessions')\r\n          .select('id', { count: 'exact', head: true })\r\n          .eq('user_id', userId)\r\n          .gte('started_at', cutoffIso),\r\n        supabase\r\n          .from('reading_goals')\r\n          .select('id, target_books, current_progress', { count: 'exact', head: false })\r\n          .eq('user_id', userId),\r\n        supabase\r\n          .from('user_reading_stats')\r\n          .select('total_books_completed')\r\n          .eq('user_id', userId)\r\n          .maybeSingle(),\r\n        supabase\r\n          .from('reading_streaks')\r\n          .select('current_streak')\r\n          .eq('user_id', userId)\r\n          .maybeSingle(),\r\n        supabase\r\n          .from('subscriptions')\r\n          .select('id, status')\r\n          .eq('user_id', userId),\r\n        fetchUserSearchHistoryAdmin(userId, { days: 30 }),\r\n      ]);\r\n\r\n      const safeCount = (res) => (res && typeof res.count === 'number' ? res.count : 0);\r\n\r\n      const viewsCount = safeCount(viewsRes);\r\n      const downloadsCount = safeCount(downloadsRes);\r\n      const likesCount = safeCount(likesRes);\r\n      const commentsCount = safeCount(commentsRes);\r\n      const uploadsBooksCount = safeCount(uploadsBooksRes);\r\n      const uploadsPastPapersCount = safeCount(uploadsPastPapersRes);\r\n      const uploadsUniversitiesCount = safeCount(uploadsUniversitiesRes);\r\n      const sessionsCount = safeCount(sessionsRes);\r\n\r\n      let completedGoals = 0;\r\n      if (goalsRes && !goalsRes.error && Array.isArray(goalsRes.data)) {\r\n        completedGoals = goalsRes.data.filter((g) => {\r\n          if (!g) return false;\r\n          if (typeof g.target_books === 'number' && g.target_books > 0) {\r\n            return (g.current_progress || 0) >= g.target_books;\r\n          }\r\n          return false;\r\n        }).length;\r\n      }\r\n\r\n      const booksCompleted = statsRes && !statsRes.error && statsRes.data\r\n        ? statsRes.data.total_books_completed || 0\r\n        : 0;\r\n\r\n      const streakDays = streakRes && !streakRes.error && streakRes.data\r\n        ? streakRes.data.current_streak || 0\r\n        : 0;\r\n\r\n      const subsData = subsRes && !subsRes.error && Array.isArray(subsRes.data)\r\n        ? subsRes.data\r\n        : [];\r\n      const activeSubscriptions = subsData.filter((s) => s.status === 'active').length;\r\n\r\n      const searchesCount = Array.isArray(searchEvents) ? searchEvents.length : 0;\r\n\r\n      const metrics = [\r\n        { key: 'views', label: 'Reads / views', count: viewsCount, pointsPerUnit: 1 },\r\n        { key: 'downloads', label: 'Downloads', count: downloadsCount, pointsPerUnit: 3 },\r\n        { key: 'likes', label: 'Likes', count: likesCount, pointsPerUnit: 2 },\r\n        { key: 'comments', label: 'Comments', count: commentsCount, pointsPerUnit: 3 },\r\n        { key: 'uploads_books', label: 'Books uploaded (approved)', count: uploadsBooksCount, pointsPerUnit: 5 },\r\n        { key: 'uploads_past_papers', label: 'Past papers uploaded (approved)', count: uploadsPastPapersCount, pointsPerUnit: 5 },\r\n        { key: 'uploads_universities', label: 'Universities created', count: uploadsUniversitiesCount, pointsPerUnit: 8 },\r\n        { key: 'searches', label: 'Searches', count: searchesCount, pointsPerUnit: 0.5 },\r\n        { key: 'sessions', label: 'Reading sessions', count: sessionsCount, pointsPerUnit: 1 },\r\n        { key: 'completed_goals', label: 'Completed goals', count: completedGoals, pointsPerUnit: 8 },\r\n        { key: 'books_completed', label: 'Books completed (lifetime)', count: booksCompleted, pointsPerUnit: 2 },\r\n        { key: 'streak_days', label: 'Reading streak (days)', count: streakDays, pointsPerUnit: 1 },\r\n        { key: 'subscriptions', label: 'Active subscriptions', count: activeSubscriptions, pointsPerUnit: 20 },\r\n      ].map((m) => ({\r\n        ...m,\r\n        totalPoints: m.count * m.pointsPerUnit,\r\n      }));\r\n\r\n      const totalPoints = metrics.reduce((sum, m) => sum + m.totalPoints, 0);\r\n\r\n      let tierFromPoints = null;\r\n      if (totalPoints >= 400) tierFromPoints = 'legend';\r\n      else if (totalPoints >= 250) tierFromPoints = 'power_reader';\r\n      else if (totalPoints >= 150) tierFromPoints = 'active_reader';\r\n      else if (totalPoints >= 60) tierFromPoints = 'community_star';\r\n      else if (totalPoints > 0) tierFromPoints = 'new_reader';\r\n\r\n      setTierMetrics({ metrics, totalPoints, tierFromPoints });\r\n    } catch (e) {\r\n      console.error('Failed to load tier metrics', e);\r\n      setTierMetricsError('Failed to load tier details');\r\n    } finally {\r\n      setTierMetricsLoading(false);\r\n    }\r\n  };\r\n\r\n  const formatTierName = (tier) => {\r\n    if (!tier) return 'Not ranked';\r\n    return tier\r\n      .replace('new_reader', 'New Reader')\r\n      .replace('active_reader', 'Active Reader')\r\n      .replace('power_reader', 'Power Reader')\r\n      .replace('community_star', 'Community Star')\r\n      .replace('legend', 'Legend');\r\n  };\r\n\r\n  return (\r\n    <div\r\n      style={{\r\n        position: 'fixed',\r\n        inset: 0,\r\n        background: 'rgba(0,0,0,0.65)',\r\n        display: 'flex',\r\n        alignItems: 'center',\r\n        justifyContent: 'center',\r\n        zIndex: 9999,\r\n        padding: 16,\r\n      }}\r\n      onClick={onClose}\r\n    >\r\n      <div\r\n        style={{\r\n          background: '#111b21',\r\n          borderRadius: 16,\r\n          maxWidth: 520,\r\n          width: '100%',\r\n          maxHeight: '90vh',\r\n          overflowY: 'auto',\r\n          border: '1px solid #202c33',\r\n          boxShadow: '0 18px 45px rgba(0,0,0,0.6)',\r\n        }}\r\n        onClick={(e) => e.stopPropagation()}\r\n      >\r\n        <div\r\n          style={{\r\n            padding: '14px 18px',\r\n            borderBottom: '1px solid #202c33',\r\n            display: 'flex',\r\n            alignItems: 'center',\r\n            justifyContent: 'space-between',\r\n          }}\r\n        >\r\n          <div>\r\n            <div style={{ fontSize: 14, color: '#8696a0' }}>Tier breakdown</div>\r\n            <div style={{ fontSize: 18, fontWeight: 600, color: '#e9edef' }}>\r\n              {formatTierName(user.rankTier)}\r\n            </div>\r\n          </div>\r\n          <button\r\n            className=\"btn\"\r\n            style={{ padding: '4px 10px', fontSize: 12 }}\r\n            onClick={onClose}\r\n          >\r\n            Close\r\n          </button>\r\n        </div>\r\n\r\n        <div style={{ padding: 16, display: 'grid', gap: 12 }}>\r\n          <div\r\n            style={{\r\n              background: '#0b141a',\r\n              borderRadius: 12,\r\n              padding: 12,\r\n              border: '1px solid #202c33',\r\n              fontSize: 13,\r\n              color: '#cfd8dc',\r\n            }}\r\n          >\r\n            <div style={{ fontWeight: 600, marginBottom: 8 }}>Activity points (last 30 days)</div>\r\n            {tierMetricsLoading && (\r\n              <div style={{ color: '#8696a0' }}>Loading tier details...</div>\r\n            )}\r\n            {tierMetricsError && !tierMetricsLoading && (\r\n              <div style={{ color: '#f15e6c' }}>{tierMetricsError}</div>\r\n            )}\r\n            {tierMetrics && !tierMetricsLoading && !tierMetricsError && (\r\n              <div style={{ overflowX: 'auto' }}>\r\n                <table className=\"table\" style={{ fontSize: 12 }}>\r\n                  <thead>\r\n                    <tr>\r\n                      <th>Metric</th>\r\n                      <th style={{ textAlign: 'right' }}>Count</th>\r\n                      <th style={{ textAlign: 'right' }}>Points / unit</th>\r\n                      <th style={{ textAlign: 'right' }}>Total points</th>\r\n                    </tr>\r\n                  </thead>\r\n                  <tbody>\r\n                    {tierMetrics.metrics.map((m) => (\r\n                      <tr key={m.key}>\r\n                        <td>{m.label}</td>\r\n                        <td style={{ textAlign: 'right' }}>{m.count}</td>\r\n                        <td style={{ textAlign: 'right' }}>{m.pointsPerUnit}</td>\r\n                        <td style={{ textAlign: 'right' }}>{m.totalPoints.toFixed(1)}</td>\r\n                      </tr>\r\n                    ))}\r\n                    <tr>\r\n                      <td colSpan={3} style={{ textAlign: 'right', fontWeight: 600 }}>Total</td>\r\n                      <td style={{ textAlign: 'right', fontWeight: 600 }}>{tierMetrics.totalPoints.toFixed(1)}</td>\r\n                    </tr>\r\n                  </tbody>\r\n                </table>\r\n                <div style={{ marginTop: 8, fontSize: 12 }}>\r\n                  <div>\r\n                    Computed tier from points:{' '}\r\n                    <strong>\r\n                      {formatTierName(tierMetrics.tierFromPoints)}\r\n                    </strong>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            )}\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default UserTierModal;","import React, { useEffect, useState, useMemo } from 'react';\nimport { useNavigate } from 'react-router-dom';\nimport { fetchProfiles, fetchUploadCountsByUser, updateUserRole, fetchUserRankingsAdmin, fetchAuthenticatedUsers } from '../api';\nimport { FiSearch } from 'react-icons/fi';\nimport UsersAnalytics from './UsersAnalytics';\nimport UserTierModal from './UserTierModal';\n\nconst Users = ({ isSuperAdmin }) => {\n  const [rows, setRows] = useState([]);\n  const [loading, setLoading] = useState(true);\n  const [saving, setSaving] = useState({});\n  const [search, setSearch] = useState('');\n  const [roleFilter, setRoleFilter] = useState('');\n  const [activeFilter, setActiveFilter] = useState('');\n  const [sortBy, setSortBy] = useState('latest_login'); // 'ranking' or 'latest_login'\n  const [sortDir, setSortDir] = useState('desc'); // 'asc' or 'desc'\n  const [page, setPage] = useState(1);\n  const [pageSize] = useState(15);\n  const [showTierModal, setShowTierModal] = useState(false);\n  const [selectedUserTier, setSelectedUserTier] = useState(null);\n  const navigate = useNavigate();\n\n  const SUPERADMIN_EMAILS = ['campuslives254@gmail.com', 'paltechsomalux@gmail.com'];\n\n  const load = async () => {\n    setLoading(true);\n    try {\n      let profiles = [];\n      let rankings = [];\n      let uploadCounts = [];\n\n      try {\n        profiles = await fetchProfiles();\n        console.log('[Users.load] fetchProfiles success:', profiles?.length || 0);\n      } catch (e) {\n        console.error('[Users.load] fetchProfiles error:', e?.message || e);\n      }\n\n      try {\n        rankings = await fetchUserRankingsAdmin();\n        console.log('[Users.load] fetchUserRankingsAdmin success:', rankings?.length || 0);\n      } catch (e) {\n        console.error('[Users.load] fetchUserRankingsAdmin error:', e?.message || e);\n      }\n\n      try {\n        uploadCounts = await fetchUploadCountsByUser();\n        console.log('[Users.load] fetchUploadCountsByUser success:', uploadCounts?.length || 0);\n      } catch (e) {\n        console.error('[Users.load] fetchUploadCountsByUser error:', e?.message || e);\n      }\n\n      console.groupCollapsed('[Users.load] fetched data');\n      console.log('profiles (count):', Array.isArray(profiles) ? profiles.length : profiles, profiles?.slice?.(0, 3));\n      console.log('rankings (count):', Array.isArray(rankings) ? rankings.length : rankings, rankings?.slice?.(0, 5));\n      console.log('uploadCounts (count):', Array.isArray(uploadCounts) ? uploadCounts.length : uploadCounts, uploadCounts?.slice?.(0, 10));\n      console.groupEnd();\n\n      const uploadsMap = new Map(\n        (uploadCounts || []).map((u) => [String(u.uploaded_by), {\n          books: u.books || 0,\n          pastPapers: u.past_papers || 0,\n          universities: u.universities || 0,\n          total: typeof u.total === 'number' ? u.total : (u.books || 0) + (u.past_papers || 0) + (u.universities || 0),\n        }])\n      );\n\n      const rankingsMap = new Map();\n      (rankings || []).forEach((r) => {\n        const possibleKeys = [\n          r.user_id,\n          r.user?.id,\n          r.profile_id,\n          r.profiles?.id,\n          r.profiles?.profile_id,\n          r.email,\n          r.user_email,\n        ];\n        possibleKeys.forEach((k) => {\n          if (k !== undefined && k !== null) rankingsMap.set(String(k), r);\n        });\n      });\n\n      const computeFallbackRanking = (profile) => {\n        const contrib = uploadsMap.get(String(profile.id)) || { total: 0 };\n        const uploads = contrib.total || 0;\n        const createdAt = profile.created_at ? new Date(profile.created_at) : null;\n        const lastActiveAt = profile.last_active_at ? new Date(profile.last_active_at) : createdAt;\n        let recencyScore = 0;\n        if (lastActiveAt) {\n          const days = (Date.now() - lastActiveAt.getTime()) / (1000 * 60 * 60 * 24);\n          if (days <= 7) recencyScore = 50;\n          else if (days <= 30) recencyScore = 20;\n          else if (days <= 90) recencyScore = 5;\n        }\n        const score = uploads * 10 + recencyScore;\n        let tier = null;\n        if (score >= 200) tier = 'legend';\n        else if (score >= 100) tier = 'power_reader';\n        else if (score >= 50) tier = 'active_reader';\n        else if (score >= 10) tier = 'community_star';\n        else if (score > 0) tier = 'new_reader';\n        return { score, tier, fallback: true };\n      };\n\n      try {\n        const keys = Array.from(rankingsMap.keys()).slice(0, 50);\n        console.groupCollapsed('[Users.load] rankingsMap (sample keys)');\n        console.log('keys sample:', keys);\n        keys.slice(0,10).forEach((k) => {\n          console.log(`rankingsMap[${k}] =`, rankingsMap.get(k));\n        });\n        console.groupEnd();\n      } catch (e) {\n        console.warn('Failed to log rankingsMap sample', e);\n      }\n\n      const normalizeRanking = (r) => {\n        if (!r) return null;\n        const pickNumber = (...keys) => {\n          for (const k of keys) {\n            if (r && Object.prototype.hasOwnProperty.call(r, k)) {\n              const n = Number(r[k]);\n              if (!Number.isNaN(n)) return n;\n            }\n          }\n          return null;\n        };\n        const score = pickNumber(\n          'score',\n          'score_30',\n          'score_30_days',\n          'score30',\n          'score_last_30',\n          'last_30_score',\n          'value'\n        );\n        const tier = r.tier ?? r.rank_tier ?? r.level ?? r.category ?? null;\n        const position = pickNumber('rank_position', 'position', 'rank', 'rankPos');\n        const subscription = !!(r.subscription_bonus_applied ?? r.has_subscription_boost ?? r.subscription_boost ?? r.subscriber_bonus);\n        return { raw: r, score, tier, position, subscription };\n      };\n\n      // Helper function to compute user status and last seen\n      const computeUserStatus = (profile) => {\n        const now = Date.now();\n        const lastActiveTime = profile.last_active_at \n          ? new Date(profile.last_active_at).getTime()\n          : new Date(profile.created_at).getTime();\n        const minutesAgo = (now - lastActiveTime) / (1000 * 60);\n        \n        // Determine status: online if active in last 5 minutes\n        const isOnline = minutesAgo <= 5;\n        const status = profile.deactivated_at ? 'signed_out' : (isOnline ? 'online' : 'offline');\n\n        // Format last seen - show \"Online\" if online, otherwise show time\n        let lastSeen = null;\n        if (isOnline) {\n          lastSeen = 'Online';\n        } else if (profile.last_active_at || profile.created_at) {\n          if (minutesAgo < 1) {\n            lastSeen = 'now';\n          } else if (minutesAgo < 60) {\n            lastSeen = `${Math.round(minutesAgo)}m ago`;\n          } else if (minutesAgo < 1440) {\n            lastSeen = `${Math.round(minutesAgo / 60)}h ago`;\n          } else {\n            lastSeen = `${Math.round(minutesAgo / 1440)}d ago`;\n          }\n        } else {\n          lastSeen = 'never';\n        }\n\n        return { status, lastSeen };\n      };\n\n      const enriched = (profiles || []).map((p) => {\n        const byId = rankingsMap.get(String(p.id));\n        const byEmail = p.email ? rankingsMap.get(String(p.email)) : null;\n        const r = byId || byEmail || null;\n        const norm = normalizeRanking(r);\n\n        let finalScore = null;\n        let finalTier = null;\n        let usedFallback = false;\n        if (norm && typeof norm.score === 'number') {\n          finalScore = norm.score;\n          finalTier = norm.tier || null;\n        } else {\n          const fb = computeFallbackRanking(p);\n          if (fb && typeof fb.score === 'number') {\n            finalScore = fb.score;\n            finalTier = fb.tier;\n            usedFallback = true;\n          }\n        }\n\n        if (!norm && !usedFallback) {\n          console.warn('[Users.load] no ranking and no fallback for profile', { id: p.id, email: p.email });\n        } else if (usedFallback) {\n          console.info('[Users.load] applied fallback ranking for', { id: p.id, email: p.email, score: finalScore, tier: finalTier });\n        } else {\n          console.debug('[Users.load] ranking matched for', { id: p.id, email: p.email, normalized: norm });\n        }\n\n        const contrib = uploadsMap.get(String(p.id)) || { total: 0, books: 0, pastPapers: 0, universities: 0 };\n        const userStatus = computeUserStatus(p);\n\n        return {\n          ...p,\n          uploadCount: contrib.total || 0,\n          contribBooks: contrib.books || 0,\n          contribPastPapers: contrib.pastPapers || 0,\n          contribUniversities: contrib.universities || 0,\n          ranking: norm ? norm.raw : null,\n          rankTier: finalTier || null,\n          rankScore: typeof finalScore === 'number' ? finalScore : null,\n          rankPosition: typeof norm?.position === 'number' ? norm.position : null,\n          hasSubscriptionBoost: !!norm?.subscription,\n          status: userStatus.status,\n          lastSeen: userStatus.lastSeen,\n        };\n      });\n\n      enriched.sort((a, b) => {\n        const scoreA = typeof a.rankScore === 'number' ? a.rankScore : -1;\n        const scoreB = typeof b.rankScore === 'number' ? b.rankScore : -1;\n        if (scoreA !== scoreB) return scoreB - scoreA;\n        const roleOrder = { admin: 0, editor: 1, viewer: 2 };\n        const ra = roleOrder[a.role] ?? 3;\n        const rb = roleOrder[b.role] ?? 3;\n        if (ra !== rb) return ra - rb;\n        const nameA = (a.display_name || a.email || '').toLowerCase();\n        const nameB = (b.display_name || b.email || '').toLowerCase();\n        return nameA.localeCompare(nameB);\n      });\n\n      setRows(enriched);\n    } catch (error) {\n      console.error('[Users.load] Error loading users:', error);\n      setRows([]);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  useEffect(() => { load(); }, []);\n\n  const changeRole = async (id, role) => {\n    setSaving((s) => ({ ...s, [id]: true }));\n    try {\n      console.log('[Users.changeRole] Updating role for user:', id, 'to:', role);\n      await updateUserRole(id, role);\n      console.log('[Users.changeRole] Role updated successfully');\n      await load();\n    } catch (error) {\n      console.error('[Users.changeRole] Error updating role:', error?.message || error);\n      alert(`Failed to update role: ${error?.message || 'Unknown error'}`);\n    } finally { \n      setSaving((s) => ({ ...s, [id]: false })); \n    }\n  };\n\n  const filteredRows = useMemo(() => {\n    let filtered = rows.filter(u => {\n      const matchSearch = !search || \n        (u.email && u.email.toLowerCase().includes(search.toLowerCase())) ||\n        (u.display_name && u.display_name.toLowerCase().includes(search.toLowerCase()));\n      const matchRole = !roleFilter || u.role === roleFilter;\n      const matchActive = !activeFilter || u.status === activeFilter;\n      return matchSearch && matchRole && matchActive;\n    });\n\n    // Apply sorting\n    if (sortBy === 'latest_login') {\n      filtered.sort((a, b) => {\n        const dateA = a.created_at ? new Date(a.created_at).getTime() : 0;\n        const dateB = b.created_at ? new Date(b.created_at).getTime() : 0;\n        const diff = dateB - dateA;\n        return sortDir === 'desc' ? diff : -diff;\n      });\n    } else {\n      // Default ranking sort\n      filtered.sort((a, b) => {\n        const scoreA = typeof a.rankScore === 'number' ? a.rankScore : -1;\n        const scoreB = typeof b.rankScore === 'number' ? b.rankScore : -1;\n        let diff = scoreB - scoreA;\n        if (diff !== 0) return sortDir === 'desc' ? diff : -diff;\n        const roleOrder = { admin: 0, editor: 1, viewer: 2 };\n        const ra = roleOrder[a.role] ?? 3;\n        const rb = roleOrder[b.role] ?? 3;\n        if (ra !== rb) return ra - rb;\n        const nameA = (a.display_name || a.email || '').toLowerCase();\n        const nameB = (b.display_name || b.email || '').toLowerCase();\n        return nameA.localeCompare(nameB);\n      });\n    }\n\n    return filtered;\n  }, [rows, search, roleFilter, activeFilter, sortBy, sortDir]);\n\n  const paginatedRows = useMemo(() => {\n    const start = (page - 1) * pageSize;\n    const end = start + pageSize;\n    return filteredRows.slice(start, end);\n  }, [filteredRows, page, pageSize]);\n\n  const totalPages = useMemo(() => Math.max(1, Math.ceil(filteredRows.length / pageSize)), [filteredRows.length, pageSize]);\n\n  useEffect(() => {\n    setPage(1);\n  }, [search, roleFilter, activeFilter, sortBy, sortDir]);\n\n  const handleTierClick = (user) => {\n    if (!user || !user.id) return;\n    setSelectedUserTier(user);\n    setShowTierModal(true);\n  };\n\n  const isSuperadminEmail = (email) => {\n    return SUPERADMIN_EMAILS.includes(email);\n  };\n\n  return (\n    <div className=\"panel\">\n      <div className=\"panel-title\">Users</div>\n      \n      <UsersAnalytics rows={rows} />\n      \n      <div style={{ display: 'flex', gap: 6, marginBottom: 8, flexWrap: 'wrap', alignItems: 'center' }}>\n        <div style={{ position: 'relative', flex: '1 1 250px', minWidth: '200px', maxWidth: '270px' }}>\n          <FiSearch style={{ position: 'absolute', left: 8, top: '50%', transform: 'translateY(-50%)', color: '#8696a0', fontSize: '14px' }} />\n          <input\n            type=\"text\"\n            placeholder=\"Search by name or email...\"\n            value={search}\n            onChange={(e) => setSearch(e.target.value)}\n            className=\"input\"\n            style={{ paddingLeft: 32, width: '100%', backgroundColor: 'black', color: 'white', fontSize: '13px' }}\n          />\n        </div>\n        <select\n          className=\"select\"\n          value={roleFilter ? `role:${roleFilter}` : activeFilter ? `active:${activeFilter}` : `sort:${sortBy}:${sortDir}`}\n          onChange={(e) => {\n            const value = e.target.value;\n            if (value.startsWith('role:')) {\n              setRoleFilter(value.substring(5));\n              setActiveFilter('');\n              setSortBy('ranking');\n              setSortDir('desc');\n            } else if (value.startsWith('active:')) {\n              setActiveFilter(value.substring(7));\n              setRoleFilter('');\n              setSortBy('ranking');\n              setSortDir('desc');\n            } else if (value.startsWith('sort:')) {\n              const parts = value.substring(5).split(':');\n              setSortBy(parts[0]);\n              setSortDir(parts[1]);\n              setRoleFilter('');\n              setActiveFilter('');\n            }\n          }}\n          style={{ minWidth: 200, width: 'auto' }}\n        >\n          <option value=\"role:\">All Roles</option>\n          <option value=\"role:admin\">Admin</option>\n          <option value=\"role:editor\">Editor</option>\n          <option value=\"role:viewer\">Viewer</option>\n          <option value=\"active:\">All Status</option>\n          <option value=\"active:online\">Online</option>\n          <option value=\"active:offline\">Offline</option>\n          <option value=\"active:signed_out\">Signed Out</option>\n          <option value=\"sort:ranking:desc\">Ranking (High to Low)</option>\n          <option value=\"sort:ranking:asc\">Ranking (Low to High)</option>\n          <option value=\"sort:latest_login:desc\">Login (Newest)</option>\n          <option value=\"sort:latest_login:asc\">Login (Oldest)</option>\n        </select>\n      </div>\n\n      <table className=\"table\">\n        <thead>\n          <tr>\n            <th>Rank</th>\n            <th>Name</th>\n            <th>Email</th>\n            <th>Last Seen</th>\n            <th>Role</th>\n            <th>Scores</th>\n            <th>Actions</th>\n          </tr>\n        </thead>\n        <tbody>\n          {loading ? (\n            <tr><td colSpan={7} style={{ color: '#8696a0', textAlign: 'center' }}>Loading...</td></tr>\n          ) : paginatedRows.length === 0 ? (\n            <tr><td colSpan={7} style={{ color: '#8696a0', textAlign: 'center' }}>No users found</td></tr>\n          ) : paginatedRows.map((u, idx) => {\n            const rankPos = (page - 1) * pageSize + idx + 1;\n            return (\n            <tr key={u.id}>\n              <td style={{ fontSize: '13px', fontWeight: '600', color: '#00a884' }}>\n                #{rankPos}\n              </td>\n              <td>\n                <div style={{ display: 'flex', alignItems: 'center', gap: 8 }}>\n                  <div className=\"viewer-avatar\">\n                    {u.avatar_url ? (\n                      <img\n                        src={u.avatar_url}\n                        alt={u.display_name || u.email || 'User avatar'}\n                        style={{ width: '100%', height: '100%', borderRadius: '50%', objectFit: 'cover' }}\n                      />\n                    ) : (\n                      (u.display_name || u.email || '?').charAt(0).toUpperCase()\n                    )}\n                  </div>\n                  <span>{u.display_name || ''}</span>\n                </div>\n              </td>\n              <td>{u.email}</td>\n              <td>\n                <span style={{\n                  fontSize: '12px',\n                  fontWeight: u.lastSeen === 'Online' ? '600' : '500',\n                  color: u.lastSeen === 'Online' ? '#00a884' : '#8696a0'\n                }}>\n                  {u.lastSeen || 'never'}\n                </span>\n              </td>\n              <td>\n                {isSuperadminEmail(u.email) ? (\n                  <span style={{ color: '#ffd700', fontWeight: 600 }}>\n                    Superadmin\n                  </span>\n                ) : (\n                  <select\n                    className=\"select\"\n                    value={u.role}\n                    onChange={(e) => changeRole(u.id, e.target.value)}\n                    disabled={!isSuperAdmin || !!saving[u.id]}\n                    title={\n                      !isSuperAdmin\n                        ? 'Only the superadmin can change roles'\n                        : undefined\n                    }\n                  >\n                    <option value=\"viewer\">viewer</option>\n                    <option value=\"editor\">editor</option>\n                    <option value=\"admin\">admin</option>\n                  </select>\n                )}\n              </td>\n              <td>\n                {u.rankScore !== null ? (\n                  <span\n                    style={{\n                      display: 'inline-flex',\n                      alignItems: 'center',\n                      gap: 4,\n                      padding: '2px 8px',\n                      borderRadius: 999,\n                      fontSize: 11,\n                      fontWeight: 600,\n                      background:\n                        u.rankScore >= 200\n                          ? 'linear-gradient(135deg, #ffd700, #ff6f00)'\n                          : u.rankScore >= 100\n                          ? '#102a43'\n                          : u.rankScore >= 50\n                          ? '#0b3a2e'\n                          : '#111b21',\n                      color: u.rankScore >= 200 ? '#111' : '#e9edef',\n                      cursor: 'pointer',\n                    }}\n                    onClick={() => handleTierClick(u)}\n                  >\n                    <span>\n                      {Math.round(u.rankScore)}\n                    </span>\n                    {u.hasSubscriptionBoost && (\n                      <span\n                        title=\"Includes subscriber activity bonus\"\n                        style={{\n                          fontSize: 9,\n                          padding: '1px 4px',\n                          borderRadius: 8,\n                          background: 'rgba(0,0,0,0.3)',\n                        }}\n                      >\n                        sub\n                      </span>\n                    )}\n                  </span>\n                ) : (\n                  <span style={{ color: '#8696a0', fontSize: 11 }}>Not ranked yet</span>\n                )}\n              </td>\n              <td>\n                <div className=\"actions\">\n                  <button\n                    className=\"btn\"\n                    onClick={() => navigate(`/books/admin/users/${u.id}`)}\n                  >\n                    Details\n                  </button>\n                  {(() => {\n                    const hasUploads = (u.uploadCount || 0) > 0;\n                    const elevated = u.role === 'admin' || u.role === 'editor';\n                    if (!elevated && !hasUploads) return null;\n                    return (\n                      <>\n                        <button\n                          className=\"btn\"\n                          onClick={() => navigate(`/books/admin/users/${u.id}?tab=uploads`)}\n                          style={{ marginLeft: 8 }}\n                        >\n                          View uploads\n                        </button>\n                        {!elevated && hasUploads && (\n                          <span\n                            style={{\n                              marginLeft: 6,\n                              padding: '2px 6px',\n                              borderRadius: 8,\n                              fontSize: 10,\n                              background: '#202c33',\n                              color: '#8696a0',\n                            }}\n                          >\n                            had admin/editor access\n                          </span>\n                        )}\n                      </>\n                    );\n                  })()}\n                </div>\n              </td>\n            </tr>\n          );\n          })}\n        </tbody>\n      </table>\n      \n      {filteredRows.length > 0 && (\n        <div className=\"actions\" style={{ marginTop: 10, justifyContent: 'space-between' }}>\n          <button className=\"btn\" disabled={page <= 1} onClick={() => setPage(p => Math.max(1, p - 1))}>Prev</button>\n          <span style={{ color: '#cfd8dc' }}>Page {page} of {totalPages} ({filteredRows.length} users)</span>\n          <button className=\"btn\" disabled={page >= totalPages} onClick={() => setPage(p => Math.min(totalPages, p + 1))}>Next</button>\n        </div>\n      )}\n\n      {showTierModal && selectedUserTier && (\n        <UserTierModal\n          user={selectedUserTier}\n          onClose={() => setShowTierModal(false)}\n        />\n      )}\n    </div>\n  );\n};\n\nexport default Users;"],"names":["_ref","rows","range","setRange","useState","kpiActive","kpiSignedOut","totalActiveNow","totalUsers","totalSignedOut","chartData","rangeLabel","useMemo","now","Date","from","getTime","getFullYear","getMonth","getDate","totalUsersLocal","length","totalActiveNowLocal","totalSignedOutLocal","activePeriod","signedOutPeriod","forEach","u","createdAt","created_at","lastActiveAt","last_active_at","deactivatedAt","deactivated_at","isOnlineNow","ONLINE_WINDOW_MINUTES","isSignedOutByTimestamp","activityTime","_jsxs","style","marginBottom","children","display","justifyContent","alignItems","gap","flexWrap","_jsx","map","key","className","padding","borderRadius","background","color","border","fontSize","textTransform","onClick","gridTemplateColumns","marginTop","fontWeight","user","onClose","tierMetrics","setTierMetrics","tierMetricsLoading","setTierMetricsLoading","tierMetricsError","setTierMetricsError","useEffect","loadTierMetrics","id","async","userId","cutoffIso","toISOString","viewsRes","downloadsRes","likesRes","commentsRes","uploadsBooksRes","uploadsPastPapersRes","uploadsUniversitiesRes","sessionsRes","goalsRes","statsRes","streakRes","subsRes","searchEvents","Promise","all","supabase","select","count","head","eq","gte","maybeSingle","fetchUserSearchHistoryAdmin","days","safeCount","res","viewsCount","downloadsCount","likesCount","commentsCount","uploadsBooksCount","uploadsPastPapersCount","uploadsUniversitiesCount","sessionsCount","completedGoals","error","Array","isArray","data","filter","g","target_books","current_progress","booksCompleted","total_books_completed","streakDays","current_streak","activeSubscriptions","s","status","metrics","label","pointsPerUnit","m","_objectSpread","totalPoints","reduce","sum","tierFromPoints","e","console","formatTierName","tier","replace","position","inset","zIndex","maxWidth","width","maxHeight","overflowY","boxShadow","stopPropagation","borderBottom","rankTier","overflowX","textAlign","toFixed","colSpan","isSuperAdmin","setRows","loading","setLoading","saving","setSaving","search","setSearch","roleFilter","setRoleFilter","activeFilter","setActiveFilter","sortBy","setSortBy","sortDir","setSortDir","page","setPage","pageSize","showTierModal","setShowTierModal","selectedUserTier","setSelectedUserTier","navigate","useNavigate","SUPERADMIN_EMAILS","load","_profiles2","_profiles2$slice","_rankings2","_rankings2$slice","_uploadCounts2","_uploadCounts2$slice","profiles","rankings","uploadCounts","_profiles","fetchProfiles","log","message","_rankings","fetchUserRankingsAdmin","_uploadCounts","fetchUploadCountsByUser","groupCollapsed","slice","call","groupEnd","uploadsMap","Map","String","uploaded_by","books","pastPapers","past_papers","universities","total","rankingsMap","r","_r$user","_r$profiles","_r$profiles2","user_id","profile_id","email","user_email","k","undefined","set","computeFallbackRanking","profile","uploads","get","recencyScore","score","fallback","keys","concat","warn","normalizeRanking","_ref2","_ref3","_ref4","_r$tier","_ref5","_ref6","_r$subscription_bonus","pickNumber","_len","arguments","_key","Object","prototype","hasOwnProperty","n","Number","isNaN","rank_tier","level","category","subscription","subscription_bonus_applied","has_subscription_boost","subscription_boost","subscriber_bonus","raw","computeUserStatus","minutesAgo","isOnline","lastSeen","Math","round","enriched","p","byId","byEmail","norm","finalScore","finalTier","usedFallback","fb","info","debug","normalized","contrib","userStatus","uploadCount","contribBooks","contribPastPapers","contribUniversities","ranking","rankScore","rankPosition","hasSubscriptionBoost","sort","a","b","_roleOrder$a$role","_roleOrder$b$role","scoreA","scoreB","roleOrder","admin","editor","viewer","ra","role","rb","nameA","display_name","toLowerCase","nameB","localeCompare","filteredRows","filtered","matchSearch","includes","matchRole","matchActive","dateA","diff","_roleOrder$a$role2","_roleOrder$b$role2","paginatedRows","start","end","totalPages","max","ceil","UsersAnalytics","flex","minWidth","FiSearch","left","top","transform","type","placeholder","value","onChange","target","paddingLeft","backgroundColor","startsWith","substring","parts","split","idx","rankPos","avatar_url","src","alt","height","objectFit","charAt","toUpperCase","updateUserRole","alert","changeRole","disabled","title","cursor","hasUploads","elevated","_Fragment","marginLeft","min","UserTierModal"],"ignoreList":[],"sourceRoot":""}