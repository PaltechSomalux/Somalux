"use strict";(self.webpackChunkcampuslife=self.webpackChunkcampuslife||[]).push([[173],{1903:(e,a,n)=>{n.d(a,{Fn:()=>r,M9:()=>c,d$:()=>u,xH:()=>l,zd:()=>o});var t=n(7488),i=n(3488);const s=!0;async function l(e){let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10;try{let{data:l,error:r}=await t.N.rpc("search_university_names",{p_query:e,p_limit:a});if(r)throw r;if(null!==l&&void 0!==l&&l.length)return l;const o=await async function(e){let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10;try{const n="https://en.wikipedia.org/w/api.php?action=opensearch&search=".concat(encodeURIComponent(e+" university"),"&limit=").concat(a,"&namespace=0&format=json&origin=*"),t=await fetch(n);if(!t.ok)return[];const i=await t.json(),s=i[1]||[],l=i[2]||[],r=i[3]||[];return s.filter(e=>e.toLowerCase().includes("university")||e.toLowerCase().includes("college")).map((e,a)=>({name:e,description:l[a]||"",website_url:r[a]||""}))}catch(r){return console.error("Error searching Wikipedia:",r),[]}}(e,a);if(o.length>0)return await Promise.all(o.map(e=>d(e.name,e,"wikipedia"))),o;if(s)try{const n=await fetch("".concat(i.H,"/api/university/search?query=").concat(encodeURIComponent(e),"&limit=").concat(a));if(n.ok){const e=(await n.json()).universities||[];return e.length>0&&await Promise.all(e.map(e=>d(e.name,e,"google_proxy"))),e}}catch(n){console.warn("Backend proxy unavailable:",n.message)}return[]}catch(l){return console.error("Error searching university names:",l),[]}}async function r(e){try{var a,n,t;const i=(e||"").trim().replace(/\s+/g,"_");if(!i)return[];const s="https://commons.wikimedia.org/w/api.php?action=query&format=json&origin=*&prop=images&titles=".concat(encodeURIComponent(i)),l=await fetch(s);if(!l.ok)return[];const r=await l.json(),o=(null===(n=(null!==r&&void 0!==r&&null!==(a=r.query)&&void 0!==a&&a.pages?Object.values(r.query.pages):[])[0])||void 0===n?void 0:n.images)||[];if(!o.length)return[];const c=o.map(e=>null===e||void 0===e?void 0:e.title).filter(Boolean).slice(0,50).join("|");if(!c)return[];const d="https://commons.wikimedia.org/w/api.php?action=query&format=json&origin=*&prop=imageinfo&iiprop=url&titles=".concat(encodeURIComponent(c)),u=await fetch(d);if(!u.ok)return[];const p=await u.json(),m=(null!==p&&void 0!==p&&null!==(t=p.query)&&void 0!==t&&t.pages?Object.values(p.query.pages):[]).map(e=>{var a,n;return null===e||void 0===e||null===(a=e.imageinfo)||void 0===a||null===(n=a[0])||void 0===n?void 0:n.url}).filter(e=>"string"===typeof e&&/\.(jpg|jpeg|png|webp)$/i.test(e));return m.sort((e,a)=>{const n=e=>/logo|seal|coat_of_arms|emblem/i.test(e)?1:0;return n(e)-n(a)}).slice(0,5)}catch(i){return console.error("Error fetching Wikimedia images:",i),[]}}async function o(e){if(s)try{const n=await fetch("".concat(i.H,"/api/university/images?query=").concat(encodeURIComponent(e)));if(n.ok){var a;return(null===(a=(await n.json()).images)||void 0===a?void 0:a.map(e=>e.url))||[]}}catch(n){console.error("Error fetching Unsplash images via proxy:",n)}return[]}async function c(e,a){try{const n=await fetch(e);if(!n.ok)throw new Error("Failed to download image");const t=await n.blob();return new File([t],a,{type:t.type})}catch(n){return console.error("Error downloading image:",n),null}}async function d(e,a){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"manual";try{const{error:i}=await t.N.from("university_prefill_cache").upsert({university_name:e,data:a,source:n,updated_at:(new Date).toISOString()});if(i)throw i;return!0}catch(i){return console.error("Error caching prefill data:",i),!1}}async function u(e){try{let c=await async function(e){try{const{data:a,error:n}=await t.N.rpc("get_university_prefill_data",{p_university_name:e});if(n)throw n;return a}catch(a){return console.error("Error fetching prefill data:",a),null}}(e);if(c)return c;const u=await async function(e){try{var a;const n="https://en.wikipedia.org/api/rest_v1/page/summary/".concat(encodeURIComponent(e)),t=await fetch(n);if(!t.ok)return null;const i=await t.json();return{name:i.title||e,description:i.extract||"",website_url:"",location:"",established:null,student_count:null,cover_images:null!==(a=i.thumbnail)&&void 0!==a&&a.source?[i.thumbnail.source]:[]}}catch(n){return console.error("Error fetching from Wikipedia REST:",n),null}}(e),p=await async function(e){try{var a,n,t,i;const s='\n      SELECT ?item ?itemLabel ?locationLabel ?established ?studentCount ?website\n      WHERE {\n        ?item wdt:P31/wdt:P279* wd:Q3918;\n              rdfs:label ?itemLabel.\n        OPTIONAL { ?item wdt:P131 ?location. }\n        OPTIONAL { ?item wdt:P571 ?established. }\n        OPTIONAL { ?item wdt:P2196 ?studentCount. }\n        OPTIONAL { ?item wdt:P856 ?website. }\n        FILTER(CONTAINS(LCASE(?itemLabel), LCASE("'.concat(e,'")))\n        FILTER(LANG(?itemLabel) = "en")\n        SERVICE wikibase:label { bd:serviceParam wikibase:language "en". }\n      }\n      LIMIT 1\n    '),l="https://query.wikidata.org/sparql?query=".concat(encodeURIComponent(s),"&format=json"),r=await fetch(l);if(!r.ok)return null;const o=(await r.json()).results.bindings[0];return o?{name:o.itemLabel.value,description:"",website_url:(null===(a=o.website)||void 0===a?void 0:a.value)||"",location:(null===(n=o.locationLabel)||void 0===n?void 0:n.value)||"",established:null!==(t=o.established)&&void 0!==t&&t.value?new Date(o.established.value).getFullYear():null,student_count:(null===(i=o.studentCount)||void 0===i?void 0:i.value)||null,cover_images:[]}:null}catch(s){return console.error("Error fetching from Wikidata:",s),null}}(e);if(u||p){var a,n,l;c={name:null!==(a=(null===u||void 0===u?void 0:u.name)||(null===p||void 0===p?void 0:p.name)||e)&&void 0!==a?a:e,description:(null===u||void 0===u?void 0:u.description)||"",website_url:(null===p||void 0===p?void 0:p.website_url)||"",location:(null===p||void 0===p?void 0:p.location)||"",established:null!==(n=null===p||void 0===p?void 0:p.established)&&void 0!==n?n:null,student_count:null!==(l=null===p||void 0===p?void 0:p.student_count)&&void 0!==l?l:null,cover_images:(null===u||void 0===u?void 0:u.cover_images)||[]}}if(c||(c=await async function(e){if(s)try{const a=await fetch("".concat(i.H,"/api/university/details?name=").concat(encodeURIComponent(e)));if(a.ok){const n=await a.json();return{name:n.university.name||e,description:n.university.description||"",website_url:n.university.website_url||"",location:n.university.location||"",established:null,student_count:null,cover_images:n.university.image?[n.university.image]:[]}}}catch(a){console.error("Error fetching from Google via proxy:",a)}return null}(e)),c&&(!c.cover_images||0===c.cover_images.length)){const a=await r(c.name||e);if(a.length)c.cover_images=a;else{const a=await o(c.name||e);c.cover_images=a}}return c&&await d(e,c,"wikipedia_wikidata"),c||{name:e,description:"",website_url:"",location:"",established:null,student_count:null,cover_images:[]}}catch(c){return console.error("Error auto-filling university data:",c),{name:e,description:"",website_url:"",location:"",established:null,student_count:null,cover_images:[]}}}},9935:(e,a,n)=>{n.r(a),n.d(a,{default:()=>m});var t=n(9379),i=n(5043),s=n(4218),l=n(3515),r=n(4972),o=n(9738),c=n(1903),d=n(5200),u=n(9101),p=n(579);const m=e=>{let{userProfile:a,initialTab:n="books"}=e;(0,i.useEffect)(()=>{const e=document.createElement("style");return e.innerHTML="\n  .dropzone {\n    border: 2px dashed #374151;\n    border-radius: 8px;\n    padding: 20px;\n    text-align: center;\n    cursor: pointer;\n    transition: all 0.3s ease;\n  }\n  .dropzone:hover {\n    border-color: #00a884;\n    background: rgba(0, 168, 132, 0.05);\n  }\n  .dropzone.drag-over {\n    border-color: #00a884;\n    background: rgba(0, 168, 132, 0.1);\n  }\n  .upload-tabs {\n    display: flex;\n    gap: 8px;\n    margin-bottom: 20px;\n    border-bottom: 2px solid #374151;\n  }\n  .upload-tab {\n    display: flex;\n    align-items: center;\n    gap: 8px;\n    padding: 12px 24px;\n    background: transparent;\n    border: none;\n    color: #8696a0;\n    cursor: pointer;\n    font-size: 16px;\n    font-weight: 500;\n    transition: all 0.3s ease;\n    border-bottom: 3px solid transparent;\n    margin-bottom: -2px;\n  }\n  .upload-tab:hover {\n    color: #e9edef;\n    background: rgba(0, 168, 132, 0.05);\n  }\n  .upload-tab.active {\n    color: #00a884;\n    border-bottom-color: #00a884;\n  }\n  @keyframes spin {\n    from { transform: rotate(0deg); }\n    to { transform: rotate(360deg); }\n  }\n  .spin {\n    animation: spin 1s linear infinite;\n  }\n",document.head.appendChild(e),()=>e.remove()},[]);const[m,g]=(0,i.useState)(n),h=(0,s.Zp)(),{showToast:v}=(0,u.v)();(0,i.useEffect)(()=>{g(n)},[n]);const[b,y]=(0,i.useState)(null),[x,f]=(0,i.useState)(null),[j,w]=(0,i.useState)([]),[_,N]=(0,i.useState)({title:"",author:"",description:"",category_id:"",year:"",language:"",isbn:"",pages:"",publisher:""}),[C,k]=(0,i.useState)([]),[T,P]=(0,i.useState)({name:"",description:"",website_url:"",location:"",established:"",student_count:""}),[S,E]=(0,i.useState)(""),[A,L]=(0,i.useState)([]),[U,I]=(0,i.useState)(!1),[R,F]=(0,i.useState)(!1),[z,B]=(0,i.useState)(null),[D,H]=(0,i.useState)([]),[M,O]=(0,i.useState)({university_id:"",faculty:"",unit_code:"",unit_name:"",year:"",semester:"",exam_type:""}),[q,W]=(0,i.useState)(!1);(0,i.useEffect)(()=>{(async()=>{try{w(await(0,l.jE)()),H(await(0,o.Hk)())}catch(e){}})()},[]);const Y=e=>a=>N(n=>(0,t.A)((0,t.A)({},n),{},{[e]:a.target.value})),G=e=>a=>{P(n=>(0,t.A)((0,t.A)({},n),{},{[e]:a.target.value})),"name"===e&&(E(a.target.value),$(a.target.value))},$=function(e,a){const n=(0,i.useRef)(null);return(0,i.useCallback)(function(){for(var t=arguments.length,i=new Array(t),s=0;s<t;s++)i[s]=arguments[s];n.current&&clearTimeout(n.current),n.current=setTimeout(()=>e(...i),a)},[e,a])}(async e=>{if(e.length<2)return L([]),void I(!1);try{const a=await(0,c.xH)(e);L(a),I(a.length>0)}catch(a){console.error("Error searching:",a)}},300),Q=async e=>{F(!0),I(!1);try{const i=await(0,c.d$)(e||T.name);var a,n;if(i)if(P({name:i.name||"",description:i.description||"",website_url:i.website_url||"",location:i.location||"",established:(null===(a=i.established)||void 0===a?void 0:a.toString())||"",student_count:(null===(n=i.student_count)||void 0===n?void 0:n.toString())||""}),i.cover_images&&i.cover_images.length>0){const e=[];for(let a=0;a<Math.min(i.cover_images.length,5);a++){const n=i.cover_images[a],s="".concat(i.name.replace(/\s+/g,"_"),"_image_").concat(a+1,".jpg");try{const a=await(0,c.M9)(n,s);a&&e.push(a)}catch(t){console.error("Error downloading image:",t)}}e.length>0?(k(e),v({type:"success",message:"Auto-filled data for ".concat(i.name," with ").concat(e.length," image(s)!")})):v({type:"info",message:"Auto-filled data for ".concat(i.name,"! But images could not be downloaded, please upload manually.")})}else{let e=await(0,c.Fn)(i.name);if(e.length||(e=await(0,c.zd)(i.name)),e.length>0){const a=[];for(let n=0;n<e.length;n++)try{const t="".concat(i.name.replace(/\s+/g,"_"),"_auto_").concat(n+1,".jpg"),s=await(0,c.M9)(e[n],t);s&&a.push(s)}catch(t){console.error("Auto image download error:",t)}a.length>0?(k(a),v({type:"success",message:"Auto-filled data for ".concat(i.name," with ").concat(a.length," image(s)!")})):v({type:"info",message:"Auto-filled data for ".concat(i.name,", but images couldn't be downloaded.")})}else v({type:"info",message:"Auto-filled data for ".concat(i.name,", but no images were found automatically.")})}else v({type:"info",message:"No data found for this university. Please enter details manually."})}catch(i){console.error("Error auto-filling:",i),v({type:"error",message:"Failed to auto-fill data. Please try again."})}finally{F(!1)}},Z=e=>a=>O(n=>(0,t.A)((0,t.A)({},n),{},{[e]:a.target.value})),J=(e,a,n,t,i)=>(0,p.jsxs)("div",{className:"dropzone",onDragOver:e=>{e.preventDefault(),e.currentTarget.classList.add("drag-over")},onDragLeave:e=>{e.preventDefault(),e.currentTarget.classList.remove("drag-over")},onDrop:e=>{e.preventDefault(),e.currentTarget.classList.remove("drag-over");const t=e.dataTransfer.files[0];t&&t.type.match(n)&&a(t)},onClick:()=>document.getElementById("".concat(t,"-input")).click(),style:{border:"2px dashed #374151",borderRadius:"8px",padding:"20px",textAlign:"center",cursor:"pointer",background:e?"rgba(0, 168, 132, 0.1)":"transparent",transition:"all 0.3s ease"},children:[(0,p.jsx)("input",{id:"".concat(t,"-input"),type:"file",accept:n,onChange:e=>{var n;return a((null===(n=e.target.files)||void 0===n?void 0:n[0])||null)},style:{display:"none"}}),e?(0,p.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",gap:"10px",color:"#00a884"},children:[i,(0,p.jsx)("span",{children:e.name})]}):(0,p.jsxs)("div",{children:[(0,p.jsx)(d.B88,{size:20,style:{marginBottom:"4px",color:"#8696a0"}}),(0,p.jsx)("div",{style:{color:"#e9edef"},children:"Drag and drop or click to browse"}),(0,p.jsx)("div",{style:{color:"#8696a0",fontSize:"0.85em",marginTop:"2px"},children:"application/pdf"===n?"PDF files only":"Image files (JPG, PNG, GIF)"})]})]});return(0,p.jsxs)("div",{className:"panel",children:[(0,p.jsx)("div",{className:"panel-title",children:"Upload Content"}),(0,p.jsxs)("div",{className:"upload-tabs",children:[(0,p.jsxs)("button",{className:"upload-tab ".concat("books"===m?"active":""),onClick:()=>g("books"),children:[(0,p.jsx)(d.H9b,{size:20}),"Books"]}),(0,p.jsxs)("button",{className:"upload-tab ".concat("campus"===m?"active":""),onClick:()=>g("campus"),children:[(0,p.jsx)(d.HzC,{size:20}),"Campus"]}),(0,p.jsxs)("button",{className:"upload-tab ".concat("pastpapers"===m?"active":""),onClick:()=>g("pastpapers"),children:[(0,p.jsx)(d.jH2,{size:20}),"Past Papers"]})]}),"books"===m&&(0,p.jsxs)("div",{className:"grid-2",children:[(0,p.jsxs)("div",{className:"panel",children:[(0,p.jsx)("label",{className:"label",children:"PDF File"}),J(b,y,"application/pdf","pdf",(0,p.jsx)(d.QuH,{size:24})),(0,p.jsx)("label",{className:"label",style:{marginTop:20},children:"Cover Image (optional)"}),J(x,f,"image/*","cover",(0,p.jsx)(d.fZZ,{size:24}))]}),(0,p.jsxs)("div",{className:"panel",children:[(0,p.jsx)("label",{className:"label",children:"Title"}),(0,p.jsx)("input",{className:"input",placeholder:"Book title",value:_.title,onChange:Y("title")}),(0,p.jsx)("label",{className:"label",style:{marginTop:10},children:"Author"}),(0,p.jsx)("input",{className:"input",placeholder:"Author",value:_.author,onChange:Y("author")}),(0,p.jsx)("label",{className:"label",style:{marginTop:10},children:"Description"}),(0,p.jsx)("textarea",{className:"input",rows:5,placeholder:"Short description",value:_.description,onChange:Y("description")}),(0,p.jsxs)("div",{className:"grid-2",style:{marginTop:10},children:[(0,p.jsxs)("div",{children:[(0,p.jsx)("label",{className:"label",children:"Category"}),(0,p.jsxs)("select",{className:"select",value:_.category_id,onChange:Y("category_id"),children:[(0,p.jsx)("option",{value:"",children:"Uncategorized"}),j.map(e=>(0,p.jsx)("option",{value:e.id,children:e.name},e.id))]})]}),(0,p.jsxs)("div",{children:[(0,p.jsx)("label",{className:"label",children:"Year"}),(0,p.jsx)("input",{className:"input",placeholder:"Year",value:_.year,onChange:Y("year")})]})]}),(0,p.jsxs)("div",{className:"grid-2",style:{marginTop:10},children:[(0,p.jsxs)("div",{children:[(0,p.jsx)("label",{className:"label",children:"Language"}),(0,p.jsx)("input",{className:"input",placeholder:"English",value:_.language,onChange:Y("language")})]}),(0,p.jsxs)("div",{children:[(0,p.jsx)("label",{className:"label",children:"ISBN"}),(0,p.jsx)("input",{className:"input",placeholder:"978-0-123456-78-9",value:_.isbn,onChange:Y("isbn")})]})]}),(0,p.jsxs)("div",{className:"grid-2",style:{marginTop:10},children:[(0,p.jsxs)("div",{children:[(0,p.jsx)("label",{className:"label",children:"Pages"}),(0,p.jsx)("input",{className:"input",type:"number",placeholder:"Number of pages",value:_.pages,onChange:Y("pages")})]}),(0,p.jsxs)("div",{children:[(0,p.jsx)("label",{className:"label",children:"Publisher"}),(0,p.jsx)("input",{className:"input",placeholder:"Publisher name",value:_.publisher,onChange:Y("publisher")})]})]}),(0,p.jsx)("div",{className:"actions",style:{marginTop:12},children:(0,p.jsx)("button",{className:"btn primary",disabled:q,onClick:async()=>{if(b){W(!0);try{var e;const n={title:_.title||(null===b||void 0===b||null===(e=b.name)||void 0===e?void 0:e.replace(/\.[^/.]+$/,""))||"",author:_.author||"Unknown",description:_.description||"",category_id:_.category_id||null,year:_.year?Number(_.year):null,language:_.language||"",isbn:_.isbn||"",pages:_.pages?Number(_.pages):0,publisher:_.publisher||"",uploaded_by:(null===a||void 0===a?void 0:a.id)||null};await(0,l.WI)({metadata:n,pdfFile:b,coverFile:x}),v({type:"success",message:"Book submitted for approval. Admin will review it shortly."}),y(null),f(null),N({title:"",author:"",description:"",category_id:"",year:"",language:"",isbn:"",pages:"",publisher:""}),h("/user/upload")}catch(n){console.error("Book upload failed:",n),v({type:"error",message:(null===n||void 0===n?void 0:n.message)||"Upload failed."})}finally{W(!1)}}else v({type:"error",message:"Please choose a PDF file."})},children:q?"Uploading...":"Upload Book"})})]})]}),"campus"===m&&(0,p.jsxs)("div",{className:"grid-2",children:[(0,p.jsxs)("div",{className:"panel",children:[(0,p.jsx)("label",{className:"label",children:"University Cover Images (Multiple)"}),(0,p.jsx)("input",{type:"file",accept:"image/*",multiple:!0,onChange:e=>k(Array.from(e.target.files)),style:{marginBottom:"10px"},className:"input"}),C.length>0&&(0,p.jsxs)("div",{style:{marginTop:"10px",color:"#00a884"},children:["\u2713 ",C.length," image(s) selected",(0,p.jsxs)("button",{onClick:()=>k([]),style:{marginLeft:"10px",color:"#dc2626",background:"none",border:"none",cursor:"pointer"},children:[(0,p.jsx)(d.yGN,{})," Clear"]})]}),(0,p.jsx)("div",{style:{display:"grid",gridTemplateColumns:"repeat(2, 1fr)",gap:"4px",marginTop:"6px"},children:C.map((e,a)=>(0,p.jsxs)("div",{style:{position:"relative",border:"2px solid #374151",borderRadius:"8px",overflow:"hidden"},children:[(0,p.jsx)("img",{src:URL.createObjectURL(e),alt:"Preview ".concat(a+1),style:{width:"100%",height:"120px",objectFit:"cover"}}),(0,p.jsx)("button",{"aria-label":"Remove image",title:"Remove",onClick:()=>k(e=>e.filter((e,n)=>n!==a)),style:{position:"absolute",top:"6px",left:"6px",width:"20px",height:"20px",padding:"2px",borderRadius:"6px",fontWeight:"bold",border:"none",cursor:"pointer",background:"#a08f8f96",color:"#111010ff",display:"flex",alignItems:"center",justifyContent:"center",boxShadow:"0 2px 6px rgba(0,0,0,0.4)"},children:"X"}),(0,p.jsx)("div",{style:{position:"absolute",top:"4px",right:"4px",background:"rgba(0,0,0,0.7)",padding:"4px 8px",borderRadius:"4px",color:"white",fontSize:"12px"},children:0===a?"Primary":"#".concat(a+1)})]},a))})]}),(0,p.jsxs)("div",{className:"panel",children:[(0,p.jsx)("label",{className:"label",children:"University Name *"}),(0,p.jsxs)("div",{style:{position:"relative"},children:[(0,p.jsx)("input",{className:"input",placeholder:"e.g., University of Nairobi",value:T.name,onChange:G("name"),style:{paddingRight:"80px"}}),(0,p.jsx)("button",{onClick:()=>Q(),disabled:!T.name||R,style:{position:"absolute",right:"8px",top:"50%",transform:"translateY(-50%)",background:"#00a884",color:"white",border:"none",padding:"6px 12px",borderRadius:"4px",cursor:T.name&&!R?"pointer":"not-allowed",fontSize:"12px",opacity:T.name&&!R?1:.5,display:"flex",alignItems:"center",gap:"4px"},children:R?(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)(d.TwU,{className:"spin"})," Loading"]}):(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)(d.CKj,{})," Auto-Fill"]})}),U&&A.length>0&&(0,p.jsx)("div",{style:{position:"absolute",top:"100%",left:0,right:0,background:"#202c33",border:"1px solid #374151",borderRadius:"8px",marginTop:"4px",maxHeight:"200px",overflowY:"auto",zIndex:1e3,boxShadow:"0 4px 6px rgba(0,0,0,0.3)"},children:A.map((e,a)=>(0,p.jsx)("div",{onClick:()=>Q(e.university_name),style:{padding:"10px",cursor:"pointer",borderBottom:a<A.length-1?"1px solid #374151":"none",transition:"background 0.2s"},onMouseEnter:e=>e.target.style.background="rgba(0, 168, 132, 0.1)",onMouseLeave:e=>e.target.style.background="transparent",children:e.university_name},a))})]}),(0,p.jsx)("label",{className:"label",style:{marginTop:10},children:"Description"}),(0,p.jsx)("textarea",{className:"input",rows:4,placeholder:"Brief description about the university",value:T.description,onChange:G("description")}),(0,p.jsxs)("div",{className:"grid-2",style:{marginTop:10},children:[(0,p.jsxs)("div",{children:[(0,p.jsx)("label",{className:"label",children:"Location"}),(0,p.jsx)("input",{className:"input",placeholder:"e.g., Nairobi",value:T.location,onChange:G("location")})]}),(0,p.jsxs)("div",{children:[(0,p.jsx)("label",{className:"label",children:"Website URL"}),(0,p.jsx)("input",{className:"input",placeholder:"https://...",value:T.website_url,onChange:G("website_url")})]})]}),(0,p.jsxs)("div",{className:"grid-2",style:{marginTop:10},children:[(0,p.jsxs)("div",{children:[(0,p.jsx)("label",{className:"label",children:"Established Year"}),(0,p.jsx)("input",{className:"input",type:"number",placeholder:"e.g., 1956",value:T.established,onChange:G("established")})]}),(0,p.jsxs)("div",{children:[(0,p.jsx)("label",{className:"label",children:"Student Count"}),(0,p.jsx)("input",{className:"input",type:"number",placeholder:"e.g., 84000",value:T.student_count,onChange:G("student_count")})]})]}),(0,p.jsx)("div",{className:"actions",style:{marginTop:12},children:(0,p.jsx)("button",{className:"btn primary",disabled:q,onClick:async()=>{if(T.name){W(!0);try{const e={name:T.name,description:T.description||"",website_url:T.website_url||"",location:T.location||"",established:T.established?Number(T.established):null,student_count:T.student_count?Number(T.student_count):0},a=C[0]||null;(await(0,r.zj)({metadata:e,coverFile:a})).id;v({type:"success",message:"University submitted for approval with ".concat(C.length," image(s)!")}),P({name:"",description:"",website_url:"",location:"",established:"",student_count:""}),k([]),h("/user/upload")}catch(e){console.error("University upload failed:",e),v({type:"error",message:(null===e||void 0===e?void 0:e.message)||"Upload failed."})}finally{W(!1)}}else v({type:"error",message:"Please enter university name."})},children:q?"Adding...":"Add University"})})]})]}),"pastpapers"===m&&(0,p.jsxs)("div",{className:"grid-2",children:[(0,p.jsxs)("div",{className:"panel",children:[(0,p.jsx)("label",{className:"label",children:"Past Paper PDF *"}),J(z,B,"application/pdf","paper-pdf",(0,p.jsx)(d.QuH,{size:24}))]}),(0,p.jsxs)("div",{className:"panel",children:[(0,p.jsx)("label",{className:"label",children:"University (optional)"}),(0,p.jsxs)("select",{className:"select",value:M.university_id,onChange:Z("university_id"),children:[(0,p.jsx)("option",{value:"",children:"Select University"}),D.map(e=>(0,p.jsx)("option",{value:e.id,children:e.name},e.id))]}),(0,p.jsx)("label",{className:"label",style:{marginTop:10},children:"Faculty *"}),(0,p.jsx)("input",{className:"input",placeholder:"e.g., Engineering, Business, Arts",value:M.faculty,onChange:Z("faculty")}),(0,p.jsxs)("div",{className:"grid-2",style:{marginTop:10},children:[(0,p.jsxs)("div",{children:[(0,p.jsx)("label",{className:"label",children:"Unit Code *"}),(0,p.jsx)("input",{className:"input",placeholder:"e.g., CS101",value:M.unit_code,onChange:Z("unit_code")})]}),(0,p.jsxs)("div",{children:[(0,p.jsx)("label",{className:"label",children:"Unit Name *"}),(0,p.jsx)("input",{className:"input",placeholder:"e.g., Introduction to Programming",value:M.unit_name,onChange:Z("unit_name")})]})]}),(0,p.jsxs)("div",{className:"grid-2",style:{marginTop:10},children:[(0,p.jsxs)("div",{children:[(0,p.jsx)("label",{className:"label",children:"Year"}),(0,p.jsx)("input",{className:"input",type:"number",placeholder:"e.g., 2023",value:M.year,onChange:Z("year")})]}),(0,p.jsxs)("div",{children:[(0,p.jsx)("label",{className:"label",children:"Semester"}),(0,p.jsxs)("select",{className:"select",value:M.semester,onChange:Z("semester"),children:[(0,p.jsx)("option",{value:"",children:"Select Semester"}),(0,p.jsx)("option",{value:"1",children:"Semester 1"}),(0,p.jsx)("option",{value:"2",children:"Semester 2"}),(0,p.jsx)("option",{value:"3",children:"Semester 3"})]})]})]}),(0,p.jsx)("label",{className:"label",style:{marginTop:10},children:"Exam Type"}),(0,p.jsxs)("select",{className:"select",value:M.exam_type,onChange:Z("exam_type"),children:[(0,p.jsx)("option",{value:"Main",children:"Main Exam"}),(0,p.jsx)("option",{value:"Supplementary",children:"Supplementary"}),(0,p.jsx)("option",{value:"CAT",children:"CAT"}),(0,p.jsx)("option",{value:"Mock",children:"Mock Exam"})]}),(0,p.jsx)("div",{className:"actions",style:{marginTop:12},children:(0,p.jsx)("button",{className:"btn primary",disabled:q,onClick:async()=>{if(z)if(M.faculty)if(M.unit_code)if(M.unit_name){W(!0);try{const e={title:"".concat(M.unit_code," - ").concat(M.unit_name),university_id:M.university_id||null,faculty:M.faculty,unit_code:M.unit_code,unit_name:M.unit_name,year:M.year?Number(M.year):null,semester:M.semester||"",exam_type:M.exam_type||"Main",uploaded_by:(null===a||void 0===a?void 0:a.id)||null};await(0,o.Jw)({metadata:e,pdfFile:z}),v({type:"success",message:"Past paper submitted for approval. Admin will review it shortly."}),O({university_id:"",faculty:"",unit_code:"",unit_name:"",year:"",semester:"",exam_type:""}),B(null),h("/user/upload")}catch(e){console.error("Past paper upload failed:",e),v({type:"error",message:(null===e||void 0===e?void 0:e.message)||"Upload failed."})}finally{W(!1)}}else v({type:"error",message:"Please enter unit name."});else v({type:"error",message:"Please enter unit code."});else v({type:"error",message:"Please enter faculty."});else v({type:"error",message:"Please choose a PDF file."})},children:q?"Uploading...":"Upload Past Paper"})})]})]})]})}}}]);
//# sourceMappingURL=173.037b57ad.chunk.js.map