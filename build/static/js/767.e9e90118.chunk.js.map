{"version":3,"file":"static/js/767.e9e90118.chunk.js","mappings":"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","sources":["SomaLux/Books/Admin/pages/Books.jsx","SomaLux/Books/Admin/pages/UniversitiesManagement.jsx","SomaLux/Books/Admin/pages/PastPapersManagement.jsx","SomaLux/Books/Admin/authorInteractionsApi.js","SomaLux/Books/Admin/pages/Authors.jsx","SomaLux/Books/Admin/pages/ContentManagement.jsx","SomaLux/Books/Admin/universityPrefillApi.js"],"sourcesContent":["import React, { useEffect, useMemo, useState } from 'react';\nimport { fetchBooks, fetchCategories, deleteBook, updateBook } from '../api';\nimport { useAdminUI } from '../AdminUIContext';\n\nconst Books = ({ userProfile }) => {\n  const [loading, setLoading] = useState(true);\n  const [rows, setRows] = useState([]);\n  const [count, setCount] = useState(0);\n  const [page, setPage] = useState(1);\n  const [pageSize] = useState(10);\n  const [search, setSearch] = useState('');\n  const [categories, setCategories] = useState([]);\n  const [categoryId, setCategoryId] = useState(null);\n  const [sort, setSort] = useState({ col: 'created_at', dir: 'desc' });\n  const [editingId, setEditingId] = useState(null);\n  const [editDraft, setEditDraft] = useState({});\n  const [newPdf, setNewPdf] = useState(null);\n  const [newCover, setNewCover] = useState(null);\n\n  const { confirm, showToast } = useAdminUI();\n\n  const ADMIN_EMAILS = ['campuslives254@gmail.com', 'paltechsomalux@gmail.com'];\n  const isAdmin = userProfile?.role === 'admin' || ADMIN_EMAILS.includes(userProfile?.email);\n  const isEditor = userProfile?.role === 'editor' || ADMIN_EMAILS.includes(userProfile?.email);\n\n  const totalPages = useMemo(() => Math.max(1, Math.ceil(count / pageSize)), [count, pageSize]);\n\n  const load = async () => {\n    setLoading(true);\n    try {\n      const { data, count: total } = await fetchBooks({ \n        page, \n        pageSize, \n        search, \n        categoryId, \n        sort\n      });\n      \n      setRows(data);\n      setCount(total);\n    } finally { setLoading(false); }\n  };\n\n  useEffect(() => {\n    (async () => {\n      try { setCategories(await fetchCategories()); } catch {}\n      if (userProfile) {\n        await load();\n      }\n    })();\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [page, search, categoryId, sort.col, sort.dir, userProfile]);\n\n  const canEdit = (row) => {\n    if (isAdmin) return true;\n    if (isEditor) return true;\n    return false;\n  };\n\n  const startEdit = (row) => {\n    if (!canEdit(row)) {\n      showToast({ type: 'error', message: 'You do not have permission to edit this book.' });\n      return;\n    }\n    setEditingId(row.id);\n    setEditDraft({\n      title: row.title || '',\n      author: row.author || '',\n      year: row.year || '',\n      category_id: row.category_id || null,\n      language: row.language || '',\n      isbn: row.isbn || '',\n      pages: row.pages || '',\n      publisher: row.publisher || ''\n    });\n    setNewPdf(null);\n    setNewCover(null);\n  };\n\n  const cancelEdit = () => {\n    setEditingId(null);\n    setEditDraft({});\n    setNewPdf(null);\n    setNewCover(null);\n  };\n\n  const saveEdit = async (row) => {\n    if (!canEdit(row)) {\n      showToast({ type: 'error', message: 'You can only edit books you uploaded.' });\n      return;\n    }\n    const updates = { ...editDraft };\n\n    try {\n      await updateBook(row.id, { updates, newPdfFile: newPdf, newCoverFile: newCover, oldFilePath: row.file_path });\n      cancelEdit();\n      await load();\n      showToast({ type: 'success', message: 'Book details updated.' });\n    } catch (e) {\n      console.error('Failed to update book:', e);\n      showToast({ type: 'error', message: e?.message || 'Failed to update book.' });\n    }\n  };\n\n  const handleDelete = async (row) => {\n    if (!canEdit(row)) {\n      showToast({ type: 'error', message: 'You can only delete books you uploaded.' });\n      return;\n    }\n    const ok = await confirm({\n      title: 'Delete book?',\n      message: `Delete \"${row.title}\" and its files? This action cannot be undone.`,\n      confirmLabel: 'Delete',\n      cancelLabel: 'Cancel',\n      variant: 'danger',\n    });\n    if (!ok) return;\n\n    try {\n      await deleteBook({ id: row.id, file_path: row.file_path });\n      await load();\n      showToast({ type: 'success', message: 'Book deleted.' });\n    } catch (e) {\n      console.error('Failed to delete book:', e);\n      showToast({ type: 'error', message: e?.message || 'Failed to delete book.' });\n    }\n  };\n\n  const toggleSort = (col) => {\n    setSort((s) => (s.col === col ? { col, dir: s.dir === 'asc' ? 'desc' : 'asc' } : { col, dir: 'asc' }));\n  };\n\n  return (\n    <div>\n      <div className=\"panel\">\n        <div className=\"panel-title\">Books Management</div>\n\n        {/* Stats Summary */}\n        {!loading && rows.length > 0 && (\n          <div style={{ display: 'grid', gridTemplateColumns: 'repeat(auto-fit, minmax(150px, 1fr))', gap: '8px', marginBottom: '12px' }}>\n            <div style={{ background: '#1a2332', border: '1px solid #2a3f56', borderRadius: '6px', padding: '8px 12px', color: '#8696a0', fontSize: '0.85rem' }}>\n              <div style={{ color: '#00a884', fontSize: '1.2rem', fontWeight: '600' }}>{rows.reduce((sum, r) => sum + (r.downloads || 0), 0)}</div>\n              <div>Total Downloads</div>\n            </div>\n            <div style={{ background: '#1a2332', border: '1px solid #2a3f56', borderRadius: '6px', padding: '8px 12px', color: '#8696a0', fontSize: '0.85rem' }}>\n              <div style={{ color: '#34B7F1', fontSize: '1.2rem', fontWeight: '600' }}>{rows.reduce((sum, r) => sum + (r.views || 0), 0)}</div>\n              <div>Total Views</div>\n            </div>\n            <div style={{ background: '#1a2332', border: '1px solid #2a3f56', borderRadius: '6px', padding: '8px 12px', color: '#8696a0', fontSize: '0.85rem' }}>\n              <div style={{ color: '#FF6B9D', fontSize: '1.2rem', fontWeight: '600' }}>{rows.reduce((sum, r) => sum + (r.comments_count || 0), 0)}</div>\n              <div>Total Comments</div>\n            </div>\n            <div style={{ background: '#1a2332', border: '1px solid #2a3f56', borderRadius: '6px', padding: '8px 12px', color: '#8696a0', fontSize: '0.85rem' }}>\n              <div style={{ color: '#F44336', fontSize: '1.2rem', fontWeight: '600' }}>{rows.reduce((sum, r) => sum + (r.likes_count || 0), 0)}</div>\n              <div>Total Likes</div>\n            </div>\n            <div style={{ background: '#1a2332', border: '1px solid #2a3f56', borderRadius: '6px', padding: '8px 12px', color: '#8696a0', fontSize: '0.85rem' }}>\n              <div style={{ color: '#FFCC00', fontSize: '1.2rem', fontWeight: '600' }}>{rows.length}/{count}</div>\n              <div>Page Books</div>\n            </div>\n          </div>\n        )}\n\n        <div className=\"grid-2\" style={{ marginBottom: 6 }}>\n          <div className=\"panel\" style={{ padding: '6px 8px' }}>\n            <label className=\"label\" style={{ marginBottom: '0.2rem' }}>Search</label>\n            <input className=\"input\" value={search} onChange={(e) => { setPage(1); setSearch(e.target.value); }} placeholder=\"Search by title...\" style={{ fontSize: '0.9rem' }} />\n          </div>\n          <div className=\"panel\" style={{ padding: '6px 8px' }}>\n            <label className=\"label\" style={{ marginBottom: '0.2rem' }}>Category</label>\n            <select className=\"select\" value={categoryId || ''} onChange={(e) => { setPage(1); setCategoryId(e.target.value || null); }} style={{ fontSize: '0.9rem' }}>\n              <option value=\"\">All</option>\n              {categories.map(c => <option key={c.id} value={c.id}>{c.name}</option>)}\n            </select>\n          </div>\n        </div>\n\n        <div className=\"actions\" style={{ marginBottom: 10 }}>\n          <button className=\"btn primary\" onClick={() => (window.location.href = '/books/admin/upload')}>Add / Upload New Book</button>\n        </div>\n\n        <div className=\"panel\" style={{ padding: 0, overflowX: 'auto', WebkitOverflowScrolling: 'touch' }}>\n          <table className=\"table\" style={{ minWidth: '1620px', borderCollapse: 'separate', borderSpacing: 0 }}>\n            <thead>\n              <tr>\n                <th style={{ width: '60px' }}>Cover</th>\n                <th style={{ width: '300px', cursor: 'pointer' }} onClick={() => toggleSort('title')}>Title {sort.col === 'title' ? (sort.dir === 'asc' ? '' : '') : ''}</th>\n                <th style={{ width: '200px', cursor: 'pointer' }} onClick={() => toggleSort('author')}>Author {sort.col === 'author' ? (sort.dir === 'asc' ? '' : '') : ''}</th>\n                <th style={{ width: '120px' }}>Category</th>\n                <th style={{ width: '100px', cursor: 'pointer' }} onClick={() => toggleSort('year')}>Year {sort.col === 'year' ? (sort.dir === 'asc' ? '' : '') : ''}</th>\n                <th style={{ width: '100px' }}>Pages</th>\n                <th style={{ width: '180px' }}>Publisher</th>\n                <th style={{ width: '100px', cursor: 'pointer' }} onClick={() => toggleSort('downloads')}>Downloads {sort.col === 'downloads' ? (sort.dir === 'asc' ? '' : '') : ''}</th>\n                <th style={{ width: '80px', cursor: 'pointer', background: 'rgba(52, 183, 241, 0.1)', borderBottom: '2px solid #34B7F1' }} onClick={() => toggleSort('views')}>Views {sort.col === 'views' ? (sort.dir === 'asc' ? '' : '') : ''}</th>\n                <th style={{ width: '80px', cursor: 'pointer', background: 'rgba(255, 107, 157, 0.1)', borderBottom: '2px solid #FF6B9D' }} onClick={() => toggleSort('comments_count')}>Comments {sort.col === 'comments_count' ? (sort.dir === 'asc' ? '' : '') : ''}</th>\n                <th style={{ width: '80px', cursor: 'pointer', background: 'rgba(244, 67, 54, 0.1)', borderBottom: '2px solid #F44336' }} onClick={() => toggleSort('likes_count')}>Likes {sort.col === 'likes_count' ? (sort.dir === 'asc' ? '' : '') : ''}</th>\n                <th style={{ width: '100px' }}>Date Added</th>\n                <th style={{ width: '200px' }}>Actions</th>\n              </tr>\n            </thead>\n            <tbody>\n              {loading ? (\n                <tr><td colSpan={13} style={{ color: '#8696a0', textAlign: 'center' }}>Loading...</td></tr>\n              ) : rows.length === 0 ? (\n                <tr><td colSpan={13} style={{ color: '#8696a0', textAlign: 'center' }}>No data</td></tr>\n              ) : rows.map(row => (\n                <tr key={row.id}>\n                  <td>{row.cover_url ? <img src={row.cover_url} alt=\"cover\" style={{ width: 36, height: 48, objectFit: 'cover', borderRadius: 4 }} /> : <span className=\"badge\">No cover</span>}</td>\n                  <td>\n                    {editingId === row.id ? (\n                      <input className=\"input\" value={editDraft.title} onChange={(e) => setEditDraft({ ...editDraft, title: e.target.value })} />\n                    ) : row.title}\n                  </td>\n                  <td>\n                    {editingId === row.id ? (\n                      <input className=\"input\" value={editDraft.author} onChange={(e) => setEditDraft({ ...editDraft, author: e.target.value })} />\n                    ) : row.author}\n                  </td>\n                  <td>\n                    {editingId === row.id ? (\n                      <select className=\"select\" value={editDraft.category_id || ''} onChange={(e) => setEditDraft({ ...editDraft, category_id: e.target.value || null })}>\n                        <option value=\"\">Uncategorized</option>\n                        {categories.map(c => <option key={c.id} value={c.id}>{c.name}</option>)}\n                      </select>\n                    ) : (categories.find(c => c.id === row.category_id)?.name || '')}\n                  </td>\n                  <td>\n                    {editingId === row.id ? (\n                      <input className=\"input\" value={editDraft.year} onChange={(e) => setEditDraft({ ...editDraft, year: e.target.value })} />\n                    ) : (row.year || '')}\n                  </td>\n                  <td>\n                    {editingId === row.id ? (\n                      <input className=\"input\" type=\"number\" placeholder=\"Pages\" value={editDraft.pages} onChange={(e) => setEditDraft({ ...editDraft, pages: e.target.value })} />\n                    ) : (row.pages || '')}\n                  </td>\n                  <td>\n                    {editingId === row.id ? (\n                      <input className=\"input\" placeholder=\"Publisher\" value={editDraft.publisher} onChange={(e) => setEditDraft({ ...editDraft, publisher: e.target.value })} />\n                    ) : (row.publisher || '')}\n                  </td>\n                  <td>{row.downloads || 0}</td>\n                  <td style={{ fontWeight: '500', color: '#00a884' }}>{row.views || 0}</td>\n                  <td style={{ fontWeight: '500', color: '#FF6B9D' }}>{row.comments_count || 0}</td>\n                  <td style={{ fontWeight: '500', color: '#F44336' }}>{row.likes_count || 0}</td>\n                  <td>{new Date(row.created_at).toLocaleDateString()}</td>\n                  <td>\n                    {editingId === row.id ? (\n                      <div style={{ display: 'flex', flexDirection: 'column', gap: '10px', minWidth: '180px' }}>\n                        <div>\n                          <label className=\"label\">Replace PDF</label>\n                          <div\n                            className=\"file-upload-btn\"\n                            onClick={() => document.getElementById(`pdf-input-${row.id}`).click()}\n                            style={{\n                              border: '1px solid #374151',\n                              borderRadius: '6px',\n                              padding: '6px 12px',\n                              cursor: 'pointer',\n                              display: 'flex',\n                              alignItems: 'center',\n                              gap: '8px',\n                              background: newPdf ? 'rgba(0, 168, 132, 0.1)' : 'transparent',\n                              color: newPdf ? '#00a884' : '#e9edef',\n                              transition: 'all 0.2s'\n                            }}\n                          >\n                            <input\n                              id={`pdf-input-${row.id}`}\n                              type=\"file\"\n                              accept=\"application/pdf\"\n                              onChange={(e) => setNewPdf(e.target.files?.[0] || null)}\n                              style={{ display: 'none' }}\n                            />\n                            {newPdf ? (\n                              <> {newPdf.name.slice(0, 20)}{newPdf.name.length > 20 ? '...' : ''}</>\n                            ) : (\n                              <> Choose PDF</>\n                            )}\n                          </div>\n                        </div>\n                        <div>\n                          <label className=\"label\">Replace Cover</label>\n                          <div\n                            className=\"file-upload-btn\"\n                            onClick={() => document.getElementById(`cover-input-${row.id}`).click()}\n                            style={{\n                              border: '1px solid #374151',\n                              borderRadius: '6px',\n                              padding: '6px 12px',\n                              cursor: 'pointer',\n                              display: 'flex',\n                              alignItems: 'center',\n                              gap: '8px',\n                              background: newCover ? 'rgba(0, 168, 132, 0.1)' : 'transparent',\n                              color: newCover ? '#00a884' : '#e9edef',\n                              transition: 'all 0.2s'\n                            }}\n                          >\n                            <input\n                              id={`cover-input-${row.id}`}\n                              type=\"file\"\n                              accept=\"image/*\"\n                              onChange={(e) => setNewCover(e.target.files?.[0] || null)}\n                              style={{ display: 'none' }}\n                            />\n                            {newCover ? (\n                              <> {newCover.name.slice(0, 20)}{newCover.name.length > 20 ? '...' : ''}</>\n                            ) : (\n                              <> Choose Image</>\n                            )}\n                          </div>\n                        </div>\n                        <div style={{ display: 'flex', gap: '8px', marginTop: '4px' }}>\n                          <button className=\"btn primary\" onClick={() => saveEdit(row)}>Save</button>\n                          <button className=\"btn\" onClick={cancelEdit}>Cancel</button>\n                        </div>\n                      </div>\n                    ) : (\n                      <div className=\"actions\">\n                        <button \n                          className=\"btn\" \n                          onClick={() => startEdit(row)}\n                          disabled={!canEdit(row)}\n                        >\n                          Edit\n                        </button>\n                        <button \n                          className=\"btn\" \n                          onClick={() => handleDelete(row)}\n                          disabled={!canEdit(row)}\n                        >\n                          Delete\n                        </button>\n                      </div>\n                    )}\n                  </td>\n                </tr>\n              ))}\n            </tbody>\n          </table>\n        </div>\n\n        <div className=\"actions\" style={{ marginTop: 10 }}>\n          <button className=\"btn\" disabled={page <= 1} onClick={() => setPage(p => Math.max(1, p - 1))}>Prev</button>\n          <span style={{ color: '#cfd8dc' }}>Page {page} of {totalPages}</span>\n          <button className=\"btn\" disabled={page >= totalPages} onClick={() => setPage(p => Math.min(totalPages, p + 1))}>Next</button>\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default Books;\n","import React, { useEffect, useMemo, useState } from 'react';\nimport { fetchUniversities, deleteUniversity, updateUniversity } from '../campusApi';\nimport { getUniversityImages, deleteUniversityImage } from '../universityPrefillApi';\nimport { getPastPaperCountByUniversity } from '../pastPapersApi';\nimport { useAdminUI } from '../AdminUIContext';\n\nconst UniversitiesManagement = ({ userProfile }) => {\n  const [loading, setLoading] = useState(true);\n  const [rows, setRows] = useState([]);\n  const [count, setCount] = useState(0);\n  const [page, setPage] = useState(1);\n  const [pageSize] = useState(10);\n  const [search, setSearch] = useState('');\n  const [sort, setSort] = useState({ col: 'created_at', dir: 'desc' });\n  const [editingId, setEditingId] = useState(null);\n  const [editDraft, setEditDraft] = useState({});\n  const [newCover, setNewCover] = useState(null);\n  const [paperCounts, setPaperCounts] = useState({});\n\n  const { confirm, showToast } = useAdminUI();\n\n  const ADMIN_EMAILS = ['campuslives254@gmail.com', 'paltechsomalux@gmail.com'];\n  const isAdmin = userProfile?.role === 'admin' || ADMIN_EMAILS.includes(userProfile?.email);\n  const isEditor = userProfile?.role === 'editor' || ADMIN_EMAILS.includes(userProfile?.email);\n\n  const totalPages = useMemo(() => Math.max(1, Math.ceil(count / pageSize)), [count, pageSize]);\n\n  const load = async () => {\n    setLoading(true);\n    try {\n      const { data, count: total } = await fetchUniversities({ page, pageSize, search, sort });\n      setRows(data);\n      setCount(total);\n      \n      // Fetch paper counts for each university\n      const counts = {};\n      for (const uni of data) {\n        counts[uni.id] = await getPastPaperCountByUniversity(uni.id);\n      }\n      setPaperCounts(counts);\n    } finally { setLoading(false); }\n  };\n\n  useEffect(() => {\n    if (userProfile) load();\n  }, [page, search, sort.col, sort.dir, userProfile]);\n\n  const canEdit = (row) => {\n    if (isAdmin) return true;\n    if (isEditor) return true;\n    return false;\n  };\n\n  const startEdit = (row) => {\n    if (!canEdit(row)) {\n      showToast({ type: 'error', message: 'You do not have permission to edit this university.' });\n      return;\n    }\n    setEditingId(row.id);\n    setEditDraft({\n      name: row.name || '',\n      description: row.description || '',\n      website_url: row.website_url || '',\n      location: row.location || '',\n      established: row.established || '',\n      student_count: row.student_count || ''\n    });\n    setNewCover(null);\n  };\n\n  const cancelEdit = () => {\n    setEditingId(null);\n    setEditDraft({});\n    setNewCover(null);\n  };\n\n  const saveEdit = async (row) => {\n    if (!canEdit(row)) {\n      showToast({ type: 'error', message: 'You do not have permission to edit this university.' });\n      return;\n    }\n    const updates = { ...editDraft };\n\n    // Normalize numeric fields so we don't send \"\" to integer columns\n    if (updates.established === '' || updates.established === undefined) {\n      updates.established = null;\n    } else {\n      updates.established = Number(updates.established);\n    }\n\n    if (updates.student_count === '' || updates.student_count === undefined) {\n      updates.student_count = null;\n    } else {\n      updates.student_count = Number(updates.student_count);\n    }\n\n    try {\n      await updateUniversity(row.id, { updates, newCoverFile: newCover });\n      cancelEdit();\n      await load();\n      showToast({ type: 'success', message: 'University updated successfully.' });\n    } catch (e) {\n      console.error('Failed to update university:', e);\n      showToast({ type: 'error', message: e?.message || 'Failed to update university.' });\n    }\n  };\n\n  const handleDelete = async (row) => {\n    if (!canEdit(row)) {\n      showToast({ type: 'error', message: 'You can only delete universities you uploaded.' });\n      return;\n    }\n\n    const ok = await confirm({\n      title: 'Delete university?',\n      message: `Delete \"${row.name}\" and its related data? This action cannot be undone.`,\n      confirmLabel: 'Delete',\n      cancelLabel: 'Cancel',\n      variant: 'danger',\n    });\n    if (!ok) return;\n\n    try {\n      await deleteUniversity({ id: row.id, cover_image_url: row.cover_image_url });\n      await load();\n      showToast({ type: 'success', message: 'University deleted.' });\n    } catch (err) {\n      console.error('Failed to delete university:', err);\n      showToast({ type: 'error', message: err?.message || 'Failed to delete university.' });\n    }\n  };\n\n  const toggleSort = (col) => {\n    setSort((s) => (s.col === col ? { col, dir: s.dir === 'asc' ? 'desc' : 'asc' } : { col, dir: 'asc' }));\n  };\n\n  return (\n    <div>\n      <div className=\"panel\">\n        <div className=\"panel-title\">Universities Management</div>\n\n        {/* Stats Summary */}\n        {!loading && rows.length > 0 && (\n          <div style={{ display: 'grid', gridTemplateColumns: 'repeat(auto-fit, minmax(150px, 1fr))', gap: '8px', marginBottom: '12px' }}>\n            <div style={{ background: '#1a2332', border: '1px solid #2a3f56', borderRadius: '6px', padding: '8px 12px', color: '#8696a0', fontSize: '0.85rem' }}>\n              <div style={{ color: '#34B7F1', fontSize: '1.2rem', fontWeight: '600' }}>{rows.reduce((sum, r) => sum + (r.views || 0), 0)}</div>\n              <div>Total Views</div>\n            </div>\n            <div style={{ background: '#1a2332', border: '1px solid #2a3f56', borderRadius: '6px', padding: '8px 12px', color: '#8696a0', fontSize: '0.85rem' }}>\n              <div style={{ color: '#E74C3C', fontSize: '1.2rem', fontWeight: '600' }}>{rows.reduce((sum, r) => sum + (r.likes_count || 0), 0)}</div>\n              <div>Total Likes</div>\n            </div>\n            <div style={{ background: '#1a2332', border: '1px solid #2a3f56', borderRadius: '6px', padding: '8px 12px', color: '#8696a0', fontSize: '0.85rem' }}>\n              <div style={{ color: '#FFCC00', fontSize: '1.2rem', fontWeight: '600' }}>{rows.length}/{count}</div>\n              <div>Page Universities</div>\n            </div>\n          </div>\n        )}\n\n        <div className=\"panel\" style={{ marginBottom: 6 }}>\n          <label className=\"label\">Search</label>\n          <input className=\"input\" value={search} onChange={(e) => { setPage(1); setSearch(e.target.value); }} placeholder=\"Search by name or location...\" />\n        </div>\n\n        <div className=\"actions\" style={{ marginBottom: 6 }}>\n          <button className=\"btn primary\" onClick={() => (window.location.href = '/books/admin/upload')}>Add New University</button>\n        </div>\n\n        <div className=\"panel\" style={{ padding: 0, overflowX: 'auto' }}>\n          <table className=\"table\" style={{ minWidth: '1200px' }}>\n            <thead>\n              <tr>\n                <th style={{ width: '60px' }}>Cover</th>\n                <th style={{ width: '250px', cursor: 'pointer' }} onClick={() => toggleSort('name')}>Name {sort.col === 'name' ? (sort.dir === 'asc' ? '' : '') : ''}</th>\n                <th style={{ width: '300px' }}>Description</th>\n                <th style={{ width: '150px' }}>Location</th>\n                <th style={{ width: '100px', cursor: 'pointer' }} onClick={() => toggleSort('established')}>Est. {sort.col === 'established' ? (sort.dir === 'asc' ? '' : '') : ''}</th>\n                <th style={{ width: '100px' }}>Students</th>\n                <th style={{ width: '80px', cursor: 'pointer', background: 'rgba(52, 183, 241, 0.1)', borderBottom: '2px solid #34B7F1' }} onClick={() => toggleSort('views_count')}>Views {sort.col === 'views_count' ? (sort.dir === 'asc' ? '' : '') : ''}</th>\n                <th style={{ width: '80px', cursor: 'pointer', background: 'rgba(231, 76, 60, 0.1)', borderBottom: '2px solid #E74C3C' }} onClick={() => toggleSort('likes_count')}>Likes {sort.col === 'likes_count' ? (sort.dir === 'asc' ? '' : '') : ''}</th>\n                <th style={{ width: '80px', background: 'rgba(102, 187, 106, 0.1)', borderBottom: '2px solid #66BB6A' }}>Papers</th>\n                <th style={{ width: '180px' }}>Actions</th>\n              </tr>\n            </thead>\n            <tbody>\n              {loading ? (\n                <tr><td colSpan={10} style={{ textAlign: 'center', color: '#8696a0' }}>Loading...</td></tr>\n              ) : rows.length === 0 ? (\n                <tr><td colSpan={10} style={{ textAlign: 'center', color: '#8696a0' }}>No data</td></tr>\n              ) : rows.map(row => (\n                <tr key={row.id}>\n                  <td>{row.cover_image_url ? <img src={row.cover_image_url} alt=\"cover\" style={{ width: 36, height: 36, objectFit: 'cover', borderRadius: 4 }} /> : <span className=\"badge\">No cover</span>}</td>\n                  <td>\n                    {editingId === row.id ? (\n                      <input className=\"input\" value={editDraft.name} onChange={(e) => setEditDraft({ ...editDraft, name: e.target.value })} />\n                    ) : row.name}\n                  </td>\n                  <td>\n                    {editingId === row.id ? (\n                      <textarea className=\"input\" rows={2} value={editDraft.description} onChange={(e) => setEditDraft({ ...editDraft, description: e.target.value })} />\n                    ) : (row.description?.slice(0, 100) || '')}\n                  </td>\n                  <td>\n                    {editingId === row.id ? (\n                      <input className=\"input\" value={editDraft.location} onChange={(e) => setEditDraft({ ...editDraft, location: e.target.value })} />\n                    ) : (row.location || '')}\n                  </td>\n                  <td>\n                    {editingId === row.id ? (\n                      <input className=\"input\" type=\"number\" value={editDraft.established} onChange={(e) => setEditDraft({ ...editDraft, established: e.target.value })} />\n                    ) : (row.established || '')}\n                  </td>\n                  <td>{row.student_count?.toLocaleString() || ''}</td>\n                  <td style={{ fontWeight: '500', color: '#00a884' }}>{row.views || 0}</td>\n                  <td style={{ fontWeight: '500', color: '#E74C3C' }}>{row.likes_count || 0}</td>\n                  <td style={{ fontWeight: '500', color: '#66BB6A' }}>{paperCounts[row.id] || 0}</td>\n                  <td>\n                    {editingId === row.id ? (\n                      <div style={{ display: 'flex', gap: '4px', flexDirection: 'column' }}>\n                        <button className=\"btn primary\" onClick={() => saveEdit(row)}>Save</button>\n                        <button className=\"btn\" onClick={cancelEdit}>Cancel</button>\n                      </div>\n                    ) : (\n                      <div className=\"actions\">\n                        <button className=\"btn\" onClick={() => startEdit(row)} disabled={!canEdit(row)}>Edit</button>\n                        <button className=\"btn\" onClick={() => handleDelete(row)} disabled={!canEdit(row)}>Delete</button>\n                      </div>\n                    )}\n                  </td>\n                </tr>\n              ))}\n            </tbody>\n          </table>\n        </div>\n\n        <div className=\"actions\" style={{ marginTop: 6 }}>\n          <button className=\"btn\" disabled={page <= 1} onClick={() => setPage(p => Math.max(1, p - 1))}>Prev</button>\n          <span style={{ color: '#cfd8dc' }}>Page {page} of {totalPages}</span>\n          <button className=\"btn\" disabled={page >= totalPages} onClick={() => setPage(p => Math.min(totalPages, p + 1))}>Next</button>\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default UniversitiesManagement;\n","import React, { useEffect, useMemo, useState } from 'react';\nimport { fetchPastPapers, deletePastPaper, updatePastPaper, getFaculties } from '../pastPapersApi';\nimport { useAdminUI } from '../AdminUIContext';\n\n// Format timestamp to local time with timezone handling\nconst formatTimestamp = (isoString) => {\n  if (!isoString) return '';\n  try {\n    const date = new Date(isoString);\n    return date.toLocaleString('en-US', { \n      year: 'numeric', \n      month: 'short', \n      day: 'numeric', \n      hour: '2-digit', \n      minute: '2-digit', \n      second: '2-digit',\n      hour12: true,\n      timeZoneName: 'short'\n    });\n  } catch (e) {\n    return isoString;\n  }\n};\n\nconst PastPapersManagement = ({ userProfile }) => {\n  const [loading, setLoading] = useState(true);\n  const [rows, setRows] = useState([]);\n  const [count, setCount] = useState(0);\n  const [page, setPage] = useState(1);\n  const [pageSize] = useState(10);\n  const [search, setSearch] = useState('');\n  const [faculties, setFaculties] = useState([]);\n  const [facultyFilter, setFacultyFilter] = useState(null);\n  const [sort, setSort] = useState({ col: 'created_at', dir: 'desc' });\n  const [editingId, setEditingId] = useState(null);\n  const [editDraft, setEditDraft] = useState({});\n  const [newPdf, setNewPdf] = useState(null);\n\n  const { confirm, showToast } = useAdminUI();\n\n  const isAdmin = userProfile?.role === 'admin';\n  const isEditor = userProfile?.role === 'editor';\n  const totalPages = useMemo(() => Math.max(1, Math.ceil(count / pageSize)), [count, pageSize]);\n\n  const load = async () => {\n    setLoading(true);\n    try {\n      const { data, count: total } = await fetchPastPapers({ page, pageSize, search, faculty: facultyFilter, sort });\n      setRows(data);\n      setCount(total);\n    } finally { setLoading(false); }\n  };\n\n  useEffect(() => {\n    (async () => { try { setFaculties(await getFaculties()); } catch {} })();\n  }, []);\n\n  useEffect(() => {\n    if (userProfile) load();\n  }, [page, search, facultyFilter, sort.col, sort.dir, userProfile]);\n\n  const canEdit = (row) => {\n    if (isAdmin) return true;\n    if (isEditor) return true;\n    return false;\n  };\n\n  const startEdit = (row) => {\n    if (!canEdit(row)) {\n      showToast({ type: 'error', message: 'You do not have permission to edit this past paper.' });\n      return;\n    }\n    setEditingId(row.id);\n    setEditDraft({\n      faculty: row.faculty || '', unit_code: row.unit_code || '', unit_name: row.unit_name || '',\n      year: row.year || '', semester: row.semester || '', exam_type: row.exam_type || ''\n    });\n    setNewPdf(null);\n  };\n\n  const cancelEdit = () => { setEditingId(null); setEditDraft({}); setNewPdf(null); };\n\n  const saveEdit = async (row) => {\n    if (!canEdit(row)) {\n      showToast({ type: 'error', message: 'You do not have permission to edit this past paper.' });\n      return;\n    }\n    const updates = { ...editDraft };\n\n    try {\n      await updatePastPaper(row.id, { updates, newPdfFile: newPdf, oldFilePath: row.file_path });\n      cancelEdit();\n      await load();\n      showToast({ type: 'success', message: 'Past paper updated.' });\n    } catch (e) {\n      console.error('Failed to update past paper:', e?.message || e);\n      showToast({ type: 'error', message: e?.message || 'Failed to update past paper.' });\n    }\n  };\n\n  const handleDelete = async (row) => {\n    if (!canEdit(row)) {\n      showToast({ type: 'error', message: 'You can only delete past papers you uploaded.' });\n      return;\n    }\n\n    const ok = await confirm({\n      title: 'Delete past paper?',\n      message: `Delete \"${row.unit_code} - ${row.unit_name}\"? This action cannot be undone.`,\n      confirmLabel: 'Delete',\n      cancelLabel: 'Cancel',\n      variant: 'danger',\n    });\n    if (!ok) return;\n\n    try {\n      await deletePastPaper({ id: row.id, file_path: row.file_path });\n      await load();\n      showToast({ type: 'success', message: 'Past paper deleted.' });\n    } catch (e) {\n      console.error('Failed to delete past paper:', e);\n      showToast({ type: 'error', message: e?.message || 'Failed to delete past paper.' });\n    }\n  };\n\n  const toggleSort = (col) => setSort((s) => (s.col === col ? { col, dir: s.dir === 'asc' ? 'desc' : 'asc' } : { col, dir: 'asc' }));\n\n  return (\n    <div>\n      <div className=\"panel\">\n        <div className=\"panel-title\">Past Papers Management</div>\n\n        {/* Stats Summary */}\n        {!loading && rows.length > 0 && (\n          <div style={{ display: 'grid', gridTemplateColumns: 'repeat(auto-fit, minmax(150px, 1fr))', gap: '8px', marginBottom: '12px' }}>\n            <div style={{ background: '#1a2332', border: '1px solid #2a3f56', borderRadius: '6px', padding: '8px 12px', color: '#8696a0', fontSize: '0.85rem' }}>\n              <div style={{ color: '#00a884', fontSize: '1.2rem', fontWeight: '600' }}>{rows.reduce((sum, r) => sum + (r.downloads_count || 0), 0)}</div>\n              <div>Total Downloads</div>\n            </div>\n            <div style={{ background: '#1a2332', border: '1px solid #2a3f56', borderRadius: '6px', padding: '8px 12px', color: '#8696a0', fontSize: '0.85rem' }}>\n              <div style={{ color: '#34B7F1', fontSize: '1.2rem', fontWeight: '600' }}>{rows.reduce((sum, r) => sum + (r.views_count || 0), 0)}</div>\n              <div>Total Views</div>\n            </div>\n            <div style={{ background: '#1a2332', border: '1px solid #2a3f56', borderRadius: '6px', padding: '8px 12px', color: '#8696a0', fontSize: '0.85rem' }}>\n              <div style={{ color: '#FFCC00', fontSize: '1.2rem', fontWeight: '600' }}>{rows.length}/{count}</div>\n              <div>Page Papers</div>\n            </div>\n          </div>\n        )}\n\n        <div className=\"grid-2\" style={{ marginBottom: 6 }}>\n          <div className=\"panel\">\n            <label className=\"label\">Search</label>\n            <input className=\"input\" value={search} onChange={(e) => { setPage(1); setSearch(e.target.value.trim()); }} placeholder=\"e.g., MENT 130 or Introduction to...\" />\n          </div>\n          <div className=\"panel\">\n            <label className=\"label\">Faculty</label>\n            <select className=\"select\" value={facultyFilter || ''} onChange={(e) => { setPage(1); setFacultyFilter(e.target.value || null); }}>\n              <option value=\"\">All Faculties</option>\n              {faculties.map(f => <option key={f} value={f}>{f}</option>)}\n            </select>\n          </div>\n        </div>\n        <div className=\"actions\" style={{ marginBottom: 6 }}>\n          <button className=\"btn primary\" onClick={() => (window.location.href = '/books/admin/upload')}>Add New Past Paper</button>\n        </div>\n        <div className=\"panel\" style={{ padding: 0, overflowX: 'auto' }}>\n          <table className=\"table\" style={{ minWidth: '1200px' }}>\n            <thead>\n              <tr>\n                <th style={{ width: '250px' }}>Unit Name</th>\n                <th style={{ width: '150px', cursor: 'pointer' }} onClick={() => toggleSort('unit_code')}>Unit Code {sort.col === 'unit_code' ? (sort.dir === 'asc' ? '' : '') : ''}</th>\n                <th style={{ width: '150px' }}>Faculty</th>\n                <th style={{ width: '100px', cursor: 'pointer' }} onClick={() => toggleSort('year')}>Year {sort.col === 'year' ? (sort.dir === 'asc' ? '' : '') : ''}</th>\n                <th style={{ width: '100px' }}>Semester</th>\n                <th style={{ width: '120px' }}>Exam Type</th>\n                <th style={{ width: '80px', cursor: 'pointer', background: 'rgba(52, 183, 241, 0.1)', borderBottom: '2px solid #34B7F1' }} onClick={() => toggleSort('views_count')}>Views {sort.col === 'views_count' ? (sort.dir === 'asc' ? '' : '') : ''}</th>\n                <th style={{ width: '100px', cursor: 'pointer' }} onClick={() => toggleSort('downloads_count')}>Downloads {sort.col === 'downloads_count' ? (sort.dir === 'asc' ? '' : '') : ''}</th>\n                <th style={{ width: '180px', cursor: 'pointer' }} onClick={() => toggleSort('created_at')}>Uploaded {sort.col === 'created_at' ? (sort.dir === 'asc' ? '' : '') : ''}</th>\n                <th style={{ width: '150px' }}>Uploaded By</th>\n                <th style={{ width: '200px' }}>Actions</th>\n              </tr>\n            </thead>\n            <tbody>\n              {loading ? (\n                <tr><td colSpan={12} style={{ textAlign: 'center', color: '#8696a0' }}>Loading...</td></tr>\n              ) : rows.length === 0 ? (\n                <tr><td colSpan={12} style={{ textAlign: 'center', color: '#8696a0' }}>No data</td></tr>\n              ) : rows.map(row => (\n                <tr key={row.id}>\n                  <td style={{ color: row.unit_name ? '#e9edef' : '#8696a0' }}>{editingId === row.id ? <input className=\"input\" value={editDraft.unit_name} onChange={(e) => setEditDraft({ ...editDraft, unit_name: e.target.value })} /> : (row.unit_name || '')}</td>\n                  <td style={{ color: row.unit_code ? '#e9edef' : '#8696a0' }}>{editingId === row.id ? <input className=\"input\" value={editDraft.unit_code} onChange={(e) => setEditDraft({ ...editDraft, unit_code: e.target.value })} /> : (row.unit_code || '')}</td>\n                  <td style={{ color: row.faculty ? '#e9edef' : '#8696a0' }}>{editingId === row.id ? <input className=\"input\" value={editDraft.faculty} onChange={(e) => setEditDraft({ ...editDraft, faculty: e.target.value })} /> : (row.faculty || '')}</td>\n                  <td style={{ color: row.year ? '#e9edef' : '#8696a0' }}>{editingId === row.id ? <input className=\"input\" type=\"number\" value={editDraft.year} onChange={(e) => setEditDraft({ ...editDraft, year: e.target.value })} /> : (row.year || '')}</td>\n                  <td>{editingId === row.id ? <select className=\"select\" value={editDraft.semester} onChange={(e) => setEditDraft({ ...editDraft, semester: e.target.value })}><option value=\"\"></option><option value=\"1\">1</option><option value=\"2\">2</option><option value=\"3\">3</option></select> : (row.semester || '')}</td>\n                  <td>{editingId === row.id ? <select className=\"select\" value={editDraft.exam_type} onChange={(e) => setEditDraft({ ...editDraft, exam_type: e.target.value })}><option value=\"Main\">Main</option><option value=\"Supplementary\">Supplementary</option><option value=\"CAT\">CAT</option><option value=\"Mock\">Mock</option></select> : (row.exam_type || 'Main')}</td>\n                  <td style={{ fontWeight: '500', color: '#34B7F1' }}>{row.views_count || 0}</td>\n                  <td>{row.downloads_count || 0}</td>\n                  <td style={{ color: '#8696a0', fontSize: '12px' }}>{formatTimestamp(row.created_at)}</td>\n                  <td style={{ color: row.profiles?.full_name ? '#e9edef' : '#8696a0', fontSize: '13px' }}>{row.profiles?.full_name || row.profiles?.email || ''}</td>\n                  <td>\n                    {editingId === row.id ? (\n                      <div style={{ display: 'flex', gap: '4px', flexDirection: 'column' }}>\n                        <button className=\"btn primary\" onClick={() => saveEdit(row)}>Save</button>\n                        <button className=\"btn\" onClick={cancelEdit}>Cancel</button>\n                      </div>\n                    ) : (\n                      <div className=\"actions\">\n                        <button className=\"btn\" onClick={() => startEdit(row)} disabled={!canEdit(row)}>Edit</button>\n                        <button className=\"btn\" onClick={() => handleDelete(row)} disabled={!canEdit(row)}>Delete</button>\n                      </div>\n                    )}\n                  </td>\n                </tr>\n              ))}\n            </tbody>\n          </table>\n        </div>\n        <div className=\"actions\" style={{ marginTop: 6 }}>\n          <button className=\"btn\" disabled={page <= 1} onClick={() => setPage(p => Math.max(1, p - 1))}>Prev</button>\n          <span style={{ color: '#cfd8dc' }}>Page {page} of {totalPages}</span>\n          <button className=\"btn\" disabled={page >= totalPages} onClick={() => setPage(p => Math.min(totalPages, p + 1))}>Next</button>\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default PastPapersManagement;\n","/**\r\n * Author Interactions API\r\n * Handles: followers, likes, loves, comments, ratings, shares\r\n */\r\n\r\nimport { supabase } from '../../Books/supabaseClient';\r\n\r\n// ============================================\r\n// FOLLOWERS MANAGEMENT\r\n// ============================================\r\n\r\nexport async function toggleAuthorFollow(authorId, userId) {\r\n  try {\r\n    if (!userId) throw new Error('User ID required');\r\n    \r\n    const { data, error } = await supabase\r\n      .rpc('toggle_author_follow', {\r\n        p_follower_id: userId,\r\n        p_author_id: authorId\r\n      });\r\n    \r\n    if (error) throw error;\r\n    return { success: true, isFollowing: data };\r\n  } catch (error) {\r\n    console.error('Error toggling author follow:', error);\r\n    throw error;\r\n  }\r\n}\r\n\r\nexport async function getAuthorFollowers(authorId) {\r\n  try {\r\n    const { data, error } = await supabase\r\n      .from('author_followers')\r\n      .select('id, follower_id, profiles(id, username, avatar_url), followed_at')\r\n      .eq('author_id', authorId)\r\n      .order('followed_at', { ascending: false });\r\n    \r\n    if (error) throw error;\r\n    return data || [];\r\n  } catch (error) {\r\n    console.error('Error fetching author followers:', error);\r\n    return [];\r\n  }\r\n}\r\n\r\nexport async function getFollowersCount(authorId) {\r\n  try {\r\n    const { count, error } = await supabase\r\n      .from('author_followers')\r\n      .select('id', { count: 'exact' })\r\n      .eq('author_id', authorId);\r\n    \r\n    if (error) throw error;\r\n    return count || 0;\r\n  } catch (error) {\r\n    console.error('Error fetching followers count:', error);\r\n    return 0;\r\n  }\r\n}\r\n\r\n// ============================================\r\n// LIKES MANAGEMENT\r\n// ============================================\r\n\r\nexport async function toggleAuthorLike(authorId, userId) {\r\n  try {\r\n    if (!userId) throw new Error('User ID required');\r\n    \r\n    const { data, error } = await supabase\r\n      .rpc('toggle_author_like', {\r\n        p_user_id: userId,\r\n        p_author_id: authorId\r\n      });\r\n    \r\n    if (error) throw error;\r\n    return { success: true, isLiked: data };\r\n  } catch (error) {\r\n    console.error('Error toggling author like:', error);\r\n    throw error;\r\n  }\r\n}\r\n\r\nexport async function getAuthorLikes(authorId) {\r\n  try {\r\n    const { data, error } = await supabase\r\n      .from('author_likes')\r\n      .select('id, user_id, profiles(id, username, avatar_url), liked_at')\r\n      .eq('author_id', authorId)\r\n      .order('liked_at', { ascending: false });\r\n    \r\n    if (error) throw error;\r\n    return data || [];\r\n  } catch (error) {\r\n    console.error('Error fetching author likes:', error);\r\n    return [];\r\n  }\r\n}\r\n\r\nexport async function getLikesCount(authorId) {\r\n  try {\r\n    const { count, error } = await supabase\r\n      .from('author_likes')\r\n      .select('id', { count: 'exact' })\r\n      .eq('author_id', authorId);\r\n    \r\n    if (error) throw error;\r\n    return count || 0;\r\n  } catch (error) {\r\n    console.error('Error fetching likes count:', error);\r\n    return 0;\r\n  }\r\n}\r\n\r\n// ============================================\r\n// LOVES MANAGEMENT\r\n// ============================================\r\n\r\nexport async function toggleAuthorLove(authorId, userId) {\r\n  try {\r\n    if (!userId) throw new Error('User ID required');\r\n    \r\n    const { data, error } = await supabase\r\n      .rpc('toggle_author_love', {\r\n        p_user_id: userId,\r\n        p_author_id: authorId\r\n      });\r\n    \r\n    if (error) throw error;\r\n    return { success: true, isLoved: data };\r\n  } catch (error) {\r\n    console.error('Error toggling author love:', error);\r\n    throw error;\r\n  }\r\n}\r\n\r\nexport async function getAuthorLoves(authorId) {\r\n  try {\r\n    const { data, error } = await supabase\r\n      .from('author_loves')\r\n      .select('id, user_id, profiles(id, username, avatar_url), loved_at')\r\n      .eq('author_id', authorId)\r\n      .order('loved_at', { ascending: false });\r\n    \r\n    if (error) throw error;\r\n    return data || [];\r\n  } catch (error) {\r\n    console.error('Error fetching author loves:', error);\r\n    return [];\r\n  }\r\n}\r\n\r\nexport async function getLovesCount(authorId) {\r\n  try {\r\n    const { count, error } = await supabase\r\n      .from('author_loves')\r\n      .select('id', { count: 'exact' })\r\n      .eq('author_id', authorId);\r\n    \r\n    if (error) throw error;\r\n    return count || 0;\r\n  } catch (error) {\r\n    console.error('Error fetching loves count:', error);\r\n    return 0;\r\n  }\r\n}\r\n\r\n// ============================================\r\n// COMMENTS MANAGEMENT\r\n// ============================================\r\n\r\nexport async function addAuthorComment(authorId, userId, content, parentCommentId = null) {\r\n  try {\r\n    if (!userId) throw new Error('User ID required');\r\n    if (!content || content.trim().length === 0) throw new Error('Comment content required');\r\n\r\n    const { data, error } = await supabase\r\n      .from('author_comments')\r\n      .insert({\r\n        author_id: authorId,\r\n        user_id: userId,\r\n        content,\r\n        parent_comment_id: parentCommentId\r\n      })\r\n      .select('*, profiles(id, username, avatar_url)')\r\n      .single();\r\n\r\n    if (error) throw error;\r\n    return data;\r\n  } catch (error) {\r\n    console.error('Error adding author comment:', error);\r\n    throw error;\r\n  }\r\n}\r\n\r\nexport async function getAuthorComments(authorId, limit = 50) {\r\n  try {\r\n    const { data, error } = await supabase\r\n      .from('author_comments')\r\n      .select('id, user_id, content, parent_comment_id, likes_count, created_at, updated_at, profiles(id, username, avatar_url, tier)')\r\n      .eq('author_id', authorId)\r\n      .is('parent_comment_id', null)\r\n      .order('created_at', { ascending: false })\r\n      .limit(limit);\r\n\r\n    if (error) throw error;\r\n    return data || [];\r\n  } catch (error) {\r\n    console.error('Error fetching author comments:', error);\r\n    return [];\r\n  }\r\n}\r\n\r\nexport async function deleteAuthorComment(commentId, userId) {\r\n  try {\r\n    // Verify ownership\r\n    const { data: comment, error: fetchError } = await supabase\r\n      .from('author_comments')\r\n      .select('user_id')\r\n      .eq('id', commentId)\r\n      .single();\r\n\r\n    if (fetchError) throw fetchError;\r\n    if (comment.user_id !== userId) throw new Error('Unauthorized');\r\n\r\n    const { error } = await supabase\r\n      .from('author_comments')\r\n      .delete()\r\n      .eq('id', commentId);\r\n\r\n    if (error) throw error;\r\n    return { success: true };\r\n  } catch (error) {\r\n    console.error('Error deleting author comment:', error);\r\n    throw error;\r\n  }\r\n}\r\n\r\nexport async function getCommentsCount(authorId) {\r\n  try {\r\n    const { count, error } = await supabase\r\n      .from('author_comments')\r\n      .select('id', { count: 'exact' })\r\n      .eq('author_id', authorId)\r\n      .is('parent_comment_id', null);\r\n\r\n    if (error) throw error;\r\n    return count || 0;\r\n  } catch (error) {\r\n    console.error('Error fetching comments count:', error);\r\n    return 0;\r\n  }\r\n}\r\n\r\n// ============================================\r\n// RATINGS MANAGEMENT\r\n// ============================================\r\n\r\nexport async function rateAuthor(authorId, userId, rating, review = '') {\r\n  try {\r\n    if (!userId) throw new Error('User ID required');\r\n    if (rating < 1 || rating > 5) throw new Error('Rating must be between 1 and 5');\r\n\r\n    const { data, error } = await supabase\r\n      .from('author_ratings')\r\n      .upsert(\r\n        {\r\n          author_id: authorId,\r\n          user_id: userId,\r\n          rating,\r\n          review: review || null\r\n        },\r\n        { onConflict: 'user_id,author_id' }\r\n      )\r\n      .select('*, profiles(id, username, avatar_url)')\r\n      .single();\r\n\r\n    if (error) throw error;\r\n    return data;\r\n  } catch (error) {\r\n    console.error('Error rating author:', error);\r\n    throw error;\r\n  }\r\n}\r\n\r\nexport async function getAuthorRatings(authorId, limit = 20) {\r\n  try {\r\n    const { data, error } = await supabase\r\n      .from('author_ratings')\r\n      .select('id, user_id, rating, review, helpful_count, created_at, profiles(id, username, avatar_url, tier)')\r\n      .eq('author_id', authorId)\r\n      .order('helpful_count', { ascending: false })\r\n      .order('created_at', { ascending: false })\r\n      .limit(limit);\r\n\r\n    if (error) throw error;\r\n    return data || [];\r\n  } catch (error) {\r\n    console.error('Error fetching author ratings:', error);\r\n    return [];\r\n  }\r\n}\r\n\r\nexport async function getRatingsCount(authorId) {\r\n  try {\r\n    const { count, error } = await supabase\r\n      .from('author_ratings')\r\n      .select('id', { count: 'exact' })\r\n      .eq('author_id', authorId);\r\n\r\n    if (error) throw error;\r\n    return count || 0;\r\n  } catch (error) {\r\n    console.error('Error fetching ratings count:', error);\r\n    return 0;\r\n  }\r\n}\r\n\r\nexport async function getAverageRating(authorId) {\r\n  try {\r\n    const { data, error } = await supabase\r\n      .from('author_ratings')\r\n      .select('rating')\r\n      .eq('author_id', authorId);\r\n\r\n    if (error) throw error;\r\n    if (!data || data.length === 0) return 0;\r\n\r\n    const average = data.reduce((sum, r) => sum + r.rating, 0) / data.length;\r\n    return Math.round(average * 10) / 10;\r\n  } catch (error) {\r\n    console.error('Error calculating average rating:', error);\r\n    return 0;\r\n  }\r\n}\r\n\r\nexport async function deleteAuthorRating(authorId, userId) {\r\n  try {\r\n    const { error } = await supabase\r\n      .from('author_ratings')\r\n      .delete()\r\n      .eq('author_id', authorId)\r\n      .eq('user_id', userId);\r\n\r\n    if (error) throw error;\r\n    return { success: true };\r\n  } catch (error) {\r\n    console.error('Error deleting rating:', error);\r\n    throw error;\r\n  }\r\n}\r\n\r\n// ============================================\r\n// SHARES MANAGEMENT\r\n// ============================================\r\n\r\nexport async function recordAuthorShare(authorId, userId, shareType, platform = null) {\r\n  try {\r\n    const { data, error } = await supabase\r\n      .from('author_shares')\r\n      .insert({\r\n        author_id: authorId,\r\n        user_id: userId || null,\r\n        share_type: shareType,\r\n        platform: platform || null\r\n      })\r\n      .select()\r\n      .single();\r\n\r\n    if (error) throw error;\r\n    return data;\r\n  } catch (error) {\r\n    console.error('Error recording author share:', error);\r\n    throw error;\r\n  }\r\n}\r\n\r\nexport async function getSharesCount(authorId) {\r\n  try {\r\n    const { count, error } = await supabase\r\n      .from('author_shares')\r\n      .select('id', { count: 'exact' })\r\n      .eq('author_id', authorId);\r\n\r\n    if (error) throw error;\r\n    return count || 0;\r\n  } catch (error) {\r\n    console.error('Error fetching shares count:', error);\r\n    return 0;\r\n  }\r\n}\r\n\r\n// ============================================\r\n// USER INTERACTION STATUS\r\n// ============================================\r\n\r\nexport async function getUserAuthorInteractionStatus(authorId, userId) {\r\n  try {\r\n    if (!userId) {\r\n      return {\r\n        isFollower: false,\r\n        hasLiked: false,\r\n        hasLoved: false,\r\n        userRating: null\r\n      };\r\n    }\r\n\r\n    const { data, error } = await supabase\r\n      .rpc('get_author_interaction_status', {\r\n        p_user_id: userId,\r\n        p_author_id: authorId\r\n      })\r\n      .single();\r\n\r\n    if (error) {\r\n      console.error('Error fetching user interaction status:', error);\r\n      return {\r\n        isFollower: false,\r\n        hasLiked: false,\r\n        hasLoved: false,\r\n        userRating: null\r\n      };\r\n    }\r\n\r\n    return {\r\n      isFollower: data.is_follower || false,\r\n      hasLiked: data.has_liked || false,\r\n      hasLoved: data.has_loved || false,\r\n      userRating: data.user_rating\r\n    };\r\n  } catch (error) {\r\n    console.error('Error in getUserAuthorInteractionStatus:', error);\r\n    return {\r\n      isFollower: false,\r\n      hasLiked: false,\r\n      hasLoved: false,\r\n      userRating: null\r\n    };\r\n  }\r\n}\r\n\r\n// ============================================\r\n// AUTHOR ENGAGEMENT STATISTICS\r\n// ============================================\r\n\r\nexport async function getAuthorEngagementStats(authorId) {\r\n  try {\r\n    const { data, error } = await supabase\r\n      .from('author_engagement_stats')\r\n      .select('*')\r\n      .eq('author_id', authorId)\r\n      .single();\r\n\r\n    if (error && error.code !== 'PGRST116') throw error;\r\n\r\n    return data || {\r\n      author_id: authorId,\r\n      books_count: 0,\r\n      total_downloads: 0,\r\n      total_views: 0,\r\n      average_rating: 0,\r\n      followers_count: 0,\r\n      likes_count: 0,\r\n      loves_count: 0,\r\n      comments_count: 0,\r\n      ratings_count: 0,\r\n      shares_count: 0,\r\n      engagement_score: 0\r\n    };\r\n  } catch (error) {\r\n    console.error('Error fetching author engagement stats:', error);\r\n    return null;\r\n  }\r\n}\r\n\r\nexport async function getAllAuthorsEngagementStats(limit = 100) {\r\n  try {\r\n    const { data, error } = await supabase\r\n      .from('author_engagement_stats')\r\n      .select('*')\r\n      .order('engagement_score', { ascending: false })\r\n      .limit(limit);\r\n\r\n    if (error) throw error;\r\n    return data || [];\r\n  } catch (error) {\r\n    console.error('Error fetching all authors engagement stats:', error);\r\n    return [];\r\n  }\r\n}\r\n\r\nexport async function getTopAuthors(limit = 10) {\r\n  try {\r\n    const { data, error } = await supabase\r\n      .from('author_engagement_stats')\r\n      .select('*')\r\n      .order('engagement_score', { ascending: false })\r\n      .limit(limit);\r\n\r\n    if (error) throw error;\r\n    return data || [];\r\n  } catch (error) {\r\n    console.error('Error fetching top authors:', error);\r\n    return [];\r\n  }\r\n}\r\n\r\n// ============================================\r\n// AUTHOR PROFILE ENRICHMENT\r\n// ============================================\r\n\r\nexport async function enrichAuthorWithInteractions(author, userId = null) {\r\n  try {\r\n    const stats = await getAuthorEngagementStats(author.name || author.author_id);\r\n    const interactions = userId \r\n      ? await getUserAuthorInteractionStatus(author.name || author.author_id, userId)\r\n      : null;\r\n\r\n    return {\r\n      ...author,\r\n      ...stats,\r\n      interactions\r\n    };\r\n  } catch (error) {\r\n    console.error('Error enriching author:', error);\r\n    return author;\r\n  }\r\n}\r\n\r\nexport async function enrichAuthorsWithInteractions(authors, userId = null) {\r\n  try {\r\n    return Promise.all(\r\n      authors.map(author => enrichAuthorWithInteractions(author, userId))\r\n    );\r\n  } catch (error) {\r\n    console.error('Error enriching authors:', error);\r\n    return authors;\r\n  }\r\n}\r\n","import React, { useEffect, useState, useMemo } from 'react';\r\nimport { FiBook, FiDownload, FiStar, FiSearch, FiTrendingUp, FiHeart, FiUsers, FiMessageSquare, FiThumbsUp } from 'react-icons/fi';\r\nimport { MdFavoriteBorder } from 'react-icons/md';\r\nimport { fetchStats } from '../api';\r\nimport { getAllAuthorsEngagementStats } from '../authorInteractionsApi';\r\nimport './Authors.css';\r\n\r\nconst Authors = () => {\r\n  const [stats, setStats] = useState(null);\r\n  const [engagementStats, setEngagementStats] = useState({});\r\n  const [loading, setLoading] = useState(true);\r\n  const [searchTerm, setSearchTerm] = useState('');\r\n  const [sortBy, setSortBy] = useState('engagement');\r\n  const [timeRange, setTimeRange] = useState('monthly');\r\n\r\n  useEffect(() => {\r\n    const loadData = async () => {\r\n      try {\r\n        setLoading(true);\r\n        const [statsData, engageData] = await Promise.all([\r\n          fetchStats(),\r\n          getAllAuthorsEngagementStats(100)\r\n        ]);\r\n        \r\n        setStats(statsData);\r\n        \r\n        // Create engagement stats map for quick lookup by author name\r\n        const engageMap = {};\r\n        engageData.forEach(stat => {\r\n          engageMap[stat.author_name] = stat;\r\n        });\r\n        setEngagementStats(engageMap);\r\n      } catch (error) {\r\n        console.error('Failed to load authors stats:', error);\r\n      } finally {\r\n        setLoading(false);\r\n      }\r\n    };\r\n\r\n    loadData();\r\n    const interval = setInterval(loadData, 30000); // Refresh every 30 seconds\r\n    return () => clearInterval(interval);\r\n  }, []);\r\n\r\n  const filteredAndSorted = useMemo(() => {\r\n    if (!stats || !stats.authors) return [];\r\n\r\n    let filtered = stats.authors.filter(author =>\r\n      author.name.toLowerCase().includes(searchTerm.toLowerCase())\r\n    );\r\n\r\n    filtered.sort((a, b) => {\r\n      const authorEngageA = engagementStats[a.name] || {};\r\n      const authorEngageB = engagementStats[b.name] || {};\r\n\r\n      switch (sortBy) {\r\n        case 'engagement':\r\n          return (authorEngageB.engagement_score || 0) - (authorEngageA.engagement_score || 0);\r\n        case 'books':\r\n          return b.bookCount - a.bookCount;\r\n        case 'downloads':\r\n          return b.totalDownloads - a.totalDownloads;\r\n        case 'followers':\r\n          return (authorEngageB.followers_count || 0) - (authorEngageA.followers_count || 0);\r\n        case 'likes':\r\n          return (authorEngageB.likes_count || 0) - (authorEngageA.likes_count || 0);\r\n        case 'rating':\r\n          return parseFloat(b.avgRating || 0) - parseFloat(a.avgRating || 0);\r\n        case 'name':\r\n          return a.name.localeCompare(b.name);\r\n        default:\r\n          return (authorEngageB.engagement_score || 0) - (authorEngageA.engagement_score || 0);\r\n      }\r\n    });\r\n\r\n    return filtered;\r\n  }, [stats, searchTerm, sortBy, engagementStats]);\r\n\r\n  const overallStats = useMemo(() => {\r\n    if (!stats || !stats.authors) return { \r\n      totalAuthors: 0, \r\n      totalBooks: 0, \r\n      totalDL: 0, \r\n      avgRating: 0,\r\n      totalFollowers: 0,\r\n      totalLikes: 0,\r\n      totalLoves: 0,\r\n      totalComments: 0\r\n    };\r\n\r\n    const totalBooks = stats.authors.reduce((sum, a) => sum + (a.bookCount || 0), 0);\r\n    const totalDL = stats.authors.reduce((sum, a) => sum + (a.totalDownloads || 0), 0);\r\n    const avgRating = stats.authors.length > 0\r\n      ? (stats.authors.reduce((sum, a) => sum + (parseFloat(a.avgRating) || 0), 0) / stats.authors.length).toFixed(1)\r\n      : 0;\r\n    \r\n    // Sum engagement metrics\r\n    const totalFollowers = Object.values(engagementStats).reduce((sum, stat) => sum + (stat.followers_count || 0), 0);\r\n    const totalLikes = Object.values(engagementStats).reduce((sum, stat) => sum + (stat.likes_count || 0), 0);\r\n    const totalLoves = Object.values(engagementStats).reduce((sum, stat) => sum + (stat.loves_count || 0), 0);\r\n    const totalComments = Object.values(engagementStats).reduce((sum, stat) => sum + (stat.comments_count || 0), 0);\r\n\r\n    return {\r\n      totalAuthors: stats.authors.length,\r\n      totalBooks,\r\n      totalDL,\r\n      avgRating,\r\n      totalFollowers,\r\n      totalLikes,\r\n      totalLoves,\r\n      totalComments\r\n    };\r\n  }, [stats, engagementStats]);\r\n\r\n  if (loading) {\r\n    return (\r\n      <div className=\"authors-page\">\r\n        <div className=\"authors-loading\">\r\n          <div className=\"authors-spinner\"></div>\r\n          <p>Loading authors data...</p>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className=\"authors-page\">\r\n      {/* Header */}\r\n      <div className=\"authors-header\">\r\n        <div className=\"authors-title-section\">\r\n          <h1 className=\"authors-title\">\r\n            <FiTrendingUp /> Authors Analytics\r\n          </h1>\r\n          <p className=\"authors-subtitle\">Comprehensive author performance and engagement metrics</p>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Stats Cards */}\r\n      <div className=\"authors-stats-grid\">\r\n        <div className=\"authors-stat-card\">\r\n          <div className=\"authors-stat-icon authors-stat-icon-1\">\r\n            <FiBook />\r\n          </div>\r\n          <div className=\"authors-stat-content\">\r\n            <div className=\"authors-stat-label\">Total Authors</div>\r\n            <div className=\"authors-stat-value\">{overallStats.totalAuthors}</div>\r\n          </div>\r\n        </div>\r\n\r\n        <div className=\"authors-stat-card\">\r\n          <div className=\"authors-stat-icon authors-stat-icon-2\">\r\n            <FiBook />\r\n          </div>\r\n          <div className=\"authors-stat-content\">\r\n            <div className=\"authors-stat-label\">Total Books</div>\r\n            <div className=\"authors-stat-value\">{overallStats.totalBooks}</div>\r\n          </div>\r\n        </div>\r\n\r\n        <div className=\"authors-stat-card\">\r\n          <div className=\"authors-stat-icon authors-stat-icon-3\">\r\n            <FiDownload />\r\n          </div>\r\n          <div className=\"authors-stat-content\">\r\n            <div className=\"authors-stat-label\">Total Downloads</div>\r\n            <div className=\"authors-stat-value\">{overallStats.totalDL.toLocaleString()}</div>\r\n          </div>\r\n        </div>\r\n\r\n        <div className=\"authors-stat-card\">\r\n          <div className=\"authors-stat-icon authors-stat-icon-4\">\r\n            <FiStar />\r\n          </div>\r\n          <div className=\"authors-stat-content\">\r\n            <div className=\"authors-stat-label\">Avg Rating</div>\r\n            <div className=\"authors-stat-value\">{overallStats.avgRating}</div>\r\n          </div>\r\n        </div>\r\n\r\n        <div className=\"authors-stat-card\">\r\n          <div className=\"authors-stat-icon authors-stat-icon-5\">\r\n            <FiUsers />\r\n          </div>\r\n          <div className=\"authors-stat-content\">\r\n            <div className=\"authors-stat-label\">Total Followers</div>\r\n            <div className=\"authors-stat-value\">{overallStats.totalFollowers}</div>\r\n          </div>\r\n        </div>\r\n\r\n        <div className=\"authors-stat-card\">\r\n          <div className=\"authors-stat-icon authors-stat-icon-6\">\r\n            <MdFavoriteBorder />\r\n          </div>\r\n          <div className=\"authors-stat-content\">\r\n            <div className=\"authors-stat-label\">Total Likes</div>\r\n            <div className=\"authors-stat-value\">{overallStats.totalLikes}</div>\r\n          </div>\r\n        </div>\r\n\r\n        <div className=\"authors-stat-card\">\r\n          <div className=\"authors-stat-icon authors-stat-icon-7\">\r\n            <FiHeart />\r\n          </div>\r\n          <div className=\"authors-stat-content\">\r\n            <div className=\"authors-stat-label\">Total Loves</div>\r\n            <div className=\"authors-stat-value\">{overallStats.totalLoves}</div>\r\n          </div>\r\n        </div>\r\n\r\n        <div className=\"authors-stat-card\">\r\n          <div className=\"authors-stat-icon authors-stat-icon-8\">\r\n            <FiMessageSquare />\r\n          </div>\r\n          <div className=\"authors-stat-content\">\r\n            <div className=\"authors-stat-label\">Total Comments</div>\r\n            <div className=\"authors-stat-value\">{overallStats.totalComments}</div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Controls */}\r\n      <div className=\"authors-controls\">\r\n        <div className=\"authors-control-group\">\r\n          <label className=\"authors-label\">Search Author</label>\r\n          <div className=\"authors-search-wrapper\">\r\n            <FiSearch className=\"authors-search-icon\" />\r\n            <input\r\n              type=\"text\"\r\n              placeholder=\"Search by author name...\"\r\n              value={searchTerm}\r\n              onChange={(e) => setSearchTerm(e.target.value)}\r\n              className=\"authors-search-input\"\r\n            />\r\n          </div>\r\n        </div>\r\n\r\n        <div className=\"authors-control-group\">\r\n          <label className=\"authors-label\">Sort By</label>\r\n          <select\r\n            value={sortBy}\r\n            onChange={(e) => setSortBy(e.target.value)}\r\n            className=\"authors-select\"\r\n          >\r\n            <option value=\"engagement\">Engagement Score</option>\r\n            <option value=\"followers\">Followers</option>\r\n            <option value=\"likes\">Likes</option>\r\n            <option value=\"books\">Books Count</option>\r\n            <option value=\"downloads\">Downloads</option>\r\n            <option value=\"rating\">Rating</option>\r\n            <option value=\"name\">Name (A-Z)</option>\r\n          </select>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Table */}\r\n      <div className=\"authors-table-wrapper\">\r\n        <table className=\"authors-table\">\r\n          <thead className=\"authors-table-head\">\r\n            <tr>\r\n              <th className=\"authors-table-header authors-rank-col\">Rank</th>\r\n              <th className=\"authors-table-header authors-name-col\">Author Name</th>\r\n              <th className=\"authors-table-header authors-num-col\">Books</th>\r\n              <th className=\"authors-table-header authors-num-col\">Downloads</th>\r\n              <th className=\"authors-table-header authors-num-col\">Followers</th>\r\n              <th className=\"authors-table-header authors-num-col\">Likes</th>\r\n              <th className=\"authors-table-header authors-num-col\">Loves</th>\r\n              <th className=\"authors-table-header authors-num-col\">Rating</th>\r\n              <th className=\"authors-table-header authors-num-col\">Score</th>\r\n            </tr>\r\n          </thead>\r\n          <tbody className=\"authors-table-body\">\r\n            {filteredAndSorted.length > 0 ? (\r\n              filteredAndSorted.map((author, idx) => {\r\n                const engage = engagementStats[author.name] || {};\r\n                const engScore = engage.engagement_score || 0;\r\n                const medal = idx === 0 ? '' : idx === 1 ? '' : idx === 2 ? '' : `#${idx + 1}`;\r\n\r\n                return (\r\n                  <tr key={author.id} className=\"authors-table-row\">\r\n                    <td className=\"authors-table-cell authors-rank-col\">\r\n                      <span className=\"authors-rank-badge\">{medal}</span>\r\n                    </td>\r\n                    <td className=\"authors-table-cell authors-name-col\">\r\n                      <div className=\"authors-author-name\">\r\n                        {author.name === 'Unknown' ? ' Unknown Author' : author.name}\r\n                      </div>\r\n                    </td>\r\n                    <td className=\"authors-table-cell authors-num-col\">\r\n                      <span className=\"authors-metric-plain authors-books-count\">{author.bookCount}</span>\r\n                    </td>\r\n                    <td className=\"authors-table-cell authors-num-col\">\r\n                      <span className=\"authors-metric-plain authors-downloads-count\">{author.totalDownloads}</span>\r\n                    </td>\r\n                    <td className=\"authors-table-cell authors-num-col\">\r\n                      <span className=\"authors-metric-plain authors-followers-count\">{engage.followers_count || 0}</span>\r\n                    </td>\r\n                    <td className=\"authors-table-cell authors-num-col\">\r\n                      <span className=\"authors-metric-plain authors-likes-count\">\r\n                        <FiThumbsUp className=\"authors-metric-icon\" />\r\n                        {engage.likes_count || 0}\r\n                      </span>\r\n                    </td>\r\n                    <td className=\"authors-table-cell authors-num-col\">\r\n                      <span className=\"authors-metric-plain authors-loves-count\">\r\n                        <FiHeart className=\"authors-metric-icon\" />\r\n                        {engage.loves_count || 0}\r\n                      </span>\r\n                    </td>\r\n                    <td className=\"authors-table-cell authors-num-col\">\r\n                      <span className=\"authors-rating-plain\">\r\n                        {engage.average_rating > 0 ? engage.average_rating.toFixed(1) : ''} \r\n                      </span>\r\n                    </td>\r\n                    <td className=\"authors-table-cell authors-num-col\">\r\n                      <span className=\"authors-score-plain\">{engScore.toFixed(2)}</span>\r\n                    </td>\r\n                  </tr>\r\n                );\r\n              })\r\n            ) : (\r\n              <tr className=\"authors-table-row authors-empty-row\">\r\n                <td colSpan=\"9\" className=\"authors-table-cell authors-empty-message\">\r\n                  No authors found matching \"{searchTerm}\"\r\n                </td>\r\n              </tr>\r\n            )}\r\n          </tbody>\r\n        </table>\r\n      </div>\r\n\r\n      {/* Summary */}\r\n      <div className=\"authors-summary\">\r\n        <div className=\"authors-summary-item\">\r\n          <span className=\"authors-summary-label\">Showing</span>\r\n          <span className=\"authors-summary-value\">{filteredAndSorted.length} of {overallStats.totalAuthors}</span>\r\n          <span className=\"authors-summary-label\">authors</span>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Authors;\r\n","import React, { useState, useEffect } from 'react';\nimport { useSearchParams } from 'react-router-dom';\nimport { FiBook, FiMapPin, FiFileText, FiBookOpen } from 'react-icons/fi';\nimport Books from './Books';\nimport UniversitiesManagement from './UniversitiesManagement';\nimport PastPapersManagement from './PastPapersManagement';\nimport Authors from './Authors';\n\nconst tabStyles = `\n  .content-tabs {\n    display: flex;\n    gap: 4px;\n    margin-bottom: 8px;\n    border-bottom: 1px solid #374151;\n  }\n  .content-tab {\n    display: flex;\n    align-items: center;\n    gap: 4px;\n    padding: 6px 12px;\n    background: transparent;\n    border: none;\n    color: #8696a0;\n    cursor: pointer;\n    font-size: 14px;\n    font-weight: 500;\n    transition: all 0.3s ease;\n    border-bottom: 2px solid transparent;\n    margin-bottom: -1px;\n  }\n  .content-tab:hover {\n    color: #e9edef;\n    background: rgba(0, 168, 132, 0.05);\n  }\n  .content-tab.active {\n    color: #00a884;\n    border-bottom-color: #00a884;\n  }\n`;\n\nconst ContentManagement = ({ userProfile }) => {\n  const [searchParams] = useSearchParams();\n  const [activeTab, setActiveTab] = useState('books');\n\n  useEffect(() => {\n    const tabParam = searchParams.get('tab');\n    if (tabParam === 'pastpapers') {\n      setActiveTab('pastpapers');\n    } else if (tabParam === 'universities') {\n      setActiveTab('universities');\n    } else if (tabParam === 'authors') {\n      setActiveTab('authors');\n    } else {\n      setActiveTab('books');\n    }\n  }, [searchParams]);\n\n  React.useEffect(() => {\n    const styleTag = document.createElement('style');\n    styleTag.innerHTML = tabStyles;\n    document.head.appendChild(styleTag);\n    return () => styleTag.remove();\n  }, []);\n\n  return (\n    <div>\n      <div className=\"content-tabs\">\n        <button \n          className={`content-tab ${activeTab === 'books' ? 'active' : ''}`}\n          onClick={() => setActiveTab('books')}\n        >\n          <FiBook size={20} />\n          Books\n        </button>\n        <button \n          className={`content-tab ${activeTab === 'universities' ? 'active' : ''}`}\n          onClick={() => setActiveTab('universities')}\n        >\n          <FiMapPin size={20} />\n          Universities\n        </button>\n        <button \n          className={`content-tab ${activeTab === 'pastpapers' ? 'active' : ''}`}\n          onClick={() => setActiveTab('pastpapers')}\n        >\n          <FiFileText size={20} />\n          Past Papers\n        </button>\n        <button \n          className={`content-tab ${activeTab === 'authors' ? 'active' : ''}`}\n          onClick={() => setActiveTab('authors')}\n        >\n          <FiBookOpen size={20} />\n          Authors\n        </button>\n      </div>\n\n      {activeTab === 'books' && <Books userProfile={userProfile} />}\n      {activeTab === 'universities' && <UniversitiesManagement userProfile={userProfile} />}\n      {activeTab === 'pastpapers' && <PastPapersManagement userProfile={userProfile} />}\n      {activeTab === 'authors' && <Authors />}\n    </div>\n  );\n};\n\nexport default ContentManagement;","import { supabase } from '../supabaseClient';\nimport { API_URL } from '../../../config';\n\n// API Configuration\nconst USE_BACKEND_PROXY = true; // Set to false to use direct API calls\n\n/**\n * Search for university names for autocomplete\n */\nexport async function searchUniversityNames(query, limit = 10) {\n  try {\n    // Check cache first\n    let { data, error } = await supabase\n      .rpc('search_university_names', { p_query: query, p_limit: limit });\n\n    if (error) throw error;\n    if (data?.length) return data;\n\n    // Try Wikipedia/Wikidata search as primary method (more reliable, no API key needed)\n    const wikiResults = await searchWikipediaUniversities(query, limit);\n    if (wikiResults.length > 0) {\n      // Cache results\n      await Promise.all(wikiResults.map(uni => \n        cacheUniversityPrefillData(uni.name, uni, 'wikipedia')\n      ));\n      return wikiResults;\n    }\n\n    // Try backend proxy for Google Knowledge Graph (if enabled)\n    if (USE_BACKEND_PROXY) {\n      try {\n        const response = await fetch(`${API_URL}/api/university/search?query=${encodeURIComponent(query)}&limit=${limit}`);\n        \n        if (response.ok) {\n          const data = await response.json();\n          const universities = data.universities || [];\n          \n          // Cache results\n          if (universities.length > 0) {\n            await Promise.all(universities.map(uni => \n              cacheUniversityPrefillData(uni.name, uni, 'google_proxy')\n            ));\n          }\n          \n          return universities;\n        }\n      } catch (proxyError) {\n        console.warn('Backend proxy unavailable:', proxyError.message);\n      }\n    }\n\n    return [];\n  } catch (error) {\n    console.error('Error searching university names:', error);\n    return [];\n  }\n}\n\n/**\n * Search for universities using Wikipedia API (more reliable, no API key needed)\n */\nasync function searchWikipediaUniversities(query, limit = 10) {\n  try {\n    const searchUrl = `https://en.wikipedia.org/w/api.php?action=opensearch&search=${encodeURIComponent(query + ' university')}&limit=${limit}&namespace=0&format=json&origin=*`;\n    const response = await fetch(searchUrl);\n    \n    if (!response.ok) return [];\n    \n    const data = await response.json();\n    // data[0] = query, data[1] = titles, data[2] = descriptions, data[3] = urls\n    const titles = data[1] || [];\n    const descriptions = data[2] || [];\n    const urls = data[3] || [];\n    \n    return titles\n      .filter(title => title.toLowerCase().includes('university') || title.toLowerCase().includes('college'))\n      .map((title, index) => ({\n        name: title,\n        description: descriptions[index] || '',\n        website_url: urls[index] || '',\n      }));\n  } catch (error) {\n    console.error('Error searching Wikipedia:', error);\n    return [];\n  }\n}\n\n/**\n * Get prefill data for a university by name from cache\n */\nexport async function getUniversityPrefillData(universityName) {\n  try {\n    const { data, error } = await supabase\n      .rpc('get_university_prefill_data', {\n        p_university_name: universityName,\n      });\n\n    if (error) throw error;\n    return data;\n  } catch (error) {\n    console.error('Error fetching prefill data:', error);\n    return null;\n  }\n}\n\n/**\n * Fetch university data from Google Knowledge Graph (via backend proxy)\n */\nexport async function fetchUniversityDataFromGoogle(universityName) {\n  if (USE_BACKEND_PROXY) {\n    try {\n      const response = await fetch(`${API_URL}/api/university/details?name=${encodeURIComponent(universityName)}`);\n      \n      if (response.ok) {\n        const data = await response.json();\n        return {\n          name: data.university.name || universityName,\n          description: data.university.description || '',\n          website_url: data.university.website_url || '',\n          location: data.university.location || '',\n          established: null,\n          student_count: null,\n          cover_images: data.university.image ? [data.university.image] : [],\n        };\n      }\n    } catch (error) {\n      console.error('Error fetching from Google via proxy:', error);\n    }\n  }\n  \n  return null;\n}\n\n/**\n * Fetch university summary from Wikipedia REST API\n */\nexport async function fetchUniversityDataFromWikipedia(universityName) {\n  try {\n    const url = `https://en.wikipedia.org/api/rest_v1/page/summary/${encodeURIComponent(universityName)}`;\n    const res = await fetch(url);\n    if (!res.ok) return null;\n    const json = await res.json();\n\n    return {\n      name: json.title || universityName,\n      description: json.extract || '',\n      website_url: '',\n      location: '',\n      established: null,\n      student_count: null,\n      cover_images: json.thumbnail?.source ? [json.thumbnail.source] : [],\n    };\n  } catch (e) {\n    console.error('Error fetching from Wikipedia REST:', e);\n    return null;\n  }\n}\n\n/**\n * Fetch university data from Wikidata\n */\nexport async function fetchUniversityDataFromWikidata(universityName) {\n  try {\n    const sparqlQuery = `\n      SELECT ?item ?itemLabel ?locationLabel ?established ?studentCount ?website\n      WHERE {\n        ?item wdt:P31/wdt:P279* wd:Q3918;\n              rdfs:label ?itemLabel.\n        OPTIONAL { ?item wdt:P131 ?location. }\n        OPTIONAL { ?item wdt:P571 ?established. }\n        OPTIONAL { ?item wdt:P2196 ?studentCount. }\n        OPTIONAL { ?item wdt:P856 ?website. }\n        FILTER(CONTAINS(LCASE(?itemLabel), LCASE(\"${universityName}\")))\n        FILTER(LANG(?itemLabel) = \"en\")\n        SERVICE wikibase:label { bd:serviceParam wikibase:language \"en\". }\n      }\n      LIMIT 1\n    `;\n    const url = `https://query.wikidata.org/sparql?query=${encodeURIComponent(sparqlQuery)}&format=json`;\n    const response = await fetch(url);\n    if (!response.ok) return null;\n\n    const data = await response.json();\n    const binding = data.results.bindings[0];\n\n    if (!binding) return null;\n\n    return {\n      name: binding.itemLabel.value,\n      description: '',\n      website_url: binding.website?.value || '',\n      location: binding.locationLabel?.value || '',\n      established: binding.established?.value ? new Date(binding.established.value).getFullYear() : null,\n      student_count: binding.studentCount?.value || null,\n      cover_images: [],\n    };\n  } catch (error) {\n    console.error('Error fetching from Wikidata:', error);\n    return null;\n  }\n}\n\n/**\n * Fetch Wikimedia Commons images for a university\n */\nexport async function fetchWikimediaImages(universityName) {\n  try {\n    const title = (universityName || '').trim().replace(/\\s+/g, '_');\n    if (!title) return [];\n\n    const listUrl = `https://commons.wikimedia.org/w/api.php?action=query&format=json&origin=*&prop=images&titles=${encodeURIComponent(title)}`;\n    const listRes = await fetch(listUrl);\n    if (!listRes.ok) return [];\n    const listJson = await listRes.json();\n\n    const pages = listJson?.query?.pages ? Object.values(listJson.query.pages) : [];\n    const images = pages[0]?.images || [];\n    if (!images.length) return [];\n\n    const fileTitles = images\n      .map((img) => img?.title)\n      .filter(Boolean)\n      .slice(0, 50)\n      .join('|');\n\n    if (!fileTitles) return [];\n\n    const infoUrl = `https://commons.wikimedia.org/w/api.php?action=query&format=json&origin=*&prop=imageinfo&iiprop=url&titles=${encodeURIComponent(fileTitles)}`;\n    const infoRes = await fetch(infoUrl);\n    if (!infoRes.ok) return [];\n    const infoJson = await infoRes.json();\n\n    const filePages = infoJson?.query?.pages ? Object.values(infoJson.query.pages) : [];\n    const urls = filePages\n      .map((p) => p?.imageinfo?.[0]?.url)\n      .filter((u) => typeof u === 'string' && /\\.(jpg|jpeg|png|webp)$/i.test(u));\n\n    const prioritized = urls.sort((a, b) => {\n      const deprioritize = (s) => /logo|seal|coat_of_arms|emblem/i.test(s) ? 1 : 0;\n      return deprioritize(a) - deprioritize(b);\n    });\n\n    return prioritized.slice(0, 5);\n  } catch (e) {\n    console.error('Error fetching Wikimedia images:', e);\n    return [];\n  }\n}\n\n/**\n * Fetch images from Unsplash (via backend proxy if enabled)\n */\nexport async function fetchUnsplashImages(universityName) {\n  if (USE_BACKEND_PROXY) {\n    try {\n      const response = await fetch(`${API_URL}/api/university/images?query=${encodeURIComponent(universityName)}`);\n      \n      if (response.ok) {\n        const data = await response.json();\n        return data.images?.map(img => img.url) || [];\n      }\n    } catch (error) {\n      console.error('Error fetching Unsplash images via proxy:', error);\n    }\n  }\n  \n  return [];\n}\n\n/**\n * Download image from URL and convert to File object\n */\nexport async function downloadImageAsFile(imageUrl, fileName) {\n  try {\n    const response = await fetch(imageUrl);\n    if (!response.ok) throw new Error('Failed to download image');\n\n    const blob = await response.blob();\n    const file = new File([blob], fileName, { type: blob.type });\n    return file;\n  } catch (error) {\n    console.error('Error downloading image:', error);\n    return null;\n  }\n}\n\n/**\n * Cache university prefill data\n */\nexport async function cacheUniversityPrefillData(universityName, data, source = 'manual') {\n  try {\n    const { error } = await supabase\n      .from('university_prefill_cache')\n      .upsert({\n        university_name: universityName,\n        data: data,\n        source: source,\n        updated_at: new Date().toISOString(),\n      });\n\n    if (error) throw error;\n    return true;\n  } catch (error) {\n    console.error('Error caching prefill data:', error);\n    return false;\n  }\n}\n\n/**\n * Upload multiple images for a university\n */\nexport async function uploadUniversityImages(universityId, imageFiles) {\n  try {\n    const uploadedImages = [];\n    const bucket = 'university-covers';\n\n    for (let i = 0; i < imageFiles.length; i++) {\n      const file = imageFiles[i];\n      const fileExt = file.name.split('.').pop();\n      const fileName = `${universityId}/image_${i + 1}_${Date.now()}.${fileExt}`;\n\n      const { error: uploadError } = await supabase.storage\n        .from(bucket)\n        .upload(fileName, file, {\n          cacheControl: '3600',\n          upsert: false,\n        });\n\n      if (uploadError) {\n        console.error('Error uploading image:', uploadError);\n        continue;\n      }\n\n      const { data: urlData } = supabase.storage\n        .from(bucket)\n        .getPublicUrl(fileName);\n\n      uploadedImages.push({\n        url: urlData.publicUrl,\n        fileName: fileName,\n      });\n    }\n\n    return uploadedImages;\n  } catch (error) {\n    console.error('Error uploading multiple images:', error);\n    throw error;\n  }\n}\n\n/**\n * Add image record to university_images table\n */\nexport async function addUniversityImage(universityId, imageUrl, caption = null, isPrimary = false, displayOrder = 0) {\n  try {\n    const { data, error } = await supabase\n      .rpc('add_university_image', {\n        p_university_id: universityId,\n        p_image_url: imageUrl,\n        p_caption: caption,\n        p_is_primary: isPrimary,\n        p_display_order: displayOrder,\n      });\n\n    if (error) throw error;\n    return data;\n  } catch (error) {\n    console.error('Error adding university image:', error);\n    throw error;\n  }\n}\n\n/**\n * Get all images for a university\n */\nexport async function getUniversityImages(universityId) {\n  try {\n    const { data, error } = await supabase\n      .from('university_images')\n      .select('*')\n      .eq('university_id', universityId)\n      .order('is_primary', { ascending: false })\n      .order('display_order', { ascending: true });\n\n    if (error) throw error;\n    return data || [];\n  } catch (error) {\n    console.error('Error fetching university images:', error);\n    throw error;\n  }\n}\n\n/**\n * Set image as primary\n */\nexport async function setPrimaryUniversityImage(imageId) {\n  try {\n    const { error } = await supabase\n      .rpc('set_primary_university_image', {\n        p_image_id: imageId,\n      });\n\n    if (error) throw error;\n    return true;\n  } catch (error) {\n    console.error('Error setting primary image:', error);\n    return false;\n  }\n}\n\n/**\n * Delete university image\n */\nexport async function deleteUniversityImage(imageId, imageUrl) {\n  try {\n    const urlParts = imageUrl.split('/');\n    const bucket = 'university-covers';\n    const filePath = urlParts.slice(urlParts.indexOf(bucket) + 1).join('/');\n\n    const { error: storageError } = await supabase.storage\n      .from(bucket)\n      .remove([filePath]);\n\n    if (storageError) {\n      console.error('Error deleting from storage:', storageError);\n    }\n\n    const { error: dbError } = await supabase\n      .from('university_images')\n      .delete()\n      .eq('id', imageId);\n\n    if (dbError) throw dbError;\n    return true;\n  } catch (error) {\n    console.error('Error deleting university image:', error);\n    throw error;\n  }\n}\n\n/**\n * Main auto-fill function triggered on tab/input\n */\nexport async function autoFillUniversityData(universityName) {\n  try {\n    // Check cache first\n    let data = await getUniversityPrefillData(universityName);\n    if (data) return data;\n\n    // Prefer Wikipedia + Wikidata for accuracy (no API keys needed)\n    const wikiSummary = await fetchUniversityDataFromWikipedia(universityName);\n    const wikidata = await fetchUniversityDataFromWikidata(universityName);\n\n    if (wikiSummary || wikidata) {\n      const merged = {\n        name: (wikiSummary?.name || wikidata?.name || universityName) ?? universityName,\n        description: wikiSummary?.description || '',\n        website_url: wikidata?.website_url || '',\n        location: wikidata?.location || '',\n        established: wikidata?.established ?? null,\n        student_count: wikidata?.student_count ?? null,\n        cover_images: wikiSummary?.cover_images || [],\n      };\n      data = merged;\n    }\n\n    // Try Google as last resort (via proxy if enabled)\n    if (!data) {\n      data = await fetchUniversityDataFromGoogle(universityName);\n    }\n\n    // Fetch images\n    if (data && (!data.cover_images || data.cover_images.length === 0)) {\n      const commons = await fetchWikimediaImages(data.name || universityName);\n      if (commons.length) {\n        data.cover_images = commons;\n      } else {\n        const unsplash = await fetchUnsplashImages(data.name || universityName);\n        data.cover_images = unsplash;\n      }\n    }\n\n    // Cache the result\n    if (data) {\n      await cacheUniversityPrefillData(universityName, data, 'wikipedia_wikidata');\n    }\n\n    return (\n      data || {\n        name: universityName,\n        description: '',\n        website_url: '',\n        location: '',\n        established: null,\n        student_count: null,\n        cover_images: [],\n      }\n    );\n  } catch (error) {\n    console.error('Error auto-filling university data:', error);\n    return {\n      name: universityName,\n      description: '',\n      website_url: '',\n      location: '',\n      established: null,\n      student_count: null,\n      cover_images: [],\n    };\n  }\n}\n\n/**\n * Get all cached universities for dropdown/autocomplete\n */\nexport async function getAllCachedUniversities() {\n  try {\n    const { data, error } = await supabase\n      .from('university_prefill_cache')\n      .select('university_name')\n      .order('university_name');\n\n    if (error) throw error;\n    return data?.map(u => u.university_name) || [];\n  } catch (error) {\n    console.error('Error fetching cached universities:', error);\n    return [];\n  }\n}\n\n/**\n * Debounce utility\n */\nfunction debounce(func, wait) {\n  let timeout;\n  return (...args) => {\n    clearTimeout(timeout);\n    timeout = setTimeout(() => func(...args), wait);\n  };\n}\n\n/**\n * Frontend integration for auto-fill\n */\nexport function setupAutoFill(inputElement, resultContainer) {\n  inputElement.addEventListener(\n    'input',\n    debounce(async () => {\n      const query = inputElement.value.trim();\n      if (query.length < 3) return;\n\n      const suggestions = await searchUniversityNames(query);\n      console.log('Suggestions:', suggestions);\n      \n      const datalist = document.createElement('datalist');\n      datalist.id = 'university-suggestions';\n      suggestions.forEach(s => {\n        const option = document.createElement('option');\n        option.value = s.name;\n        datalist.appendChild(option);\n      });\n      inputElement.setAttribute('list', 'university-suggestions');\n      inputElement.parentNode.appendChild(datalist);\n    }, 300)\n  );\n\n  inputElement.addEventListener('keydown', async (event) => {\n    if (event.key === 'Tab') {\n      event.preventDefault();\n      const universityName = inputElement.value.trim();\n      if (!universityName) return;\n\n      const data = await autoFillUniversityData(universityName);\n      if (data) {\n        resultContainer.innerHTML = `\n          <h3>${data.name}</h3>\n          <p>${data.description || 'No description available'}</p>\n          <a href=\"${data.website_url || '#'}\" target=\"_blank\">Website</a>\n          <p>Location: ${data.location || 'N/A'}</p>\n          <p>Established: ${data.established || 'N/A'}</p>\n          <p>Students: ${data.student_count || 'N/A'}</p>\n          <div>\n            ${data.cover_images\n              .map(img => `<img src=\"${img}\" alt=\"${data.name} campus\" width=\"200\" style=\"margin-right: 10px;\" />`)\n              .join('')}\n          </div>\n        `;\n      }\n    }\n  });\n}"],"names":["_ref","userProfile","loading","setLoading","useState","rows","setRows","count","setCount","page","setPage","pageSize","search","setSearch","categories","setCategories","categoryId","setCategoryId","sort","setSort","col","dir","editingId","setEditingId","editDraft","setEditDraft","newPdf","setNewPdf","newCover","setNewCover","confirm","showToast","useAdminUI","ADMIN_EMAILS","isAdmin","role","includes","email","isEditor","totalPages","useMemo","Math","max","ceil","load","async","data","total","fetchBooks","useEffect","fetchCategories","_unused","canEdit","row","cancelEdit","toggleSort","s","_jsx","children","_jsxs","className","length","style","display","gridTemplateColumns","gap","marginBottom","background","border","borderRadius","padding","color","fontSize","fontWeight","reduce","sum","r","downloads","views","comments_count","likes_count","value","onChange","e","target","placeholder","map","c","id","name","onClick","window","location","href","overflowX","WebkitOverflowScrolling","minWidth","borderCollapse","borderSpacing","width","cursor","borderBottom","colSpan","textAlign","_categories$find","cover_url","src","alt","height","objectFit","title","_objectSpread","author","category_id","find","year","type","pages","publisher","Date","created_at","toLocaleDateString","flexDirection","document","getElementById","concat","click","alignItems","transition","accept","_e$target$files","files","_Fragment","slice","_e$target$files2","marginTop","message","updates","updateBook","newPdfFile","newCoverFile","oldFilePath","file_path","console","error","saveEdit","language","isbn","startEdit","disabled","confirmLabel","cancelLabel","variant","deleteBook","handleDelete","p","min","paperCounts","setPaperCounts","fetchUniversities","counts","uni","getPastPaperCountByUniversity","_row$description","_row$student_count","cover_image_url","description","established","student_count","toLocaleString","undefined","Number","updateUniversity","website_url","deleteUniversity","err","formatTimestamp","isoString","month","day","hour","minute","second","hour12","timeZoneName","faculties","setFaculties","facultyFilter","setFacultyFilter","fetchPastPapers","faculty","getFaculties","downloads_count","views_count","trim","f","_row$profiles","_row$profiles2","_row$profiles3","unit_name","unit_code","semester","exam_type","profiles","full_name","updatePastPaper","deletePastPaper","getAllAuthorsEngagementStats","limit","arguments","supabase","from","select","order","ascending","Authors","stats","setStats","engagementStats","setEngagementStats","searchTerm","setSearchTerm","sortBy","setSortBy","timeRange","setTimeRange","loadData","statsData","engageData","Promise","all","fetchStats","engageMap","forEach","stat","author_name","interval","setInterval","clearInterval","filteredAndSorted","authors","filtered","filter","toLowerCase","a","b","authorEngageA","authorEngageB","engagement_score","bookCount","totalDownloads","followers_count","parseFloat","avgRating","localeCompare","overallStats","totalAuthors","totalBooks","totalDL","totalFollowers","totalLikes","totalLoves","totalComments","toFixed","Object","values","loves_count","FiTrendingUp","FiBook","FiDownload","FiStar","FiUsers","MdFavoriteBorder","FiHeart","FiMessageSquare","FiSearch","idx","engage","engScore","medal","FiThumbsUp","average_rating","searchParams","useSearchParams","activeTab","setActiveTab","tabParam","get","React","styleTag","createElement","innerHTML","head","appendChild","remove","size","FiMapPin","FiFileText","FiBookOpen","Books","UniversitiesManagement","PastPapersManagement","USE_BACKEND_PROXY","searchUniversityNames","query","rpc","p_query","p_limit","wikiResults","searchUrl","encodeURIComponent","response","fetch","ok","json","titles","descriptions","urls","index","searchWikipediaUniversities","cacheUniversityPrefillData","API_URL","universities","proxyError","warn","fetchWikimediaImages","universityName","_listJson$query","_pages$","_infoJson$query","replace","listUrl","listRes","listJson","images","fileTitles","img","Boolean","join","infoUrl","infoRes","infoJson","_p$imageinfo","_p$imageinfo$","imageinfo","url","u","test","deprioritize","fetchUnsplashImages","_data$images","downloadImageAsFile","imageUrl","fileName","Error","blob","File","source","upsert","university_name","updated_at","toISOString","autoFillUniversityData","p_university_name","getUniversityPrefillData","wikiSummary","_json$thumbnail","res","extract","cover_images","thumbnail","fetchUniversityDataFromWikipedia","wikidata","_binding$website","_binding$locationLabe","_binding$established","_binding$studentCount","sparqlQuery","binding","results","bindings","itemLabel","website","locationLabel","getFullYear","studentCount","fetchUniversityDataFromWikidata","_wikidata$established","_wikidata$student_cou","university","image","fetchUniversityDataFromGoogle","commons","unsplash"],"ignoreList":[],"sourceRoot":""}