"use strict";(self.webpackChunkcampuslife=self.webpackChunkcampuslife||[]).push([[131],{2131:(e,i,s)=>{s.r(i),s.d(i,{default:()=>p});var o=s(9379),n=s(5043),t=s(5200),r=s(9101),d=s(579);const a=e=>{let{items:i,loading:s,type:o,busy:n,onSelect:r,onApprove:a,onReject:l}=e;return s?(0,d.jsx)("div",{style:{padding:12,color:"#8696a0",fontSize:12},children:"Loading\u2026"}):0===i.length?(0,d.jsx)("div",{style:{padding:12,color:"#8696a0",fontSize:12},children:"No submissions."}):(0,d.jsx)("div",{style:{display:"flex",flexDirection:"column",gap:6},children:i.map(e=>{return(0,d.jsx)("div",{style:{background:"#0b141a",border:"1px solid #1f2c33",borderRadius:4,padding:8,cursor:"pointer"},onClick:()=>r(e),children:(0,d.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",gap:6},children:[(0,d.jsxs)("div",{style:{minWidth:0},children:[(0,d.jsx)("div",{style:{color:"#e9edef",fontWeight:600,fontSize:12},children:"universities"===o?e.name||"Untitled":e.title||"Untitled"}),"books"===o?(0,d.jsxs)("div",{style:{color:"#8696a0",fontSize:11},children:[e.author||"Unknown"," ",e.isbn?"\u2022 ISBN: ".concat(e.isbn):""]}):"universities"===o?(0,d.jsxs)("div",{style:{color:"#8696a0",fontSize:11},children:[e.location||"Unknown location"," ",e.website_url?"\u2022 Has website":""]}):(0,d.jsxs)("div",{style:{color:"#8696a0",fontSize:11},children:[e.faculty||"Unknown faculty"," ",e.unit_code?"\u2022 ".concat(e.unit_code):""," ",e.unit_name?"\u2022 ".concat(e.unit_name):""]}),(0,d.jsxs)("div",{style:{color:"#8696a0",fontSize:10,marginTop:3},children:[(i=e.created_at,i?new Date(i).toLocaleString():"\u2014")," \u2022 ",e.status,e.uploader_email?(0,d.jsxs)(d.Fragment,{children:[" \u2022 Uploaded by ",e.uploader_name||e.uploader_email]}):e.uploaded_by?(0,d.jsxs)(d.Fragment,{children:[" \u2022 Uploaded by ",String(e.uploaded_by)]}):null]})]}),(0,d.jsx)("div",{style:{display:"flex",gap:4},children:"pending"===e.status?(0,d.jsxs)(d.Fragment,{children:[(0,d.jsxs)("button",{className:"btn",disabled:!!n[e.id],onClick:i=>{i.stopPropagation(),a(e.id)},style:{display:"flex",alignItems:"center",gap:4,background:"#00a884",color:"#fff",fontSize:11,padding:"4px 8px"},children:[(0,d.jsx)(t.YrT,{})," Approve"]}),(0,d.jsxs)("button",{className:"btn",disabled:!!n[e.id],onClick:i=>{i.stopPropagation(),l(e.id)},style:{display:"flex",alignItems:"center",gap:4,background:"#ea4335",color:"#fff",fontSize:11,padding:"4px 8px"},children:[(0,d.jsx)(t.yGN,{})," Reject"]})]}):(0,d.jsxs)("div",{style:{color:"#8696a0",display:"flex",alignItems:"center",gap:4,fontSize:11},children:[(0,d.jsx)(t.Ohp,{})," Reviewed"]})})]})},e.id);var i})})},l=e=>{let{submission:i,type:s,busy:o,onClose:n,onApprove:r,onReject:a}=e;const l=e=>e?new Date(e).toLocaleString():"\u2014";return(0,d.jsx)("div",{className:"profile-signout-overlay",onClick:n,style:{zIndex:60},children:(0,d.jsxs)("div",{className:"profile-signout-modal",onClick:e=>e.stopPropagation(),style:{maxWidth:760,width:"96%",maxHeight:"90vh",display:"flex",flexDirection:"column",background:"#111b21"},children:[(0,d.jsxs)("div",{className:"profile-signout-header",style:{borderBottom:"1px solid #1f2c33",padding:"8px 12px"},children:[(0,d.jsxs)("h2",{style:{display:"flex",alignItems:"center",gap:4,fontSize:"13px",margin:0},children:[(0,d.jsx)(t.zd,{})," Review ","books"===s?"Book":"universities"===s?"University":"Past Paper"," Submission"]}),(0,d.jsx)("button",{className:"profile-signout-close",onClick:n,children:"\xd7"})]}),(0,d.jsxs)("div",{className:"profile-signout-body",style:{padding:8,display:"flex",flexDirection:"column",gap:8,overflowY:"auto"},children:[(0,d.jsxs)("div",{style:{padding:6,background:"rgba(0, 168, 132, 0.1)",border:"1px solid rgba(0, 168, 132, 0.3)",borderRadius:4},children:[(0,d.jsx)("div",{style:{color:"#00a884",fontSize:10,fontWeight:600,marginBottom:2},children:"UPLOADER"}),(0,d.jsx)("div",{style:{color:"#e9edef",fontSize:12,fontWeight:500},children:i.uploader_name||i.uploader_email||(i.uploaded_by?String(i.uploaded_by):"Unknown")}),i.uploader_email&&i.uploader_email!==i.uploader_name&&(0,d.jsx)("div",{style:{color:"#8696a0",fontSize:10},children:i.uploader_email}),!i.uploader_email&&i.uploaded_by&&String(i.uploaded_by).includes("@")&&(0,d.jsx)("div",{style:{color:"#8696a0",fontSize:10},children:String(i.uploaded_by)})]}),"books"===s?(0,d.jsxs)(d.Fragment,{children:[i.cover_url&&(0,d.jsx)("div",{style:{flex:"0 0 120px",alignSelf:"center"},children:(0,d.jsx)("img",{src:i.cover_url,alt:i.title||"Cover",style:{width:"100%",borderRadius:4,objectFit:"cover",boxShadow:"0 2px 6px rgba(0,0,0,0.3)"}})}),(0,d.jsxs)("div",{children:[(0,d.jsx)("h3",{style:{color:"#e9edef",marginBottom:2,fontSize:13,fontWeight:600},children:i.title||"Untitled"}),(0,d.jsxs)("div",{style:{color:"#8696a0",marginBottom:8,fontSize:11},children:[(0,d.jsx)("strong",{children:i.author||"Unknown author"}),i.isbn&&(0,d.jsxs)(d.Fragment,{children:[" \u2022 ISBN: ",i.isbn]})]}),i.description&&(0,d.jsxs)("div",{style:{color:"#cbd5f5",fontSize:11,marginBottom:8,lineHeight:1.4,padding:"6px 0",borderTop:"1px solid #1f2c33",borderBottom:"1px solid #1f2c33"},children:[(0,d.jsx)("strong",{style:{color:"#e9edef"},children:"Description:"}),(0,d.jsx)("br",{}),i.description]}),(0,d.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(120px, 1fr))",gap:6,marginBottom:8},children:[i.author&&(0,d.jsxs)("div",{style:{padding:6,background:"#0b141a",borderRadius:4,border:"1px solid #1f2c33"},children:[(0,d.jsx)("div",{style:{color:"#8696a0",fontSize:10},children:"AUTHOR"}),(0,d.jsx)("div",{style:{color:"#e9edef",fontSize:11,fontWeight:500},children:i.author})]}),i.year&&(0,d.jsxs)("div",{style:{padding:6,background:"#0b141a",borderRadius:4,border:"1px solid #1f2c33"},children:[(0,d.jsx)("div",{style:{color:"#8696a0",fontSize:10},children:"YEAR"}),(0,d.jsx)("div",{style:{color:"#e9edef",fontSize:11,fontWeight:500},children:i.year})]}),i.publisher&&(0,d.jsxs)("div",{style:{padding:6,background:"#0b141a",borderRadius:4,border:"1px solid #1f2c33"},children:[(0,d.jsx)("div",{style:{color:"#8696a0",fontSize:10},children:"PUBLISHER"}),(0,d.jsx)("div",{style:{color:"#e9edef",fontSize:11,fontWeight:500},children:i.publisher})]}),i.pages&&(0,d.jsxs)("div",{style:{padding:6,background:"#0b141a",borderRadius:4,border:"1px solid #1f2c33"},children:[(0,d.jsx)("div",{style:{color:"#8696a0",fontSize:10},children:"PAGES"}),(0,d.jsx)("div",{style:{color:"#e9edef",fontSize:11,fontWeight:500},children:i.pages})]}),i.language&&(0,d.jsxs)("div",{style:{padding:6,background:"#0b141a",borderRadius:4,border:"1px solid #1f2c33"},children:[(0,d.jsx)("div",{style:{color:"#8696a0",fontSize:10},children:"LANGUAGE"}),(0,d.jsx)("div",{style:{color:"#e9edef",fontSize:11,fontWeight:500},children:i.language})]}),i.isbn&&(0,d.jsxs)("div",{style:{padding:6,background:"#0b141a",borderRadius:4,border:"1px solid #1f2c33"},children:[(0,d.jsx)("div",{style:{color:"#8696a0",fontSize:10},children:"ISBN"}),(0,d.jsx)("div",{style:{color:"#e9edef",fontSize:11,fontWeight:500,wordBreak:"break-all"},children:i.isbn})]})]}),(0,d.jsxs)("div",{style:{marginTop:12,padding:10,background:"#0b141a",borderRadius:6,border:"1px solid #1f2c33"},children:[(0,d.jsx)("div",{style:{color:"#8696a0",fontSize:11,marginBottom:4},children:"SUBMISSION INFO"}),(0,d.jsxs)("div",{style:{color:"#e9edef",fontSize:12},children:[(0,d.jsxs)("div",{children:["Uploaded: ",l(i.created_at)]}),(0,d.jsxs)("div",{children:["Status: ",(0,d.jsx)("span",{style:{color:"pending"===i.status?"#fbbf24":"approved"===i.status?"#00a884":"#ea4335",fontWeight:600},children:i.status.toUpperCase()})]}),i.rejection_reason&&(0,d.jsxs)("div",{style:{color:"#ea4335",marginTop:4},children:["Rejection Reason: ",i.rejection_reason]})]})]})]})]}):"universities"===s?(0,d.jsxs)(d.Fragment,{children:[i.cover_image_url&&(0,d.jsx)("div",{style:{flex:"0 0 150px",alignSelf:"center"},children:(0,d.jsx)("img",{src:i.cover_image_url,alt:i.name||"Cover",style:{width:"100%",borderRadius:4,objectFit:"cover",boxShadow:"0 2px 6px rgba(0,0,0,0.3)"}})}),(0,d.jsxs)("div",{children:[(0,d.jsx)("h3",{style:{color:"#e9edef",marginBottom:4,fontSize:16,fontWeight:600},children:i.name||"Untitled"}),(0,d.jsx)("div",{style:{color:"#8696a0",marginBottom:12,fontSize:13},children:(0,d.jsx)("strong",{children:i.location||"Unknown location"})}),i.description&&(0,d.jsxs)("div",{style:{color:"#cbd5f5",fontSize:11,marginBottom:8,lineHeight:1.4,padding:"6px 0",borderTop:"1px solid #1f2c33",borderBottom:"1px solid #1f2c33"},children:[(0,d.jsx)("strong",{style:{color:"#e9edef"},children:"Description:"}),(0,d.jsx)("br",{}),i.description]}),(0,d.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(120px, 1fr))",gap:6,marginBottom:8},children:[i.location&&(0,d.jsxs)("div",{style:{padding:6,background:"#0b141a",borderRadius:4,border:"1px solid #1f2c33"},children:[(0,d.jsx)("div",{style:{color:"#8696a0",fontSize:10},children:"LOCATION"}),(0,d.jsx)("div",{style:{color:"#e9edef",fontSize:11,fontWeight:500},children:i.location})]}),i.established&&(0,d.jsxs)("div",{style:{padding:6,background:"#0b141a",borderRadius:4,border:"1px solid #1f2c33"},children:[(0,d.jsx)("div",{style:{color:"#8696a0",fontSize:10},children:"ESTABLISHED"}),(0,d.jsx)("div",{style:{color:"#e9edef",fontSize:11,fontWeight:500},children:i.established})]}),i.website_url&&(0,d.jsxs)("div",{style:{padding:6,background:"#0b141a",borderRadius:4,border:"1px solid #1f2c33"},children:[(0,d.jsx)("div",{style:{color:"#8696a0",fontSize:10},children:"WEBSITE"}),(0,d.jsx)("a",{href:i.website_url,target:"_blank",rel:"noopener noreferrer",style:{color:"#00a884",fontSize:11,fontWeight:500,wordBreak:"break-all"},children:"Visit"})]}),i.student_count&&(0,d.jsxs)("div",{style:{padding:6,background:"#0b141a",borderRadius:4,border:"1px solid #1f2c33"},children:[(0,d.jsx)("div",{style:{color:"#8696a0",fontSize:10},children:"STUDENT COUNT"}),(0,d.jsx)("div",{style:{color:"#e9edef",fontSize:11,fontWeight:500},children:i.student_count.toLocaleString()})]})]}),(0,d.jsxs)("div",{style:{marginTop:12,padding:10,background:"#0b141a",borderRadius:6,border:"1px solid #1f2c33"},children:[(0,d.jsx)("div",{style:{color:"#8696a0",fontSize:11,marginBottom:4},children:"SUBMISSION INFO"}),(0,d.jsxs)("div",{style:{color:"#e9edef",fontSize:12},children:[(0,d.jsxs)("div",{children:["Submitted: ",l(i.created_at)]}),(0,d.jsxs)("div",{children:["Status: ",(0,d.jsx)("span",{style:{color:"pending"===i.status?"#fbbf24":"approved"===i.status?"#00a884":"#ea4335",fontWeight:600},children:i.status.toUpperCase()})]}),i.rejection_reason&&(0,d.jsxs)("div",{style:{color:"#ea4335",marginTop:4},children:["Rejection Reason: ",i.rejection_reason]})]})]})]})]}):(0,d.jsx)(d.Fragment,{children:(0,d.jsxs)("div",{children:[(0,d.jsxs)("h3",{style:{color:"#e9edef",marginBottom:4,fontSize:16,fontWeight:600},children:[i.unit_code?"".concat(i.unit_code," \u2014 "):"",i.unit_name||"Untitled"]}),(0,d.jsxs)("div",{style:{color:"#8696a0",marginBottom:12,fontSize:13},children:[(0,d.jsx)("strong",{children:i.faculty||"Unknown faculty"}),i.year&&(0,d.jsxs)(d.Fragment,{children:[" \u2022 ",i.year]}),i.semester&&(0,d.jsxs)(d.Fragment,{children:[" \u2022 Sem ",i.semester]}),i.exam_type&&(0,d.jsxs)(d.Fragment,{children:[" \u2022 ",i.exam_type]})]}),(0,d.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(120px, 1fr))",gap:6,marginBottom:8},children:[i.unit_code&&(0,d.jsxs)("div",{style:{padding:6,background:"#0b141a",borderRadius:4,border:"1px solid #1f2c33"},children:[(0,d.jsx)("div",{style:{color:"#8696a0",fontSize:10},children:"UNIT CODE"}),(0,d.jsx)("div",{style:{color:"#e9edef",fontSize:11,fontWeight:500},children:i.unit_code})]}),i.faculty&&(0,d.jsxs)("div",{style:{padding:6,background:"#0b141a",borderRadius:4,border:"1px solid #1f2c33"},children:[(0,d.jsx)("div",{style:{color:"#8696a0",fontSize:10},children:"FACULTY"}),(0,d.jsx)("div",{style:{color:"#e9edef",fontSize:11,fontWeight:500},children:i.faculty})]}),i.year&&(0,d.jsxs)("div",{style:{padding:6,background:"#0b141a",borderRadius:4,border:"1px solid #1f2c33"},children:[(0,d.jsx)("div",{style:{color:"#8696a0",fontSize:10},children:"YEAR"}),(0,d.jsx)("div",{style:{color:"#e9edef",fontSize:11,fontWeight:500},children:i.year})]}),i.semester&&(0,d.jsxs)("div",{style:{padding:6,background:"#0b141a",borderRadius:4,border:"1px solid #1f2c33"},children:[(0,d.jsx)("div",{style:{color:"#8696a0",fontSize:10},children:"SEMESTER"}),(0,d.jsx)("div",{style:{color:"#e9edef",fontSize:11,fontWeight:500},children:i.semester})]}),i.exam_type&&(0,d.jsxs)("div",{style:{padding:6,background:"#0b141a",borderRadius:4,border:"1px solid #1f2c33"},children:[(0,d.jsx)("div",{style:{color:"#8696a0",fontSize:10},children:"EXAM TYPE"}),(0,d.jsx)("div",{style:{color:"#e9edef",fontSize:11,fontWeight:500},children:i.exam_type})]})]}),(0,d.jsxs)("div",{style:{marginTop:12,padding:10,background:"#0b141a",borderRadius:6,border:"1px solid #1f2c33"},children:[(0,d.jsx)("div",{style:{color:"#8696a0",fontSize:11,marginBottom:4},children:"SUBMISSION INFO"}),(0,d.jsxs)("div",{style:{color:"#e9edef",fontSize:12},children:[(0,d.jsxs)("div",{children:["Uploaded: ",l(i.created_at)]}),(0,d.jsxs)("div",{children:["Status: ",(0,d.jsx)("span",{style:{color:"pending"===i.status?"#fbbf24":"approved"===i.status?"#00a884":"#ea4335",fontWeight:600},children:i.status.toUpperCase()})]}),i.rejection_reason&&(0,d.jsxs)("div",{style:{color:"#ea4335",marginTop:4},children:["Rejection Reason: ",i.rejection_reason]})]})]})]})})]}),(0,d.jsx)("div",{className:"profile-signout-footer",style:{borderTop:"1px solid #1f2c33",padding:6,display:"flex",justifyContent:"flex-end",gap:4},children:"pending"===i.status?(0,d.jsxs)(d.Fragment,{children:[(0,d.jsxs)("button",{className:"btn",disabled:!!o[i.id],onClick:()=>r(i.id),style:{display:"flex",alignItems:"center",gap:4,background:"#00a884",color:"#fff",fontSize:11,padding:"4px 8px"},children:[(0,d.jsx)(t.YrT,{})," Approve"]}),(0,d.jsxs)("button",{className:"btn",disabled:!!o[i.id],onClick:()=>a(i.id),style:{display:"flex",alignItems:"center",gap:4,background:"#ea4335",color:"#fff",fontSize:11,padding:"4px 8px"},children:[(0,d.jsx)(t.yGN,{})," Reject"]})]}):(0,d.jsxs)("div",{style:{color:"#8696a0",display:"flex",alignItems:"center",gap:4,fontSize:11},children:[(0,d.jsx)(t.Ohp,{})," Already reviewed"]})})]})})};const c=s(3488).H,p=e=>{let{userProfile:i}=e;const[s,p]=(0,n.useState)([]),[u,f]=(0,n.useState)(!1),[g,x]=(0,n.useState)(null),[b,h]=(0,n.useState)("pending"),[v,y]=(0,n.useState)({}),[m,j]=(0,n.useState)("books"),[S,k]=(0,n.useState)({booksPending:0,pastPapersPending:0,universitiesPending:0}),[z,P]=(0,n.useState)(null),{confirm:_,prompt:w,showToast:R}=(0,r.v)(),C=(0,n.useMemo)(()=>({"Content-Type":"application/json","x-actor-email":(null===i||void 0===i?void 0:i.email)||"admin","x-actor-id":(null===i||void 0===i?void 0:i.id)||(null===i||void 0===i?void 0:i.user_id)||""}),[null===i||void 0===i?void 0:i.email,null===i||void 0===i?void 0:i.id,null===i||void 0===i?void 0:i.user_id]),I=async()=>{f(!0),x(null);try{var e;const i="".concat(c,"/api/elib/submissions?status=").concat(encodeURIComponent(b),"&type=").concat(encodeURIComponent(m));console.log("[Submissions] Fetching ".concat(m," with status=").concat(b,": ").concat(i));const s=await fetch(i),o=await s.json();if(console.log("[Submissions] Response for ".concat(m,":"),{status:s.status,count:null===(e=o.submissions)||void 0===e?void 0:e.length,items:o.submissions}),!s.ok)throw new Error((null===o||void 0===o?void 0:o.error)||"Failed to load ".concat(m," submissions"));const n=Array.isArray(o.submissions)?o.submissions:[];console.log("[Submissions] Loaded ".concat(n.length," ").concat(m," submissions with status=").concat(b)),p(n)}catch(i){console.error("[Submissions] Error fetching ".concat(m,":"),i),x(i.message||"Failed to load ".concat(m," submissions"))}finally{f(!1)}},A=async()=>{try{const e=await fetch("".concat(c,"/api/elib/submissions/summary")),i=await e.json();if(!e.ok)throw new Error((null===i||void 0===i?void 0:i.error)||"Failed to load summary");k({booksPending:i.booksPending||0,pastPapersPending:i.pastPapersPending||0,universitiesPending:i.universitiesPending||0})}catch(e){}};(0,n.useEffect)(()=>{I()},[b,m]),(0,n.useEffect)(()=>{A()},[]);const N=async e=>{console.log("Approve called with id:",e,"type of id:",typeof e);const i=s.find(i=>i.id===e)||z;console.log("Found item:",i);const n="books"===m?(null===i||void 0===i?void 0:i.title)||"this book":"universities"===m?(null===i||void 0===i?void 0:i.name)||"this university":(null===i||void 0===i?void 0:i.unit_code)||(null===i||void 0===i?void 0:i.unit_name)||"this past paper",t=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i;if(!t.test(e))return console.error("Invalid submission ID format:",e),null!==z&&void 0!==z&&z.id&&t.test(z.id)?(console.log("Recursing with selected.id:",z.id),N(z.id)):void R({type:"error",message:"Invalid submission ID format. Please refresh and try again."});if(await _({title:"Approve ".concat("books"===m?"Book":"universities"===m?"University":"Past Paper","?"),message:"Are you sure you want to approve ".concat(n,"? It will become visible to users and count towards the uploader's contributions."),confirmLabel:"Approve",cancelLabel:"Cancel",variant:"default"})){y(i=>(0,o.A)((0,o.A)({},i),{},{[e]:!0})),p(i=>i.filter(i=>i.id!==e)),P(null),k(e=>{const i=(0,o.A)({},e);return"books"===m?i.booksPending=Math.max(0,i.booksPending-1):"universities"===m?i.universitiesPending=Math.max(0,i.universitiesPending-1):"past_papers"===m&&(i.pastPapersPending=Math.max(0,i.pastPapersPending-1)),i});try{let i;i="universities"===m?await fetch("".concat(c,"/api/elib/universities/").concat(e),{method:"PATCH",headers:C,body:JSON.stringify({status:"approved"})}):await fetch("".concat(c,"/api/elib/submissions/").concat(e,"/approve?type=").concat(encodeURIComponent(m)),{method:"POST",headers:C});const s=await i.json();if(!i.ok)throw new Error((null===s||void 0===s?void 0:s.error)||"Approve failed");R({type:"success",message:"".concat("books"===m?"Book":"universities"===m?"University":"Past paper"," approved successfully.")})}catch(r){console.error("Approve submission failed:",r),R({type:"error",message:r.message||"Approve failed."}),I(),A()}finally{y(i=>(0,o.A)((0,o.A)({},i),{},{[e]:!1}))}}},U=async e=>{console.log("Reject called with id:",e,"type of id:",typeof e);const i=s.find(i=>i.id===e)||z;console.log("Found item:",i);const n="books"===m?(null===i||void 0===i?void 0:i.title)||"this book":"universities"===m?(null===i||void 0===i?void 0:i.name)||"this university":(null===i||void 0===i?void 0:i.unit_code)||(null===i||void 0===i?void 0:i.unit_name)||"this past paper",t=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i;if(!t.test(e))return console.error("Invalid submission ID format:",e),null!==z&&void 0!==z&&z.id&&t.test(z.id)?(console.log("Recursing with selected.id:",z.id),U(z.id)):void R({type:"error",message:"Invalid submission ID format. Please refresh and try again."});const r=await w({title:"Reject ".concat("books"===m?"Book":"universities"===m?"University":"Past Paper","?"),message:"Optionally provide a reason for rejecting ".concat(n,". This may be shared with the uploader."),label:"Rejection reason",defaultValue:"",multiline:!0,confirmLabel:"Reject",cancelLabel:"Cancel",variant:"danger"});if(null!==r){y(i=>(0,o.A)((0,o.A)({},i),{},{[e]:!0})),p(i=>i.filter(i=>i.id!==e)),P(null),k(e=>{const i=(0,o.A)({},e);return"books"===m?i.booksPending=Math.max(0,i.booksPending-1):"universities"===m?i.universitiesPending=Math.max(0,i.universitiesPending-1):"past_papers"===m&&(i.pastPapersPending=Math.max(0,i.pastPapersPending-1)),i});try{let i;i="universities"===m?await fetch("".concat(c,"/api/elib/universities/").concat(e),{method:"PATCH",headers:C,body:JSON.stringify({status:"rejected",rejection_reason:r||""})}):await fetch("".concat(c,"/api/elib/submissions/").concat(e,"/reject?type=").concat(encodeURIComponent(m)),{method:"POST",headers:C,body:JSON.stringify({reason:r||""})});const s=await i.json();if(!i.ok)throw new Error((null===s||void 0===s?void 0:s.error)||"Reject failed");R({type:"success",message:"".concat("books"===m?"Book":"universities"===m?"University":"Past paper"," rejected.")})}catch(d){console.error("Reject submission failed:",d),R({type:"error",message:d.message||"Reject failed."}),I(),A()}finally{y(i=>(0,o.A)((0,o.A)({},i),{},{[e]:!1}))}}};return(0,d.jsxs)("div",{className:"panel",children:[(0,d.jsx)("div",{className:"panel-title",children:"Submissions"}),(0,d.jsx)("div",{style:{color:"#8696a0",fontSize:12,marginBottom:8},children:"Review and approve or reject user-contributed books, universities, and past papers."}),(0,d.jsxs)("div",{className:"panel",style:{marginBottom:8,display:"flex",alignItems:"center",gap:6,flexWrap:"wrap"},children:[(0,d.jsxs)("div",{style:{display:"flex",gap:4,flexWrap:"wrap"},children:[(0,d.jsxs)("button",{className:"btn",style:{display:"flex",alignItems:"center",gap:4,background:"books"===m?"#00a884":"transparent",color:"books"===m?"#fff":"#e9edef",borderColor:"books"===m?"#00a884":"#374151"},onClick:()=>j("books"),children:[(0,d.jsx)(t.H9b,{})," Books",S.booksPending>0&&(0,d.jsx)("span",{className:"notification-badge",style:{marginLeft:4},children:S.booksPending>99?"99+":S.booksPending})]}),(0,d.jsxs)("button",{className:"btn",style:{display:"flex",alignItems:"center",gap:4,background:"universities"===m?"#00a884":"transparent",color:"universities"===m?"#fff":"#e9edef",borderColor:"universities"===m?"#00a884":"#374151"},onClick:()=>j("universities"),children:[(0,d.jsx)(t.HzC,{})," Universities",S.universitiesPending>0&&(0,d.jsx)("span",{className:"notification-badge",style:{marginLeft:4},children:S.universitiesPending>99?"99+":S.universitiesPending})]}),(0,d.jsxs)("button",{className:"btn",style:{display:"flex",alignItems:"center",gap:4,background:"past_papers"===m?"#00a884":"transparent",color:"past_papers"===m?"#fff":"#e9edef",borderColor:"past_papers"===m?"#00a884":"#374151"},onClick:()=>j("past_papers"),children:[(0,d.jsx)(t.jH2,{})," Past Papers",S.pastPapersPending>0&&(0,d.jsx)("span",{className:"notification-badge",style:{marginLeft:4},children:S.pastPapersPending>99?"99+":S.pastPapersPending})]})]}),(0,d.jsxs)("select",{className:"input",value:b,onChange:e=>h(e.target.value),style:{maxWidth:200},children:[(0,d.jsx)("option",{value:"pending",children:"Pending"}),(0,d.jsx)("option",{value:"approved",children:"Approved"}),(0,d.jsx)("option",{value:"rejected",children:"Rejected"}),(0,d.jsx)("option",{value:"all",children:"All"})]}),(0,d.jsxs)("button",{className:"btn",onClick:I,style:{display:"flex",alignItems:"center",gap:4},children:[(0,d.jsx)(t.jTZ,{})," Refresh"]})]}),g&&(0,d.jsx)("div",{style:{marginBottom:8,padding:6,borderRadius:4,border:"1px solid rgba(234,67,53,.35)",color:"#ffab91",background:"rgba(234,67,53,.08)",fontSize:12},children:g}),(0,d.jsx)(a,{items:s,loading:u,type:m,busy:v,onSelect:P,onApprove:N,onReject:U}),z&&(0,d.jsx)(l,{submission:z,type:m,busy:v,onClose:()=>P(null),onApprove:N,onReject:U})]})}}}]);
//# sourceMappingURL=131.7d06a7c9.chunk.js.map