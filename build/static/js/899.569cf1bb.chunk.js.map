{"version":3,"file":"static/js/899.569cf1bb.chunk.js","mappings":"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","sources":["SomaLux/Books/Admin/utils/extractPastPaperMetadata.js","SomaLux/Books/Admin/pages/AutoUpload.jsx"],"sourcesContent":["import * as pdfjsLib from 'pdfjs-dist';\r\n\r\n/**\r\n * Extract metadata from past paper PDF\r\n * Reads first page and extracts: university, faculty, unit code, year, exam type\r\n */\r\nexport async function extractPastPaperMetadata(pdfFile) {\r\n  try {\r\n    // Set up PDF.js worker\r\n    if (!pdfjsLib.GlobalWorkerOptions.workerSrc) {\r\n      pdfjsLib.GlobalWorkerOptions.workerSrc = `//cdnjs.cloudflare.com/ajax/libs/pdf.js/${pdfjsLib.version}/pdf.worker.min.js`;\r\n    }\r\n\r\n    const arrayBuffer = await pdfFile.arrayBuffer();\r\n    const pdfDoc = await pdfjsLib.getDocument({ data: arrayBuffer }).promise;\r\n\r\n    // Extract text from first 2 pages\r\n    let fullText = '';\r\n    const pagesToRead = Math.min(2, pdfDoc.numPages);\r\n\r\n    for (let i = 1; i <= pagesToRead; i++) {\r\n      const page = await pdfDoc.getPage(i);\r\n      const textContent = await page.getTextContent();\r\n      const pageText = textContent.items.map(item => item.str).join(' ');\r\n      fullText += pageText + '\\n';\r\n    }\r\n\r\n    return parseMetadataFromText(fullText, pdfFile.name);\r\n  } catch (error) {\r\n    console.warn('PDF extraction failed, falling back to filename parsing:', error);\r\n    return parseMetadataFromFilename(pdfFile.name);\r\n  }\r\n}\r\n\r\n/**\r\n * Parse metadata from extracted text\r\n */\r\nfunction parseMetadataFromText(text, filename) {\r\n  const metadata = {\r\n    university: null,\r\n    faculty: null,\r\n    unitCode: null,\r\n    unitName: null,\r\n    year: null,\r\n    semester: null,\r\n    examType: null,\r\n    source: 'text'\r\n  };\r\n\r\n  // Convert to uppercase for pattern matching\r\n  const upperText = text.toUpperCase();\r\n\r\n  // Extract University - look for common patterns\r\n  const universityPatterns = [\r\n    /UNIVERSITY\\s+OF\\s+([A-Z\\s]+?)(?:\\n|EXAMINATION|EXAM|PAPER|FACULTY|SCHOOL|DEPARTMENT|$)/i,\r\n    /([A-Z\\s]+?)\\s+UNIVERSITY(?:\\n|\\s|EXAMINATION|EXAM|FACULTY|SCHOOL|DEPARTMENT|$)/i,\r\n  ];\r\n\r\n  for (const pattern of universityPatterns) {\r\n    const match = text.match(pattern);\r\n    if (match && match[1]) {\r\n      const extracted = match[1].trim();\r\n      // Clean up extracted text\r\n      if (extracted.length > 3) { // Avoid very short matches\r\n        metadata.university = extracted;\r\n        break;\r\n      }\r\n    }\r\n  }\r\n\r\n  // Extract Faculty/School - more flexible patterns - ENHANCED\r\n  const facultyPatterns = [\r\n    /FACULTY\\s+OF\\s+([A-Z\\s&,]+?)(?:\\n|EXAMINATION|EXAM|PAPER|COURSE|UNIT|$)/i,\r\n    /SCHOOL\\s+OF\\s+([A-Z\\s&,]+?)(?:\\n|EXAMINATION|EXAM|PAPER|COURSE|UNIT|$)/i,\r\n    /DEPARTMENT\\s+OF\\s+([A-Z\\s&,]+?)(?:\\n|EXAMINATION|EXAM|PAPER|COURSE|UNIT|$)/i,\r\n    /COLLEGE\\s+OF\\s+([A-Z\\s&,]+?)(?:\\n|EXAMINATION|EXAM|PAPER|COURSE|UNIT|$)/i,\r\n    /(?:FACULTY|SCHOOL|DEPARTMENT|COLLEGE):\\s*([A-Z\\s&,]+?)(?:\\n|EXAMINATION|EXAM)/i,\r\n    // Pattern: look for subject/faculty after university name\r\n    /(?:UNIVERSITY.*?\\n)((?:[A-Z][A-Z\\s&,]+?))\\s*(?:EXAMINATION|EXAM|$)/i\r\n  ];\r\n\r\n  for (const pattern of facultyPatterns) {\r\n    const match = text.match(pattern);\r\n    if (match && match[1]) {\r\n      const extracted = match[1].trim();\r\n      // Clean up extracted text - remove common artifacts\r\n      let cleaned = extracted\r\n        .replace(/\\d+/g, '') // Remove numbers\r\n        .replace(/\\s{2,}/g, ' ') // Normalize whitespace\r\n        .trim();\r\n      \r\n      // Only accept if it looks like a faculty name (not too short, not too long)\r\n      if (cleaned.length > 3 && cleaned.length < 100 && !cleaned.match(/^(AND|OR|THE|A|EXAMINATION|EXAM)$/i)) {\r\n        metadata.faculty = cleaned;\r\n        break;\r\n      }\r\n    }\r\n  }\r\n\r\n  // Extract Unit Code (usually 4-6 letters followed by 2-3 digits)\r\n  const codeMatch = text.match(/([A-Z]{2,6}\\s*\\d{3,4})/);\r\n  if (codeMatch) {\r\n    metadata.unitCode = codeMatch[1].replace(/\\s+/g, '');\r\n  }\r\n\r\n  // Extract Unit Name (usually follows the code)\r\n  const nameMatch = text.match(/(?:[A-Z]{2,6}\\s*\\d{3,4})[:\\s]+([A-Z][A-Za-z\\s&,\\-]+?)(?:\\n|EXAMINATION|EXAM|COURSE CODE)/i);\r\n  if (nameMatch) {\r\n    metadata.unitName = nameMatch[1].trim();\r\n  }\r\n\r\n  // Extract Year (4 digits)\r\n  const yearMatch = text.match(/\\b(19|20)\\d{2}\\b/);\r\n  if (yearMatch) {\r\n    metadata.year = parseInt(yearMatch[0]);\r\n  }\r\n\r\n  // Extract Semester\r\n  const semesterMatch = text.match(/SEMESTER\\s*:?\\s*([1-3])/i) || \r\n                        text.match(/FIRST SEMESTER/i) ||\r\n                        text.match(/SECOND SEMESTER/i) ||\r\n                        text.match(/THIRD SEMESTER/i);\r\n  if (semesterMatch) {\r\n    if (semesterMatch[0].includes('FIRST')) metadata.semester = '1';\r\n    else if (semesterMatch[0].includes('SECOND')) metadata.semester = '2';\r\n    else if (semesterMatch[0].includes('THIRD')) metadata.semester = '3';\r\n    else metadata.semester = semesterMatch[1];\r\n  }\r\n\r\n  // Extract Exam Type\r\n  const examTypePatterns = [\r\n    /(?:MAIN|SUPPLEMENTARY|SUPPLEMENTAL|CAT|CONTINUOUS ASSESSMENT|MOCK|MIDTERM)/i\r\n  ];\r\n\r\n  for (const pattern of examTypePatterns) {\r\n    const match = text.match(pattern);\r\n    if (match) {\r\n      const typeStr = match[0].toUpperCase();\r\n      if (typeStr.includes('MAIN')) metadata.examType = 'Main';\r\n      else if (typeStr.includes('SUPPLEMENTARY') || typeStr.includes('SUPPLEMENTAL')) metadata.examType = 'Supplementary';\r\n      else if (typeStr.includes('CAT') || typeStr.includes('CONTINUOUS')) metadata.examType = 'CAT';\r\n      else if (typeStr.includes('MOCK')) metadata.examType = 'Mock';\r\n      break;\r\n    }\r\n  }\r\n\r\n  // Fall back to filename if extraction failed\r\n  if (!metadata.unitCode || !metadata.year) {\r\n    const fallback = parseMetadataFromFilename(filename);\r\n    metadata.unitCode = metadata.unitCode || fallback.unitCode;\r\n    metadata.unitName = metadata.unitName || fallback.unitName;\r\n    metadata.year = metadata.year || fallback.year;\r\n    metadata.semester = metadata.semester || fallback.semester;\r\n    metadata.examType = metadata.examType || fallback.examType;\r\n  }\r\n\r\n  return metadata;\r\n}\r\n\r\n/**\r\n * Parse metadata from filename\r\n * Format: UNITCODE_UnitName_2023_1_Main.pdf\r\n */\r\nfunction parseMetadataFromFilename(filename) {\r\n  const metadata = {\r\n    university: null,\r\n    faculty: null,\r\n    unitCode: null,\r\n    unitName: null,\r\n    year: null,\r\n    semester: null,\r\n    examType: null,\r\n    source: 'filename'\r\n  };\r\n\r\n  const fileNameWithoutExt = filename.replace('.pdf', '').replace(/\\.[a-z]+$/i, '');\r\n  const parts = fileNameWithoutExt.split('_');\r\n\r\n  if (parts.length >= 5) {\r\n    metadata.unitCode = parts[0] || null;\r\n    metadata.unitName = parts[1] || null;\r\n    metadata.year = parts[2] ? parseInt(parts[2]) : null;\r\n    metadata.semester = parts[3] || null;\r\n    metadata.examType = parts[4] || 'Main';\r\n  }\r\n\r\n  return metadata;\r\n}\r\n\r\n/**\r\n * Find matching university by name (fuzzy match)\r\n * @param {string} extractedUniversity - Extracted university name\r\n * @param {Array} universities - List of available universities [{id, name}, ...]\r\n * @returns {string|null} - Matched university ID or null\r\n */\r\nexport function findMatchingUniversity(extractedUniversity, universities) {\r\n  if (!extractedUniversity || !universities.length) return null;\r\n\r\n  const extracted = extractedUniversity.toUpperCase().trim();\r\n  \r\n  // Exact or substring match\r\n  for (const uni of universities) {\r\n    const uniName = uni.name.toUpperCase();\r\n    if (uniName.includes(extracted) || extracted.includes(uniName)) {\r\n      return uni.id;\r\n    }\r\n  }\r\n\r\n  // Fuzzy match - count matching words\r\n  const extractedWords = extracted.split(/\\s+/);\r\n  let bestMatch = null;\r\n  let bestScore = 0;\r\n\r\n  for (const uni of universities) {\r\n    const uniWords = uni.name.toUpperCase().split(/\\s+/);\r\n    let matchCount = 0;\r\n    \r\n    for (const word of extractedWords) {\r\n      if (uniWords.some(w => w.includes(word) || word.includes(w))) {\r\n        matchCount++;\r\n      }\r\n    }\r\n\r\n    const score = matchCount / Math.max(extractedWords.length, uniWords.length);\r\n    if (score > bestScore && score > 0.6) {\r\n      bestScore = score;\r\n      bestMatch = uni.id;\r\n    }\r\n  }\r\n\r\n  return bestMatch;\r\n}\r\n\r\n/**\r\n * Find matching faculty by name\r\n * @param {string} extractedFaculty - Extracted faculty name\r\n * @param {Array} faculties - List of available faculties [string, ...]\r\n * @returns {string|null} - Matched faculty or null\r\n */\r\nexport function findMatchingFaculty(extractedFaculty, faculties) {\r\n  if (!extractedFaculty || !faculties.length) return null;\r\n\r\n  const extracted = extractedFaculty.toUpperCase().trim();\r\n\r\n  // Exact or substring match\r\n  for (const fac of faculties) {\r\n    const facName = fac.toUpperCase();\r\n    if (facName.includes(extracted) || extracted.includes(facName)) {\r\n      return fac;\r\n    }\r\n  }\r\n\r\n  // Fuzzy match\r\n  const extractedWords = extracted.split(/\\s+/);\r\n  let bestMatch = null;\r\n  let bestScore = 0;\r\n\r\n  for (const fac of faculties) {\r\n    const facWords = fac.toUpperCase().split(/\\s+/);\r\n    let matchCount = 0;\r\n    \r\n    for (const word of extractedWords) {\r\n      if (facWords.some(w => w.includes(word) || word.includes(w))) {\r\n        matchCount++;\r\n      }\r\n    }\r\n\r\n    const score = matchCount / Math.max(extractedWords.length, facWords.length);\r\n    if (score > bestScore && score > 0.6) {\r\n      bestScore = score;\r\n      bestMatch = fac;\r\n    }\r\n  }\r\n\r\n  return bestMatch;\r\n}\r\n\r\n/**\r\n * Intelligently guess faculty/department from unit code\r\n * Common patterns: CHEM→Chemistry, BIO→Biology, MATH→Mathematics, etc.\r\n */\r\nexport function guessFacultyFromUnitCode(unitCode, unitName) {\r\n  if (!unitCode) return null;\r\n  \r\n  const code = (unitCode || '').toUpperCase();\r\n  const name = (unitName || '').toUpperCase();\r\n  \r\n  // Map common unit code prefixes to faculties\r\n  const codeToFaculty = {\r\n    // Sciences\r\n    'CHEM': 'Chemistry',\r\n    'BIO': 'Biology',\r\n    'PHYS': 'Physics',\r\n    'MATH': 'Mathematics',\r\n    'STAT': 'Statistics',\r\n    'GEO': 'Geology',\r\n    'BOT': 'Botany',\r\n    'ZOO': 'Zoology',\r\n    \r\n    // Engineering\r\n    'ENG': 'Engineering',\r\n    'MECH': 'Mechanical Engineering',\r\n    'ELEC': 'Electrical Engineering',\r\n    'CIVI': 'Civil Engineering',\r\n    'COMP': 'Computer Science/Engineering',\r\n    'ICT': 'Information & Communication Technology',\r\n    'IT': 'Information Technology',\r\n    'CS': 'Computer Science',\r\n    'SE': 'Software Engineering',\r\n    \r\n    // Humanities & Social Sciences\r\n    'ENG': 'English',\r\n    'HIST': 'History',\r\n    'GEOG': 'Geography',\r\n    'SOC': 'Sociology',\r\n    'ECON': 'Economics',\r\n    'POLI': 'Political Science',\r\n    'PSYCH': 'Psychology',\r\n    'PHIL': 'Philosophy',\r\n    'LAW': 'Law',\r\n    \r\n    // Business & Management\r\n    'BUS': 'Business',\r\n    'MGMT': 'Management',\r\n    'ACC': 'Accounting',\r\n    'FIN': 'Finance',\r\n    'MARK': 'Marketing',\r\n    'HR': 'Human Resources',\r\n    \r\n    // Healthcare\r\n    'MED': 'Medicine',\r\n    'NURS': 'Nursing',\r\n    'PHARM': 'Pharmacy',\r\n    'DENT': 'Dentistry',\r\n    \r\n    // Agriculture\r\n    'AGR': 'Agriculture',\r\n    'AGBM': 'Agriculture Business Management',\r\n    \r\n    // Education\r\n    'EDU': 'Education',\r\n    'SOCI': 'Education / Sociology'\r\n  };\r\n  \r\n  // Try exact code prefix match\r\n  for (const [prefix, faculty] of Object.entries(codeToFaculty)) {\r\n    if (code.startsWith(prefix)) {\r\n      return faculty;\r\n    }\r\n  }\r\n  \r\n  // Try matching unit name against faculty keywords\r\n  if (name) {\r\n    for (const [prefix, faculty] of Object.entries(codeToFaculty)) {\r\n      if (name.includes(prefix.toUpperCase())) {\r\n        return faculty;\r\n      }\r\n    }\r\n  }\r\n  \r\n  return null;\r\n}\r\n\r\n","import React, { useState, useRef, useEffect } from 'react';\r\nimport { useNavigate } from 'react-router-dom';\r\nimport { FiUpload, FiFolder, FiRefreshCw, FiCheck, FiX, FiAlertCircle, FiFile, FiBook, FiFileText, FiClock } from 'react-icons/fi';\r\nimport { createBook, createBookSubmission, fetchCategories } from '../api';\r\nimport { getUniversitiesForDropdown, getFacultiesByUniversity, createPastPaper, createPastPaperSubmission, searchUnitFaculty, clearPastPapersCache, checkDuplicatePastPaper, logUploadHistory } from '../pastPapersApi';\r\nimport { extractPastPaperMetadata, findMatchingUniversity, findMatchingFaculty, guessFacultyFromUnitCode } from '../utils/extractPastPaperMetadata';\r\nimport * as pdfjsLib from 'pdfjs-dist';\r\nimport { useAdminUI } from '../AdminUIContext';\r\n\r\n// Books Auto Upload Component\r\nconst BooksAutoUploadContent = ({ userProfile, asSubmission, showToast }) => {\r\n  const [selectedFiles, setSelectedFiles] = useState([]);\r\n  const [uploading, setUploading] = useState(false);\r\n  const [uploadProgress, setUploadProgress] = useState({ current: 0, total: 0 });\r\n  const [uploadedCount, setUploadedCount] = useState(0);\r\n  const [failedCount, setFailedCount] = useState(0);\r\n  const [duplicatesCount, setDuplicatesCount] = useState(0);\r\n  const [skippedCount, setSkippedCount] = useState(0);\r\n  const [toast, setToast] = useState(null);\r\n  const [dragOver, setDragOver] = useState(false);\r\n  const [categories, setCategories] = useState([]);\r\n  const folderInputRef = useRef(null);\r\n  const { showToast: uiShowToast } = useAdminUI();\r\n\r\n  useEffect(() => {\r\n    // Configure PDF.js worker\r\n    if (!pdfjsLib.GlobalWorkerOptions.workerSrc) {\r\n      pdfjsLib.GlobalWorkerOptions.workerSrc = `//cdnjs.cloudflare.com/ajax/libs/pdf.js/${pdfjsLib.version}/pdf.worker.min.js`;\r\n    }\r\n    // Fetch categories\r\n    fetchCategories().then(cats => setCategories(cats || []));\r\n  }, []);\r\n\r\n  const internalShowToast = (message, type = 'info') => {\r\n    showToast(message, type);\r\n    setToast({ message, type });\r\n    setTimeout(() => setToast(null), 4000);\r\n  };\r\n\r\n  const extractCoverFromPDF = async (pdfFile) => {\r\n    try {\r\n      const arrayBuffer = await pdfFile.arrayBuffer();\r\n      const pdfDoc = await pdfjsLib.getDocument({ data: arrayBuffer }).promise;\r\n      \r\n      if (pdfDoc.numPages > 0) {\r\n        const page = await pdfDoc.getPage(1);\r\n        const viewport = page.getViewport({ scale: 2 });\r\n        const canvas = document.createElement('canvas');\r\n        canvas.width = viewport.width;\r\n        canvas.height = viewport.height;\r\n        \r\n        const context = canvas.getContext('2d');\r\n        await page.render({ canvasContext: context, viewport }).promise;\r\n        \r\n        return new Promise((resolve) => {\r\n          canvas.toBlob((blob) => {\r\n            if (blob) {\r\n              const coverFile = new File([blob], `${pdfFile.name.replace('.pdf', '')}_cover.png`, { type: 'image/png' });\r\n              resolve(coverFile);\r\n            } else {\r\n              resolve(null);\r\n            }\r\n          }, 'image/png', 0.95);\r\n        });\r\n      }\r\n    } catch (error) {\r\n      console.error('Error extracting cover:', error);\r\n    }\r\n    return null;\r\n  };\r\n\r\n  const extractBasicMetadataFromName = (fileName) => {\r\n    // Try to extract title from filename\r\n    const name = fileName.replace('.pdf', '').trim();\r\n    return {\r\n      title: name.length > 3 ? name : '',\r\n      author: '',\r\n      description: '',\r\n      category_id: null,\r\n      year: null,\r\n      language: 'English',\r\n      isbn: '',\r\n      pages: 0,\r\n      publisher: ''\r\n    };\r\n  };\r\n\r\n  const handleFolderSelect = (event) => {\r\n    const files = Array.from(event.target.files || []);\r\n    const pdfFiles = files.filter(f => f.name.toLowerCase().endsWith('.pdf'));\r\n    \r\n    if (pdfFiles.length === 0) {\r\n      internalShowToast('No PDF files found in selected folder', 'error');\r\n      return;\r\n    }\r\n\r\n    setSelectedFiles(pdfFiles);\r\n    internalShowToast(`Found ${pdfFiles.length} PDF files`, 'success');\r\n  };\r\n\r\n  const handleDragOver = (e) => {\r\n    e.preventDefault();\r\n    e.stopPropagation();\r\n    setDragOver(true);\r\n  };\r\n\r\n  const handleDragLeave = (e) => {\r\n    e.preventDefault();\r\n    e.stopPropagation();\r\n    setDragOver(false);\r\n  };\r\n\r\n  const handleDrop = (e) => {\r\n    e.preventDefault();\r\n    e.stopPropagation();\r\n    setDragOver(false);\r\n\r\n    // Handle dropped files/folders\r\n    const items = e.dataTransfer.items;\r\n    const files = [];\r\n\r\n    if (items) {\r\n      for (let i = 0; i < items.length; i++) {\r\n        const item = items[i];\r\n        if (item.kind === 'file') {\r\n          const file = item.getAsFile();\r\n          if (file.name.toLowerCase().endsWith('.pdf')) {\r\n            files.push(file);\r\n          }\r\n        }\r\n      }\r\n    }\r\n\r\n    if (files.length === 0) {\r\n      internalShowToast('No PDF files found', 'error');\r\n      return;\r\n    }\r\n\r\n    setSelectedFiles(files);\r\n    internalShowToast(`Found ${files.length} PDF files`, 'success');\r\n  };\r\n\r\n  const uploadFiles = async () => {\r\n    if (selectedFiles.length === 0) {\r\n      internalShowToast('No files selected', 'error');\r\n      return;\r\n    }\r\n\r\n    setUploading(true);\r\n    setUploadProgress({ current: 0, total: selectedFiles.length });\r\n    setUploadedCount(0);\r\n    setFailedCount(0);\r\n    setDuplicatesCount(0);\r\n    setSkippedCount(0);\r\n\r\n    let uploaded = 0;\r\n    let failed = 0;\r\n    let duplicates = 0;\r\n    let skipped = 0;\r\n\r\n    for (let i = 0; i < selectedFiles.length; i++) {\r\n      const file = selectedFiles[i];\r\n      setUploadProgress({ current: i + 1, total: selectedFiles.length });\r\n\r\n      try {\r\n        // Extract cover\r\n        const cover = await extractCoverFromPDF(file);\r\n\r\n        // Extract basic metadata from filename\r\n        const metadata = extractBasicMetadataFromName(file.name);\r\n\r\n        // Determine if user is admin\r\n        const isAdmin = userProfile?.role === 'admin' || userProfile?.role === 'editor';\r\n\r\n        // Upload\r\n        if (isAdmin) {\r\n          await createBook({ metadata, pdfFile: file, coverFile: cover });\r\n        } else {\r\n          await createBookSubmission({ metadata, pdfFile: file, coverFile: cover });\r\n        }\r\n\r\n        uploaded++;\r\n        setUploadedCount(uploaded);\r\n      } catch (error) {\r\n        console.error(`Failed to upload ${file.name}:`, error);\r\n        failed++;\r\n        setFailedCount(failed);\r\n      }\r\n    }\r\n\r\n    setUploading(false);\r\n    const message = `Upload complete: ${uploaded} successful, ${failed} failed`;\r\n    internalShowToast(message, failed === 0 ? 'success' : 'info');\r\n    \r\n    // Clear selected files after upload\r\n    setTimeout(() => {\r\n      setSelectedFiles([]);\r\n      setUploadProgress({ current: 0, total: 0 });\r\n    }, 2000);\r\n  };\r\n\r\n  const clearSelection = () => {\r\n    setSelectedFiles([]);\r\n    setUploadProgress({ current: 0, total: 0 });\r\n    setUploadedCount(0);\r\n    setFailedCount(0);\r\n    setDuplicatesCount(0);\r\n    setSkippedCount(0);\r\n    if (folderInputRef.current) {\r\n      folderInputRef.current.value = '';\r\n    }\r\n  };\r\n\r\n  const progressPercent = uploadProgress.total > 0 ? (uploadProgress.current / uploadProgress.total) * 100 : 0;\r\n  const totalSize = selectedFiles.reduce((sum, f) => sum + f.size, 0) / 1024 / 1024;\r\n\r\n  return (\r\n    <div className=\"panel\">\r\n      {/* Header */}\r\n      <div style={{ marginBottom: '20px' }}>\r\n        <h2 style={{ color: '#e9edef', fontSize: '20px', fontWeight: '600', margin: '0 0 8px 0' }}>\r\n          Bulk Upload from Folder\r\n        </h2>\r\n        <p style={{ color: '#8696a0', fontSize: '13px', margin: '0' }}>\r\n          Select a folder to upload multiple PDF files at once\r\n        </p>\r\n      </div>\r\n\r\n      {asSubmission && (\r\n        <div style={{\r\n          marginBottom: '15px',\r\n          padding: '10px 12px',\r\n          background: '#1f2c33',\r\n          border: '1px solid #00a884',\r\n          borderRadius: '6px',\r\n          color: '#00a884',\r\n          fontSize: '12px'\r\n        }}>\r\n          📋 Your uploads will be reviewed and appear after approval\r\n        </div>\r\n      )}\r\n\r\n      {/* Main Content */}\r\n      {selectedFiles.length === 0 ? (\r\n        // Upload Area\r\n        <div\r\n          onDragOver={handleDragOver}\r\n          onDragLeave={handleDragLeave}\r\n          onDrop={handleDrop}\r\n          onClick={() => folderInputRef.current?.click()}\r\n          style={{\r\n            border: `2px dashed ${dragOver ? '#00a884' : '#374151'}`,\r\n            borderRadius: '8px',\r\n            padding: '40px 20px',\r\n            textAlign: 'center',\r\n            cursor: 'pointer',\r\n            background: dragOver ? 'rgba(0, 168, 132, 0.08)' : '#0b141a',\r\n            transition: 'all 0.2s'\r\n          }}\r\n        >\r\n          <FiFolder size={40} style={{ color: '#00a884', marginBottom: '12px' }} />\r\n          <h3 style={{ color: '#e9edef', fontSize: '16px', fontWeight: '500', margin: '0 0 4px 0' }}>\r\n            Select Folder or Drag & Drop\r\n          </h3>\r\n          <p style={{ color: '#8696a0', fontSize: '13px', margin: '0' }}>\r\n            Choose a folder with PDF files\r\n          </p>\r\n          <input\r\n            ref={folderInputRef}\r\n            type=\"file\"\r\n            webkitdirectory=\"true\"\r\n            directory=\"\"\r\n            multiple\r\n            onChange={handleFolderSelect}\r\n            style={{ display: 'none' }}\r\n            accept=\".pdf\"\r\n          />\r\n        </div>\r\n      ) : (\r\n        <>\r\n          {/* File List */}\r\n          <div style={{\r\n            background: '#0b141a',\r\n            border: '1px solid #1f2c33',\r\n            borderRadius: '8px',\r\n            marginBottom: '20px',\r\n            overflow: 'hidden'\r\n          }}>\r\n            <div style={{\r\n              padding: '12px 16px',\r\n              borderBottom: '1px solid #1f2c33',\r\n              background: '#0b141a'\r\n            }}>\r\n              <div style={{ color: '#e9edef', fontSize: '13px', fontWeight: '500' }}>\r\n                Files ({selectedFiles.length}) • {totalSize.toFixed(1)} MB\r\n              </div>\r\n            </div>\r\n\r\n            <div style={{\r\n              maxHeight: '250px',\r\n              overflowY: 'auto'\r\n            }}>\r\n              {selectedFiles.map((file, idx) => (\r\n                <div\r\n                  key={idx}\r\n                  style={{\r\n                    display: 'flex',\r\n                    alignItems: 'center',\r\n                    gap: '10px',\r\n                    padding: '10px 16px',\r\n                    borderBottom: idx < selectedFiles.length - 1 ? '1px solid #1f2c33' : 'none',\r\n                    color: '#8696a0',\r\n                    fontSize: '12px'\r\n                  }}\r\n                >\r\n                  <FiFile size={14} style={{ color: '#00a884', flexShrink: 0 }} />\r\n                  <span style={{ flex: 1, overflow: 'hidden', textOverflow: 'ellipsis', whiteSpace: 'nowrap' }}>\r\n                    {file.name}\r\n                  </span>\r\n                  <span style={{ color: '#8696a0', fontSize: '11px', flexShrink: 0 }}>\r\n                    {(file.size / 1024 / 1024).toFixed(1)} MB\r\n                  </span>\r\n                </div>\r\n              ))}\r\n            </div>\r\n          </div>\r\n\r\n          {/* Progress */}\r\n          {uploading && (\r\n            <div style={{ marginBottom: '20px' }}>\r\n              <div style={{\r\n                display: 'flex',\r\n                justifyContent: 'space-between',\r\n                marginBottom: '8px',\r\n                color: '#8696a0',\r\n                fontSize: '12px'\r\n              }}>\r\n                <span>Progress: {uploadProgress.current} / {uploadProgress.total}</span>\r\n                <span>✓ {uploadedCount} | ⏭️ {duplicatesCount} | ✗ {failedCount}</span>\r\n              </div>\r\n              <div style={{\r\n                width: '100%',\r\n                height: '6px',\r\n                background: '#1f2c33',\r\n                borderRadius: '3px',\r\n                overflow: 'hidden'\r\n              }}>\r\n                <div style={{\r\n                  width: `${progressPercent}%`,\r\n                  height: '100%',\r\n                  background: '#00a884',\r\n                  transition: 'width 0.3s'\r\n                }} />\r\n              </div>\r\n            </div>\r\n          )}\r\n\r\n          {/* Action Buttons */}\r\n          <div style={{ display: 'flex', gap: '10px' }}>\r\n            <button\r\n              onClick={uploadFiles}\r\n              disabled={uploading}\r\n              style={{\r\n                flex: 1,\r\n                padding: '10px 16px',\r\n                background: uploading ? '#00a88466' : '#00a884',\r\n                color: '#fff',\r\n                border: 'none',\r\n                borderRadius: '6px',\r\n                fontSize: '13px',\r\n                fontWeight: '500',\r\n                cursor: uploading ? 'not-allowed' : 'pointer',\r\n                display: 'flex',\r\n                alignItems: 'center',\r\n                justifyContent: 'center',\r\n                gap: '8px',\r\n                opacity: uploading ? 0.6 : 1\r\n              }}\r\n            >\r\n              {uploading ? (\r\n                <>\r\n                  <FiRefreshCw style={{ animation: 'spin 1s linear infinite' }} />\r\n                  Uploading...\r\n                </>\r\n              ) : (\r\n                <>\r\n                  <FiUpload size={14} />\r\n                  Upload {selectedFiles.length} File{selectedFiles.length !== 1 ? 's' : ''}\r\n                </>\r\n              )}\r\n            </button>\r\n            <button\r\n              onClick={clearSelection}\r\n              disabled={uploading}\r\n              style={{\r\n                padding: '10px 16px',\r\n                background: '#1f2c33',\r\n                color: '#8696a0',\r\n                border: '1px solid #374151',\r\n                borderRadius: '6px',\r\n                fontSize: '13px',\r\n                fontWeight: '500',\r\n                cursor: uploading ? 'not-allowed' : 'pointer',\r\n                display: 'flex',\r\n                alignItems: 'center',\r\n                gap: '6px',\r\n                opacity: uploading ? 0.5 : 1\r\n              }}\r\n            >\r\n              <FiX size={14} />\r\n              Clear\r\n            </button>\r\n          </div>\r\n        </>\r\n      )}\r\n\r\n      {/* Results */}\r\n      {(uploadedCount > 0 || duplicatesCount > 0 || failedCount > 0) && !uploading && (\r\n        <div style={{\r\n          marginTop: '20px',\r\n          padding: '16px',\r\n          background: '#0b141a',\r\n          border: `1px solid ${failedCount === 0 ? '#00a884' : '#f1b233'}`,\r\n          borderRadius: '8px'\r\n        }}>\r\n          <div style={{ color: '#e9edef', fontSize: '13px', fontWeight: '500', marginBottom: '12px' }}>\r\n            Upload Complete\r\n          </div>\r\n          <div style={{ display: 'flex', gap: '16px' }}>\r\n            <div style={{ textAlign: 'center' }}>\r\n              <div style={{ color: '#00a884', fontSize: '20px', fontWeight: '600', marginBottom: '2px' }}>\r\n                {uploadedCount}\r\n              </div>\r\n              <div style={{ color: '#8696a0', fontSize: '11px' }}>Uploaded</div>\r\n            </div>\r\n            {duplicatesCount > 0 && (\r\n              <div style={{ textAlign: 'center' }}>\r\n                <div style={{ color: '#f1b233', fontSize: '20px', fontWeight: '600', marginBottom: '2px' }}>\r\n                  {duplicatesCount}\r\n                </div>\r\n                <div style={{ color: '#8696a0', fontSize: '11px' }}>Skipped (Duplicates)</div>\r\n              </div>\r\n            )}\r\n            {failedCount > 0 && (\r\n              <div style={{ textAlign: 'center' }}>\r\n                <div style={{ color: '#ea4335', fontSize: '20px', fontWeight: '600', marginBottom: '2px' }}>\r\n                  {failedCount}\r\n                </div>\r\n                <div style={{ color: '#8696a0', fontSize: '11px' }}>Failed</div>\r\n              </div>\r\n            )}\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      {/* Toast */}\r\n      {toast && (\r\n        <div style={{\r\n          position: 'fixed',\r\n          bottom: '20px',\r\n          right: '20px',\r\n          maxWidth: '300px',\r\n          width: 'calc(100% - 40px)',\r\n          background: toast.type === 'error' ? '#ea4335' : toast.type === 'success' ? '#00a884' : '#374151',\r\n          color: '#fff',\r\n          padding: '12px 16px',\r\n          borderRadius: '6px',\r\n          zIndex: 10000,\r\n          boxShadow: '0 4px 12px rgba(0, 0, 0, 0.3)',\r\n          display: 'flex',\r\n          alignItems: 'center',\r\n          gap: '8px',\r\n          fontSize: '13px',\r\n          animation: 'slideIn 0.3s ease'\r\n        }}>\r\n          {toast.type === 'success' ? '✓' : toast.type === 'error' ? '✗' : 'ℹ'} {toast.message}\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\n// Past Papers Auto Upload Component\r\nconst PastPapersAutoUploadContent = ({ userProfile, asSubmission, showToast }) => {\r\n  const [selectedFiles, setSelectedFiles] = useState([]);\r\n  const [dragOver, setDragOver] = useState(false);\r\n  const [uploading, setUploading] = useState(false);\r\n  const [uploadProgress, setUploadProgress] = useState({ current: 0, total: 0 });\r\n  const [uploadedCount, setUploadedCount] = useState(0);\r\n  const [failedCount, setFailedCount] = useState(0);\r\n  const [duplicatesCount, setDuplicatesCount] = useState(0);\r\n  const [university, setUniversity] = useState('');\r\n  const [faculty, setFaculty] = useState('');\r\n  const [universities, setUniversities] = useState([]);\r\n  const [faculties, setFaculties] = useState([]);\r\n  const [showOverride, setShowOverride] = useState(false);\r\n  const [extractedMetadata, setExtractedMetadata] = useState(null);\r\n  const folderInputRef = useRef(null);\r\n\r\n  const internalShowToast = (message, type = 'info') => {\r\n    showToast(message, type);\r\n  };\r\n\r\n  // Load universities on mount\r\n  useEffect(() => {\r\n    const loadUniversities = async () => {\r\n      try {\r\n        console.log('🔄 Loading universities...');\r\n        const unis = await getUniversitiesForDropdown();\r\n        console.log('✅ Universities loaded:', unis);\r\n        setUniversities(unis);\r\n      } catch (error) {\r\n        console.error('❌ Failed to load universities:', error);\r\n      }\r\n    };\r\n    loadUniversities();\r\n  }, []);\r\n\r\n  // Load faculties when university changes\r\n  useEffect(() => {\r\n    const loadFaculties = async () => {\r\n      if (!university) {\r\n        setFaculties([]);\r\n        setFaculty('');\r\n        return;\r\n      }\r\n      try {\r\n        const facs = await getFacultiesByUniversity(university);\r\n        setFaculties(facs);\r\n        \r\n        // If we have extracted faculty, try to match it\r\n        if (extractedMetadata?.faculty && facs.length > 0) {\r\n          const matchedFaculty = findMatchingFaculty(extractedMetadata.faculty, facs);\r\n          if (matchedFaculty) {\r\n            setFaculty(matchedFaculty);\r\n            internalShowToast(`✓ Auto-filled: University & Faculty detected from PDF`, 'success');\r\n          }\r\n        }\r\n      } catch (error) {\r\n        console.error('Failed to load faculties:', error);\r\n        setFaculties([]);\r\n      }\r\n    };\r\n    loadFaculties();\r\n  }, [university, extractedMetadata?.faculty]);\r\n\r\n  // Auto-extract metadata from PDF and filename\r\n  const autoExtractMetadata = async (pdfFile, unisList = null) => {\r\n    try {\r\n      console.log('🔄 Extracting metadata from PDF:', pdfFile.name);\r\n      const pdfMetadata = await extractPastPaperMetadata(pdfFile);\r\n      setExtractedMetadata(pdfMetadata);\r\n      \r\n      console.log('📄 Extracted from PDF:', pdfMetadata);\r\n\r\n      // Use provided universities list or fallback to state\r\n      const unis = unisList || universities;\r\n      \r\n      // Try to match university from PDF\r\n      let matchedUniversityId = null;\r\n      if (pdfMetadata.university && unis.length > 0) {\r\n        console.log('🔍 Attempting to match university:', pdfMetadata.university);\r\n        matchedUniversityId = findMatchingUniversity(pdfMetadata.university, unis);\r\n        console.log('✅ Matched university ID:', matchedUniversityId);\r\n        \r\n        if (matchedUniversityId) {\r\n          setUniversity(matchedUniversityId);\r\n        }\r\n      }\r\n\r\n      // Try to match faculty if we found a university\r\n      if (matchedUniversityId && pdfMetadata.faculty) {\r\n        console.log('🔍 Attempting to match faculty:', pdfMetadata.faculty);\r\n        try {\r\n          const facs = await getFacultiesByUniversity(matchedUniversityId);\r\n          if (facs.length > 0) {\r\n            const matchedFaculty = findMatchingFaculty(pdfMetadata.faculty, facs);\r\n            if (matchedFaculty) {\r\n              setFaculty(matchedFaculty);\r\n              console.log('✅ Matched faculty:', matchedFaculty);\r\n            }\r\n          }\r\n        } catch (error) {\r\n          console.warn('⚠️ Could not fetch faculties:', error);\r\n        }\r\n      }\r\n\r\n      // Show success message regardless of extraction result\r\n      internalShowToast('✅ Metadata extracted - ready to upload', 'success');\r\n    } catch (error) {\r\n      console.error('⚠️ Extraction error:', error);\r\n      // Don't fail - allow upload with filename extraction\r\n      internalShowToast('✅ Ready to upload (using filename extraction)', 'success');\r\n    }\r\n  };\r\n\r\n  const handleFolderSelect = (event) => {\r\n    const files = Array.from(event.target.files || []);\r\n    const pdfFiles = files.filter(f => f.name.toLowerCase().endsWith('.pdf'));\r\n    \r\n    if (pdfFiles.length === 0) {\r\n      internalShowToast('No PDF files found in selected folder', 'error');\r\n      return;\r\n    }\r\n\r\n    setSelectedFiles(pdfFiles);\r\n    internalShowToast(`Found ${pdfFiles.length} PDF files`, 'success');\r\n    setShowOverride(false);\r\n    \r\n    // Ensure universities are loaded before extracting\r\n    const performExtraction = async () => {\r\n      let unis = universities;\r\n      \r\n      // If universities not yet loaded, wait and load them\r\n      if (!unis || unis.length === 0) {\r\n        console.log('⏳ Universities not loaded yet, loading now...');\r\n        try {\r\n          unis = await getUniversitiesForDropdown({ forceRefresh: true });\r\n          console.log('✅ Universities loaded during extraction:', unis);\r\n          setUniversities(unis);\r\n        } catch (error) {\r\n          console.error('❌ Failed to load universities during extraction:', error);\r\n          internalShowToast('Failed to load universities - please try again', 'error');\r\n          return;\r\n        }\r\n      }\r\n      \r\n      // Now extract with loaded universities\r\n      autoExtractMetadata(pdfFiles[0], unis);\r\n    };\r\n    \r\n    performExtraction();\r\n  };\r\n\r\n  const handleDragOver = (e) => {\r\n    e.preventDefault();\r\n    e.stopPropagation();\r\n    setDragOver(true);\r\n  };\r\n\r\n  const handleDragLeave = (e) => {\r\n    e.preventDefault();\r\n    e.stopPropagation();\r\n    setDragOver(false);\r\n  };\r\n\r\n  const handleDrop = (e) => {\r\n    e.preventDefault();\r\n    e.stopPropagation();\r\n    setDragOver(false);\r\n\r\n    const items = e.dataTransfer.items;\r\n    const files = [];\r\n\r\n    if (items) {\r\n      for (let i = 0; i < items.length; i++) {\r\n        const item = items[i];\r\n        if (item.kind === 'file') {\r\n          const file = item.getAsFile();\r\n          if (file.name.toLowerCase().endsWith('.pdf')) {\r\n            files.push(file);\r\n          }\r\n        }\r\n      }\r\n    }\r\n\r\n    if (files.length === 0) {\r\n      internalShowToast('No PDF files found', 'error');\r\n      return;\r\n    }\r\n\r\n    setSelectedFiles(files);\r\n    internalShowToast(`Found ${files.length} PDF files`, 'success');\r\n    setShowOverride(false);\r\n    \r\n    // Ensure universities are loaded before extracting\r\n    const performExtraction = async () => {\r\n      let unis = universities;\r\n      \r\n      // If universities not yet loaded, wait and load them\r\n      if (!unis || unis.length === 0) {\r\n        console.log('⏳ Universities not loaded yet, loading now...');\r\n        try {\r\n          unis = await getUniversitiesForDropdown({ forceRefresh: true });\r\n          console.log('✅ Universities loaded during extraction:', unis);\r\n          setUniversities(unis);\r\n        } catch (error) {\r\n          console.error('❌ Failed to load universities during extraction:', error);\r\n          internalShowToast('Failed to load universities - please try again', 'error');\r\n          return;\r\n        }\r\n      }\r\n      \r\n      // Now extract with loaded universities\r\n      autoExtractMetadata(files[0], unis);\r\n    };\r\n    \r\n    performExtraction();\r\n  };\r\n\r\n  const uploadFiles = async () => {\r\n    if (selectedFiles.length === 0) {\r\n      internalShowToast('No files selected', 'error');\r\n      return;\r\n    }\r\n\r\n    setUploading(true);\r\n    setUploadProgress({ current: 0, total: selectedFiles.length });\r\n    setUploadedCount(0);\r\n    setFailedCount(0);\r\n    setDuplicatesCount(0);\r\n\r\n    let uploaded = 0;\r\n    let failed = 0;\r\n    let duplicates = 0;\r\n\r\n    for (let i = 0; i < selectedFiles.length; i++) {\r\n      const file = selectedFiles[i];\r\n      setUploadProgress({ current: i + 1, total: selectedFiles.length });\r\n      \r\n      let metadata = null; // Declare here so it's accessible in catch block\r\n\r\n      try {\r\n        // Extract metadata from filename\r\n        // Expected formats:\r\n        // 1. UNITCODE_UnitName_2023_1_Main.pdf (underscore-separated)\r\n        // 2. CODE NUMBER MONTH YEAR.pdf (space-separated) e.g., \"CHEM 212 JUNE 2019.pdf\"\r\n        const fileNameWithoutExt = file.name.replace('.pdf', '').trim();\r\n        \r\n        // Try underscore-separated format first\r\n        let parts = fileNameWithoutExt.split('_');\r\n        let unit_code = '';\r\n        let unit_name = '';\r\n        let year = '';\r\n        let semester = '';\r\n        let exam_type = '';\r\n        \r\n        console.log('📋 Parsing filename:', fileNameWithoutExt, 'Parts:', parts, 'Parts length:', parts.length);\r\n        \r\n        if (parts.length >= 2) {\r\n          // Standard format: CODE_Name_Year_Sem_Type\r\n          unit_code = parts[0] || '';\r\n          unit_name = parts[1] || '';\r\n          year = parts[2] || '';\r\n          semester = parts[3] || '';\r\n          exam_type = parts[4] || '';\r\n          console.log('✅ Using underscore format - code:', unit_code, 'name:', unit_name, 'year:', year);\r\n        } else {\r\n          // Fallback: try to extract from space-separated filename: \"CODE NUMBER MONTH YEAR\" or \"PREFIX CODE NUMBER MONTH YEAR\"\r\n          console.log('🔄 Trying space-separated parsing...');\r\n          try {\r\n            // Extract year first (most reliable) - look for 4-digit year\r\n            const yearMatch = fileNameWithoutExt.match(/\\b(19|20)\\d{2}\\b/);\r\n            year = yearMatch ? yearMatch[0] : '';\r\n            console.log('📅 Extracted year:', year);\r\n            \r\n            // Try to extract course code and numbers (handles DIP EDFO 0112, AGBM 0220, SOCI 104, etc.)\r\n            // Matches: \"DIP EDFO 0112\", \"AGBM 0220\", \"SOCI 104\", \"CODE123\", etc.\r\n            \r\n            // First, try pattern with potential prefix: \"WORD WORD DIGITS\" or \"WORD DIGITS\"\r\n            let codeMatch = fileNameWithoutExt.match(/\\b([A-Z]{2,4})\\s+(\\d{3,4})\\b/i);\r\n            \r\n            if (codeMatch) {\r\n              // Found single code with numbers: \"EDFO 0112\"\r\n              const letters = codeMatch[1];\r\n              const numbers = codeMatch[2];\r\n              \r\n              unit_name = letters;\r\n              unit_code = numbers;\r\n              console.log('🔤 Extracted - Name:', unit_name, 'Code:', unit_code, 'from:', codeMatch[0]);\r\n            } else {\r\n              // Try pattern with prefix: \"DIP EDFO\" where EDFO is the real code\r\n              codeMatch = fileNameWithoutExt.match(/\\b([A-Z]{3})\\s+([A-Z]{2,4})\\s+(\\d{3,4})\\b/i);\r\n              if (codeMatch) {\r\n                // codeMatch[1] = prefix (e.g., \"DIP\")\r\n                // codeMatch[2] = unit code letters (e.g., \"EDFO\")\r\n                // codeMatch[3] = unit code numbers (e.g., \"0112\")\r\n                const letters = codeMatch[2];\r\n                const numbers = codeMatch[3];\r\n                \r\n                unit_name = letters;\r\n                unit_code = numbers;\r\n                console.log('🔤 Extracted with prefix - Prefix:', codeMatch[1], 'Name:', unit_name, 'Code:', unit_code, 'from:', codeMatch[0]);\r\n              } else {\r\n                // Last resort: just use the whole filename\r\n                unit_name = fileNameWithoutExt;\r\n                console.log('⚠️ Could not extract code, using filename as name:', unit_name);\r\n              }\r\n            }\r\n          } catch (e) {\r\n            console.warn('⚠️ Error parsing filename:', e);\r\n            unit_name = fileNameWithoutExt;\r\n          }\r\n        }\r\n        \r\n        console.log('📊 Final parsed metadata:', { unit_code, unit_name, year, semester, exam_type });\r\n        \r\n        // EGERTON UNIVERSITY AUTO-DETECTION FOR PAPERS\r\n        // If we have Egerton unit codes, automatically set Egerton University\r\n        let selectedUniversity = university || null;\r\n        \r\n        // If no university selected, try to detect from unit code pattern\r\n        if (!selectedUniversity) {\r\n          // Check if this looks like an Egerton unit code\r\n          const egerton_codes = new Set([\r\n            'AGEC', 'AGBM', 'ANSC', 'APHY', 'CROP', 'HORT', 'SOIL', 'LPBP', 'DAIR', 'FOST', 'AENG', 'ENTM', 'AGRI',\r\n            'ECON', 'BECO', 'STAT', 'LITL', 'ENGL', 'KISW', 'LINS', 'FREN', 'GERM', 'CRSS', 'SOCI', 'PSCS', 'PHIL', 'HIST', 'RELI', 'ANTH', 'LIBS', 'COMM',\r\n            'BACT', 'BFIN', 'BOPM', 'BBIS', 'BMGT', 'BBAM', 'BCOM', 'PROC', 'ENTR', 'HRM', 'MARK',\r\n            'AGED', 'ACDS', 'ADSN', 'CDEV', 'CIEM', 'BUST', 'EPSC', 'EDFO', 'EDUC', 'MENT', 'PSYC', 'GUID', 'COUN', 'ECD', 'SPEC',\r\n            'AGEN', 'CEEN', 'ECEN', 'IEEN', 'MEEN', 'WREN', 'BENG', 'CENG', 'SENG', 'EENG', 'PENG', 'TENG', 'MENG', 'COMP', 'ICT', 'CSCI', 'DATA', 'SOFT', 'NETS',\r\n            'ENVS', 'GEOG', 'NRES', 'FRST', 'DRLM', 'WILD', 'ECOT', 'WEM', 'LAND', 'ENVI', 'ENMS', 'CLEE', 'WRES', 'FRES', 'SWCO', 'CONS', 'NARE',\r\n            'ANAT', 'PHYS', 'PATH', 'NURS', 'NUTR', 'COMH', 'REPH', 'PEDI', 'IMED', 'SURG', 'CLIN', 'EPID', 'MICB', 'MED', 'MEDS', 'PHAR', 'PHARM', 'CHEM', 'DENT', 'DRES', 'PUHE',\r\n            'LAW', 'LLB', 'CLAW', 'PLAW', 'ILWA', 'LAWI', 'LAWS',\r\n            'BIOL', 'ZOO', 'BOT', 'BCMB', 'ORGA', 'INOR', 'PHCH', 'MECH', 'ELEC', 'OPTI', 'BIO', 'ZOOL', 'ECOL', 'GENT', 'ALGE', 'CALC', 'GEOL', 'MING', 'GEOM',\r\n            'VAPH', 'VMTP', 'VPMP', 'VETA', 'PARA', 'ANAV', 'VMED', 'VETS', 'VSUR', 'DVSO', 'VPAT', 'VPHE', 'DVET', 'VANA', 'VPHY'\r\n          ]);\r\n          \r\n          const unitPrefix = unit_name.replace(/\\d+/g, '').toUpperCase().trim();\r\n          if (egerton_codes.has(unitPrefix)) {\r\n            console.log('✅ Detected Egerton University from unit code:', unitPrefix);\r\n            // Find Egerton University ID in the universities list\r\n            const egerton = universities.find(u => u.name?.toLowerCase().includes('egerton'));\r\n            if (egerton) {\r\n              selectedUniversity = egerton.id;\r\n              console.log('✅ Auto-set Egerton University ID:', selectedUniversity);\r\n            }\r\n          }\r\n        }\r\n        \r\n        // Fallback: try extracted metadata university\r\n        if (!selectedUniversity && extractedMetadata?.university) {\r\n          selectedUniversity = findMatchingUniversity(extractedMetadata.university, universities);\r\n          if (selectedUniversity) {\r\n            console.log('✅ Using extracted university:', selectedUniversity);\r\n          }\r\n        }\r\n        \r\n        // Egerton-specific unit code to faculty mapping\r\n        // ======================================================\r\n        // EGERTON UNIVERSITY 2026 - VERIFIED UNIT CODES\r\n        // 161 Verified Codes Across 10 Faculties\r\n        // ======================================================\r\n        const egerton_unit_mapping = {\r\n          // ========== 1. FACULTY OF AGRICULTURE (FoA) - 13 codes ==========\r\n          'AGEC': 'Agriculture', 'AGBM': 'Agriculture',\r\n          'ANSC': 'Agriculture', 'APHY': 'Agriculture',\r\n          'CROP': 'Agriculture', 'HORT': 'Agriculture',\r\n          'SOIL': 'Agriculture', 'LPBP': 'Agriculture',\r\n          'DAIR': 'Agriculture', 'FOST': 'Agriculture',\r\n          'AENG': 'Agriculture', 'ENTM': 'Agriculture',\r\n          'AGRI': 'Agriculture',\r\n          \r\n          // ========== 2. FACULTY OF ARTS & SOCIAL SCIENCES (FASS) - 18 codes ==========\r\n          'ECON': 'FASS', 'BECO': 'FASS',\r\n          'STAT': 'FASS', 'LITL': 'FASS',\r\n          'ENGL': 'FASS', 'KISW': 'FASS',\r\n          'LINS': 'FASS', 'FREN': 'FASS',\r\n          'GERM': 'FASS', 'CRSS': 'FASS',\r\n          'SOCI': 'FASS', 'PSCS': 'FASS',\r\n          'PHIL': 'FASS', 'HIST': 'FASS',\r\n          'RELI': 'FASS', 'ANTH': 'FASS',\r\n          'LIBS': 'FASS', 'COMM': 'FASS',\r\n          \r\n          // ========== 3. FACULTY OF COMMERCE (FoC) - 11 codes ==========\r\n          'BACT': 'Commerce', 'BFIN': 'Commerce',\r\n          'BOPM': 'Commerce', 'BBIS': 'Commerce',\r\n          'BMGT': 'Commerce', 'BBAM': 'Commerce',\r\n          'BCOM': 'Commerce', 'PROC': 'Commerce',\r\n          'ENTR': 'Commerce', 'HRM': 'Commerce',\r\n          'MARK': 'Commerce',\r\n          \r\n          // ========== 4. FACULTY OF EDUCATION & COMMUNITY DEVELOPMENT STUDIES (FEDCOS) - 15 codes ==========\r\n          'AGED': 'FEDCOS',\r\n          'ACDS': 'FEDCOS',\r\n          'ADSN': 'FEDCOS',\r\n          'CDEV': 'FEDCOS',\r\n          'CIEM': 'FEDCOS',\r\n          'BUST': 'FEDCOS',\r\n          'EPSC': 'FEDCOS',\r\n          'EDFO': 'FEDCOS',\r\n          'EDUC': 'FEDCOS',\r\n          'MENT': 'FEDCOS',\r\n          'PSYC': 'FEDCOS',\r\n          'GUID': 'FEDCOS',\r\n          'COUN': 'FEDCOS',\r\n          'ECD': 'FEDCOS',\r\n          'SPEC': 'FEDCOS',\r\n          \r\n          // ========== 5. FACULTY OF ENGINEERING & TECHNOLOGY (FET) - 20 codes ==========\r\n          'AGEN': 'FET',\r\n          'CEEN': 'FET',\r\n          'ECEN': 'FET',\r\n          'IEEN': 'FET',\r\n          'MEEN': 'FET',\r\n          'WREN': 'FET',\r\n          'BENG': 'FET',\r\n          'CENG': 'FET',\r\n          'SENG': 'FET',\r\n          'EENG': 'FET',\r\n          'PENG': 'FET',\r\n          'TENG': 'FET',\r\n          'MENG': 'FET',\r\n          'COMP': 'FET',\r\n          'ICT': 'FET',\r\n          'CSCI': 'FET',\r\n          'DATA': 'FET',\r\n          'SOFT': 'FET',\r\n          'NETS': 'FET',\r\n          \r\n          // ========== 6. FACULTY OF ENVIRONMENT & RESOURCES DEVELOPMENT (FERD) - 17 codes ==========\r\n          'ENVS': 'FERD',\r\n          'GEOG': 'FERD',\r\n          'NRES': 'FERD',\r\n          'FRST': 'FERD',\r\n          'DRLM': 'FERD',\r\n          'WILD': 'FERD',\r\n          'ECOT': 'FERD',\r\n          'WEM': 'FERD',\r\n          'LAND': 'FERD',\r\n          'ENVI': 'FERD',\r\n          'ENMS': 'FERD',\r\n          'CLEE': 'FERD',\r\n          'WRES': 'FERD',\r\n          'FRES': 'FERD',\r\n          'SWCO': 'FERD',\r\n          'CONS': 'FERD',\r\n          'NARE': 'FERD',\r\n          \r\n          // ========== 7. FACULTY OF HEALTH SCIENCES (FHS) - 21 codes ==========\r\n          'ANAT': 'Health Sciences', 'PHYS': 'Health Sciences',\r\n          'PATH': 'Health Sciences', 'NURS': 'Health Sciences',\r\n          'NUTR': 'Health Sciences', 'COMH': 'Health Sciences',\r\n          'REPH': 'Health Sciences', 'PEDI': 'Health Sciences',\r\n          'IMED': 'Health Sciences', 'SURG': 'Health Sciences',\r\n          'CLIN': 'Health Sciences', 'EPID': 'Health Sciences',\r\n          'MICB': 'Health Sciences', 'MED': 'Health Sciences',\r\n          'MEDS': 'Health Sciences', 'PHAR': 'Health Sciences',\r\n          'PHARM': 'Health Sciences', 'CHEM': 'Health Sciences',\r\n          'DENT': 'Health Sciences', 'DRES': 'Health Sciences',\r\n          'PUHE': 'Health Sciences',\r\n          \r\n          // ========== 8. FACULTY OF LAW (FoL) - 7 codes ==========\r\n          'LAW': 'Law', 'LLB': 'Law',\r\n          'CLAW': 'Law', 'PLAW': 'Law',\r\n          'ILWA': 'Law', 'LAWI': 'Law',\r\n          'LAWS': 'Law',\r\n          \r\n          // ========== 9. FACULTY OF SCIENCE (FoS) - 25 codes ==========\r\n          'BIOL': 'Science', 'ZOO': 'Science',\r\n          'BOT': 'Science', 'BCMB': 'Science',\r\n          'CHEM': 'Science', 'COMP': 'Science',\r\n          'MATH': 'Science', 'STAT': 'Science',\r\n          'PHYS': 'Science', 'MET': 'Science',\r\n          'ORGA': 'Science', 'INOR': 'Science',\r\n          'PHCH': 'Science', 'MECH': 'Science',\r\n          'ELEC': 'Science', 'OPTI': 'Science',\r\n          'BIO': 'Science', 'ZOOL': 'Science',\r\n          'ECOL': 'Science', 'GENT': 'Science',\r\n          'ALGE': 'Science', 'CALC': 'Science',\r\n          'GEOL': 'Science', 'MING': 'Science',\r\n          'GEOM': 'Science',\r\n          \r\n          // ========== 10. FACULTY OF VETERINARY MEDICINE & SURGERY (FVMS) - 15 codes ==========\r\n          'VAPH': 'Veterinary Medicine and Surgery',\r\n          'VMTP': 'Veterinary Medicine and Surgery',\r\n          'VPMP': 'Veterinary Medicine and Surgery',\r\n          'VETA': 'Veterinary Medicine and Surgery',\r\n          'PARA': 'Veterinary Medicine and Surgery',\r\n          'ANAV': 'Veterinary Medicine and Surgery',\r\n          'VMED': 'Veterinary Medicine and Surgery',\r\n          'VETS': 'Veterinary Medicine and Surgery',\r\n          'VSUR': 'Veterinary Medicine and Surgery',\r\n          'DVSO': 'Veterinary Medicine and Surgery',\r\n          'VPAT': 'Veterinary Medicine and Surgery',\r\n          'VPHE': 'Veterinary Medicine and Surgery',\r\n          'DVET': 'Veterinary Medicine and Surgery',\r\n          'VANA': 'Veterinary Medicine and Surgery',\r\n          'VPHY': 'Veterinary Medicine and Surgery'\r\n        };\r\n\r\n        // EGERTON-ONLY STRICT DETECTION - EXACT MATCH ONLY\r\n        const detectEgertonFaculty = (unitPrefix) => {\r\n          if (!unitPrefix) return null;\r\n          \r\n          // ONLY EXACT MATCH\r\n          const faculty = egerton_unit_mapping[unitPrefix];\r\n          if (faculty) {\r\n            console.log('✅ Egerton verified: \"' + unitPrefix + '\" → ' + faculty);\r\n            return faculty;\r\n          }\r\n          \r\n          console.log('❌ Unknown Egerton unit code: \"' + unitPrefix + '\"');\r\n          return null;\r\n        };\r\n        \r\n        // Faculty priority: extracted > Google Search > Semantic detection > code guessing > 'Unknown'\r\n        let selectedFaculty = faculty || extractedMetadata?.faculty;\r\n        \r\n        // Try Google Search if faculty not found from PDF extraction\r\n        if (!selectedFaculty && selectedUniversity && unit_code) {\r\n          try {\r\n            // Get university name from the universities list\r\n            const universityObj = universities.find(u => u.id === selectedUniversity);\r\n            if (universityObj?.name) {\r\n              console.log('🔍 Searching Google for faculty of', unit_code, 'at', universityObj.name);\r\n              const searchResult = await searchUnitFaculty(universityObj.name, unit_code, unit_name);\r\n              \r\n              if (searchResult?.faculty) {\r\n                selectedFaculty = searchResult.faculty;\r\n                console.log('🌐 Found faculty via Google Search:', selectedFaculty);\r\n              } else {\r\n                console.log('ℹ️ Google Search did not find faculty, trying smart Egerton detection');\r\n              }\r\n            }\r\n          } catch (error) {\r\n            console.warn('⚠️ Google Search failed, trying smart Egerton detection:', error);\r\n          }\r\n        }\r\n        \r\n        // Fallback: Try Egerton strict detection (exact match only)\r\n        if (!selectedFaculty && unit_name) {\r\n          const unitPrefix = unit_name.replace(/\\d+/g, '').toUpperCase().trim();\r\n          selectedFaculty = detectEgertonFaculty(unitPrefix);\r\n          \r\n          if (!selectedFaculty) {\r\n            console.log('⚠️ Egerton strict mode: Unknown unit code \"' + unitPrefix + '\", marking for manual review');\r\n          }\r\n        }\r\n        \r\n        // Fallback: Try to guess faculty from unit code/name\r\n        if (!selectedFaculty && unit_name) {\r\n          selectedFaculty = guessFacultyFromUnitCode(unit_code, unit_name);\r\n          if (selectedFaculty) {\r\n            console.log('🎯 Guessed faculty from unit code:', selectedFaculty);\r\n          }\r\n        }\r\n        \r\n        selectedFaculty = selectedFaculty || 'Unknown';\r\n        \r\n        // CRITICAL: Ensure university_id is NEVER null by defaulting to Egerton if undetected\r\n        let finalUniversity = selectedUniversity;\r\n        if (!finalUniversity && universities.length > 0) {\r\n          // Default to Egerton University if no university detected\r\n          const egerton = universities.find(u => u.name?.toLowerCase().includes('egerton'));\r\n          if (egerton) {\r\n            finalUniversity = egerton.id;\r\n            console.log('⚠️ No university detected, defaulting to Egerton:', egerton.id);\r\n          } else {\r\n            // If Egerton not found, use the first university in the list\r\n            finalUniversity = universities[0]?.id;\r\n            console.log('⚠️ No university detected, using first available:', universities[0]?.name, finalUniversity);\r\n          }\r\n        }\r\n        \r\n        metadata = {\r\n          university_id: finalUniversity || null,\r\n          faculty: selectedFaculty,\r\n          unit_code: unit_code || extractedMetadata?.unitCode || '',\r\n          unit_name: unit_name || extractedMetadata?.unitName || '',\r\n          year: (year && !isNaN(year)) ? Number(year) : (extractedMetadata?.year || new Date().getFullYear()),\r\n          semester: semester || extractedMetadata?.semester || '',\r\n          exam_type: exam_type || extractedMetadata?.examType || 'Main',\r\n          uploaded_by: userProfile?.id || userProfile?.uid || null\r\n        };\r\n\r\n        console.log('📤 Uploading with metadata:', { \r\n          fileName: file.name, \r\n          universityId: metadata.university_id,\r\n          faculty: metadata.faculty,\r\n          unitCode: metadata.unit_code,\r\n          unitName: metadata.unit_name,\r\n          year: metadata.year,\r\n          semester: metadata.semester,\r\n          examType: metadata.exam_type\r\n        });\r\n\r\n        // Use the proper API function instead of direct fetch\r\n        // This ensures data is saved with correct field names to the database\r\n        console.log('📤 Using createPastPaper API to upload:', {\r\n          fileName: file.name,\r\n          metadata: {\r\n            title: `${metadata.unit_code} - ${metadata.unit_name}`,\r\n            university_id: metadata.university_id,\r\n            faculty: metadata.faculty,\r\n            unit_code: metadata.unit_code,\r\n            unit_name: metadata.unit_name,\r\n            year: metadata.year,\r\n            semester: metadata.semester,\r\n            exam_type: metadata.exam_type\r\n          }\r\n        });\r\n\r\n        // CHECK FOR DUPLICATES BEFORE UPLOADING\r\n        console.log('🔍 Checking for duplicate papers...');\r\n        const duplicateCheck = await checkDuplicatePastPaper({\r\n          universityId: metadata.university_id,\r\n          faculty: metadata.faculty,\r\n          unitCode: metadata.unit_code,\r\n          unitName: metadata.unit_name,\r\n          year: metadata.year\r\n        });\r\n\r\n        if (duplicateCheck.exists) {\r\n          console.log('⚠️ DUPLICATE DETECTED - Paper already exists!', duplicateCheck.paper);\r\n          \r\n          // Log duplicate to history\r\n          await logUploadHistory({\r\n            fileName: file.name,\r\n            status: 'duplicate',\r\n            paperTitle: `${metadata.unit_code} - ${metadata.unit_name}`,\r\n            universityId: metadata.university_id,\r\n            faculty: metadata.faculty,\r\n            unitCode: metadata.unit_code,\r\n            unitName: metadata.unit_name,\r\n            year: metadata.year,\r\n            uploadedBy: userProfile?.id,\r\n            isDuplicate: true\r\n          });\r\n          \r\n          duplicates++;\r\n          setDuplicatesCount(duplicates);\r\n          internalShowToast(`⏭️ Skipped \"${file.name}\" - Paper already uploaded (${duplicateCheck.paper.unit_code} ${duplicateCheck.paper.unit_name} ${duplicateCheck.paper.year})`, 'warning');\r\n          continue; // Skip to next file\r\n        }\r\n\r\n        console.log('✅ No duplicate found, proceeding with upload...');\r\n\r\n        const uploadFunction = asSubmission ? createPastPaperSubmission : createPastPaper;\r\n        const pastPaperRecord = await uploadFunction({\r\n          metadata: {\r\n            title: `${metadata.unit_code} - ${metadata.unit_name}`,\r\n            university_id: metadata.university_id,\r\n            faculty: metadata.faculty,\r\n            unit_code: metadata.unit_code,\r\n            unit_name: metadata.unit_name,\r\n            year: metadata.year,\r\n            semester: metadata.semester,\r\n            exam_type: metadata.exam_type\r\n          },\r\n          pdfFile: file\r\n        });\r\n\r\n        console.log(`✅ Uploaded successfully:`, { fileName: file.name, pastPaperId: pastPaperRecord?.id });\r\n\r\n        // Log successful upload to history\r\n        await logUploadHistory({\r\n          fileName: file.name,\r\n          status: 'success',\r\n          paperTitle: `${metadata.unit_code} - ${metadata.unit_name}`,\r\n          universityId: metadata.university_id,\r\n          faculty: metadata.faculty,\r\n          unitCode: metadata.unit_code,\r\n          unitName: metadata.unit_name,\r\n          year: metadata.year,\r\n          uploadedBy: userProfile?.id\r\n        });\r\n\r\n        uploaded++;\r\n        setUploadedCount(uploaded);\r\n        console.log(`✅ Uploaded: ${file.name}`);\r\n        \r\n        // Clear past papers cache so newly uploaded papers appear immediately\r\n        try { clearPastPapersCache(); } catch (e) {}\r\n      } catch (error) {\r\n        console.error(`❌ Failed to upload ${file.name}:`, error);\r\n        console.error('Error details:', { \r\n          message: error?.message, \r\n          code: error?.code,\r\n          stack: error?.stack\r\n        });\r\n\r\n        // Log failed upload to history\r\n        await logUploadHistory({\r\n          fileName: file.name,\r\n          status: 'failed',\r\n          paperTitle: `${metadata.unit_code} - ${metadata.unit_name}`,\r\n          universityId: metadata.university_id,\r\n          faculty: metadata.faculty,\r\n          unitCode: metadata.unit_code,\r\n          unitName: metadata.unit_name,\r\n          year: metadata.year,\r\n          uploadedBy: userProfile?.id,\r\n          errorMessage: error?.message || 'Unknown error'\r\n        }).catch(err => console.error('Failed to log error history:', err));\r\n\r\n        failed++;\r\n        setFailedCount(failed);\r\n      }\r\n    }\r\n\r\n    setUploading(false);\r\n    \r\n    // Final cache clear to ensure all new papers are visible\r\n    try { clearPastPapersCache(); } catch (e) {}\r\n    \r\n    let message = `Upload complete: ${uploaded} successful, ${duplicates} duplicates skipped, ${failed} failed`;\r\n    if (failed > 0) {\r\n      message += ' ❌ Check browser console for error details';\r\n    }\r\n    const messageType = failed === 0 ? 'success' : (duplicates > 0 ? 'warning' : 'error');\r\n    internalShowToast(message, messageType);\r\n    \r\n    setTimeout(() => {\r\n      setSelectedFiles([]);\r\n      setUploadProgress({ current: 0, total: 0 });\r\n      setUniversity('');\r\n      setFaculty('');\r\n      setExtractedMetadata(null);\r\n      setShowOverride(false);\r\n    }, 2000);\r\n  };\r\n\r\n  const clearSelection = () => {\r\n    setSelectedFiles([]);\r\n    setUploadProgress({ current: 0, total: 0 });\r\n    setUploadedCount(0);\r\n    setFailedCount(0);\r\n    setUniversity('');\r\n    setFaculty('');\r\n    setExtractedMetadata(null);\r\n    setShowOverride(false);\r\n    if (folderInputRef.current) {\r\n      folderInputRef.current.value = '';\r\n    }\r\n  };\r\n\r\n  const progressPercent = uploadProgress.total > 0 ? (uploadProgress.current / uploadProgress.total) * 100 : 0;\r\n  const totalSize = selectedFiles.reduce((sum, f) => sum + f.size, 0) / 1024 / 1024;\r\n\r\n  return (\r\n    <div className=\"panel\">\r\n      {/* Header */}\r\n      <div style={{ marginBottom: '20px' }}>\r\n        <h2 style={{ color: '#e9edef', fontSize: '20px', fontWeight: '600', margin: '0 0 8px 0' }}>\r\n          Bulk Upload Past Papers from Folder\r\n        </h2>\r\n        <p style={{ color: '#8696a0', fontSize: '13px', margin: '0' }}>\r\n          Select a folder to upload multiple past papers with automatic metadata extraction\r\n        </p>\r\n      </div>\r\n\r\n      {asSubmission && (\r\n        <div style={{\r\n          marginBottom: '15px',\r\n          padding: '10px 12px',\r\n          background: '#1f2c33',\r\n          border: '1px solid #00a884',\r\n          borderRadius: '6px',\r\n          color: '#00a884',\r\n          fontSize: '12px'\r\n        }}>\r\n          📋 Your uploads will be reviewed and appear after approval\r\n        </div>\r\n      )}\r\n\r\n      {/* Main Content */}\r\n      {selectedFiles.length === 0 ? (\r\n        // Upload Area\r\n        <div\r\n          onDragOver={handleDragOver}\r\n          onDragLeave={handleDragLeave}\r\n          onDrop={handleDrop}\r\n          onClick={() => folderInputRef.current?.click()}\r\n          style={{\r\n            border: `2px dashed ${dragOver ? '#00a884' : '#374151'}`,\r\n            borderRadius: '8px',\r\n            padding: '40px 20px',\r\n            textAlign: 'center',\r\n            cursor: 'pointer',\r\n            background: dragOver ? 'rgba(0, 168, 132, 0.08)' : '#0b141a',\r\n            transition: 'all 0.2s'\r\n          }}\r\n        >\r\n          <FiFolder size={40} style={{ color: '#00a884', marginBottom: '12px' }} />\r\n          <h3 style={{ color: '#e9edef', fontSize: '16px', fontWeight: '500', margin: '0 0 4px 0' }}>\r\n            Select Folder or Drag & Drop\r\n          </h3>\r\n          <p style={{ color: '#8696a0', fontSize: '13px', margin: '0' }}>\r\n            Choose a folder with past paper PDF files\r\n          </p>\r\n          <input\r\n            ref={folderInputRef}\r\n            type=\"file\"\r\n            webkitdirectory=\"true\"\r\n            directory=\"\"\r\n            multiple\r\n            onChange={handleFolderSelect}\r\n            style={{ display: 'none' }}\r\n            accept=\".pdf\"\r\n          />\r\n        </div>\r\n      ) : (\r\n        <>\r\n          {/* File List */}\r\n          <div style={{\r\n            background: '#0b141a',\r\n            border: '1px solid #1f2c33',\r\n            borderRadius: '8px',\r\n            marginBottom: '20px',\r\n            overflow: 'hidden'\r\n          }}>\r\n            <div style={{\r\n              padding: '12px 16px',\r\n              borderBottom: '1px solid #1f2c33',\r\n              background: '#0b141a'\r\n            }}>\r\n              <div style={{ color: '#e9edef', fontSize: '13px', fontWeight: '500' }}>\r\n                Files ({selectedFiles.length}) • {totalSize.toFixed(1)} MB\r\n              </div>\r\n            </div>\r\n\r\n            <div style={{ maxHeight: '250px', overflowY: 'auto' }}>\r\n              {selectedFiles.map((file, idx) => (\r\n                <div\r\n                  key={idx}\r\n                  style={{\r\n                    display: 'flex',\r\n                    alignItems: 'center',\r\n                    padding: '10px 16px',\r\n                    borderBottom: '1px solid #1f2c33',\r\n                    color: '#8696a0',\r\n                    fontSize: '12px'\r\n                  }}\r\n                >\r\n                  <FiFile size={14} style={{ marginRight: '8px', color: '#00a884' }} />\r\n                  <span style={{ flex: 1, overflow: 'hidden', textOverflow: 'ellipsis', whiteSpace: 'nowrap' }}>\r\n                    {file.name}\r\n                  </span>\r\n                  <span style={{ marginLeft: '8px', color: '#374151' }}>\r\n                    {(file.size / 1024 / 1024).toFixed(1)} MB\r\n                  </span>\r\n                </div>\r\n              ))}\r\n            </div>\r\n          </div>\r\n\r\n          {/* Progress */}\r\n          {uploading && (\r\n            <div style={{ marginBottom: '20px' }}>\r\n              <div style={{\r\n                display: 'flex',\r\n                justifyContent: 'space-between',\r\n                marginBottom: '8px',\r\n                color: '#8696a0',\r\n                fontSize: '12px'\r\n              }}>\r\n                <span>Uploading...</span>\r\n                <span>{uploadProgress.current} of {uploadProgress.total}</span>\r\n              </div>\r\n              <div style={{\r\n                width: '100%',\r\n                height: '6px',\r\n                background: '#1f2c33',\r\n                borderRadius: '3px',\r\n                overflow: 'hidden'\r\n              }}>\r\n                <div style={{\r\n                  height: '100%',\r\n                  width: `${progressPercent}%`,\r\n                  background: '#00a884',\r\n                  transition: 'width 0.3s'\r\n                }} />\r\n              </div>\r\n              {uploadedCount > 0 && (\r\n                <div style={{\r\n                  marginTop: '8px',\r\n                  color: '#00a884',\r\n                  fontSize: '12px'\r\n                }}>\r\n                  ✓ {uploadedCount} uploaded\r\n                </div>\r\n              )}\r\n              {failedCount > 0 && (\r\n                <div style={{\r\n                  marginTop: '4px',\r\n                  color: '#ea4335',\r\n                  fontSize: '12px'\r\n                }}>\r\n                  ✗ {failedCount} failed\r\n                </div>\r\n              )}\r\n            </div>\r\n          )}\r\n\r\n          {/* Buttons */}\r\n          <div style={{ display: 'flex', gap: '12px' }}>\r\n            {!uploading && (\r\n              <>\r\n                <button\r\n                  onClick={uploadFiles}\r\n                  disabled={selectedFiles.length === 0}\r\n                  style={{\r\n                    flex: 1,\r\n                    padding: '10px 16px',\r\n                    background: selectedFiles.length === 0 ? '#374151' : '#00a884',\r\n                    color: '#fff',\r\n                    border: 'none',\r\n                    borderRadius: '6px',\r\n                    cursor: selectedFiles.length === 0 ? 'not-allowed' : 'pointer',\r\n                    fontSize: '14px',\r\n                    fontWeight: '500',\r\n                    transition: 'background 0.2s'\r\n                  }}\r\n                >\r\n                  🚀 Upload {selectedFiles.length} Files\r\n                </button>\r\n                <button\r\n                  onClick={clearSelection}\r\n                  style={{\r\n                    padding: '10px 16px',\r\n                    background: '#374151',\r\n                    color: '#e9edef',\r\n                    border: 'none',\r\n                    borderRadius: '6px',\r\n                    cursor: 'pointer',\r\n                    fontSize: '14px'\r\n                  }}\r\n                >\r\n                  Cancel\r\n                </button>\r\n              </>\r\n            )}\r\n          </div>\r\n        </>\r\n      )}\r\n\r\n      {/* Info Box */}\r\n      <div style={{\r\n        marginTop: '20px',\r\n        padding: '12px 16px',\r\n        background: '#1f2c33',\r\n        border: '1px solid #374151',\r\n        borderRadius: '6px',\r\n        color: '#8696a0',\r\n        fontSize: '12px',\r\n        lineHeight: '1.6'\r\n      }}>\r\n        <strong style={{ color: '#e9edef' }}>🤖 Fully Automatic Extraction:</strong>\r\n        <br />\r\n        ✅ <strong>No manual selection needed!</strong> Just select folder and upload\r\n        <br />\r\n        ✓ University & Faculty automatically extracted from PDF text\r\n        <br />\r\n        ✓ Unit Code, Year, Semester automatically extracted from filename: <code style={{ background: '#0b141a', padding: '2px 4px', borderRadius: '3px' }}>UNITCODE_Name_2023_1_Main.pdf</code>\r\n        <br />\r\n        ✓ If PDF extraction fails, filename extraction is used as fallback\r\n        <br />\r\n        <br />\r\n        <strong>Best Results:</strong> Include \"University Name\" and \"Faculty Name\" on the first page of your PDF\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\n// Main TabContainer Component\r\nconst AutoUpload = ({ userProfile, asSubmission = false }) => {\r\n  const navigate = useNavigate();\r\n  const [activeTab, setActiveTab] = useState('books'); // 'books' or 'pastpapers'\r\n  const [toast, setToast] = useState(null);\r\n\r\n  const showToast = (message, type = 'info') => {\r\n    setToast({ message, type });\r\n    setTimeout(() => setToast(null), 4000);\r\n  };\r\n\r\n  const tabStyles = `\r\n    .autoupload-tabs-container {\r\n      display: flex;\r\n      gap: 8px;\r\n      margin-bottom: 20px;\r\n      border-bottom: 2px solid #374151;\r\n    }\r\n    .autoupload-tab-button {\r\n      display: flex;\r\n      align-items: center;\r\n      gap: 8px;\r\n      padding: 12px 24px;\r\n      background: transparent;\r\n      border: none;\r\n      color: #8696a0;\r\n      cursor: pointer;\r\n      font-size: 15px;\r\n      font-weight: 500;\r\n      transition: all 0.3s ease;\r\n      border-bottom: 3px solid transparent;\r\n      margin-bottom: -2px;\r\n    }\r\n    .autoupload-tab-button:hover {\r\n      color: #e9edef;\r\n      background: rgba(0, 168, 132, 0.05);\r\n    }\r\n    .autoupload-tab-button.active {\r\n      color: #00a884;\r\n      border-bottom-color: #00a884;\r\n    }\r\n  `;\r\n\r\n  return (\r\n    <>\r\n      <style>{tabStyles}</style>\r\n      \r\n      <div className=\"panel\">\r\n        {/* Tab Buttons and History Button */}\r\n        <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: '20px' }}>\r\n          <div className=\"autoupload-tabs-container\">\r\n            <button\r\n              className={`autoupload-tab-button ${activeTab === 'books' ? 'active' : ''}`}\r\n              onClick={() => setActiveTab('books')}\r\n            >\r\n              <FiBook size={18} />\r\n              Books Auto Upload\r\n            </button>\r\n            <button\r\n              className={`autoupload-tab-button ${activeTab === 'pastpapers' ? 'active' : ''}`}\r\n              onClick={() => setActiveTab('pastpapers')}\r\n            >\r\n              <FiFileText size={18} />\r\n              Past Papers Auto Upload\r\n            </button>\r\n          </div>\r\n          <button\r\n            onClick={() => navigate('/books/admin/upload-history')}\r\n            style={{\r\n              display: 'flex',\r\n              alignItems: 'center',\r\n              gap: '8px',\r\n              padding: '8px 16px',\r\n              background: '#0a1419',\r\n              color: '#e9edef',\r\n              border: 'none',\r\n              borderRadius: '6px',\r\n              cursor: 'pointer',\r\n              fontSize: '14px',\r\n              fontWeight: '500',\r\n              transition: 'all 0.2s',\r\n              boxShadow: '0 2px 4px rgba(0, 0, 0, 0.4)'\r\n            }}\r\n            onMouseEnter={(e) => {\r\n              e.target.style.background = '#121f28';\r\n              e.target.style.boxShadow = '0 4px 8px rgba(0, 0, 0, 0.6)';\r\n            }}\r\n            onMouseLeave={(e) => {\r\n              e.target.style.background = '#0a1419';\r\n              e.target.style.boxShadow = '0 2px 4px rgba(0, 0, 0, 0.4)';\r\n            }}\r\n          >\r\n            <FiClock size={16} />\r\n            History\r\n          </button>\r\n        </div>\r\n\r\n        {/* Tab Content */}\r\n        <div style={{ marginTop: '20px' }}>\r\n          {activeTab === 'books' && (\r\n            <BooksAutoUploadContent userProfile={userProfile} asSubmission={asSubmission} showToast={showToast} />\r\n          )}\r\n          {activeTab === 'pastpapers' && (\r\n            <PastPapersAutoUploadContent userProfile={userProfile} asSubmission={asSubmission} showToast={showToast} />\r\n          )}\r\n        </div>\r\n      </div>\r\n\r\n      {/* Global Toast */}\r\n      {toast && (\r\n        <div style={{\r\n          position: 'fixed',\r\n          bottom: '20px',\r\n          right: '20px',\r\n          maxWidth: '300px',\r\n          width: 'calc(100% - 40px)',\r\n          background: toast.type === 'error' ? '#ea4335' : toast.type === 'success' ? '#00a884' : '#374151',\r\n          color: '#fff',\r\n          padding: '12px 16px',\r\n          borderRadius: '6px',\r\n          zIndex: 10001,\r\n          boxShadow: '0 4px 12px rgba(0, 0, 0, 0.3)',\r\n          display: 'flex',\r\n          alignItems: 'center',\r\n          gap: '8px',\r\n          fontSize: '13px',\r\n          animation: 'slideIn 0.3s ease'\r\n        }}>\r\n          {toast.type === 'success' ? '✓' : toast.type === 'error' ? '✗' : 'ℹ'} {toast.message}\r\n        </div>\r\n      )}\r\n\r\n      <style>{`\r\n        @keyframes slideIn {\r\n          from {\r\n            transform: translateY(20px);\r\n            opacity: 0;\r\n          }\r\n          to {\r\n            transform: translateY(0);\r\n            opacity: 1;\r\n          }\r\n        }\r\n      `}</style>\r\n    </>\r\n  );\r\n};\r\n\r\nexport default AutoUpload;\r\n"],"names":["async","extractPastPaperMetadata","pdfFile","pdfjsLib","workerSrc","concat","arrayBuffer","pdfDoc","data","promise","fullText","pagesToRead","Math","min","numPages","i","page","getPage","textContent","getTextContent","items","map","item","str","join","text","filename","metadata","university","faculty","unitCode","unitName","year","semester","examType","source","universityPatterns","toUpperCase","pattern","match","extracted","trim","length","facultyPatterns","cleaned","replace","codeMatch","nameMatch","yearMatch","parseInt","semesterMatch","includes","examTypePatterns","typeStr","fallback","parseMetadataFromFilename","parseMetadataFromText","name","error","console","warn","parts","split","findMatchingUniversity","extractedUniversity","universities","uni","uniName","id","extractedWords","bestMatch","bestScore","uniWords","matchCount","word","some","w","score","max","findMatchingFaculty","extractedFaculty","faculties","fac","facName","facWords","guessFacultyFromUnitCode","code","codeToFaculty","prefix","Object","entries","startsWith","BooksAutoUploadContent","_ref","userProfile","asSubmission","showToast","selectedFiles","setSelectedFiles","useState","uploading","setUploading","uploadProgress","setUploadProgress","current","total","uploadedCount","setUploadedCount","failedCount","setFailedCount","duplicatesCount","setDuplicatesCount","skippedCount","setSkippedCount","toast","setToast","dragOver","setDragOver","categories","setCategories","folderInputRef","useRef","uiShowToast","useAdminUI","useEffect","fetchCategories","then","cats","internalShowToast","message","type","arguments","undefined","setTimeout","extractCoverFromPDF","viewport","getViewport","scale","canvas","document","createElement","width","height","context","getContext","render","canvasContext","Promise","resolve","toBlob","blob","coverFile","File","extractBasicMetadataFromName","fileName","title","author","description","category_id","language","isbn","pages","publisher","progressPercent","totalSize","reduce","sum","f","size","_jsxs","className","children","style","marginBottom","_jsx","color","fontSize","fontWeight","margin","padding","background","border","borderRadius","onDragOver","e","preventDefault","stopPropagation","onDragLeave","onDrop","dataTransfer","files","kind","file","getAsFile","toLowerCase","endsWith","push","onClick","_folderInputRef$curre","click","textAlign","cursor","transition","FiFolder","ref","webkitdirectory","directory","multiple","onChange","event","pdfFiles","Array","from","target","filter","display","accept","_Fragment","overflow","borderBottom","toFixed","maxHeight","overflowY","idx","alignItems","gap","FiFile","flexShrink","flex","textOverflow","whiteSpace","justifyContent","uploaded","failed","cover","role","createBook","createBookSubmission","disabled","opacity","FiRefreshCw","animation","FiUpload","clearSelection","value","FiX","marginTop","position","bottom","right","maxWidth","zIndex","boxShadow","PastPapersAutoUploadContent","_ref2","setUniversity","setFaculty","setUniversities","setFaculties","showOverride","setShowOverride","extractedMetadata","setExtractedMetadata","log","unis","getUniversitiesForDropdown","loadUniversities","facs","getFacultiesByUniversity","matchedFaculty","loadFaculties","autoExtractMetadata","unisList","pdfMetadata","matchedUniversityId","forceRefresh","performExtraction","_folderInputRef$curre2","marginRight","marginLeft","duplicates","fileNameWithoutExt","unit_code","unit_name","exam_type","letters","numbers","selectedUniversity","egerton_codes","Set","unitPrefix","has","egerton","find","u","_u$name","egerton_unit_mapping","detectEgertonFaculty","selectedFaculty","universityObj","searchResult","searchUnitFaculty","finalUniversity","_u$name2","_universities$","_universities$2","university_id","isNaN","Number","Date","getFullYear","uploaded_by","uid","universityId","duplicateCheck","checkDuplicatePastPaper","exists","paper","logUploadHistory","status","paperTitle","uploadedBy","isDuplicate","uploadFunction","createPastPaperSubmission","createPastPaper","pastPaperRecord","pastPaperId","clearPastPapersCache","stack","errorMessage","catch","err","lineHeight","_ref3","navigate","useNavigate","activeTab","setActiveTab","FiBook","FiFileText","onMouseEnter","onMouseLeave","FiClock"],"ignoreList":[],"sourceRoot":""}