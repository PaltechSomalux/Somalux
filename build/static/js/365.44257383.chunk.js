"use strict";(self.webpackChunkcampuslife=self.webpackChunkcampuslife||[]).push([[365],{2365:(e,i,t)=>{t.r(i),t.d(i,{default:()=>c});var s=t(9379),l=t(5043),r=t(3515),o=t(9101),a=t(5200),n=t(7050),d=t(579);const c=e=>{let{userProfile:i}=e;const[t,c]=(0,l.useState)(!0),[u,p]=(0,l.useState)([]),[h,m]=(0,l.useState)(0),[x,g]=(0,l.useState)(1),[f]=(0,l.useState)(15),[j,y]=(0,l.useState)(""),[b,v]=(0,l.useState)(""),[_,C]=(0,l.useState)({}),[w,S]=(0,l.useState)({col:"created_at",dir:"desc"}),{confirm:P,showToast:z}=(0,o.v)(),T="admin"===(null===i||void 0===i?void 0:i.role)||["campuslives254@gmail.com","paltechsomalux@gmail.com"].includes(null===i||void 0===i?void 0:i.email),N=(0,l.useMemo)(()=>Math.max(1,Math.ceil(h/f)),[h,f]),k=async()=>{c(!0);try{console.log("[Verify.load] Loading profiles...");const e=await(0,r.Hz)();console.log("[Verify.load] Fetched",(null===e||void 0===e?void 0:e.length)||0,"profiles");const i=(e||[]).filter(e=>e&&e.id).map(e=>(0,s.A)((0,s.A)({},e),{},{display_name:e.full_name||e.email,subscription_tier:e.subscription_tier||"basic",subscription_started_at:e.subscription_started_at,subscription_expires_at:e.subscription_expires_at,avatar_url:e.avatar_url}));console.log("[Verify.load] Loaded profiles:",i.length),p(i),m(i.length)}catch(e){console.error("[Verify.load] Failed to load profiles:",(null===e||void 0===e?void 0:e.message)||e),z({type:"error",message:"Failed to load users."})}finally{c(!1)}};(0,l.useEffect)(()=>{i&&k()},[i]);const A=(0,l.useMemo)(()=>u.filter(e=>{const i=!j||e.email&&e.email.toLowerCase().includes(j.toLowerCase())||e.display_name&&e.display_name.toLowerCase().includes(j.toLowerCase()),t=!b||e.subscription_tier===b;return i&&t}),[u,j,b]),L=(0,l.useMemo)(()=>{const e=(x-1)*f;return A.slice(e,e+f)},[A,x,f]);return T?t?(0,d.jsx)("div",{style:{padding:20,color:"#8696a0"},children:"Loading..."}):(0,d.jsxs)("div",{style:{padding:12},children:[(0,d.jsxs)("div",{className:"section-header",style:{marginBottom:16},children:[(0,d.jsx)("h2",{style:{color:"#e9edef",fontSize:18,margin:0},children:"Verify Users"}),(0,d.jsx)("p",{style:{color:"#8696a0",fontSize:12,margin:"4px 0 0 0"},children:"Manage user subscription tiers and verification status"})]}),(0,d.jsxs)("div",{style:{display:"flex",gap:8,marginBottom:12,flexWrap:"wrap"},children:[(0,d.jsxs)("div",{style:{flex:1,minWidth:200,position:"relative"},children:[(0,d.jsx)(a.CKj,{style:{position:"absolute",left:8,top:8,color:"#8696a0"}}),(0,d.jsx)("input",{type:"text",placeholder:"Search by name or email...",value:j,onChange:e=>y(e.target.value),className:"input",style:{paddingLeft:32,width:"100%",backgroundColor:"black",color:"white",fontSize:"13px"}})]}),(0,d.jsxs)("select",{className:"select",value:b,onChange:e=>v(e.target.value),style:{minWidth:150,width:"auto"},children:[(0,d.jsx)("option",{value:"",children:"All Tiers"}),(0,d.jsx)("option",{value:"basic",children:"Basic"}),(0,d.jsx)("option",{value:"premium",children:"Premium"}),(0,d.jsx)("option",{value:"premium_pro",children:"Premium Pro"})]})]}),(0,d.jsx)("div",{style:{overflowX:"auto"},children:(0,d.jsxs)("table",{className:"table",children:[(0,d.jsx)("thead",{children:(0,d.jsxs)("tr",{children:[(0,d.jsx)("th",{children:"#"}),(0,d.jsx)("th",{children:"Name"}),(0,d.jsx)("th",{children:"Email"}),(0,d.jsx)("th",{children:"Uploads"}),(0,d.jsx)("th",{children:"Current Tier"}),(0,d.jsx)("th",{children:"Subscription Date"}),(0,d.jsx)("th",{children:"Change Tier To"})]})}),(0,d.jsx)("tbody",{children:0===L.length?(0,d.jsx)("tr",{children:(0,d.jsx)("td",{colSpan:6,style:{textAlign:"center",color:"#8696a0",padding:20},children:"No users found"})}):L.map((e,i)=>{const t=(x-1)*f+i+1,l=(e=>{switch(e){case"premium":return{icon:(0,d.jsx)(a.YrT,{}),color:"#2196F3",label:"Premium",bgColor:"rgba(33, 150, 243, 0.1)"};case"premium_pro":return{icon:(0,d.jsx)(a.TPq,{}),color:"#FFD700",label:"Premium Pro",bgColor:"rgba(255, 215, 0, 0.1)"};default:return{icon:(0,d.jsx)(a.usP,{}),color:"#8696a0",label:"Basic",bgColor:"rgba(134, 150, 160, 0.05)"}}})(e.subscription_tier);return(0,d.jsxs)("tr",{children:[(0,d.jsxs)("td",{style:{fontSize:"13px",fontWeight:"600",color:"#00a884"},children:["#",t]}),(0,d.jsx)("td",{children:(0,d.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:8},children:[(0,d.jsxs)("div",{style:{position:"relative"},className:"viewer-avatar",children:[e.avatar_url?(0,d.jsx)("img",{src:e.avatar_url,alt:e.display_name||e.email||"User avatar",style:{width:"100%",height:"100%",borderRadius:"50%",objectFit:"cover"},onError:e=>{e.target.style.display="none"}}):(e.display_name||e.email||"?").charAt(0).toUpperCase(),e.uploadCount>0&&(0,d.jsx)("div",{style:{position:"absolute",bottom:-4,right:-4,backgroundColor:"#00a884",color:"white",borderRadius:"50%",width:20,height:20,display:"flex",alignItems:"center",justifyContent:"center",fontSize:10,fontWeight:"bold",border:"2px solid #0a1419"},children:e.uploadCount>99?"99+":e.uploadCount}),("premium"===e.subscription_tier||"premium_pro"===e.subscription_tier)&&(0,d.jsx)("div",{style:{position:"absolute",top:-6,right:-6,zIndex:2},children:(0,d.jsx)(n.A,{tier:e.subscription_tier,size:"sm",showLabel:!1,showTooltip:!0})})]}),(0,d.jsx)("span",{children:e.display_name||"\u2014"})]})}),(0,d.jsx)("td",{style:{fontSize:12,color:"#8696a0"},children:e.email}),(0,d.jsx)("td",{style:{fontSize:12,fontWeight:"600",color:"#00a884"},children:e.uploadCount}),(0,d.jsx)("td",{children:(0,d.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:6,padding:"4px 8px",borderRadius:4,backgroundColor:l.bgColor,width:"fit-content"},children:[(0,d.jsx)("span",{style:{color:l.color,fontSize:14},children:l.icon}),(0,d.jsx)("span",{style:{color:l.color,fontSize:12,fontWeight:500},children:l.label})]})}),(0,d.jsx)("td",{style:{fontSize:12,color:"#8696a0"},children:e.subscription_started_at?new Date(e.subscription_started_at).toLocaleDateString():"\u2014"}),(0,d.jsx)("td",{children:(0,d.jsxs)("select",{value:e.subscription_tier,onChange:i=>(async(e,i)=>{C(i=>(0,s.A)((0,s.A)({},i),{},{[e]:!0}));try{console.log("[Verify.updateTier] Updating tier for user:",e,"to:",i),await(0,r.pP)(e,i),console.log("[Verify.updateTier] Tier updated successfully"),await k()}catch(t){console.error("[Verify.updateTier] Error updating tier:",(null===t||void 0===t?void 0:t.message)||t),z({type:"error",message:"Failed to update user tier: ".concat((null===t||void 0===t?void 0:t.message)||"Unknown error")})}finally{C(i=>(0,s.A)((0,s.A)({},i),{},{[e]:!1}))}})(e.id,i.target.value),disabled:_[e.id],className:"select",style:{fontSize:12},children:[(0,d.jsx)("option",{value:"basic",children:"Basic"}),(0,d.jsx)("option",{value:"premium",children:"Premium"}),(0,d.jsx)("option",{value:"premium_pro",children:"Premium Pro"})]})})]},e.id)})})]})}),(0,d.jsxs)("div",{className:"actions",style:{marginTop:10,justifyContent:"space-between"},children:[(0,d.jsx)("button",{className:"btn",disabled:x<=1,onClick:()=>g(e=>Math.max(1,e-1)),children:"Prev"}),(0,d.jsxs)("span",{style:{color:"#cfd8dc"},children:["Page ",x," of ",N," (",A.length," users)"]}),(0,d.jsx)("button",{className:"btn",disabled:x>=N,onClick:()=>g(e=>Math.min(N,e+1)),children:"Next"})]})]}):(0,d.jsx)("div",{style:{padding:20,color:"#e9edef"},children:"You don't have permission to access this page."})}}}]);
//# sourceMappingURL=365.44257383.chunk.js.map