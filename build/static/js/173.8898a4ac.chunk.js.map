{"version":3,"file":"static/js/173.8898a4ac.chunk.js","mappings":"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","sources":["SomaLux/Books/Admin/universityPrefillApi.js","SomaLux/Books/Admin/pages/Upload.jsx"],"sourcesContent":["import { supabase } from '../supabaseClient';\nimport { API_URL } from '../../../config';\n\n// API Configuration\nconst USE_BACKEND_PROXY = true; // Set to false to use direct API calls\n\n/**\n * Search for university names for autocomplete\n */\nexport async function searchUniversityNames(query, limit = 10) {\n  try {\n    // Check cache first\n    let { data, error } = await supabase\n      .rpc('search_university_names', { p_query: query, p_limit: limit });\n\n    if (error) throw error;\n    if (data?.length) return data;\n\n    // Try Wikipedia/Wikidata search as primary method (more reliable, no API key needed)\n    const wikiResults = await searchWikipediaUniversities(query, limit);\n    if (wikiResults.length > 0) {\n      // Cache results\n      await Promise.all(wikiResults.map(uni => \n        cacheUniversityPrefillData(uni.name, uni, 'wikipedia')\n      ));\n      return wikiResults;\n    }\n\n    // Try backend proxy for Google Knowledge Graph (if enabled)\n    if (USE_BACKEND_PROXY) {\n      try {\n        const response = await fetch(`${API_URL}/api/university/search?query=${encodeURIComponent(query)}&limit=${limit}`);\n        \n        if (response.ok) {\n          const data = await response.json();\n          const universities = data.universities || [];\n          \n          // Cache results\n          if (universities.length > 0) {\n            await Promise.all(universities.map(uni => \n              cacheUniversityPrefillData(uni.name, uni, 'google_proxy')\n            ));\n          }\n          \n          return universities;\n        }\n      } catch (proxyError) {\n        console.warn('Backend proxy unavailable:', proxyError.message);\n      }\n    }\n\n    return [];\n  } catch (error) {\n    console.error('Error searching university names:', error);\n    return [];\n  }\n}\n\n/**\n * Search for universities using Wikipedia API (more reliable, no API key needed)\n */\nasync function searchWikipediaUniversities(query, limit = 10) {\n  try {\n    const searchUrl = `https://en.wikipedia.org/w/api.php?action=opensearch&search=${encodeURIComponent(query + ' university')}&limit=${limit}&namespace=0&format=json&origin=*`;\n    const response = await fetch(searchUrl);\n    \n    if (!response.ok) return [];\n    \n    const data = await response.json();\n    // data[0] = query, data[1] = titles, data[2] = descriptions, data[3] = urls\n    const titles = data[1] || [];\n    const descriptions = data[2] || [];\n    const urls = data[3] || [];\n    \n    return titles\n      .filter(title => title.toLowerCase().includes('university') || title.toLowerCase().includes('college'))\n      .map((title, index) => ({\n        name: title,\n        description: descriptions[index] || '',\n        website_url: urls[index] || '',\n      }));\n  } catch (error) {\n    console.error('Error searching Wikipedia:', error);\n    return [];\n  }\n}\n\n/**\n * Get prefill data for a university by name from cache\n */\nexport async function getUniversityPrefillData(universityName) {\n  try {\n    const { data, error } = await supabase\n      .rpc('get_university_prefill_data', {\n        p_university_name: universityName,\n      });\n\n    if (error) throw error;\n    return data;\n  } catch (error) {\n    console.error('Error fetching prefill data:', error);\n    return null;\n  }\n}\n\n/**\n * Fetch university data from Google Knowledge Graph (via backend proxy)\n */\nexport async function fetchUniversityDataFromGoogle(universityName) {\n  if (USE_BACKEND_PROXY) {\n    try {\n      const response = await fetch(`${API_URL}/api/university/details?name=${encodeURIComponent(universityName)}`);\n      \n      if (response.ok) {\n        const data = await response.json();\n        return {\n          name: data.university.name || universityName,\n          description: data.university.description || '',\n          website_url: data.university.website_url || '',\n          location: data.university.location || '',\n          established: null,\n          student_count: null,\n          cover_images: data.university.image ? [data.university.image] : [],\n        };\n      }\n    } catch (error) {\n      console.error('Error fetching from Google via proxy:', error);\n    }\n  }\n  \n  return null;\n}\n\n/**\n * Fetch university summary from Wikipedia REST API\n */\nexport async function fetchUniversityDataFromWikipedia(universityName) {\n  try {\n    const url = `https://en.wikipedia.org/api/rest_v1/page/summary/${encodeURIComponent(universityName)}`;\n    const res = await fetch(url);\n    if (!res.ok) return null;\n    const json = await res.json();\n\n    return {\n      name: json.title || universityName,\n      description: json.extract || '',\n      website_url: '',\n      location: '',\n      established: null,\n      student_count: null,\n      cover_images: json.thumbnail?.source ? [json.thumbnail.source] : [],\n    };\n  } catch (e) {\n    console.error('Error fetching from Wikipedia REST:', e);\n    return null;\n  }\n}\n\n/**\n * Fetch university data from Wikidata\n */\nexport async function fetchUniversityDataFromWikidata(universityName) {\n  try {\n    const sparqlQuery = `\n      SELECT ?item ?itemLabel ?locationLabel ?established ?studentCount ?website\n      WHERE {\n        ?item wdt:P31/wdt:P279* wd:Q3918;\n              rdfs:label ?itemLabel.\n        OPTIONAL { ?item wdt:P131 ?location. }\n        OPTIONAL { ?item wdt:P571 ?established. }\n        OPTIONAL { ?item wdt:P2196 ?studentCount. }\n        OPTIONAL { ?item wdt:P856 ?website. }\n        FILTER(CONTAINS(LCASE(?itemLabel), LCASE(\"${universityName}\")))\n        FILTER(LANG(?itemLabel) = \"en\")\n        SERVICE wikibase:label { bd:serviceParam wikibase:language \"en\". }\n      }\n      LIMIT 1\n    `;\n    const url = `https://query.wikidata.org/sparql?query=${encodeURIComponent(sparqlQuery)}&format=json`;\n    const response = await fetch(url);\n    if (!response.ok) return null;\n\n    const data = await response.json();\n    const binding = data.results.bindings[0];\n\n    if (!binding) return null;\n\n    return {\n      name: binding.itemLabel.value,\n      description: '',\n      website_url: binding.website?.value || '',\n      location: binding.locationLabel?.value || '',\n      established: binding.established?.value ? new Date(binding.established.value).getFullYear() : null,\n      student_count: binding.studentCount?.value || null,\n      cover_images: [],\n    };\n  } catch (error) {\n    console.error('Error fetching from Wikidata:', error);\n    return null;\n  }\n}\n\n/**\n * Fetch Wikimedia Commons images for a university\n */\nexport async function fetchWikimediaImages(universityName) {\n  try {\n    const title = (universityName || '').trim().replace(/\\s+/g, '_');\n    if (!title) return [];\n\n    const listUrl = `https://commons.wikimedia.org/w/api.php?action=query&format=json&origin=*&prop=images&titles=${encodeURIComponent(title)}`;\n    const listRes = await fetch(listUrl);\n    if (!listRes.ok) return [];\n    const listJson = await listRes.json();\n\n    const pages = listJson?.query?.pages ? Object.values(listJson.query.pages) : [];\n    const images = pages[0]?.images || [];\n    if (!images.length) return [];\n\n    const fileTitles = images\n      .map((img) => img?.title)\n      .filter(Boolean)\n      .slice(0, 50)\n      .join('|');\n\n    if (!fileTitles) return [];\n\n    const infoUrl = `https://commons.wikimedia.org/w/api.php?action=query&format=json&origin=*&prop=imageinfo&iiprop=url&titles=${encodeURIComponent(fileTitles)}`;\n    const infoRes = await fetch(infoUrl);\n    if (!infoRes.ok) return [];\n    const infoJson = await infoRes.json();\n\n    const filePages = infoJson?.query?.pages ? Object.values(infoJson.query.pages) : [];\n    const urls = filePages\n      .map((p) => p?.imageinfo?.[0]?.url)\n      .filter((u) => typeof u === 'string' && /\\.(jpg|jpeg|png|webp)$/i.test(u));\n\n    const prioritized = urls.sort((a, b) => {\n      const deprioritize = (s) => /logo|seal|coat_of_arms|emblem/i.test(s) ? 1 : 0;\n      return deprioritize(a) - deprioritize(b);\n    });\n\n    return prioritized.slice(0, 5);\n  } catch (e) {\n    console.error('Error fetching Wikimedia images:', e);\n    return [];\n  }\n}\n\n/**\n * Fetch images from Unsplash (via backend proxy if enabled)\n */\nexport async function fetchUnsplashImages(universityName) {\n  if (USE_BACKEND_PROXY) {\n    try {\n      const response = await fetch(`${API_URL}/api/university/images?query=${encodeURIComponent(universityName)}`);\n      \n      if (response.ok) {\n        const data = await response.json();\n        return data.images?.map(img => img.url) || [];\n      }\n    } catch (error) {\n      console.error('Error fetching Unsplash images via proxy:', error);\n    }\n  }\n  \n  return [];\n}\n\n/**\n * Download image from URL and convert to File object\n */\nexport async function downloadImageAsFile(imageUrl, fileName) {\n  try {\n    const response = await fetch(imageUrl);\n    if (!response.ok) throw new Error('Failed to download image');\n\n    const blob = await response.blob();\n    const file = new File([blob], fileName, { type: blob.type });\n    return file;\n  } catch (error) {\n    console.error('Error downloading image:', error);\n    return null;\n  }\n}\n\n/**\n * Cache university prefill data\n */\nexport async function cacheUniversityPrefillData(universityName, data, source = 'manual') {\n  try {\n    const { error } = await supabase\n      .from('university_prefill_cache')\n      .upsert({\n        university_name: universityName,\n        data: data,\n        source: source,\n        updated_at: new Date().toISOString(),\n      });\n\n    if (error) throw error;\n    return true;\n  } catch (error) {\n    console.error('Error caching prefill data:', error);\n    return false;\n  }\n}\n\n/**\n * Upload multiple images for a university\n */\nexport async function uploadUniversityImages(universityId, imageFiles) {\n  try {\n    const uploadedImages = [];\n    const bucket = 'university-covers';\n\n    for (let i = 0; i < imageFiles.length; i++) {\n      const file = imageFiles[i];\n      const fileExt = file.name.split('.').pop();\n      const fileName = `${universityId}/image_${i + 1}_${Date.now()}.${fileExt}`;\n\n      const { error: uploadError } = await supabase.storage\n        .from(bucket)\n        .upload(fileName, file, {\n          cacheControl: '3600',\n          upsert: false,\n        });\n\n      if (uploadError) {\n        console.error('Error uploading image:', uploadError);\n        continue;\n      }\n\n      const { data: urlData } = supabase.storage\n        .from(bucket)\n        .getPublicUrl(fileName);\n\n      uploadedImages.push({\n        url: urlData.publicUrl,\n        fileName: fileName,\n      });\n    }\n\n    return uploadedImages;\n  } catch (error) {\n    console.error('Error uploading multiple images:', error);\n    throw error;\n  }\n}\n\n/**\n * Add image record to university_images table\n */\nexport async function addUniversityImage(universityId, imageUrl, caption = null, isPrimary = false, displayOrder = 0) {\n  try {\n    const { data, error } = await supabase\n      .rpc('add_university_image', {\n        p_university_id: universityId,\n        p_image_url: imageUrl,\n        p_caption: caption,\n        p_is_primary: isPrimary,\n        p_display_order: displayOrder,\n      });\n\n    if (error) throw error;\n    return data;\n  } catch (error) {\n    console.error('Error adding university image:', error);\n    throw error;\n  }\n}\n\n/**\n * Get all images for a university\n */\nexport async function getUniversityImages(universityId) {\n  try {\n    const { data, error } = await supabase\n      .from('university_images')\n      .select('*')\n      .eq('university_id', universityId)\n      .order('is_primary', { ascending: false })\n      .order('display_order', { ascending: true });\n\n    if (error) throw error;\n    return data || [];\n  } catch (error) {\n    console.error('Error fetching university images:', error);\n    throw error;\n  }\n}\n\n/**\n * Set image as primary\n */\nexport async function setPrimaryUniversityImage(imageId) {\n  try {\n    const { error } = await supabase\n      .rpc('set_primary_university_image', {\n        p_image_id: imageId,\n      });\n\n    if (error) throw error;\n    return true;\n  } catch (error) {\n    console.error('Error setting primary image:', error);\n    return false;\n  }\n}\n\n/**\n * Delete university image\n */\nexport async function deleteUniversityImage(imageId, imageUrl) {\n  try {\n    const urlParts = imageUrl.split('/');\n    const bucket = 'university-covers';\n    const filePath = urlParts.slice(urlParts.indexOf(bucket) + 1).join('/');\n\n    const { error: storageError } = await supabase.storage\n      .from(bucket)\n      .remove([filePath]);\n\n    if (storageError) {\n      console.error('Error deleting from storage:', storageError);\n    }\n\n    const { error: dbError } = await supabase\n      .from('university_images')\n      .delete()\n      .eq('id', imageId);\n\n    if (dbError) throw dbError;\n    return true;\n  } catch (error) {\n    console.error('Error deleting university image:', error);\n    throw error;\n  }\n}\n\n/**\n * Main auto-fill function triggered on tab/input\n */\nexport async function autoFillUniversityData(universityName) {\n  try {\n    // Check cache first\n    let data = await getUniversityPrefillData(universityName);\n    if (data) return data;\n\n    // Prefer Wikipedia + Wikidata for accuracy (no API keys needed)\n    const wikiSummary = await fetchUniversityDataFromWikipedia(universityName);\n    const wikidata = await fetchUniversityDataFromWikidata(universityName);\n\n    if (wikiSummary || wikidata) {\n      const merged = {\n        name: (wikiSummary?.name || wikidata?.name || universityName) ?? universityName,\n        description: wikiSummary?.description || '',\n        website_url: wikidata?.website_url || '',\n        location: wikidata?.location || '',\n        established: wikidata?.established ?? null,\n        student_count: wikidata?.student_count ?? null,\n        cover_images: wikiSummary?.cover_images || [],\n      };\n      data = merged;\n    }\n\n    // Try Google as last resort (via proxy if enabled)\n    if (!data) {\n      data = await fetchUniversityDataFromGoogle(universityName);\n    }\n\n    // Fetch images\n    if (data && (!data.cover_images || data.cover_images.length === 0)) {\n      const commons = await fetchWikimediaImages(data.name || universityName);\n      if (commons.length) {\n        data.cover_images = commons;\n      } else {\n        const unsplash = await fetchUnsplashImages(data.name || universityName);\n        data.cover_images = unsplash;\n      }\n    }\n\n    // Cache the result\n    if (data) {\n      await cacheUniversityPrefillData(universityName, data, 'wikipedia_wikidata');\n    }\n\n    return (\n      data || {\n        name: universityName,\n        description: '',\n        website_url: '',\n        location: '',\n        established: null,\n        student_count: null,\n        cover_images: [],\n      }\n    );\n  } catch (error) {\n    console.error('Error auto-filling university data:', error);\n    return {\n      name: universityName,\n      description: '',\n      website_url: '',\n      location: '',\n      established: null,\n      student_count: null,\n      cover_images: [],\n    };\n  }\n}\n\n/**\n * Get all cached universities for dropdown/autocomplete\n */\nexport async function getAllCachedUniversities() {\n  try {\n    const { data, error } = await supabase\n      .from('university_prefill_cache')\n      .select('university_name')\n      .order('university_name');\n\n    if (error) throw error;\n    return data?.map(u => u.university_name) || [];\n  } catch (error) {\n    console.error('Error fetching cached universities:', error);\n    return [];\n  }\n}\n\n/**\n * Debounce utility\n */\nfunction debounce(func, wait) {\n  let timeout;\n  return (...args) => {\n    clearTimeout(timeout);\n    timeout = setTimeout(() => func(...args), wait);\n  };\n}\n\n/**\n * Frontend integration for auto-fill\n */\nexport function setupAutoFill(inputElement, resultContainer) {\n  inputElement.addEventListener(\n    'input',\n    debounce(async () => {\n      const query = inputElement.value.trim();\n      if (query.length < 3) return;\n\n      const suggestions = await searchUniversityNames(query);\n      console.log('Suggestions:', suggestions);\n      \n      const datalist = document.createElement('datalist');\n      datalist.id = 'university-suggestions';\n      suggestions.forEach(s => {\n        const option = document.createElement('option');\n        option.value = s.name;\n        datalist.appendChild(option);\n      });\n      inputElement.setAttribute('list', 'university-suggestions');\n      inputElement.parentNode.appendChild(datalist);\n    }, 300)\n  );\n\n  inputElement.addEventListener('keydown', async (event) => {\n    if (event.key === 'Tab') {\n      event.preventDefault();\n      const universityName = inputElement.value.trim();\n      if (!universityName) return;\n\n      const data = await autoFillUniversityData(universityName);\n      if (data) {\n        resultContainer.innerHTML = `\n          <h3>${data.name}</h3>\n          <p>${data.description || 'No description available'}</p>\n          <a href=\"${data.website_url || '#'}\" target=\"_blank\">Website</a>\n          <p>Location: ${data.location || 'N/A'}</p>\n          <p>Established: ${data.established || 'N/A'}</p>\n          <p>Students: ${data.student_count || 'N/A'}</p>\n          <div>\n            ${data.cover_images\n              .map(img => `<img src=\"${img}\" alt=\"${data.name} campus\" width=\"200\" style=\"margin-right: 10px;\" />`)\n              .join('')}\n          </div>\n        `;\n      }\n    }\n  });\n}","import React, { useEffect, useState, useCallback, useRef } from 'react';\nimport { useNavigate } from 'react-router-dom';\nimport { createBookSubmission, createBook, fetchCategories } from '../api';\nimport { createUniversitySubmission } from '../campusApi';\nimport { createPastPaper, createPastPaperSubmission, getUniversitiesForDropdown } from '../pastPapersApi';\nimport { \n  autoFillUniversityData, \n  searchUniversityNames,\n  uploadUniversityImages,\n  addUniversityImage,\n  downloadImageAsFile,\n  fetchWikimediaImages,\n  fetchUnsplashImages\n} from '../universityPrefillApi';\nimport { FiUpload, FiFile, FiImage, FiBook, FiMapPin, FiFileText, FiSearch, FiX, FiLoader } from 'react-icons/fi';\nimport { useAdminUI } from '../AdminUIContext';\nimport * as pdfjsLib from 'pdfjs-dist';\n\n// Simple debounce hook\nfunction useDebounce(callback, delay) {\n  const timeoutRef = useRef(null);\n  return useCallback((...args) => {\n    if (timeoutRef.current) {\n      clearTimeout(timeoutRef.current);\n    }\n    timeoutRef.current = setTimeout(() => callback(...args), delay);\n  }, [callback, delay]);\n}\n\n// Add styles for drag and drop effect and tabs\nconst dropzoneStyles = `\n  .dropzone {\n    border: 2px dashed #374151;\n    border-radius: 8px;\n    padding: 20px;\n    text-align: center;\n    cursor: pointer;\n    transition: all 0.3s ease;\n  }\n  .dropzone:hover {\n    border-color: #00a884;\n    background: rgba(0, 168, 132, 0.05);\n  }\n  .dropzone.drag-over {\n    border-color: #00a884;\n    background: rgba(0, 168, 132, 0.1);\n  }\n  .upload-tabs {\n    display: flex;\n    gap: 8px;\n    margin-bottom: 20px;\n    border-bottom: 2px solid #374151;\n  }\n  .upload-tab {\n    display: flex;\n    align-items: center;\n    gap: 8px;\n    padding: 12px 24px;\n    background: transparent;\n    border: none;\n    color: #8696a0;\n    cursor: pointer;\n    font-size: 16px;\n    font-weight: 500;\n    transition: all 0.3s ease;\n    border-bottom: 3px solid transparent;\n    margin-bottom: -2px;\n  }\n  .upload-tab:hover {\n    color: #e9edef;\n    background: rgba(0, 168, 132, 0.05);\n  }\n  .upload-tab.active {\n    color: #00a884;\n    border-bottom-color: #00a884;\n  }\n  @keyframes spin {\n    from { transform: rotate(0deg); }\n    to { transform: rotate(360deg); }\n  }\n  .spin {\n    animation: spin 1s linear infinite;\n  }\n`;\n\nconst Upload = ({ userProfile, initialTab = 'books' }) => {\n  // Add style tag to document\n  useEffect(() => {\n    const styleTag = document.createElement('style');\n    styleTag.innerHTML = dropzoneStyles;\n    document.head.appendChild(styleTag);\n    return () => styleTag.remove();\n  }, []);\n\n  const [activeTab, setActiveTab] = useState(initialTab); // 'books', 'campus', 'pastpapers'\n  const navigate = useNavigate();\n  const { showToast } = useAdminUI();\n\n  // Update active tab when initialTab prop changes\n  useEffect(() => {\n    setActiveTab(initialTab);\n  }, [initialTab]);\n  \n  // Books state\n  const [pdf, setPdf] = useState(null);\n  const [cover, setCover] = useState(null);\n  const [categories, setCategories] = useState([]);\n  const [bookForm, setBookForm] = useState({ \n    title: '', author: '', description: '', category_id: '', \n    year: '', language: '', isbn: '', pages: '', publisher: '' \n  });\n\n  // Campus state\n  const [campusImages, setCampusImages] = useState([]);\n  const [campusForm, setCampusForm] = useState({ \n    name: '', description: '', website_url: '', location: '', \n    established: '', student_count: '' \n  });\n  const [searchQuery, setSearchQuery] = useState('');\n  const [searchResults, setSearchResults] = useState([]);\n  const [showSearchResults, setShowSearchResults] = useState(false);\n  const [isAutoFilling, setIsAutoFilling] = useState(false);\n\n  // Past Papers state\n  const [paperPdf, setPaperPdf] = useState(null);\n  const [universities, setUniversities] = useState([]);\n  const [paperForm, setPaperForm] = useState({ \n    university_id: '', faculty: '', unit_code: '', \n    unit_name: '', year: '', semester: '', exam_type: '' \n  });\n\n  const [busy, setBusy] = useState(false);\n  const [extractingCover, setExtractingCover] = useState(false);\n\n  useEffect(() => { \n    (async () => { \n      try { \n        setCategories(await fetchCategories()); \n        setUniversities(await getUniversitiesForDropdown());\n      } catch {} \n    })(); \n  }, []);\n\n  // Auto-extract cover from PDF when PDF is selected\n  useEffect(() => {\n    if (!pdf) return;\n\n    const extractCoverFromPDF = async () => {\n      setExtractingCover(true);\n      try {\n        // Set worker if not already set\n        if (!pdfjsLib.GlobalWorkerOptions.workerSrc) {\n          pdfjsLib.GlobalWorkerOptions.workerSrc = `//cdnjs.cloudflare.com/ajax/libs/pdf.js/${pdfjsLib.version}/pdf.worker.min.js`;\n        }\n\n        const arrayBuffer = await pdf.arrayBuffer();\n        const pdfDoc = await pdfjsLib.getDocument({ data: arrayBuffer }).promise;\n        \n        if (pdfDoc.numPages > 0) {\n          const page = await pdfDoc.getPage(1);\n          const viewport = page.getViewport({ scale: 2 });\n          const canvas = document.createElement('canvas');\n          canvas.width = viewport.width;\n          canvas.height = viewport.height;\n          \n          const context = canvas.getContext('2d');\n          await page.render({ canvasContext: context, viewport }).promise;\n          \n          // Convert canvas to blob and create a file\n          canvas.toBlob((blob) => {\n            if (blob) {\n              const coverFile = new File([blob], `${pdf.name.replace('.pdf', '')}_cover.png`, { type: 'image/png' });\n              setCover(coverFile);\n              showToast({ type: 'success', message: 'Cover image extracted from PDF!' });\n            }\n          }, 'image/png', 0.95);\n        }\n      } catch (error) {\n        console.error('Error extracting cover from PDF:', error);\n        // Don't show error toast - this is optional, user can upload manual cover\n        showToast({ type: 'info', message: 'Could not auto-extract cover. You can upload one manually.' });\n      } finally {\n        setExtractingCover(false);\n      }\n    };\n\n    extractCoverFromPDF();\n  }, [pdf, showToast]);\n\n  const onBookChange = (k) => (e) => setBookForm((f) => ({ ...f, [k]: e.target.value }));\n  const onCampusChange = (k) => (e) => {\n    setCampusForm((f) => ({ ...f, [k]: e.target.value }));\n    // If changing name, trigger search\n    if (k === 'name') {\n      setSearchQuery(e.target.value);\n      debouncedSearch(e.target.value);\n    }\n  };\n\n  // Debounced search for universities\n  const handleSearchUniversities = async (query) => {\n    if (query.length < 2) {\n      setSearchResults([]);\n      setShowSearchResults(false);\n      return;\n    }\n\n    try {\n      const results = await searchUniversityNames(query);\n      setSearchResults(results);\n      setShowSearchResults(results.length > 0);\n    } catch (error) {\n      console.error('Error searching:', error);\n    }\n  };\n  const debouncedSearch = useDebounce(handleSearchUniversities, 300);\n\n  // Auto-fill university data\n  const handleAutoFill = async (universityName) => {\n    setIsAutoFilling(true);\n    setShowSearchResults(false);\n\n    try {\n      const data = await autoFillUniversityData(universityName || campusForm.name);\n      \n      if (data) {\n        setCampusForm({\n          name: data.name || '',\n          description: data.description || '',\n          website_url: data.website_url || '',\n          location: data.location || '',\n          established: data.established?.toString() || '',\n          student_count: data.student_count?.toString() || ''\n        });\n        \n        // Download images if available\n        if (data.cover_images && data.cover_images.length > 0) {\n          const downloadedImages = [];\n          \n          for (let i = 0; i < Math.min(data.cover_images.length, 5); i++) {\n            const imageUrl = data.cover_images[i];\n            const fileName = `${data.name.replace(/\\s+/g, '_')}_image_${i + 1}.jpg`;\n            \n            try {\n              const imageFile = await downloadImageAsFile(imageUrl, fileName);\n              if (imageFile) {\n                downloadedImages.push(imageFile);\n              }\n            } catch (err) {\n              console.error('Error downloading image:', err);\n            }\n          }\n          \n          if (downloadedImages.length > 0) {\n            setCampusImages(downloadedImages);\n            showToast({ type: 'success', message: `Auto-filled data for ${data.name} with ${downloadedImages.length} image(s)!` });\n          } else {\n            showToast({ type: 'info', message: `Auto-filled data for ${data.name}! But images could not be downloaded, please upload manually.` });\n          }\n        } else {\n          // Prefer Wikimedia Commons fallback, then Unsplash\n          let urls = await fetchWikimediaImages(data.name);\n          if (!urls.length) {\n            urls = await fetchUnsplashImages(data.name);\n          }\n\n          if (urls.length > 0) {\n            const downloadedImages = [];\n            for (let i = 0; i < urls.length; i++) {\n              try {\n                const fileName = `${data.name.replace(/\\s+/g, '_')}_auto_${i + 1}.jpg`;\n                const file = await downloadImageAsFile(urls[i], fileName);\n                if (file) downloadedImages.push(file);\n              } catch (err) {\n                console.error('Auto image download error:', err);\n              }\n            }\n\n            if (downloadedImages.length > 0) {\n              setCampusImages(downloadedImages);\n              showToast({ type: 'success', message: `Auto-filled data for ${data.name} with ${downloadedImages.length} image(s)!` });\n            } else {\n              showToast({ type: 'info', message: `Auto-filled data for ${data.name}, but images couldn't be downloaded.` });\n            }\n          } else {\n            showToast({ type: 'info', message: `Auto-filled data for ${data.name}, but no images were found automatically.` });\n          }\n        }\n      } else {\n        showToast({ type: 'info', message: 'No data found for this university. Please enter details manually.' });\n      }\n    } catch (error) {\n      console.error('Error auto-filling:', error);\n      showToast({ type: 'error', message: 'Failed to auto-fill data. Please try again.' });\n    } finally {\n      setIsAutoFilling(false);\n    }\n  };\n  const onPaperChange = (k) => (e) => setPaperForm((f) => ({ ...f, [k]: e.target.value }));\n\n  const submitBook = async () => {\n    if (!pdf) { showToast({ type: 'error', message: 'Please choose a PDF file.' }); return; }\n    setBusy(true);\n    try {\n      const metadata = {\n        title: bookForm.title || (pdf?.name?.replace(/\\.[^/.]+$/, '') || ''),\n        author: bookForm.author || 'Unknown',\n        description: bookForm.description || '',\n        category_id: bookForm.category_id || null,\n        year: bookForm.year ? Number(bookForm.year) : null,\n        language: bookForm.language || '',\n        isbn: bookForm.isbn || '',\n        pages: bookForm.pages ? Number(bookForm.pages) : 0,\n        publisher: bookForm.publisher || '',\n        uploaded_by: userProfile?.id || null\n      };\n      \n      // Check if user is admin or editor - if so, directly upload; otherwise submit for approval\n      const isAdmin = userProfile?.role === 'admin' || userProfile?.role === 'editor';\n      \n      if (isAdmin) {\n        await createBook({ metadata, pdfFile: pdf, coverFile: cover });\n        showToast({ type: 'success', message: 'Book uploaded successfully!' });\n      } else {\n        await createBookSubmission({ metadata, pdfFile: pdf, coverFile: cover });\n        showToast({ type: 'success', message: 'Book submitted for approval. Admin will review it shortly.' });\n      }\n      \n      // Reset form\n      setPdf(null);\n      setCover(null);\n      setBookForm({ title: '', author: '', description: '', category_id: '', year: '', language: '', isbn: '', pages: '', publisher: '' });\n      navigate('/user/upload');\n    } catch (e) {\n      console.error('Book upload failed:', e);\n      showToast({ type: 'error', message: e?.message || 'Upload failed.' });\n    } finally { setBusy(false); }\n  };\n\n  const submitCampus = async () => {\n    if (!campusForm.name) { showToast({ type: 'error', message: 'Please enter university name.' }); return; }\n    setBusy(true);\n    try {\n      const metadata = {\n        name: campusForm.name,\n        description: campusForm.description || '',\n        website_url: campusForm.website_url || '',\n        location: campusForm.location || '',\n        established: campusForm.established ? Number(campusForm.established) : null,\n        student_count: campusForm.student_count ? Number(campusForm.student_count) : 0\n      };\n      \n      // Create university submission (use first image as cover)\n      const primaryImage = campusImages[0] || null;\n      const result = await createUniversitySubmission({ metadata, coverFile: primaryImage });\n      const universityId = result.id;\n      \n      // Note: Additional images would be uploaded after approval\n      // For now, only primary image is saved with submission\n      \n      showToast({ type: 'success', message: `University submitted for approval with ${campusImages.length} image(s)!` });\n      // Reset form\n      setCampusForm({ name: '', description: '', website_url: '', location: '', established: '', student_count: '' });\n      setCampusImages([]);\n      navigate('/user/upload');\n    } catch (e) {\n      console.error('University upload failed:', e);\n      showToast({ type: 'error', message: e?.message || 'Upload failed.' });\n    } finally { setBusy(false); }\n  };\n\n  const submitPastPaper = async () => {\n    if (!paperPdf) { showToast({ type: 'error', message: 'Please choose a PDF file.' }); return; }\n    if (!paperForm.university_id) { showToast({ type: 'error', message: 'Please select a university.' }); return; }\n    if (!paperForm.faculty) { showToast({ type: 'error', message: 'Please enter faculty.' }); return; }\n    if (!paperForm.unit_code) { showToast({ type: 'error', message: 'Please enter unit code.' }); return; }\n    if (!paperForm.unit_name) { showToast({ type: 'error', message: 'Please enter unit name.' }); return; }\n    if (!paperForm.year) { showToast({ type: 'error', message: 'Please enter year.' }); return; }\n    \n    setBusy(true);\n    // Show instant success feedback\n    showToast({ type: 'success', message: 'Past paper submitted! Processing...' });\n    // Reset form immediately for instant feedback\n    setPaperForm({ university_id: '', faculty: '', unit_code: '', unit_name: '', year: '', semester: '', exam_type: '' });\n    setPaperPdf(null);\n    \n    try {\n      const metadata = {\n        title: `${paperForm.unit_code} - ${paperForm.unit_name}`,\n        university_id: paperForm.university_id || null,\n        faculty: paperForm.faculty,\n        unit_code: paperForm.unit_code,\n        unit_name: paperForm.unit_name,\n        year: paperForm.year ? Number(paperForm.year) : null,\n        semester: paperForm.semester || '',\n        exam_type: paperForm.exam_type || 'Main',\n        uploaded_by: userProfile?.id || null\n      };\n      \n      console.log(' Submitting past paper with metadata:', JSON.stringify(metadata, null, 2));\n      console.log(' Current form state:', JSON.stringify(paperForm, null, 2));\n      \n      // Determine if admin or user - admins get instant display, users get approval workflow\n      const isAdmin = userProfile?.role === 'admin' || userProfile?.role === 'editor';\n      const uploadFunction = isAdmin ? createPastPaper : createPastPaperSubmission;\n      \n      // Fire upload in background without waiting\n      uploadFunction({ metadata, pdfFile: paperPdf }).catch((e) => {\n        console.error('Past paper upload failed:', e);\n        showToast({ type: 'error', message: e?.message || 'Upload failed.' });\n      });\n      // Navigate instantly without waiting for upload to complete\n      setTimeout(() => navigate('/user/upload'), 300);\n    } finally { setBusy(false); }\n  };\n\n  // Render dropzone component\n  const renderDropzone = (file, setFile, accept, fileType, icon) => (\n    <div\n      className=\"dropzone\"\n      onDragOver={(e) => {\n        e.preventDefault();\n        e.currentTarget.classList.add('drag-over');\n      }}\n      onDragLeave={(e) => {\n        e.preventDefault();\n        e.currentTarget.classList.remove('drag-over');\n      }}\n      onDrop={(e) => {\n        e.preventDefault();\n        e.currentTarget.classList.remove('drag-over');\n        const droppedFile = e.dataTransfer.files[0];\n        if (droppedFile && droppedFile.type.match(accept)) {\n          setFile(droppedFile);\n        }\n      }}\n      onClick={() => document.getElementById(`${fileType}-input`).click()}\n      style={{\n        border: '2px dashed #374151',\n        borderRadius: '8px',\n        padding: '20px',\n        textAlign: 'center',\n        cursor: 'pointer',\n        background: file ? 'rgba(0, 168, 132, 0.1)' : 'transparent',\n        transition: 'all 0.3s ease'\n      }}\n    >\n      <input\n        id={`${fileType}-input`}\n        type=\"file\"\n        accept={accept}\n        onChange={(e) => setFile(e.target.files?.[0] || null)}\n        style={{ display: 'none' }}\n      />\n      {file ? (\n        <div style={{ display: 'flex', alignItems: 'center', justifyContent: 'center', gap: '10px', color: '#00a884' }}>\n          {icon}\n          <span>{file.name}</span>\n        </div>\n      ) : (\n        <div>\n          <FiUpload size={20} style={{ marginBottom: '4px', color: '#8696a0' }} />\n          <div style={{ color: '#e9edef' }}>Drag and drop or click to browse</div>\n          <div style={{ color: '#8696a0', fontSize: '0.85em', marginTop: '2px' }}>\n            {accept === 'application/pdf' ? 'PDF files only' : 'Image files (JPG, PNG, GIF)'}\n          </div>\n        </div>\n      )}\n    </div>\n  );\n\n  return (\n    <div className=\"panel\">\n      <div className=\"panel-title\">Upload Content</div>\n      \n      {/* Tabs */}\n      <div className=\"upload-tabs\">\n        <button \n          className={`upload-tab ${activeTab === 'books' ? 'active' : ''}`}\n          onClick={() => setActiveTab('books')}\n        >\n          <FiBook size={20} />\n          Books\n        </button>\n        <button \n          className={`upload-tab ${activeTab === 'campus' ? 'active' : ''}`}\n          onClick={() => setActiveTab('campus')}\n        >\n          <FiMapPin size={20} />\n          Campus\n        </button>\n        <button \n          className={`upload-tab ${activeTab === 'pastpapers' ? 'active' : ''}`}\n          onClick={() => setActiveTab('pastpapers')}\n        >\n          <FiFileText size={20} />\n          Past Papers\n        </button>\n      </div>\n\n      {/* Books Tab */}\n      {activeTab === 'books' && (\n        <div className=\"grid-2\">\n          <div className=\"panel\">\n            <label className=\"label\">PDF File</label>\n            {renderDropzone(pdf, setPdf, 'application/pdf', 'pdf', <FiFile size={24} />)}\n            \n            <label className=\"label\" style={{ marginTop: 20 }}>\n              Cover Image (optional)\n              {extractingCover && <span style={{ marginLeft: '8px', color: '#00a884', fontSize: '0.9em' }}>(Extracting...)</span>}\n            </label>\n            {renderDropzone(cover, setCover, 'image/*', 'cover', <FiImage size={24} />)}\n          </div>\n          <div className=\"panel\">\n            <label className=\"label\">Title</label>\n            <input className=\"input\" placeholder=\"Book title\" value={bookForm.title} onChange={onBookChange('title')} />\n            <label className=\"label\" style={{ marginTop: 10 }}>Author</label>\n            <input className=\"input\" placeholder=\"Author\" value={bookForm.author} onChange={onBookChange('author')} />\n            <label className=\"label\" style={{ marginTop: 10 }}>Description</label>\n            <textarea className=\"input\" rows={5} placeholder=\"Short description\" value={bookForm.description} onChange={onBookChange('description')} />\n\n            <div className=\"grid-2\" style={{ marginTop: 10 }}>\n              <div>\n                <label className=\"label\">Category</label>\n                <select className=\"select\" value={bookForm.category_id} onChange={onBookChange('category_id')}>\n                  <option value=\"\">Uncategorized</option>\n                  {categories.map(c => <option key={c.id} value={c.id}>{c.name}</option>)}\n                </select>\n              </div>\n              <div>\n                <label className=\"label\">Year</label>\n                <input className=\"input\" placeholder=\"Year\" value={bookForm.year} onChange={onBookChange('year')} />\n              </div>\n            </div>\n\n            <div className=\"grid-2\" style={{ marginTop: 10 }}>\n              <div>\n                <label className=\"label\">Language</label>\n                <input className=\"input\" placeholder=\"English\" value={bookForm.language} onChange={onBookChange('language')} />\n              </div>\n              <div>\n                <label className=\"label\">ISBN</label>\n                <input className=\"input\" placeholder=\"978-0-123456-78-9\" value={bookForm.isbn} onChange={onBookChange('isbn')} />\n              </div>\n            </div>\n\n            <div className=\"grid-2\" style={{ marginTop: 10 }}>\n              <div>\n                <label className=\"label\">Pages</label>\n                <input className=\"input\" type=\"number\" placeholder=\"Number of pages\" value={bookForm.pages} onChange={onBookChange('pages')} />\n              </div>\n              <div>\n                <label className=\"label\">Publisher</label>\n                <input className=\"input\" placeholder=\"Publisher name\" value={bookForm.publisher} onChange={onBookChange('publisher')} />\n              </div>\n            </div>\n\n            <div className=\"actions\" style={{ marginTop: 12 }}>\n              <button className=\"btn primary\" disabled={busy} onClick={submitBook}>{busy ? 'Uploading...' : 'Upload Book'}</button>\n            </div>\n          </div>\n        </div>\n      )}\n\n      {/* Campus Tab */}\n      {activeTab === 'campus' && (\n        <div className=\"grid-2\">\n          <div className=\"panel\">\n            <label className=\"label\">University Cover Images (Multiple)</label>\n            <input \n              type=\"file\"\n              accept=\"image/*\"\n              multiple\n              onChange={(e) => setCampusImages(Array.from(e.target.files))}\n              style={{ marginBottom: '10px' }}\n              className=\"input\"\n            />\n            {campusImages.length > 0 && (\n            <div style={{ marginTop: '10px', color: '#00a884' }}>\n               {campusImages.length} image(s) selected\n              <button \n                onClick={() => setCampusImages([])}\n                style={{ marginLeft: '10px', color: '#dc2626', background: 'none', border: 'none', cursor: 'pointer' }}\n              >\n                <FiX /> Clear\n              </button>\n            </div>\n          )}\n            <div style={{ display: 'grid', gridTemplateColumns: 'repeat(2, 1fr)', gap: '4px', marginTop: '6px' }}>\n            {campusImages.map((img, idx) => (\n              <div key={idx} style={{ position: 'relative', border: '2px solid #374151', borderRadius: '8px', overflow: 'hidden' }}>\n                <img src={URL.createObjectURL(img)} alt={`Preview ${idx + 1}`} style={{ width: '100%', height: '120px', objectFit: 'cover' }} />\n                {/* Remove (X) button */}\n                <button\n                  aria-label=\"Remove image\"\n                  title=\"Remove\"\n                  onClick={() => setCampusImages((prev) => prev.filter((_, i) => i !== idx))}\n                  style={{\n                    position: 'absolute',\n                    top: '6px',\n                    left: '6px',\n                    width: '20px',\n                    height: '20px',\n                    padding: '2px',\n                    borderRadius: '6px',\n                    fontWeight: 'bold',\n                    border: 'none',\n                    cursor: 'pointer',\n                    background: '#a08f8f96',\n                    color: '#111010ff',\n                    display: 'flex',\n                    alignItems: 'center',\n                    justifyContent: 'center',\n                    boxShadow: '0 2px 6px rgba(0,0,0,0.4)'\n                  }}\n                >X\n                  {/* <FiX size={36} /> */}\n                </button>\n                <div style={{ position: 'absolute', top: '4px', right: '4px', background: 'rgba(0,0,0,0.7)', padding: '4px 8px', borderRadius: '4px', color: 'white', fontSize: '12px' }}>\n                  {idx === 0 ? 'Primary' : `#${idx + 1}`}\n                </div>\n              </div>\n            ))}\n          </div>\n          </div>\n          <div className=\"panel\">\n            <label className=\"label\">University Name *</label>\n            <div style={{ position: 'relative' }}>\n              <input \n                className=\"input\" \n                placeholder=\"e.g., University of Nairobi\" \n                value={campusForm.name} \n                onChange={onCampusChange('name')}\n                style={{ paddingRight: '80px' }}\n              />\n              <button \n                onClick={() => handleAutoFill()}\n                disabled={!campusForm.name || isAutoFilling}\n                style={{\n                  position: 'absolute',\n                  right: '8px',\n                  top: '50%',\n                  transform: 'translateY(-50%)',\n                  background: '#00a884',\n                  color: 'white',\n                  border: 'none',\n                  padding: '6px 12px',\n                  borderRadius: '4px',\n                  cursor: campusForm.name && !isAutoFilling ? 'pointer' : 'not-allowed',\n                  fontSize: '12px',\n                  opacity: campusForm.name && !isAutoFilling ? 1 : 0.5,\n                  display: 'flex',\n                  alignItems: 'center',\n                  gap: '4px'\n                }}\n              >\n                {isAutoFilling ? <><FiLoader className=\"spin\" /> Loading</> : <><FiSearch /> Auto-Fill</>}\n              </button>\n              \n              {/* Search Results Dropdown */}\n              {showSearchResults && searchResults.length > 0 && (\n                <div style={{\n                  position: 'absolute',\n                  top: '100%',\n                  left: 0,\n                  right: 0,\n                  background: '#202c33',\n                  border: '1px solid #374151',\n                  borderRadius: '8px',\n                  marginTop: '4px',\n                  maxHeight: '200px',\n                  overflowY: 'auto',\n                  zIndex: 1000,\n                  boxShadow: '0 4px 6px rgba(0,0,0,0.3)'\n                }}>\n                  {searchResults.map((result, idx) => (\n                    <div\n                      key={idx}\n                      onClick={() => handleAutoFill(result.university_name)}\n                      style={{\n                        padding: '10px',\n                        cursor: 'pointer',\n                        borderBottom: idx < searchResults.length - 1 ? '1px solid #374151' : 'none',\n                        transition: 'background 0.2s'\n                      }}\n                      onMouseEnter={(e) => e.target.style.background = 'rgba(0, 168, 132, 0.1)'}\n                      onMouseLeave={(e) => e.target.style.background = 'transparent'}\n                    >\n                      {result.university_name}\n                    </div>\n                  ))}\n                </div>\n              )}\n            </div>\n            \n            <label className=\"label\" style={{ marginTop: 10 }}>Description</label>\n            <textarea className=\"input\" rows={4} placeholder=\"Brief description about the university\" value={campusForm.description} onChange={onCampusChange('description')} />\n\n            <div className=\"grid-2\" style={{ marginTop: 10 }}>\n              <div>\n                <label className=\"label\">Location</label>\n                <input className=\"input\" placeholder=\"e.g., Nairobi\" value={campusForm.location} onChange={onCampusChange('location')} />\n              </div>\n              <div>\n                <label className=\"label\">Website URL</label>\n                <input className=\"input\" placeholder=\"https://...\" value={campusForm.website_url} onChange={onCampusChange('website_url')} />\n              </div>\n            </div>\n\n            <div className=\"grid-2\" style={{ marginTop: 10 }}>\n              <div>\n                <label className=\"label\">Established Year</label>\n                <input className=\"input\" type=\"number\" placeholder=\"e.g., 1956\" value={campusForm.established} onChange={onCampusChange('established')} />\n              </div>\n              <div>\n                <label className=\"label\">Student Count</label>\n                <input className=\"input\" type=\"number\" placeholder=\"e.g., 84000\" value={campusForm.student_count} onChange={onCampusChange('student_count')} />\n              </div>\n            </div>\n\n            <div className=\"actions\" style={{ marginTop: 12 }}>\n              <button className=\"btn primary\" disabled={busy} onClick={submitCampus}>{busy ? 'Adding...' : 'Add University'}</button>\n            </div>\n          </div>\n        </div>\n      )}\n\n      {/* Past Papers Tab */}\n      {activeTab === 'pastpapers' && (\n        <div className=\"grid-2\">\n          <div className=\"panel\">\n            <label className=\"label\">Past Paper PDF *</label>\n            {renderDropzone(paperPdf, setPaperPdf, 'application/pdf', 'paper-pdf', <FiFile size={24} />)}\n          </div>\n          <div className=\"panel\">\n            <label className=\"label\">University *</label>\n            <select className=\"select\" value={paperForm.university_id} onChange={onPaperChange('university_id')}>\n              <option value=\"\">Select University</option>\n              {universities.map(u => <option key={u.id} value={u.id}>{u.name}</option>)}\n            </select>\n\n            <label className=\"label\" style={{ marginTop: 10 }}>Faculty *</label>\n            <input className=\"input\" placeholder=\"e.g., Engineering, Business, Arts\" value={paperForm.faculty} onChange={onPaperChange('faculty')} />\n\n            <div className=\"grid-2\" style={{ marginTop: 10 }}>\n              <div>\n                <label className=\"label\">Unit Name *</label>\n                <input className=\"input\" placeholder=\"e.g., Introduction to Programming\" value={paperForm.unit_name} onChange={onPaperChange('unit_name')} />\n              </div>\n              <div>\n                <label className=\"label\">Unit Code *</label>\n                <input className=\"input\" placeholder=\"e.g., CS101\" value={paperForm.unit_code} onChange={onPaperChange('unit_code')} />\n              </div>\n            </div>\n\n            <div className=\"grid-2\" style={{ marginTop: 10 }}>\n              <div>\n                <label className=\"label\">Year *</label>\n                <input className=\"input\" type=\"number\" placeholder=\"e.g., 2023\" value={paperForm.year} onChange={onPaperChange('year')} />\n              </div>\n              <div>\n                <label className=\"label\">Semester</label>\n                <select className=\"select\" value={paperForm.semester} onChange={onPaperChange('semester')}>\n                  <option value=\"\">Select Semester</option>\n                  <option value=\"1\">Semester 1</option>\n                  <option value=\"2\">Semester 2</option>\n                  <option value=\"3\">Semester 3</option>\n                </select>\n              </div>\n            </div>\n\n            <label className=\"label\" style={{ marginTop: 10 }}>Exam Type</label>\n            <select className=\"select\" value={paperForm.exam_type} onChange={onPaperChange('exam_type')}>\n              <option value=\"Main\">Main Exam</option>\n              <option value=\"Supplementary\">Supplementary</option>\n              <option value=\"CAT\">CAT</option>\n              <option value=\"Mock\">Mock Exam</option>\n            </select>\n\n            <div className=\"actions\" style={{ marginTop: 12 }}>\n              <button className=\"btn primary\" disabled={busy} onClick={submitPastPaper}>{busy ? 'Uploading...' : 'Upload Past Paper'}</button>\n            </div>\n          </div>\n        </div>\n      )}\n    </div>\n  );\n};\n\nexport default Upload;"],"names":["USE_BACKEND_PROXY","async","searchUniversityNames","query","limit","arguments","length","undefined","data","error","supabase","rpc","p_query","p_limit","wikiResults","searchUrl","concat","encodeURIComponent","response","fetch","ok","json","titles","descriptions","urls","filter","title","toLowerCase","includes","map","index","name","description","website_url","console","searchWikipediaUniversities","Promise","all","uni","cacheUniversityPrefillData","API_URL","universities","proxyError","warn","message","fetchWikimediaImages","universityName","_listJson$query","_pages$","_infoJson$query","trim","replace","listUrl","listRes","listJson","images","pages","Object","values","fileTitles","img","Boolean","slice","join","infoUrl","infoRes","infoJson","p","_p$imageinfo","_p$imageinfo$","imageinfo","url","u","test","sort","a","b","deprioritize","s","e","fetchUnsplashImages","_data$images","downloadImageAsFile","imageUrl","fileName","Error","blob","File","type","source","from","upsert","university_name","updated_at","Date","toISOString","autoFillUniversityData","p_university_name","getUniversityPrefillData","wikiSummary","_json$thumbnail","res","extract","location","established","student_count","cover_images","thumbnail","fetchUniversityDataFromWikipedia","wikidata","_binding$website","_binding$locationLabe","_binding$established","_binding$studentCount","sparqlQuery","binding","results","bindings","itemLabel","value","website","locationLabel","getFullYear","studentCount","fetchUniversityDataFromWikidata","_ref","_wikidata$established","_wikidata$student_cou","university","image","fetchUniversityDataFromGoogle","commons","unsplash","userProfile","initialTab","useEffect","styleTag","document","createElement","innerHTML","head","appendChild","remove","activeTab","setActiveTab","useState","navigate","useNavigate","showToast","useAdminUI","pdf","setPdf","cover","setCover","categories","setCategories","bookForm","setBookForm","author","category_id","year","language","isbn","publisher","campusImages","setCampusImages","campusForm","setCampusForm","searchQuery","setSearchQuery","searchResults","setSearchResults","showSearchResults","setShowSearchResults","isAutoFilling","setIsAutoFilling","paperPdf","setPaperPdf","setUniversities","paperForm","setPaperForm","university_id","faculty","unit_code","unit_name","semester","exam_type","busy","setBusy","extractingCover","setExtractingCover","fetchCategories","getUniversitiesForDropdown","_unused","pdfjsLib","workerSrc","arrayBuffer","pdfDoc","promise","numPages","page","getPage","viewport","getViewport","scale","canvas","width","height","context","getContext","render","canvasContext","toBlob","coverFile","extractCoverFromPDF","onBookChange","k","f","_objectSpread","target","onCampusChange","debouncedSearch","callback","delay","timeoutRef","useRef","useCallback","_len","args","Array","_key","current","clearTimeout","setTimeout","useDebounce","handleAutoFill","_data$established","_data$student_count","toString","downloadedImages","i","Math","min","imageFile","push","err","file","onPaperChange","renderDropzone","setFile","accept","fileType","icon","_jsxs","className","onDragOver","preventDefault","currentTarget","classList","add","onDragLeave","onDrop","droppedFile","dataTransfer","files","match","onClick","getElementById","click","style","border","borderRadius","padding","textAlign","cursor","background","transition","children","_jsx","id","onChange","_e$target$files","display","alignItems","justifyContent","gap","color","FiUpload","size","marginBottom","fontSize","marginTop","FiBook","FiMapPin","FiFileText","FiFile","marginLeft","FiImage","placeholder","rows","c","disabled","_pdf$name","metadata","Number","uploaded_by","role","createBook","pdfFile","createBookSubmission","multiple","FiX","gridTemplateColumns","idx","position","overflow","src","URL","createObjectURL","alt","objectFit","prev","_","top","left","fontWeight","boxShadow","right","paddingRight","transform","opacity","_Fragment","FiLoader","FiSearch","maxHeight","overflowY","zIndex","result","borderBottom","onMouseEnter","onMouseLeave","primaryImage","createUniversitySubmission","log","JSON","stringify","isAdmin","createPastPaper","createPastPaperSubmission","catch"],"ignoreList":[],"sourceRoot":""}