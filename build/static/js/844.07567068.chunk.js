"use strict";(self.webpackChunkcampuslife=self.webpackChunkcampuslife||[]).push([[844],{2844:(e,t,o)=>{o.r(t),o.d(t,{default:()=>d});var n=o(5043),r=o(5200),i=o(3515),s=o(7397),l=o(9101),a=o(579);const d=e=>{let{userProfile:t,asSubmission:o=!1}=e;const[d,c]=(0,n.useState)([]),[p,x]=(0,n.useState)(!1),[f,g]=(0,n.useState)({current:0,total:0}),[u,h]=(0,n.useState)(0),[m,y]=(0,n.useState)(0),[v,j]=(0,n.useState)(0),[b,w]=(0,n.useState)(null),[S,k]=(0,n.useState)(!1),[F,z]=(0,n.useState)([]),B=(0,n.useRef)(null),{showToast:C}=(0,l.v)();(0,n.useEffect)(()=>{s.EA.workerSrc||(s.EA.workerSrc="//cdnjs.cloudflare.com/ajax/libs/pdf.js/".concat(s.rE,"/pdf.worker.min.js")),(0,i.jE)().then(e=>z(e||[]))},[]);const D=function(e){w({message:e,type:arguments.length>1&&void 0!==arguments[1]?arguments[1]:"info"}),setTimeout(()=>w(null),4e3)},P=async e=>{try{const t=await e.arrayBuffer(),o=await s.YE({data:t}).promise;if(o.numPages>0){const t=await o.getPage(1),n=t.getViewport({scale:2}),r=document.createElement("canvas");r.width=n.width,r.height=n.height;const i=r.getContext("2d");return await t.render({canvasContext:i,viewport:n}).promise,new Promise(t=>{r.toBlob(o=>{if(o){const n=new File([o],"".concat(e.name.replace(".pdf",""),"_cover.png"),{type:"image/png"});t(n)}else t(null)},"image/png",.95)})}}catch(t){console.error("Error extracting cover:",t)}return null},W=e=>{const t=e.replace(".pdf","").trim();return{title:t.length>3?t:"",author:"",description:"",category_id:null,year:null,language:"English",isbn:"",pages:0,publisher:""}},E=f.total>0?f.current/f.total*100:0,R=d.reduce((e,t)=>e+t.size,0)/1024/1024;return(0,a.jsxs)("div",{className:"panel",children:[(0,a.jsxs)("div",{style:{marginBottom:"20px"},children:[(0,a.jsx)("h2",{style:{color:"#e9edef",fontSize:"20px",fontWeight:"600",margin:"0 0 8px 0"},children:"Bulk Upload from Folder"}),(0,a.jsx)("p",{style:{color:"#8696a0",fontSize:"13px",margin:"0"},children:"Select a folder to upload multiple PDF files at once"})]}),o&&(0,a.jsx)("div",{style:{marginBottom:"15px",padding:"10px 12px",background:"#1f2c33",border:"1px solid #00a884",borderRadius:"6px",color:"#00a884",fontSize:"12px"},children:"\ud83d\udccb Your uploads will be reviewed and appear after approval"}),0===d.length?(0,a.jsxs)("div",{onDragOver:e=>{e.preventDefault(),e.stopPropagation(),k(!0)},onDragLeave:e=>{e.preventDefault(),e.stopPropagation(),k(!1)},onDrop:e=>{e.preventDefault(),e.stopPropagation(),k(!1);const t=e.dataTransfer.items,o=[];if(t)for(let n=0;n<t.length;n++){const e=t[n];if("file"===e.kind){const t=e.getAsFile();t.name.toLowerCase().endsWith(".pdf")&&o.push(t)}}0!==o.length?(c(o),D("Found ".concat(o.length," PDF files"),"success")):D("No PDF files found","error")},onClick:()=>{var e;return null===(e=B.current)||void 0===e?void 0:e.click()},style:{border:"2px dashed ".concat(S?"#00a884":"#374151"),borderRadius:"8px",padding:"40px 20px",textAlign:"center",cursor:"pointer",background:S?"rgba(0, 168, 132, 0.08)":"#0b141a",transition:"all 0.2s"},children:[(0,a.jsx)(r.UDU,{size:40,style:{color:"#00a884",marginBottom:"12px"}}),(0,a.jsx)("h3",{style:{color:"#e9edef",fontSize:"16px",fontWeight:"500",margin:"0 0 4px 0"},children:"Select Folder or Drag & Drop"}),(0,a.jsx)("p",{style:{color:"#8696a0",fontSize:"13px",margin:"0"},children:"Choose a folder with PDF files"}),(0,a.jsx)("input",{ref:B,type:"file",webkitdirectory:"true",directory:"",multiple:!0,onChange:e=>{const t=Array.from(e.target.files||[]).filter(e=>e.name.toLowerCase().endsWith(".pdf"));0!==t.length?(c(t),D("Found ".concat(t.length," PDF files"),"success")):D("No PDF files found in selected folder","error")},style:{display:"none"},accept:".pdf"})]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{style:{background:"#0b141a",border:"1px solid #1f2c33",borderRadius:"8px",marginBottom:"20px",overflow:"hidden"},children:[(0,a.jsx)("div",{style:{padding:"12px 16px",borderBottom:"1px solid #1f2c33",background:"#0b141a"},children:(0,a.jsxs)("div",{style:{color:"#e9edef",fontSize:"13px",fontWeight:"500"},children:["Files (",d.length,") \u2022 ",R.toFixed(1)," MB"]})}),(0,a.jsx)("div",{style:{maxHeight:"250px",overflowY:"auto"},children:d.map((e,t)=>(0,a.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"10px",padding:"10px 16px",borderBottom:t<d.length-1?"1px solid #1f2c33":"none",color:"#8696a0",fontSize:"12px"},children:[(0,a.jsx)(r.QuH,{size:14,style:{color:"#00a884",flexShrink:0}}),(0,a.jsx)("span",{style:{flex:1,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:e.name}),(0,a.jsxs)("span",{style:{color:"#8696a0",fontSize:"11px",flexShrink:0},children:[(e.size/1024/1024).toFixed(1)," MB"]})]},t))})]}),p&&(0,a.jsxs)("div",{style:{marginBottom:"20px"},children:[(0,a.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"8px",color:"#8696a0",fontSize:"12px"},children:[(0,a.jsxs)("span",{children:["Progress: ",f.current," / ",f.total]}),(0,a.jsxs)("span",{children:["\u2713 ",u," | \u2717 ",m]})]}),(0,a.jsx)("div",{style:{width:"100%",height:"6px",background:"#1f2c33",borderRadius:"3px",overflow:"hidden"},children:(0,a.jsx)("div",{style:{width:"".concat(E,"%"),height:"100%",background:"#00a884",transition:"width 0.3s"}})})]}),(0,a.jsxs)("div",{style:{display:"flex",gap:"10px"},children:[(0,a.jsx)("button",{onClick:async()=>{if(0===d.length)return void D("No files selected","error");x(!0),g({current:0,total:d.length}),h(0),y(0),j(0);let e=0,o=0;for(let s=0;s<d.length;s++){const n=d[s];g({current:s+1,total:d.length});try{const o=await P(n),r=W(n.name);"admin"===(null===t||void 0===t?void 0:t.role)||"editor"===(null===t||void 0===t?void 0:t.role)?await(0,i.iC)({metadata:r,pdfFile:n,coverFile:o}):await(0,i.WI)({metadata:r,pdfFile:n,coverFile:o}),e++,h(e)}catch(r){console.error("Failed to upload ".concat(n.name,":"),r),o++,y(o)}}x(!1);const n="Upload complete: ".concat(e," successful, ").concat(o," failed");D(n,0===o?"success":"info"),setTimeout(()=>{c([]),g({current:0,total:0})},2e3)},disabled:p,style:{flex:1,padding:"10px 16px",background:p?"#00a88466":"#00a884",color:"#fff",border:"none",borderRadius:"6px",fontSize:"13px",fontWeight:"500",cursor:p?"not-allowed":"pointer",display:"flex",alignItems:"center",justifyContent:"center",gap:"8px",opacity:p?.6:1},children:p?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(r.jTZ,{style:{animation:"spin 1s linear infinite"}}),"Uploading..."]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(r.B88,{size:14}),"Upload ",d.length," File",1!==d.length?"s":""]})}),(0,a.jsxs)("button",{onClick:()=>{c([]),g({current:0,total:0}),h(0),y(0),j(0),B.current&&(B.current.value="")},disabled:p,style:{padding:"10px 16px",background:"#1f2c33",color:"#8696a0",border:"1px solid #374151",borderRadius:"6px",fontSize:"13px",fontWeight:"500",cursor:p?"not-allowed":"pointer",display:"flex",alignItems:"center",gap:"6px",opacity:p?.5:1},children:[(0,a.jsx)(r.yGN,{size:14}),"Clear"]})]})]}),(u>0||m>0)&&!p&&(0,a.jsxs)("div",{style:{marginTop:"20px",padding:"16px",background:"#0b141a",border:"1px solid ".concat(0===m?"#00a884":"#f1b233"),borderRadius:"8px"},children:[(0,a.jsx)("div",{style:{color:"#e9edef",fontSize:"13px",fontWeight:"500",marginBottom:"12px"},children:"Upload Complete"}),(0,a.jsxs)("div",{style:{display:"flex",gap:"16px"},children:[(0,a.jsxs)("div",{style:{textAlign:"center"},children:[(0,a.jsx)("div",{style:{color:"#00a884",fontSize:"20px",fontWeight:"600",marginBottom:"2px"},children:u}),(0,a.jsx)("div",{style:{color:"#8696a0",fontSize:"11px"},children:"Uploaded"})]}),m>0&&(0,a.jsxs)("div",{style:{textAlign:"center"},children:[(0,a.jsx)("div",{style:{color:"#ea4335",fontSize:"20px",fontWeight:"600",marginBottom:"2px"},children:m}),(0,a.jsx)("div",{style:{color:"#8696a0",fontSize:"11px"},children:"Failed"})]})]})]}),b&&(0,a.jsxs)("div",{style:{position:"fixed",bottom:"20px",right:"20px",maxWidth:"300px",width:"calc(100% - 40px)",background:"error"===b.type?"#ea4335":"success"===b.type?"#00a884":"#374151",color:"#fff",padding:"12px 16px",borderRadius:"6px",zIndex:1e4,boxShadow:"0 4px 12px rgba(0, 0, 0, 0.3)",display:"flex",alignItems:"center",gap:"8px",fontSize:"13px",animation:"slideIn 0.3s ease"},children:["success"===b.type?"\u2713":"error"===b.type?"\u2717":"\u2139"," ",b.message]}),(0,a.jsx)("style",{children:"\n        @keyframes spin {\n          from { transform: rotate(0deg); }\n          to { transform: rotate(360deg); }\n        }\n        @keyframes slideIn {\n          from {\n            transform: translateY(20px);\n            opacity: 0;\n          }\n          to {\n            transform: translateY(0);\n            opacity: 1;\n          }\n        }\n      "})]})}}}]);
//# sourceMappingURL=844.07567068.chunk.js.map