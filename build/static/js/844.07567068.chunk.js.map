{"version":3,"file":"static/js/844.07567068.chunk.js","mappings":"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","sources":["SomaLux/Books/Admin/pages/AutoUpload.jsx"],"sourcesContent":["import React, { useState, useRef, useEffect } from 'react';\r\nimport { FiUpload, FiFolder, FiRefreshCw, FiCheck, FiX, FiAlertCircle, FiFile } from 'react-icons/fi';\r\nimport { createBook, createBookSubmission, fetchCategories } from '../api';\r\nimport * as pdfjsLib from 'pdfjs-dist';\r\nimport { useAdminUI } from '../AdminUIContext';\r\n\r\nconst AutoUpload = ({ userProfile, asSubmission = false }) => {\r\n  const [selectedFiles, setSelectedFiles] = useState([]);\r\n  const [uploading, setUploading] = useState(false);\r\n  const [uploadProgress, setUploadProgress] = useState({ current: 0, total: 0 });\r\n  const [uploadedCount, setUploadedCount] = useState(0);\r\n  const [failedCount, setFailedCount] = useState(0);\r\n  const [skippedCount, setSkippedCount] = useState(0);\r\n  const [toast, setToast] = useState(null);\r\n  const [dragOver, setDragOver] = useState(false);\r\n  const [categories, setCategories] = useState([]);\r\n  const folderInputRef = useRef(null);\r\n  const { showToast: uiShowToast } = useAdminUI();\r\n\r\n  useEffect(() => {\r\n    // Configure PDF.js worker\r\n    if (!pdfjsLib.GlobalWorkerOptions.workerSrc) {\r\n      pdfjsLib.GlobalWorkerOptions.workerSrc = `//cdnjs.cloudflare.com/ajax/libs/pdf.js/${pdfjsLib.version}/pdf.worker.min.js`;\r\n    }\r\n    // Fetch categories\r\n    fetchCategories().then(cats => setCategories(cats || []));\r\n  }, []);\r\n\r\n  const showToast = (message, type = 'info') => {\r\n    setToast({ message, type });\r\n    setTimeout(() => setToast(null), 4000);\r\n  };\r\n\r\n  const extractCoverFromPDF = async (pdfFile) => {\r\n    try {\r\n      const arrayBuffer = await pdfFile.arrayBuffer();\r\n      const pdfDoc = await pdfjsLib.getDocument({ data: arrayBuffer }).promise;\r\n      \r\n      if (pdfDoc.numPages > 0) {\r\n        const page = await pdfDoc.getPage(1);\r\n        const viewport = page.getViewport({ scale: 2 });\r\n        const canvas = document.createElement('canvas');\r\n        canvas.width = viewport.width;\r\n        canvas.height = viewport.height;\r\n        \r\n        const context = canvas.getContext('2d');\r\n        await page.render({ canvasContext: context, viewport }).promise;\r\n        \r\n        return new Promise((resolve) => {\r\n          canvas.toBlob((blob) => {\r\n            if (blob) {\r\n              const coverFile = new File([blob], `${pdfFile.name.replace('.pdf', '')}_cover.png`, { type: 'image/png' });\r\n              resolve(coverFile);\r\n            } else {\r\n              resolve(null);\r\n            }\r\n          }, 'image/png', 0.95);\r\n        });\r\n      }\r\n    } catch (error) {\r\n      console.error('Error extracting cover:', error);\r\n    }\r\n    return null;\r\n  };\r\n\r\n  const extractBasicMetadataFromName = (fileName) => {\r\n    // Try to extract title from filename\r\n    const name = fileName.replace('.pdf', '').trim();\r\n    return {\r\n      title: name.length > 3 ? name : '',\r\n      author: '',\r\n      description: '',\r\n      category_id: null,\r\n      year: null,\r\n      language: 'English',\r\n      isbn: '',\r\n      pages: 0,\r\n      publisher: ''\r\n    };\r\n  };\r\n\r\n  const handleFolderSelect = (event) => {\r\n    const files = Array.from(event.target.files || []);\r\n    const pdfFiles = files.filter(f => f.name.toLowerCase().endsWith('.pdf'));\r\n    \r\n    if (pdfFiles.length === 0) {\r\n      showToast('No PDF files found in selected folder', 'error');\r\n      return;\r\n    }\r\n\r\n    setSelectedFiles(pdfFiles);\r\n    showToast(`Found ${pdfFiles.length} PDF files`, 'success');\r\n  };\r\n\r\n  const handleDragOver = (e) => {\r\n    e.preventDefault();\r\n    e.stopPropagation();\r\n    setDragOver(true);\r\n  };\r\n\r\n  const handleDragLeave = (e) => {\r\n    e.preventDefault();\r\n    e.stopPropagation();\r\n    setDragOver(false);\r\n  };\r\n\r\n  const handleDrop = (e) => {\r\n    e.preventDefault();\r\n    e.stopPropagation();\r\n    setDragOver(false);\r\n\r\n    // Handle dropped files/folders\r\n    const items = e.dataTransfer.items;\r\n    const files = [];\r\n\r\n    if (items) {\r\n      for (let i = 0; i < items.length; i++) {\r\n        const item = items[i];\r\n        if (item.kind === 'file') {\r\n          const file = item.getAsFile();\r\n          if (file.name.toLowerCase().endsWith('.pdf')) {\r\n            files.push(file);\r\n          }\r\n        }\r\n      }\r\n    }\r\n\r\n    if (files.length === 0) {\r\n      showToast('No PDF files found', 'error');\r\n      return;\r\n    }\r\n\r\n    setSelectedFiles(files);\r\n    showToast(`Found ${files.length} PDF files`, 'success');\r\n  };\r\n\r\n  const uploadFiles = async () => {\r\n    if (selectedFiles.length === 0) {\r\n      showToast('No files selected', 'error');\r\n      return;\r\n    }\r\n\r\n    setUploading(true);\r\n    setUploadProgress({ current: 0, total: selectedFiles.length });\r\n    setUploadedCount(0);\r\n    setFailedCount(0);\r\n    setSkippedCount(0);\r\n\r\n    let uploaded = 0;\r\n    let failed = 0;\r\n    let skipped = 0;\r\n\r\n    for (let i = 0; i < selectedFiles.length; i++) {\r\n      const file = selectedFiles[i];\r\n      setUploadProgress({ current: i + 1, total: selectedFiles.length });\r\n\r\n      try {\r\n        // Extract cover\r\n        const cover = await extractCoverFromPDF(file);\r\n\r\n        // Extract basic metadata from filename\r\n        const metadata = extractBasicMetadataFromName(file.name);\r\n\r\n        // Determine if user is admin\r\n        const isAdmin = userProfile?.role === 'admin' || userProfile?.role === 'editor';\r\n\r\n        // Upload\r\n        if (isAdmin) {\r\n          await createBook({ metadata, pdfFile: file, coverFile: cover });\r\n        } else {\r\n          await createBookSubmission({ metadata, pdfFile: file, coverFile: cover });\r\n        }\r\n\r\n        uploaded++;\r\n        setUploadedCount(uploaded);\r\n      } catch (error) {\r\n        console.error(`Failed to upload ${file.name}:`, error);\r\n        failed++;\r\n        setFailedCount(failed);\r\n      }\r\n    }\r\n\r\n    setUploading(false);\r\n    const message = `Upload complete: ${uploaded} successful, ${failed} failed`;\r\n    showToast(message, failed === 0 ? 'success' : 'info');\r\n    \r\n    // Clear selected files after upload\r\n    setTimeout(() => {\r\n      setSelectedFiles([]);\r\n      setUploadProgress({ current: 0, total: 0 });\r\n    }, 2000);\r\n  };\r\n\r\n  const clearSelection = () => {\r\n    setSelectedFiles([]);\r\n    setUploadProgress({ current: 0, total: 0 });\r\n    setUploadedCount(0);\r\n    setFailedCount(0);\r\n    setSkippedCount(0);\r\n    if (folderInputRef.current) {\r\n      folderInputRef.current.value = '';\r\n    }\r\n  };\r\n\r\n  const progressPercent = uploadProgress.total > 0 ? (uploadProgress.current / uploadProgress.total) * 100 : 0;\r\n  const totalSize = selectedFiles.reduce((sum, f) => sum + f.size, 0) / 1024 / 1024;\r\n\r\n  return (\r\n    <div className=\"panel\">\r\n      {/* Header */}\r\n      <div style={{ marginBottom: '20px' }}>\r\n        <h2 style={{ color: '#e9edef', fontSize: '20px', fontWeight: '600', margin: '0 0 8px 0' }}>\r\n          Bulk Upload from Folder\r\n        </h2>\r\n        <p style={{ color: '#8696a0', fontSize: '13px', margin: '0' }}>\r\n          Select a folder to upload multiple PDF files at once\r\n        </p>\r\n      </div>\r\n\r\n      {asSubmission && (\r\n        <div style={{\r\n          marginBottom: '15px',\r\n          padding: '10px 12px',\r\n          background: '#1f2c33',\r\n          border: '1px solid #00a884',\r\n          borderRadius: '6px',\r\n          color: '#00a884',\r\n          fontSize: '12px'\r\n        }}>\r\n          ðŸ“‹ Your uploads will be reviewed and appear after approval\r\n        </div>\r\n      )}\r\n\r\n      {/* Main Content */}\r\n      {selectedFiles.length === 0 ? (\r\n        // Upload Area\r\n        <div\r\n          onDragOver={handleDragOver}\r\n          onDragLeave={handleDragLeave}\r\n          onDrop={handleDrop}\r\n          onClick={() => folderInputRef.current?.click()}\r\n          style={{\r\n            border: `2px dashed ${dragOver ? '#00a884' : '#374151'}`,\r\n            borderRadius: '8px',\r\n            padding: '40px 20px',\r\n            textAlign: 'center',\r\n            cursor: 'pointer',\r\n            background: dragOver ? 'rgba(0, 168, 132, 0.08)' : '#0b141a',\r\n            transition: 'all 0.2s'\r\n          }}\r\n        >\r\n          <FiFolder size={40} style={{ color: '#00a884', marginBottom: '12px' }} />\r\n          <h3 style={{ color: '#e9edef', fontSize: '16px', fontWeight: '500', margin: '0 0 4px 0' }}>\r\n            Select Folder or Drag & Drop\r\n          </h3>\r\n          <p style={{ color: '#8696a0', fontSize: '13px', margin: '0' }}>\r\n            Choose a folder with PDF files\r\n          </p>\r\n          <input\r\n            ref={folderInputRef}\r\n            type=\"file\"\r\n            webkitdirectory=\"true\"\r\n            directory=\"\"\r\n            multiple\r\n            onChange={handleFolderSelect}\r\n            style={{ display: 'none' }}\r\n            accept=\".pdf\"\r\n          />\r\n        </div>\r\n      ) : (\r\n        <>\r\n          {/* File List */}\r\n          <div style={{\r\n            background: '#0b141a',\r\n            border: '1px solid #1f2c33',\r\n            borderRadius: '8px',\r\n            marginBottom: '20px',\r\n            overflow: 'hidden'\r\n          }}>\r\n            <div style={{\r\n              padding: '12px 16px',\r\n              borderBottom: '1px solid #1f2c33',\r\n              background: '#0b141a'\r\n            }}>\r\n              <div style={{ color: '#e9edef', fontSize: '13px', fontWeight: '500' }}>\r\n                Files ({selectedFiles.length}) â€¢ {totalSize.toFixed(1)} MB\r\n              </div>\r\n            </div>\r\n\r\n            <div style={{\r\n              maxHeight: '250px',\r\n              overflowY: 'auto'\r\n            }}>\r\n              {selectedFiles.map((file, idx) => (\r\n                <div\r\n                  key={idx}\r\n                  style={{\r\n                    display: 'flex',\r\n                    alignItems: 'center',\r\n                    gap: '10px',\r\n                    padding: '10px 16px',\r\n                    borderBottom: idx < selectedFiles.length - 1 ? '1px solid #1f2c33' : 'none',\r\n                    color: '#8696a0',\r\n                    fontSize: '12px'\r\n                  }}\r\n                >\r\n                  <FiFile size={14} style={{ color: '#00a884', flexShrink: 0 }} />\r\n                  <span style={{ flex: 1, overflow: 'hidden', textOverflow: 'ellipsis', whiteSpace: 'nowrap' }}>\r\n                    {file.name}\r\n                  </span>\r\n                  <span style={{ color: '#8696a0', fontSize: '11px', flexShrink: 0 }}>\r\n                    {(file.size / 1024 / 1024).toFixed(1)} MB\r\n                  </span>\r\n                </div>\r\n              ))}\r\n            </div>\r\n          </div>\r\n\r\n          {/* Progress */}\r\n          {uploading && (\r\n            <div style={{ marginBottom: '20px' }}>\r\n              <div style={{\r\n                display: 'flex',\r\n                justifyContent: 'space-between',\r\n                marginBottom: '8px',\r\n                color: '#8696a0',\r\n                fontSize: '12px'\r\n              }}>\r\n                <span>Progress: {uploadProgress.current} / {uploadProgress.total}</span>\r\n                <span>âœ“ {uploadedCount} | âœ— {failedCount}</span>\r\n              </div>\r\n              <div style={{\r\n                width: '100%',\r\n                height: '6px',\r\n                background: '#1f2c33',\r\n                borderRadius: '3px',\r\n                overflow: 'hidden'\r\n              }}>\r\n                <div style={{\r\n                  width: `${progressPercent}%`,\r\n                  height: '100%',\r\n                  background: '#00a884',\r\n                  transition: 'width 0.3s'\r\n                }} />\r\n              </div>\r\n            </div>\r\n          )}\r\n\r\n          {/* Action Buttons */}\r\n          <div style={{ display: 'flex', gap: '10px' }}>\r\n            <button\r\n              onClick={uploadFiles}\r\n              disabled={uploading}\r\n              style={{\r\n                flex: 1,\r\n                padding: '10px 16px',\r\n                background: uploading ? '#00a88466' : '#00a884',\r\n                color: '#fff',\r\n                border: 'none',\r\n                borderRadius: '6px',\r\n                fontSize: '13px',\r\n                fontWeight: '500',\r\n                cursor: uploading ? 'not-allowed' : 'pointer',\r\n                display: 'flex',\r\n                alignItems: 'center',\r\n                justifyContent: 'center',\r\n                gap: '8px',\r\n                opacity: uploading ? 0.6 : 1\r\n              }}\r\n            >\r\n              {uploading ? (\r\n                <>\r\n                  <FiRefreshCw style={{ animation: 'spin 1s linear infinite' }} />\r\n                  Uploading...\r\n                </>\r\n              ) : (\r\n                <>\r\n                  <FiUpload size={14} />\r\n                  Upload {selectedFiles.length} File{selectedFiles.length !== 1 ? 's' : ''}\r\n                </>\r\n              )}\r\n            </button>\r\n            <button\r\n              onClick={clearSelection}\r\n              disabled={uploading}\r\n              style={{\r\n                padding: '10px 16px',\r\n                background: '#1f2c33',\r\n                color: '#8696a0',\r\n                border: '1px solid #374151',\r\n                borderRadius: '6px',\r\n                fontSize: '13px',\r\n                fontWeight: '500',\r\n                cursor: uploading ? 'not-allowed' : 'pointer',\r\n                display: 'flex',\r\n                alignItems: 'center',\r\n                gap: '6px',\r\n                opacity: uploading ? 0.5 : 1\r\n              }}\r\n            >\r\n              <FiX size={14} />\r\n              Clear\r\n            </button>\r\n          </div>\r\n        </>\r\n      )}\r\n\r\n      {/* Results */}\r\n      {(uploadedCount > 0 || failedCount > 0) && !uploading && (\r\n        <div style={{\r\n          marginTop: '20px',\r\n          padding: '16px',\r\n          background: '#0b141a',\r\n          border: `1px solid ${failedCount === 0 ? '#00a884' : '#f1b233'}`,\r\n          borderRadius: '8px'\r\n        }}>\r\n          <div style={{ color: '#e9edef', fontSize: '13px', fontWeight: '500', marginBottom: '12px' }}>\r\n            Upload Complete\r\n          </div>\r\n          <div style={{ display: 'flex', gap: '16px' }}>\r\n            <div style={{ textAlign: 'center' }}>\r\n              <div style={{ color: '#00a884', fontSize: '20px', fontWeight: '600', marginBottom: '2px' }}>\r\n                {uploadedCount}\r\n              </div>\r\n              <div style={{ color: '#8696a0', fontSize: '11px' }}>Uploaded</div>\r\n            </div>\r\n            {failedCount > 0 && (\r\n              <div style={{ textAlign: 'center' }}>\r\n                <div style={{ color: '#ea4335', fontSize: '20px', fontWeight: '600', marginBottom: '2px' }}>\r\n                  {failedCount}\r\n                </div>\r\n                <div style={{ color: '#8696a0', fontSize: '11px' }}>Failed</div>\r\n              </div>\r\n            )}\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      {/* Toast */}\r\n      {toast && (\r\n        <div style={{\r\n          position: 'fixed',\r\n          bottom: '20px',\r\n          right: '20px',\r\n          maxWidth: '300px',\r\n          width: 'calc(100% - 40px)',\r\n          background: toast.type === 'error' ? '#ea4335' : toast.type === 'success' ? '#00a884' : '#374151',\r\n          color: '#fff',\r\n          padding: '12px 16px',\r\n          borderRadius: '6px',\r\n          zIndex: 10000,\r\n          boxShadow: '0 4px 12px rgba(0, 0, 0, 0.3)',\r\n          display: 'flex',\r\n          alignItems: 'center',\r\n          gap: '8px',\r\n          fontSize: '13px',\r\n          animation: 'slideIn 0.3s ease'\r\n        }}>\r\n          {toast.type === 'success' ? 'âœ“' : toast.type === 'error' ? 'âœ—' : 'â„¹'} {toast.message}\r\n        </div>\r\n      )}\r\n\r\n      <style>{`\r\n        @keyframes spin {\r\n          from { transform: rotate(0deg); }\r\n          to { transform: rotate(360deg); }\r\n        }\r\n        @keyframes slideIn {\r\n          from {\r\n            transform: translateY(20px);\r\n            opacity: 0;\r\n          }\r\n          to {\r\n            transform: translateY(0);\r\n            opacity: 1;\r\n          }\r\n        }\r\n      `}</style>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default AutoUpload;\r\n"],"names":["_ref","userProfile","asSubmission","selectedFiles","setSelectedFiles","useState","uploading","setUploading","uploadProgress","setUploadProgress","current","total","uploadedCount","setUploadedCount","failedCount","setFailedCount","skippedCount","setSkippedCount","toast","setToast","dragOver","setDragOver","categories","setCategories","folderInputRef","useRef","showToast","uiShowToast","useAdminUI","useEffect","pdfjsLib","workerSrc","concat","fetchCategories","then","cats","message","type","arguments","length","undefined","setTimeout","extractCoverFromPDF","async","arrayBuffer","pdfFile","pdfDoc","data","promise","numPages","page","getPage","viewport","getViewport","scale","canvas","document","createElement","width","height","context","getContext","render","canvasContext","Promise","resolve","toBlob","blob","coverFile","File","name","replace","error","console","extractBasicMetadataFromName","fileName","trim","title","author","description","category_id","year","language","isbn","pages","publisher","progressPercent","totalSize","reduce","sum","f","size","_jsxs","className","children","style","marginBottom","_jsx","color","fontSize","fontWeight","margin","padding","background","border","borderRadius","onDragOver","e","preventDefault","stopPropagation","onDragLeave","onDrop","items","dataTransfer","files","i","item","kind","file","getAsFile","toLowerCase","endsWith","push","onClick","_folderInputRef$curre","click","textAlign","cursor","transition","FiFolder","ref","webkitdirectory","directory","multiple","onChange","event","pdfFiles","Array","from","target","filter","display","accept","_Fragment","overflow","borderBottom","toFixed","maxHeight","overflowY","map","idx","alignItems","gap","FiFile","flexShrink","flex","textOverflow","whiteSpace","justifyContent","uploaded","failed","cover","metadata","role","createBook","createBookSubmission","disabled","opacity","FiRefreshCw","animation","FiUpload","clearSelection","value","FiX","marginTop","position","bottom","right","maxWidth","zIndex","boxShadow"],"ignoreList":[],"sourceRoot":""}