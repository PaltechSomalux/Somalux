"use strict";(self.webpackChunkcampuslife=self.webpackChunkcampuslife||[]).push([[831],{8831:(e,t,s)=>{s.r(t),s.d(t,{default:()=>n});var l=s(5043),r=s(3515),i=s(9101),o=s(579);const n=e=>{var t,s,n,a,d,c,h,x,g,p,m,y,u,j,b,v,f,k,_,A,C;let{userProfile:w}=e;const[S,B]=(0,l.useState)(!1),[W,N]=(0,l.useState)(null),[z,T]=(0,l.useState)(null),[L,U]=(0,l.useState)(null),[F,R]=(0,l.useState)(null),[M,O]=(0,l.useState)(null),[P,D]=(0,l.useState)(null),{confirm:E,showToast:X}=(0,i.v)(),I="admin"===(null===w||void 0===w?void 0:w.role)||["campuslives254@gmail.com","paltechsomalux@gmail.com"].includes(null===w||void 0===w?void 0:w.email);return I?(0,o.jsxs)("div",{children:[(0,o.jsxs)("div",{className:"panel",children:[(0,o.jsx)("div",{className:"panel-title",children:"\ud83d\udcca Supabase Usage & Billing"}),(0,o.jsx)("div",{style:{marginBottom:"16px"},children:(0,o.jsx)("p",{style:{color:"#8696a0",marginBottom:"12px"},children:"Monitor your Supabase database and storage usage. Note: Billing information refreshes within 1 hour."})}),(0,o.jsx)("div",{className:"actions",style:{marginBottom:"16px"},children:(0,o.jsx)("button",{className:"btn primary",onClick:async()=>{if(I){B(!0);try{const e=await(0,r.U8)();O(e),X({type:"success",message:"Usage report loaded."})}catch(e){console.error("Failed to get usage report:",e),X({type:"error",message:"Failed to load usage report."})}finally{B(!1)}}else X({type:"error",message:"Only admins can access storage management."})},disabled:S,children:S?"Loading...":"Refresh Usage Report"})}),M&&!M.error&&(0,o.jsxs)("div",{style:{marginBottom:"16px"},children:[(0,o.jsx)("h4",{style:{color:"#e9edef",marginBottom:"12px"},children:"\ud83d\udcc8 Database Tables"}),(0,o.jsx)("div",{className:"panel",style:{padding:0,overflowX:"auto"},children:(0,o.jsxs)("table",{className:"table",style:{minWidth:"800px",borderCollapse:"separate",borderSpacing:0},children:[(0,o.jsx)("thead",{children:(0,o.jsxs)("tr",{children:[(0,o.jsx)("th",{style:{width:"200px"},children:"Table Name"}),(0,o.jsx)("th",{style:{width:"120px",textAlign:"right"},children:"Row Count"}),(0,o.jsx)("th",{style:{width:"150px",textAlign:"right"},children:"Est. Size (MB)"})]})}),(0,o.jsx)("tbody",{children:(null===(t=M.database)||void 0===t?void 0:t.tables)&&Object.entries(M.database.tables).map(e=>{let[t,s]=e;return(0,o.jsxs)("tr",{children:[(0,o.jsx)("td",{style:{textTransform:"capitalize"},children:t}),(0,o.jsx)("td",{style:{textAlign:"right",fontWeight:"bold",color:"#00a884"},children:s.rows.toLocaleString()}),(0,o.jsx)("td",{style:{textAlign:"right",color:"#00a884"},children:s.estimated_size_mb})]},t)})})]})})]}),M&&!M.error&&(null===(s=M.storage)||void 0===s?void 0:s.buckets)&&(0,o.jsxs)("div",{children:[(0,o.jsx)("h4",{style:{color:"#e9edef",marginBottom:"12px"},children:"\ud83d\udcbe Storage Buckets"}),(0,o.jsx)("div",{className:"panel",style:{padding:0,overflowX:"auto"},children:(0,o.jsxs)("table",{className:"table",style:{minWidth:"1000px",borderCollapse:"separate",borderSpacing:0},children:[(0,o.jsx)("thead",{children:(0,o.jsxs)("tr",{children:[(0,o.jsx)("th",{style:{width:"200px"},children:"Bucket Name"}),(0,o.jsx)("th",{style:{width:"120px",textAlign:"right"},children:"File Count"}),(0,o.jsx)("th",{style:{width:"120px",textAlign:"right"},children:"Size (GB)"}),(0,o.jsx)("th",{style:{width:"120px",textAlign:"right"},children:"Size (MB)"}),(0,o.jsx)("th",{style:{width:"150px",textAlign:"right"},children:"Size (Bytes)"})]})}),(0,o.jsxs)("tbody",{children:[Object.entries(M.storage.buckets).map(e=>{let[t,s]=e;return(0,o.jsxs)("tr",{children:[(0,o.jsx)("td",{style:{textTransform:"capitalize"},children:t.replace(/_/g," ")}),(0,o.jsx)("td",{style:{textAlign:"right",fontWeight:"bold",color:"#00a884"},children:s.files.toLocaleString()}),(0,o.jsx)("td",{style:{textAlign:"right",fontWeight:"bold",color:"#00a884"},children:s.size_gb}),(0,o.jsx)("td",{style:{textAlign:"right",color:"#8696a0"},children:s.size_mb}),(0,o.jsx)("td",{style:{textAlign:"right",color:"#6b7280",fontSize:"0.9rem"},children:s.size_bytes.toLocaleString()})]},t)}),(0,o.jsxs)("tr",{style:{fontWeight:"bold",backgroundColor:"#0b141a",boxShadow:"inset 0 2px 0 rgba(0, 168, 132, 0.4)"},children:[(0,o.jsx)("td",{style:{color:"#00a884"},children:"TOTAL"}),(0,o.jsx)("td",{style:{textAlign:"right",color:"#00a884"},children:Object.values(M.storage.buckets).reduce((e,t)=>e+t.files,0).toLocaleString()}),(0,o.jsx)("td",{style:{textAlign:"right",color:"#00a884"},children:(null===(n=M.summary)||void 0===n?void 0:n.total_storage_gb)||0}),(0,o.jsx)("td",{style:{textAlign:"right",color:"#00a884"},children:(1024*parseFloat((null===(a=M.summary)||void 0===a?void 0:a.total_storage_gb)||0)).toFixed(2)}),(0,o.jsx)("td",{style:{textAlign:"right",color:"#00a884"},children:(1024*parseFloat((null===(d=M.summary)||void 0===d?void 0:d.total_storage_gb)||0)*1024*1024).toLocaleString()})]})]})]})})]}),(null===M||void 0===M?void 0:M.error)&&(0,o.jsx)("div",{className:"panel",style:{padding:"12px",backgroundColor:"#7f1d1d",borderRadius:"4px"},children:(0,o.jsxs)("div",{style:{color:"#fca5a5"},children:["\u26a0\ufe0f Error: ",M.error]})}),(0,o.jsxs)("div",{className:"panel",children:[(0,o.jsx)("h4",{style:{color:"#e9edef",marginBottom:"12px"},children:"\ud83d\udcb3 Billing Summary"}),(0,o.jsx)("div",{style:{overflowX:"auto",marginBottom:"16px"},children:(0,o.jsxs)("table",{className:"table",style:{minWidth:"900px",borderCollapse:"separate",borderSpacing:0},children:[(0,o.jsx)("thead",{children:(0,o.jsxs)("tr",{children:[(0,o.jsx)("th",{style:{width:"300px"},children:"Metric"}),(0,o.jsx)("th",{style:{width:"300px",textAlign:"right"},children:"Usage"}),(0,o.jsx)("th",{style:{width:"300px",textAlign:"center"},children:"Status"})]})}),(0,o.jsxs)("tbody",{children:[(0,o.jsxs)("tr",{children:[(0,o.jsx)("td",{children:"Database Size"}),(0,o.jsxs)("td",{style:{textAlign:"right",fontWeight:"bold",color:"#00a884"},children:[(null===M||void 0===M||null===(c=M.summary)||void 0===c?void 0:c.total_database_size_gb)||"0"," GB"]}),(0,o.jsx)("td",{style:{textAlign:"center",color:"#a3e635"},children:"\u2713 Tracked"})]}),(0,o.jsxs)("tr",{children:[(0,o.jsx)("td",{children:"Storage Size"}),(0,o.jsxs)("td",{style:{textAlign:"right",fontWeight:"bold",color:"#00a884"},children:[(null===M||void 0===M||null===(h=M.summary)||void 0===h?void 0:h.total_storage_size_gb)||"0"," GB"]}),(0,o.jsx)("td",{style:{textAlign:"center",color:"#a3e635"},children:"\u2713 Tracked"})]}),(0,o.jsxs)("tr",{children:[(0,o.jsx)("td",{children:"Total Combined Size"}),(0,o.jsxs)("td",{style:{textAlign:"right",fontWeight:"bold",color:"#00a884"},children:[(null===M||void 0===M||null===(x=M.summary)||void 0===x?void 0:x.total_combined_size_gb)||"0"," GB"]}),(0,o.jsx)("td",{style:{textAlign:"center",color:"#a3e635"},children:"\u2713 Calculated"})]}),(0,o.jsxs)("tr",{children:[(0,o.jsx)("td",{children:"Total Database Rows"}),(0,o.jsx)("td",{style:{textAlign:"right",fontWeight:"bold",color:"#00a884"},children:((null===M||void 0===M||null===(g=M.summary)||void 0===g?void 0:g.total_rows)||0).toLocaleString()}),(0,o.jsx)("td",{style:{textAlign:"center",color:"#a3e635"},children:"\u2713 Counted"})]}),(0,o.jsxs)("tr",{children:[(0,o.jsx)("td",{children:"Total Files"}),(0,o.jsx)("td",{style:{textAlign:"right",fontWeight:"bold",color:"#00a884"},children:((null===M||void 0===M||null===(p=M.summary)||void 0===p?void 0:p.total_files)||0).toLocaleString()}),(0,o.jsx)("td",{style:{textAlign:"center",color:"#a3e635"},children:"\u2713 Counted"})]}),(0,o.jsxs)("tr",{children:[(0,o.jsx)("td",{children:"Authenticated Users (ALL)"}),(0,o.jsxs)("td",{style:{textAlign:"right",fontWeight:"bold",color:"#00a884"},children:[(null===M||void 0===M||null===(m=M.summary)||void 0===m?void 0:m.authenticated_users)||"0"," users"]}),(0,o.jsx)("td",{style:{textAlign:"center",color:"#a3e635"},children:"\u2713 Comprehensive Count"})]}),(0,o.jsxs)("tr",{children:[(0,o.jsx)("td",{children:"Users with Profiles"}),(0,o.jsxs)("td",{style:{textAlign:"right",fontWeight:"bold",color:"#00a884"},children:[(null===M||void 0===M||null===(y=M.summary)||void 0===y?void 0:y.users_with_profiles)||"0"," users"]}),(0,o.jsx)("td",{style:{textAlign:"center",color:"#a3e635"},children:"\u2713 Tracked"})]}),(0,o.jsxs)("tr",{children:[(0,o.jsx)("td",{children:"Users with Book Uploads"}),(0,o.jsxs)("td",{style:{textAlign:"right",fontWeight:"bold",color:"#00a884"},children:[(null===M||void 0===M||null===(u=M.billing)||void 0===u||null===(j=u.users)||void 0===j?void 0:j.users_with_book_uploads)||"0"," users"]}),(0,o.jsx)("td",{style:{textAlign:"center",color:"#a3e635"},children:"\u2713 Active"})]}),(0,o.jsxs)("tr",{children:[(0,o.jsx)("td",{children:"Users with Paper Uploads"}),(0,o.jsxs)("td",{style:{textAlign:"right",fontWeight:"bold",color:"#00a884"},children:[(null===M||void 0===M||null===(b=M.billing)||void 0===b||null===(v=b.users)||void 0===v?void 0:v.users_with_paper_uploads)||"0"," users"]}),(0,o.jsx)("td",{style:{textAlign:"center",color:"#a3e635"},children:"\u2713 Active"})]}),(null===M||void 0===M||null===(f=M.summary)||void 0===f?void 0:f.users_without_profiles)>0&&(0,o.jsxs)("tr",{children:[(0,o.jsx)("td",{children:"Users Pending Profile Completion"}),(0,o.jsxs)("td",{style:{textAlign:"right",fontWeight:"bold",color:"#f59e0b"},children:[(null===M||void 0===M||null===(k=M.summary)||void 0===k?void 0:k.users_without_profiles)||"0"," users"]}),(0,o.jsx)("td",{style:{textAlign:"center",color:"#f59e0b"},children:"\u26a0\ufe0f Pending"})]}),(0,o.jsxs)("tr",{children:[(0,o.jsx)("td",{children:"Monthly Active Users (30 days)"}),(0,o.jsxs)("td",{style:{textAlign:"right",fontWeight:"bold",color:"#00a884"},children:[(null===M||void 0===M||null===(_=M.summary)||void 0===_?void 0:_.monthly_active_users)||"0"," / 10 MAU"]}),(0,o.jsx)("td",{style:{textAlign:"center",color:(null===M||void 0===M||null===(A=M.summary)||void 0===A?void 0:A.monthly_active_users)>10?"#fca5a5":"#a3e635"},children:(null===M||void 0===M||null===(C=M.summary)||void 0===C?void 0:C.monthly_active_users)>10?"\u26a0\ufe0f Over limit":"\u2713 Within limit"})]})]})]})}),(0,o.jsxs)("div",{style:{padding:"12px",backgroundColor:"#1f2937",borderRadius:"4px",boxShadow:"inset 3px 0 0 rgba(245, 158, 11, 0.3)"},children:[(0,o.jsx)("h5",{style:{color:"#f59e0b",marginBottom:"8px",fontWeight:"600"},children:"\ud83d\udccb User Counting Methodology"}),(0,o.jsxs)("div",{style:{color:"#8696a0",fontSize:"0.85rem",lineHeight:"1.6"},children:[(0,o.jsxs)("div",{style:{marginBottom:"6px"},children:["\u2022 ",(0,o.jsx)("strong",{children:"Authenticated Users (ALL):"})," Total from multiple sources (backend API, profiles, uploaders) - Most comprehensive count"]}),(0,o.jsxs)("div",{style:{marginBottom:"6px"},children:["\u2022 ",(0,o.jsx)("strong",{children:"Users with Profiles:"})," Users who have completed profile setup"]}),(0,o.jsxs)("div",{style:{marginBottom:"6px"},children:["\u2022 ",(0,o.jsx)("strong",{children:"Users with Book Uploads:"})," Users who have uploaded books to your system"]}),(0,o.jsxs)("div",{style:{marginBottom:"6px"},children:["\u2022 ",(0,o.jsx)("strong",{children:"Users with Paper Uploads:"})," Users who have uploaded past papers to your system"]}),(0,o.jsxs)("div",{style:{marginBottom:"6px"},children:["\u2022 ",(0,o.jsx)("strong",{children:"Monthly Active Users:"})," Users with profile updates in the last 30 days"]}),(0,o.jsxs)("div",{style:{marginBottom:"6px"},children:["\u2022 ",(0,o.jsx)("strong",{children:"Database & Storage:"})," Sizes are accurately calculated from your Supabase project"]}),(0,o.jsxs)("div",{children:["\u2022 ",(0,o.jsx)("strong",{children:"Refresh Rate:"}),' Data updates every time you click "Refresh Usage Report"']})]})]})]})]}),(0,o.jsxs)("div",{className:"panel",children:[(0,o.jsx)("div",{className:"panel-title",children:"\ud83d\udc64 Avatar Migration to Profiles"}),(0,o.jsx)("div",{style:{marginBottom:"16px"},children:(0,o.jsx)("p",{style:{color:"#8696a0",marginBottom:"12px"},children:"Link existing avatar files from storage to user profiles. This will ensure all user avatars display correctly in the admin dashboard."})}),(0,o.jsx)("div",{className:"actions",style:{marginBottom:"16px"},children:(0,o.jsx)("button",{className:"btn primary",onClick:async()=>{if(!I)return void X({type:"error",message:"Only admins can access storage management."});if(await E({title:"Migrate avatars to profiles table?",message:"This will migrate existing avatar files from storage to user profiles table. This will link avatars to users so they display correctly. This action cannot be undone.",confirmLabel:"Migrate Avatars",cancelLabel:"Cancel",variant:"warning"})){B(!0);try{const e=await(0,r.hk)();D(e),e.success?X({type:"success",message:"Avatar migration completed! Migrated: ".concat(e.migrated,", Skipped: ").concat(e.skipped,", Errors: ").concat(e.errors,".")}):X({type:"error",message:"Avatar migration failed: ".concat(e.error)})}catch(e){console.error("Failed to migrate avatars:",e),X({type:"error",message:"Avatar migration failed."})}finally{B(!1)}}},disabled:S,style:{backgroundColor:"#3b82f6"},children:S?"Migrating...":"Migrate Avatars to Profiles"})}),P&&(0,o.jsxs)("div",{className:"panel",style:{marginBottom:"16px",backgroundColor:"#1a1a2e"},children:[(0,o.jsx)("h4",{style:{color:"#e9edef",marginBottom:"12px"},children:"\ud83d\udcca Migration Results"}),P.success?(0,o.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:"12px"},children:[(0,o.jsxs)("div",{style:{padding:"12px",backgroundColor:"#0b141a",borderRadius:"4px",borderLeft:"4px solid #10b981"},children:[(0,o.jsx)("div",{style:{color:"#8696a0",fontSize:"0.9rem"},children:"Migrated Profiles"}),(0,o.jsx)("div",{style:{fontSize:"1.5rem",fontWeight:"bold",color:"#10b981"},children:P.migrated})]}),(0,o.jsxs)("div",{style:{padding:"12px",backgroundColor:"#0b141a",borderRadius:"4px",borderLeft:"4px solid #6b7280"},children:[(0,o.jsx)("div",{style:{color:"#8696a0",fontSize:"0.9rem"},children:"Skipped (Already Linked)"}),(0,o.jsx)("div",{style:{fontSize:"1.5rem",fontWeight:"bold",color:"#6b7280"},children:P.skipped})]}),(0,o.jsxs)("div",{style:{padding:"12px",backgroundColor:"#0b141a",borderRadius:"4px",borderLeft:"4px solid #ef4444"},children:[(0,o.jsx)("div",{style:{color:"#8696a0",fontSize:"0.9rem"},children:"Errors"}),(0,o.jsx)("div",{style:{fontSize:"1.5rem",fontWeight:"bold",color:"#ef4444"},children:P.errors})]})]}):(0,o.jsxs)("div",{style:{padding:"12px",backgroundColor:"#7f1d1d",borderRadius:"4px",color:"#fca5a5"},children:["\u274c Migration failed: ",P.error]})]})]}),(0,o.jsxs)("div",{className:"panel",children:[(0,o.jsx)("div",{className:"panel-title",children:"Storage Cleanup & Orphaned Files Management"}),(0,o.jsx)("div",{style:{marginBottom:"16px"},children:(0,o.jsx)("p",{style:{color:"#8696a0",marginBottom:"12px"},children:"Scan Supabase storage for files that have no corresponding database records and optionally delete them."})}),(0,o.jsxs)("div",{className:"actions",style:{marginBottom:"16px",gap:"8px"},children:[(0,o.jsx)("button",{className:"btn primary",onClick:async()=>{if(I){B(!0);try{const e=await(0,r.PJ)();N(e),X({type:"success",message:"Orphaned files report generated."})}catch(e){console.error("Failed to get report:",e),X({type:"error",message:"Failed to generate report."})}finally{B(!1)}}else X({type:"error",message:"Only admins can access storage management."})},disabled:S,children:S?"Scanning...":"Scan for Orphaned Files"}),W&&(0,o.jsx)("button",{className:"btn",onClick:async()=>{if(!I)return void X({type:"error",message:"Only admins can access storage management."});if(await E({title:"Clean up orphaned files?",message:"This will permanently delete all files in storage that have no corresponding database records. This action cannot be undone.",confirmLabel:"Delete Orphaned Files",cancelLabel:"Cancel",variant:"danger"})){B(!0);try{const e=await(0,r.xl)();T(e),X({type:"success",message:"Cleanup completed! Check the results below."})}catch(e){console.error("Failed to cleanup:",e),X({type:"error",message:"Cleanup failed."})}finally{B(!1)}}},disabled:S,style:{backgroundColor:"#dc2626",color:"#fff",border:"none"},children:S?"Cleaning...":"Delete Orphaned Files"})]}),W&&(0,o.jsxs)("div",{className:"panel",style:{marginBottom:"16px"},children:[(0,o.jsx)("h4",{style:{color:"#e9edef",marginBottom:"12px"},children:"\ud83d\udcca Orphaned Files Report"}),(0,o.jsx)("div",{style:{overflowX:"auto"},children:(0,o.jsxs)("table",{className:"table",style:{minWidth:"900px",borderCollapse:"separate",borderSpacing:0},children:[(0,o.jsx)("thead",{children:(0,o.jsxs)("tr",{children:[(0,o.jsx)("th",{style:{width:"250px"},children:"Storage Bucket"}),(0,o.jsx)("th",{style:{width:"120px",textAlign:"center"},children:"Total Files"}),(0,o.jsx)("th",{style:{width:"120px",textAlign:"center"},children:"Orphaned Files"}),(0,o.jsx)("th",{style:{width:"150px",textAlign:"left"},children:"Status"})]})}),(0,o.jsxs)("tbody",{children:[(0,o.jsxs)("tr",{children:[(0,o.jsx)("td",{children:"Books (elib-books)"}),(0,o.jsx)("td",{style:{textAlign:"center"},children:W.books_bucket.total}),(0,o.jsx)("td",{style:{textAlign:"center",fontWeight:"bold",color:W.books_bucket.orphaned>0?"#dc2626":"#00a884"},children:W.books_bucket.orphaned}),(0,o.jsx)("td",{style:{color:W.books_bucket.orphaned>0?"#fca5a5":"#a3e635"},children:W.books_bucket.orphaned>0?"\u26a0\ufe0f Found orphaned":"\u2713 Clean"})]}),(0,o.jsxs)("tr",{children:[(0,o.jsx)("td",{children:"Past Papers"}),(0,o.jsx)("td",{style:{textAlign:"center"},children:W.past_papers_bucket.total}),(0,o.jsx)("td",{style:{textAlign:"center",fontWeight:"bold",color:W.past_papers_bucket.orphaned>0?"#dc2626":"#00a884"},children:W.past_papers_bucket.orphaned}),(0,o.jsx)("td",{style:{color:W.past_papers_bucket.orphaned>0?"#fca5a5":"#a3e635"},children:W.past_papers_bucket.orphaned>0?"\u26a0\ufe0f Found orphaned":"\u2713 Clean"})]}),(0,o.jsxs)("tr",{children:[(0,o.jsx)("td",{children:"University Covers"}),(0,o.jsx)("td",{style:{textAlign:"center"},children:W.university_covers_bucket.total}),(0,o.jsx)("td",{style:{textAlign:"center",fontWeight:"bold",color:W.university_covers_bucket.orphaned>0?"#dc2626":"#00a884"},children:W.university_covers_bucket.orphaned}),(0,o.jsx)("td",{style:{color:W.university_covers_bucket.orphaned>0?"#fca5a5":"#a3e635"},children:W.university_covers_bucket.orphaned>0?"\u26a0\ufe0f Found orphaned":"\u2713 Clean"})]})]})]})}),(W.books_bucket.files.length>0||W.past_papers_bucket.files.length>0||W.university_covers_bucket.files.length>0)&&(0,o.jsxs)("div",{style:{marginTop:"16px",padding:"12px",backgroundColor:"#7f1d1d",borderRadius:"4px",boxShadow:"inset 3px 0 0 rgba(220, 38, 38, 0.3)"},children:[(0,o.jsx)("div",{style:{color:"#fca5a5",fontSize:"0.95rem",fontWeight:"bold",marginBottom:"12px"},children:"\ud83d\uddd1\ufe0f Orphaned Files Details"}),W.books_bucket.files.length>0&&(0,o.jsxs)("div",{style:{marginBottom:"12px",fontSize:"0.9rem"},children:[(0,o.jsxs)("div",{style:{color:"#cfd8dc",fontWeight:"bold",marginBottom:"4px"},children:["\ud83d\udcda Books (",W.books_bucket.files.length," files):"]}),(0,o.jsxs)("div",{style:{color:"#fca5a5",marginLeft:"8px",wordBreak:"break-all",lineHeight:"1.5"},children:[W.books_bucket.files.slice(0,3).join("\n"),W.books_bucket.files.length>3&&"\n... and ".concat(W.books_bucket.files.length-3," more")]})]}),W.past_papers_bucket.files.length>0&&(0,o.jsxs)("div",{style:{marginBottom:"12px",fontSize:"0.9rem"},children:[(0,o.jsxs)("div",{style:{color:"#cfd8dc",fontWeight:"bold",marginBottom:"4px"},children:["\ud83d\udcc4 Past Papers (",W.past_papers_bucket.files.length," files):"]}),(0,o.jsxs)("div",{style:{color:"#fca5a5",marginLeft:"8px",wordBreak:"break-all",lineHeight:"1.5"},children:[W.past_papers_bucket.files.slice(0,3).join("\n"),W.past_papers_bucket.files.length>3&&"\n... and ".concat(W.past_papers_bucket.files.length-3," more")]})]}),W.university_covers_bucket.files.length>0&&(0,o.jsxs)("div",{style:{fontSize:"0.9rem"},children:[(0,o.jsxs)("div",{style:{color:"#cfd8dc",fontWeight:"bold",marginBottom:"4px"},children:["\ud83c\udfeb University Covers (",W.university_covers_bucket.files.length," files):"]}),(0,o.jsxs)("div",{style:{color:"#fca5a5",marginLeft:"8px",wordBreak:"break-all",lineHeight:"1.5"},children:[W.university_covers_bucket.files.slice(0,3).join("\n"),W.university_covers_bucket.files.length>3&&"\n... and ".concat(W.university_covers_bucket.files.length-3," more")]})]})]})]}),z&&(0,o.jsxs)("div",{className:"panel",children:[(0,o.jsx)("h4",{style:{color:"#a3e635",marginBottom:"12px"},children:"\u2705 Cleanup Results"}),(0,o.jsx)("div",{style:{overflowX:"auto",marginBottom:"16px"},children:(0,o.jsxs)("table",{className:"table",style:{minWidth:"700px",borderCollapse:"separate",borderSpacing:0},children:[(0,o.jsx)("thead",{children:(0,o.jsxs)("tr",{children:[(0,o.jsx)("th",{style:{width:"300px"},children:"File Type"}),(0,o.jsx)("th",{style:{width:"200px",textAlign:"center"},children:"Deleted Count"}),(0,o.jsx)("th",{style:{width:"200px",textAlign:"center"},children:"Status"})]})}),(0,o.jsxs)("tbody",{children:[(0,o.jsxs)("tr",{children:[(0,o.jsx)("td",{children:"Book PDFs"}),(0,o.jsx)("td",{style:{textAlign:"center",fontWeight:"bold",color:"#00a884"},children:z.books_pdf_deleted.length}),(0,o.jsx)("td",{style:{textAlign:"center",color:"#a3e635"},children:"\u2713 Removed"})]}),(0,o.jsxs)("tr",{children:[(0,o.jsx)("td",{children:"Book Covers"}),(0,o.jsx)("td",{style:{textAlign:"center",fontWeight:"bold",color:"#00a884"},children:z.books_cover_deleted.length}),(0,o.jsx)("td",{style:{textAlign:"center",color:"#a3e635"},children:"\u2713 Removed"})]}),(0,o.jsxs)("tr",{children:[(0,o.jsx)("td",{children:"Past Papers"}),(0,o.jsx)("td",{style:{textAlign:"center",fontWeight:"bold",color:"#00a884"},children:z.past_papers_deleted.length}),(0,o.jsx)("td",{style:{textAlign:"center",color:"#a3e635"},children:"\u2713 Removed"})]}),(0,o.jsxs)("tr",{children:[(0,o.jsx)("td",{children:"University Covers"}),(0,o.jsx)("td",{style:{textAlign:"center",fontWeight:"bold",color:"#00a884"},children:z.university_covers_deleted.length}),(0,o.jsx)("td",{style:{textAlign:"center",color:"#a3e635"},children:"\u2713 Removed"})]}),(0,o.jsxs)("tr",{style:{fontWeight:"bold",backgroundColor:"#0b141a",borderTop:"2px solid #a3e635"},children:[(0,o.jsx)("td",{children:"TOTAL FILES DELETED"}),(0,o.jsx)("td",{style:{textAlign:"center",color:"#a3e635",fontSize:"1.1em"},children:z.books_pdf_deleted.length+z.books_cover_deleted.length+z.past_papers_deleted.length+z.university_covers_deleted.length}),(0,o.jsx)("td",{style:{textAlign:"center",color:"#a3e635"},children:"\u2713 Complete"})]})]})]})}),z.errors.length>0&&(0,o.jsxs)("div",{style:{marginTop:"12px",padding:"12px",backgroundColor:"#7f1d1d",borderRadius:"4px",boxShadow:"inset 3px 0 0 rgba(220, 38, 38, 0.3)"},children:[(0,o.jsxs)("div",{style:{color:"#fca5a5",fontSize:"0.95rem",fontWeight:"bold",marginBottom:"8px"},children:["\u26a0\ufe0f Errors Encountered (",z.errors.length,"):"]}),z.errors.slice(0,5).map((e,t)=>(0,o.jsxs)("div",{style:{color:"#fca5a5",fontSize:"0.85rem",marginBottom:"4px"},children:["\u2022 ",e]},t)),z.errors.length>5&&(0,o.jsxs)("div",{style:{color:"#6b7280",fontSize:"0.8rem",marginTop:"4px"},children:["... and ",z.errors.length-5," more errors"]})]})]})]}),(0,o.jsxs)("div",{className:"panel",children:[(0,o.jsx)("div",{className:"panel-title",children:"Cache Management"}),(0,o.jsx)("div",{style:{marginBottom:"16px"},children:(0,o.jsx)("p",{style:{color:"#8696a0",marginBottom:"12px"},children:"Clear browser cache to free up storage and force fresh data loads for all users."})}),(0,o.jsxs)("div",{className:"actions",style:{marginBottom:"16px",gap:"8px"},children:[(0,o.jsx)("button",{className:"btn",onClick:async()=>{if(I)try{const e=await(0,r.QS)();U(e),X({type:"success",message:"Cache statistics loaded."})}catch(e){console.error("Failed to get cache stats:",e),X({type:"error",message:"Failed to load cache statistics."})}else X({type:"error",message:"Only admins can access storage management."})},disabled:S,children:"Get Cache Stats"}),L&&(0,o.jsx)("button",{className:"btn",onClick:async()=>{if(!I)return void X({type:"error",message:"Only admins can access storage management."});if(await E({title:"Clear all caches?",message:"This will clear ".concat((null===L||void 0===L?void 0:L.cache_items)||"?"," cached items from browser storage. Users will need to reload pages to see updates."),confirmLabel:"Clear Caches",cancelLabel:"Cancel",variant:"warning"}))try{const e=(0,r.mL)();R(e),U(null),X({type:"success",message:"Cleared ".concat(e.cleared," cache items.")})}catch(e){console.error("Failed to clear cache:",e),X({type:"error",message:"Failed to clear cache."})}},disabled:S,style:{backgroundColor:"#f59e0b",color:"#fff",border:"none"},children:S?"Clearing...":"Clear All Caches"})]}),L&&(0,o.jsxs)("div",{className:"panel",style:{marginBottom:"16px"},children:[(0,o.jsx)("h4",{style:{color:"#e9edef",marginBottom:"12px"},children:"\ud83d\udcca Cache Statistics"}),(0,o.jsx)("div",{style:{overflowX:"auto",marginBottom:"16px"},children:(0,o.jsxs)("table",{className:"table",style:{minWidth:"700px",borderCollapse:"separate",borderSpacing:0},children:[(0,o.jsx)("thead",{children:(0,o.jsxs)("tr",{children:[(0,o.jsx)("th",{style:{width:"300px"},children:"Cache Item"}),(0,o.jsx)("th",{style:{width:"150px",textAlign:"right"},children:"Key/Count"}),(0,o.jsx)("th",{style:{width:"150px",textAlign:"right"},children:"Size (KB)"})]})}),(0,o.jsxs)("tbody",{children:[L.items&&L.items.length>0?(0,o.jsxs)(o.Fragment,{children:[L.items.slice(0,10).map((e,t)=>(0,o.jsxs)("tr",{children:[(0,o.jsx)("td",{style:{wordBreak:"break-word",maxWidth:"300px"},children:(0,o.jsx)("span",{style:{color:"#8696a0",fontSize:"0.85rem"},children:e.key})}),(0,o.jsx)("td",{style:{textAlign:"right",color:"#00a884"},children:"\u2014"}),(0,o.jsx)("td",{style:{textAlign:"right",fontWeight:"bold",color:"#00a884"},children:e.sizeKB})]},t)),L.items.length>10&&(0,o.jsxs)("tr",{style:{fontWeight:"bold",backgroundColor:"#0b141a"},children:[(0,o.jsxs)("td",{style:{color:"#8696a0"},children:["... ",L.items.length-10," more items"]}),(0,o.jsx)("td",{colSpan:2,style:{textAlign:"right",color:"#00a884"},children:"Scroll to see all"})]})]}):(0,o.jsx)("tr",{children:(0,o.jsx)("td",{colSpan:3,style:{textAlign:"center",color:"#8696a0"},children:"No cache items found"})}),(0,o.jsxs)("tr",{style:{fontWeight:"bold",backgroundColor:"#0b141a",borderTop:"2px solid #00a884"},children:[(0,o.jsx)("td",{children:"TOTAL ITEMS"}),(0,o.jsx)("td",{style:{textAlign:"right",color:"#00a884"},children:L.cache_items}),(0,o.jsx)("td",{style:{textAlign:"right",color:"#00a884"},children:"\u2014"})]})]})]})})]}),F&&(0,o.jsxs)("div",{className:"panel",children:[(0,o.jsx)("h4",{style:{color:"#a3e635",marginBottom:"12px"},children:"\u2705 Cache Cleared Successfully"}),(0,o.jsx)("div",{style:{marginBottom:"16px"},children:(0,o.jsx)("div",{style:{overflowX:"auto"},children:(0,o.jsxs)("table",{className:"table",style:{minWidth:"600px",borderCollapse:"separate",borderSpacing:0},children:[(0,o.jsx)("thead",{children:(0,o.jsxs)("tr",{children:[(0,o.jsx)("th",{style:{width:"300px"},children:"Metric"}),(0,o.jsx)("th",{style:{width:"300px",textAlign:"center"},children:"Value"})]})}),(0,o.jsxs)("tbody",{children:[(0,o.jsxs)("tr",{children:[(0,o.jsx)("td",{children:"Cache Items Cleared"}),(0,o.jsx)("td",{style:{textAlign:"center",fontWeight:"bold",color:"#a3e635"},children:F.cleared})]}),(0,o.jsxs)("tr",{style:{fontWeight:"bold",backgroundColor:"#0b141a",borderTop:"2px solid #a3e635"},children:[(0,o.jsx)("td",{children:"Status"}),(0,o.jsx)("td",{style:{textAlign:"center",color:"#a3e635"},children:"\u2713 Complete"})]})]})]})})}),F.keys&&F.keys.length>0&&(0,o.jsxs)("div",{style:{padding:"12px",backgroundColor:"#1f2937",borderRadius:"4px",marginTop:"12px",boxShadow:"inset 3px 0 0 rgba(163, 230, 53, 0.3)"},children:[(0,o.jsxs)("div",{style:{color:"#cfd8dc",fontSize:"0.9rem",fontWeight:"bold",marginBottom:"8px"},children:["Cleared Items (",F.keys.length,"):"]}),(0,o.jsxs)("div",{style:{color:"#8696a0",fontSize:"0.85rem",lineHeight:"1.6"},children:[F.keys.slice(0,10).map((e,t)=>(0,o.jsxs)("div",{children:["\u2022 ",e]},t)),F.keys.length>10&&(0,o.jsxs)("div",{style:{marginTop:"4px",color:"#6b7280"},children:["... and ",F.keys.length-10," more"]})]})]})]})]})]}):(0,o.jsx)("div",{className:"panel",style:{padding:"16px",textAlign:"center",color:"#8696a0"},children:(0,o.jsx)("p",{children:"You don't have permission to access storage management."})})}}}]);
//# sourceMappingURL=831.83c25f4f.chunk.js.map