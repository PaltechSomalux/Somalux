"use strict";(self.webpackChunkcampuslife=self.webpackChunkcampuslife||[]).push([[643],{6643:(s,e,a)=>{a.r(e),a.d(e,{default:()=>n});var i=a(9379),l=a(5043),c=a(6263),t=a(3488),d=a(579);function n(){const[s,e]=(0,l.useState)([]),[a,n]=(0,l.useState)(null),[r,m]=(0,l.useState)(null),[o,h]=(0,l.useState)(null),[v,x]=(0,l.useState)(!0),[j,N]=(0,l.useState)(null),[p,u]=(0,l.useState)({startDate:new Date(Date.now()-2592e6).toISOString().split("T")[0],endDate:(new Date).toISOString().split("T")[0]});(0,l.useEffect)(()=>{(async()=>{try{x(!0),console.log("\ud83d\udcca [Analytics] Fetching all ads...");const s=await c.A.get("".concat(t.H,"/api/admin/analytics/all"));console.log("\u2705 [Analytics] Ads fetched:",s.data.data),e(s.data.data||[]),s.data.data&&s.data.data.length>0?n(s.data.data[0]):console.warn("\u26a0\ufe0f [Analytics] No ads found")}catch(s){console.error("\u274c [Analytics] Failed to fetch ads:",s),N("Failed to load ads")}finally{x(!1)}})()},[]),(0,l.useEffect)(()=>{a&&(g(a.id),b(a.id))},[a]);const g=async s=>{try{console.log("\ud83d\udcc8 [Analytics] Fetching detailed metrics for ad:",s);const e=await c.A.get("".concat(t.H,"/api/admin/analytics/").concat(s));console.log("\u2705 [Analytics] Metrics received:",e.data.data),m(e.data.data)}catch(e){console.error("\u274c [Analytics] Failed to fetch analytics:",e)}},b=async s=>{try{const e=await c.A.get("".concat(t.H,"/api/admin/analytics/").concat(s,"/engagement"),{params:{startDate:p.startDate,endDate:p.endDate}});h(e.data.data)}catch(e){console.error("Failed to fetch engagement:",e)}},y=(s,e)=>{u(a=>(0,i.A)((0,i.A)({},a),{},{[s]:e}))};if(v)return(0,d.jsx)("div",{className:"analytics-container",children:(0,d.jsx)("p",{children:"Loading analytics..."})});const f=(null===r||void 0===r?void 0:r.metrics)||{},w=f.deviceBreakdown||{};return(0,d.jsxs)("div",{className:"analytics-container",children:[(0,d.jsxs)("div",{className:"analytics-header",children:[(0,d.jsx)("h1",{children:"\ud83d\udcca Ad Analytics & Performance Dashboard"}),(0,d.jsx)("p",{children:"Real-time tracking of impressions, clicks, and engagement metrics"})]}),j&&(0,d.jsx)("div",{className:"analytics-error",children:j}),(0,d.jsxs)("div",{className:"ads-analytics-table-wrapper",children:[(0,d.jsx)("h2",{children:"All Advertisements Performance"}),(0,d.jsxs)("div",{className:"ads-analytics-table",children:[(0,d.jsxs)("div",{className:"table-header",children:[(0,d.jsx)("div",{className:"col-title",children:"Ad Title"}),(0,d.jsx)("div",{className:"col-placement",children:"Placement"}),(0,d.jsx)("div",{className:"col-status",children:"Status"}),(0,d.jsx)("div",{className:"col-impressions",children:"Impressions"}),(0,d.jsx)("div",{className:"col-clicks",children:"Clicks"}),(0,d.jsx)("div",{className:"col-dismisses",children:"Dismisses"}),(0,d.jsx)("div",{className:"col-ctr",children:"CTR %"}),(0,d.jsx)("div",{className:"col-engagement",children:"Engagement %"}),(0,d.jsx)("div",{className:"col-action",children:"Action"})]}),(0,d.jsx)("div",{className:"table-body",children:s.map(s=>(0,d.jsxs)("div",{className:"table-row ".concat((null===a||void 0===a?void 0:a.id)===s.id?"active":""),onClick:()=>n(s),children:[(0,d.jsx)("div",{className:"col-title",children:s.title}),(0,d.jsx)("div",{className:"col-placement",children:(0,d.jsx)("span",{className:"placement-badge",children:s.placement})}),(0,d.jsx)("div",{className:"col-status",children:(0,d.jsx)("span",{className:"status-badge ".concat(s.is_active?"active":"inactive"),children:s.is_active?"\u25cf Active":"\u25cb Inactive"})}),(0,d.jsx)("div",{className:"col-impressions",children:s.total_impressions||0}),(0,d.jsx)("div",{className:"col-clicks",children:s.total_clicks||0}),(0,d.jsx)("div",{className:"col-dismisses",children:s.total_dismisses||0}),(0,d.jsxs)("div",{className:"col-ctr",children:[s.ctr||0,"%"]}),(0,d.jsxs)("div",{className:"col-engagement",children:[s.total_impressions>0?((s.total_clicks+s.total_dismisses)/s.total_impressions*100).toFixed(1):0,"%"]}),(0,d.jsx)("div",{className:"col-action",children:(0,d.jsx)("button",{className:"view-details-btn",children:"View Details"})})]},s.id))})]})]}),a&&(0,d.jsxs)(d.Fragment,{children:[(0,d.jsxs)("div",{className:"selected-ad-details",children:[(0,d.jsxs)("h2",{children:["\ud83d\udcc8 Detailed Analytics: ",a.title]}),(0,d.jsxs)("div",{className:"details-metrics-grid",children:[(0,d.jsxs)("div",{className:"detail-metric",children:[(0,d.jsx)("span",{className:"label",children:"Total Impressions"}),(0,d.jsx)("span",{className:"value",children:a.total_impressions||0})]}),(0,d.jsxs)("div",{className:"detail-metric",children:[(0,d.jsx)("span",{className:"label",children:"Total Clicks"}),(0,d.jsx)("span",{className:"value highlight-blue",children:a.total_clicks||0})]}),(0,d.jsxs)("div",{className:"detail-metric",children:[(0,d.jsx)("span",{className:"label",children:"Total Dismisses"}),(0,d.jsx)("span",{className:"value highlight-red",children:a.total_dismisses||0})]}),(0,d.jsxs)("div",{className:"detail-metric",children:[(0,d.jsx)("span",{className:"label",children:"Click-Through Rate"}),(0,d.jsxs)("span",{className:"value highlight-green",children:[a.ctr||0,"%"]})]}),(0,d.jsxs)("div",{className:"detail-metric",children:[(0,d.jsx)("span",{className:"label",children:"Engagement Rate"}),(0,d.jsxs)("span",{className:"value highlight-purple",children:[a.total_impressions>0?((a.total_clicks+a.total_dismisses)/a.total_impressions*100).toFixed(2):0,"%"]})]}),(0,d.jsxs)("div",{className:"detail-metric",children:[(0,d.jsx)("span",{className:"label",children:"Completion Rate"}),(0,d.jsxs)("span",{className:"value highlight-yellow",children:[a.total_impressions>0?((a.total_impressions-a.total_dismisses)/a.total_impressions*100).toFixed(2):0,"%"]})]})]}),(0,d.jsxs)("div",{className:"ad-info-table",children:[(0,d.jsxs)("div",{className:"info-row",children:[(0,d.jsx)("span",{className:"info-label",children:"Ad Title:"}),(0,d.jsx)("span",{className:"info-value",children:a.title})]}),(0,d.jsxs)("div",{className:"info-row",children:[(0,d.jsx)("span",{className:"info-label",children:"Placement:"}),(0,d.jsx)("span",{className:"info-value placement-badge",children:a.placement})]}),(0,d.jsxs)("div",{className:"info-row",children:[(0,d.jsx)("span",{className:"info-label",children:"Status:"}),(0,d.jsx)("span",{className:"info-value status-badge ".concat(a.is_active?"active":"inactive"),children:a.is_active?"\u25cf Active":"\u25cb Inactive"})]}),(0,d.jsxs)("div",{className:"info-row",children:[(0,d.jsx)("span",{className:"info-label",children:"Dismiss Rate:"}),(0,d.jsxs)("span",{className:"info-value",children:[a.dismissRate||0,"%"]})]}),(0,d.jsxs)("div",{className:"info-row",children:[(0,d.jsx)("span",{className:"info-label",children:"Avg View Duration:"}),(0,d.jsxs)("span",{className:"info-value",children:[f.avgViewDuration||0,"s"]})]})]}),(0,d.jsxs)("div",{className:"device-breakdown-table",children:[(0,d.jsx)("h3",{children:"Device Breakdown"}),(0,d.jsxs)("div",{className:"device-table",children:[(0,d.jsxs)("div",{className:"device-header",children:[(0,d.jsx)("div",{className:"device-col",children:"Device"}),(0,d.jsx)("div",{className:"device-col",children:"Count"}),(0,d.jsx)("div",{className:"device-col",children:"Percentage"}),(0,d.jsx)("div",{className:"device-col",children:"Visual"})]}),(()=>{const s=(w.mobile||0)+(w.tablet||0)+(w.desktop||0);return(0,d.jsxs)(d.Fragment,{children:[(0,d.jsxs)("div",{className:"device-row",children:[(0,d.jsx)("div",{className:"device-col device-name",children:"\ud83d\udcf1 Mobile"}),(0,d.jsx)("div",{className:"device-col",children:w.mobile||0}),(0,d.jsxs)("div",{className:"device-col",children:[s>0?(w.mobile/s*100).toFixed(1):0,"%"]}),(0,d.jsx)("div",{className:"device-col device-bar",children:(0,d.jsx)("div",{className:"bar mobile",style:{width:s>0?w.mobile/s*100:"0%"}})})]}),(0,d.jsxs)("div",{className:"device-row",children:[(0,d.jsx)("div",{className:"device-col device-name",children:"\ud83d\udcf1 Tablet"}),(0,d.jsx)("div",{className:"device-col",children:w.tablet||0}),(0,d.jsxs)("div",{className:"device-col",children:[s>0?(w.tablet/s*100).toFixed(1):0,"%"]}),(0,d.jsx)("div",{className:"device-col device-bar",children:(0,d.jsx)("div",{className:"bar tablet",style:{width:s>0?w.tablet/s*100:"0%"}})})]}),(0,d.jsxs)("div",{className:"device-row",children:[(0,d.jsx)("div",{className:"device-col device-name",children:"\ud83d\udda5\ufe0f Desktop"}),(0,d.jsx)("div",{className:"device-col",children:w.desktop||0}),(0,d.jsxs)("div",{className:"device-col",children:[s>0?(w.desktop/s*100).toFixed(1):0,"%"]}),(0,d.jsx)("div",{className:"device-col device-bar",children:(0,d.jsx)("div",{className:"bar desktop",style:{width:s>0?w.desktop/s*100:"0%"}})})]})]})})()]})]})]}),(0,d.jsxs)("div",{className:"date-range-selector",children:[(0,d.jsxs)("div",{className:"date-group",children:[(0,d.jsx)("label",{children:"Start Date"}),(0,d.jsx)("input",{type:"date",value:p.startDate,onChange:s=>y("startDate",s.target.value)})]}),(0,d.jsxs)("div",{className:"date-group",children:[(0,d.jsx)("label",{children:"End Date"}),(0,d.jsx)("input",{type:"date",value:p.endDate,onChange:s=>y("endDate",s.target.value)})]}),(0,d.jsx)("button",{className:"btn-refresh",onClick:()=>{a&&b(a.id)},children:"Refresh Data"})]}),(0,d.jsxs)("div",{className:"engagement-section",children:[(0,d.jsx)("h2",{children:"Daily Engagement"}),o&&Object.keys(o).length>0?(0,d.jsxs)("div",{className:"engagement-table",children:[(0,d.jsxs)("div",{className:"engagement-header",children:[(0,d.jsx)("div",{className:"col date",children:"Date"}),(0,d.jsx)("div",{className:"col impressions",children:"Impressions"}),(0,d.jsx)("div",{className:"col clicks",children:"Clicks"}),(0,d.jsx)("div",{className:"col dismisses",children:"Dismisses"}),(0,d.jsx)("div",{className:"col avgTime",children:"Avg Time"})]}),Object.entries(o).map(s=>{let[e,a]=s;return(0,d.jsxs)("div",{className:"engagement-row",children:[(0,d.jsx)("div",{className:"col date",children:e}),(0,d.jsx)("div",{className:"col impressions",children:a.impressions||0}),(0,d.jsx)("div",{className:"col clicks",children:a.clicks||0}),(0,d.jsx)("div",{className:"col dismisses",children:a.dismisses||0}),(0,d.jsxs)("div",{className:"col avgTime",children:[a.totalViewTime>0?(a.totalViewTime/Math.max(a.impressions,1)).toFixed(1):0,"s"]})]},e)})]}):(0,d.jsx)("p",{className:"no-data",children:"No engagement data for selected date range"})]}),(0,d.jsxs)("div",{className:"performance-summary",children:[(0,d.jsx)("h2",{children:"Performance Summary"}),(0,d.jsxs)("div",{className:"summary-grid",children:[(0,d.jsxs)("div",{className:"summary-item",children:[(0,d.jsx)("h4",{children:"Status"}),(0,d.jsx)("p",{className:"summary-value",children:a.is_active?"Active":"Inactive"})]}),(0,d.jsxs)("div",{className:"summary-item",children:[(0,d.jsx)("h4",{children:"Placement"}),(0,d.jsx)("p",{className:"summary-value",children:a.placement})]}),(0,d.jsxs)("div",{className:"summary-item",children:[(0,d.jsx)("h4",{children:"Engagement Rate"}),(0,d.jsxs)("p",{className:"summary-value",children:[a.total_impressions>0?((a.total_clicks+a.total_dismisses)/a.total_impressions*100).toFixed(2):0,"%"]})]}),(0,d.jsxs)("div",{className:"summary-item",children:[(0,d.jsx)("h4",{children:"Completion Rate"}),(0,d.jsxs)("p",{className:"summary-value",children:[a.total_impressions>0?((a.total_impressions-a.total_dismisses)/a.total_impressions*100).toFixed(2):0,"%"]})]})]})]})]})]})}}}]);
//# sourceMappingURL=643.f66df6f9.chunk.js.map