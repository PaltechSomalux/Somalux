{"version":3,"file":"static/js/129.03fe10a8.chunk.js","mappings":"gLAIA,MA0FA,EA1F0BA,KACxB,MAAM,GAAEC,IAAOC,EAAAA,EAAAA,KACTC,GAAWC,EAAAA,EAAAA,OACVC,EAASC,IAAcC,EAAAA,EAAAA,WAAS,IAChCC,EAAQC,IAAaF,EAAAA,EAAAA,UAAS,KAErCG,EAAAA,EAAAA,WAAU,KACR,IAAKT,EAAI,OACT,IAAIU,GAAY,EAWhB,MAVaC,WACXN,GAAW,GACX,IACE,MAAMO,QAAaC,EAAAA,EAAAA,IAA4Bb,EAAI,CAAEc,MAAO,MACvDJ,GAAWF,EAAUI,GAAQ,GACpC,CAAC,QACMF,GAAWL,GAAW,EAC7B,GAEFU,GACO,KACLL,GAAY,IAEb,CAACV,IAEJ,MAAMgB,GAAUC,EAAAA,EAAAA,SAAQ,KACtB,MAAMC,EAAM,CAAEC,MAAO,GAAIC,WAAY,GAAIC,QAAS,GAAIC,YAAa,GAAIC,MAAO,IAM9E,OALAhB,EAAOiB,QAASC,IACd,MAAMC,EAAQD,EAAEC,OAAS,QACrBR,EAAIQ,GAAQR,EAAIQ,GAAOC,KAAKF,GAC3BP,EAAIK,MAAMI,KAAKF,KAEfP,GACN,CAACX,IAEEqB,EAAmBA,CAACC,EAASC,KACjC,MAAMlB,EAAOI,EAAQa,IAAY,GACjC,OACEE,EAAAA,EAAAA,MAAA,OAAKC,MAAO,CAAEC,aAAc,IAAKC,SAAA,EAC/BC,EAAAA,EAAAA,KAAA,MAAIH,MAAO,CAAEI,MAAO,UAAWH,aAAc,GAAIC,SAAEJ,IAClC,IAAhBlB,EAAKyB,QACJF,EAAAA,EAAAA,KAAA,OAAKH,MAAO,CAAEI,MAAO,WAAYF,SAAC,+CAElCH,EAAAA,EAAAA,MAAA,SAAOO,UAAU,QAAOJ,SAAA,EACtBC,EAAAA,EAAAA,KAAA,SAAAD,UACEH,EAAAA,EAAAA,MAAA,MAAAG,SAAA,EACEC,EAAAA,EAAAA,KAAA,MAAAD,SAAI,WACJC,EAAAA,EAAAA,KAAA,MAAAD,SAAI,mBACJC,EAAAA,EAAAA,KAAA,MAAAD,SAAI,eAGRC,EAAAA,EAAAA,KAAA,SAAAD,SACGtB,EAAKM,IAAKO,IACTM,EAAAA,EAAAA,MAAA,MAAAG,SAAA,EACEC,EAAAA,EAAAA,KAAA,MAAAD,SAAKT,EAAEc,cACPJ,EAAAA,EAAAA,KAAA,MAAAD,SAAwB,MAAnBT,EAAEe,cAAwBf,EAAEe,cAAgB,YACjDL,EAAAA,EAAAA,KAAA,MAAAD,SAAKT,EAAEgB,WAAa,IAAIC,KAAKjB,EAAEgB,YAAYE,iBAAmB,aAHvDlB,EAAEzB,cAazB,OACE+B,EAAAA,EAAAA,MAAA,OAAKO,UAAU,QAAOJ,SAAA,EACpBH,EAAAA,EAAAA,MAAA,OAAKO,UAAU,cAAcN,MAAO,CAAEY,QAAS,OAAQC,WAAY,SAAUC,IAAK,IAAKZ,SAAA,EACrFC,EAAAA,EAAAA,KAAA,UAAQG,UAAU,MAAMS,QAASA,IAAM7C,GAAU,GAAGgC,SAAC,UAGrDC,EAAAA,EAAAA,KAAA,QAAAD,SAAM,2BAGP9B,GACC+B,EAAAA,EAAAA,KAAA,OAAKH,MAAO,CAAEI,MAAO,UAAWY,QAAS,IAAKd,SAAC,mCAC3B,IAAlB3B,EAAO8B,QACTF,EAAAA,EAAAA,KAAA,OAAKH,MAAO,CAAEI,MAAO,UAAWY,QAAS,IAAKd,SAAC,4CAE/CH,EAAAA,EAAAA,MAAAkB,EAAAA,SAAA,CAAAf,SAAA,CACGN,EAAiB,QAAS,iBAC1BA,EAAiB,aAAc,qBAC/BA,EAAiB,UAAW,mBAC5BA,EAAiB,cAAe,6B","sources":["SomaLux/Books/Admin/pages/UserSearchDetails.jsx"],"sourcesContent":["import React, { useEffect, useState, useMemo } from 'react';\r\nimport { useParams, useNavigate } from 'react-router-dom';\r\nimport { fetchUserSearchHistoryAdmin } from '../api';\r\n\r\nconst UserSearchDetails = () => {\r\n  const { id } = useParams();\r\n  const navigate = useNavigate();\r\n  const [loading, setLoading] = useState(true);\r\n  const [events, setEvents] = useState([]);\r\n\r\n  useEffect(() => {\r\n    if (!id) return;\r\n    let cancelled = false;\r\n    const load = async () => {\r\n      setLoading(true);\r\n      try {\r\n        const rows = await fetchUserSearchHistoryAdmin(id, { limit: 200 });\r\n        if (!cancelled) setEvents(rows || []);\r\n      } finally {\r\n        if (!cancelled) setLoading(false);\r\n      }\r\n    };\r\n    load();\r\n    return () => {\r\n      cancelled = true;\r\n    };\r\n  }, [id]);\r\n\r\n  const grouped = useMemo(() => {\r\n    const map = { books: [], categories: [], authors: [], past_papers: [], other: [] };\r\n    events.forEach((e) => {\r\n      const scope = e.scope || 'other';\r\n      if (map[scope]) map[scope].push(e);\r\n      else map.other.push(e);\r\n    });\r\n    return map;\r\n  }, [events]);\r\n\r\n  const renderScopeTable = (scopeId, label) => {\r\n    const rows = grouped[scopeId] || [];\r\n    return (\r\n      <div style={{ marginBottom: 24 }}>\r\n        <h3 style={{ color: '#e9edef', marginBottom: 8 }}>{label}</h3>\r\n        {rows.length === 0 ? (\r\n          <div style={{ color: '#8696a0' }}>No search events recorded for this scope.</div>\r\n        ) : (\r\n          <table className=\"table\">\r\n            <thead>\r\n              <tr>\r\n                <th>Query</th>\r\n                <th>Results Count</th>\r\n                <th>When</th>\r\n              </tr>\r\n            </thead>\r\n            <tbody>\r\n              {rows.map((e) => (\r\n                <tr key={e.id}>\r\n                  <td>{e.query_text}</td>\r\n                  <td>{e.results_count != null ? e.results_count : '—'}</td>\r\n                  <td>{e.created_at ? new Date(e.created_at).toLocaleString() : '—'}</td>\r\n                </tr>\r\n              ))}\r\n            </tbody>\r\n          </table>\r\n        )}\r\n      </div>\r\n    );\r\n  };\r\n\r\n  return (\r\n    <div className=\"panel\">\r\n      <div className=\"panel-title\" style={{ display: 'flex', alignItems: 'center', gap: 16 }}>\r\n        <button className=\"btn\" onClick={() => navigate(-1)}>\r\n          Back\r\n        </button>\r\n        <span>User Search Details</span>\r\n      </div>\r\n\r\n      {loading ? (\r\n        <div style={{ color: '#8696a0', padding: 16 }}>Loading user search history...</div>\r\n      ) : events.length === 0 ? (\r\n        <div style={{ color: '#8696a0', padding: 16 }}>No search history found for this user.</div>\r\n      ) : (\r\n        <>\r\n          {renderScopeTable('books', 'Book Searches')}\r\n          {renderScopeTable('categories', 'Category Searches')}\r\n          {renderScopeTable('authors', 'Author Searches')}\r\n          {renderScopeTable('past_papers', 'Past Paper Searches')}\r\n        </>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default UserSearchDetails;\r\n"],"names":["UserSearchDetails","id","useParams","navigate","useNavigate","loading","setLoading","useState","events","setEvents","useEffect","cancelled","async","rows","fetchUserSearchHistoryAdmin","limit","load","grouped","useMemo","map","books","categories","authors","past_papers","other","forEach","e","scope","push","renderScopeTable","scopeId","label","_jsxs","style","marginBottom","children","_jsx","color","length","className","query_text","results_count","created_at","Date","toLocaleString","display","alignItems","gap","onClick","padding","_Fragment"],"ignoreList":[],"sourceRoot":""}