{"version":3,"file":"static/js/767.af8dba56.chunk.js","mappings":"8MAIA,MAwYA,EAxYcA,IAAsB,IAArB,YAAEC,GAAaD,EAC5B,MAAOE,EAASC,IAAcC,EAAAA,EAAAA,WAAS,IAChCC,EAAMC,IAAWF,EAAAA,EAAAA,UAAS,KAC1BG,EAAOC,IAAYJ,EAAAA,EAAAA,UAAS,IAC5BK,EAAMC,IAAWN,EAAAA,EAAAA,UAAS,IAC1BO,IAAYP,EAAAA,EAAAA,UAAS,KACrBQ,EAAQC,IAAaT,EAAAA,EAAAA,UAAS,KAC9BU,EAAYC,IAAiBX,EAAAA,EAAAA,UAAS,KACtCY,EAAYC,IAAiBb,EAAAA,EAAAA,UAAS,OACtCc,EAAMC,IAAWf,EAAAA,EAAAA,UAAS,CAAEgB,IAAK,aAAcC,IAAK,UACpDC,EAAWC,IAAgBnB,EAAAA,EAAAA,UAAS,OACpCoB,EAAWC,IAAgBrB,EAAAA,EAAAA,UAAS,CAAC,IACrCsB,EAAQC,IAAavB,EAAAA,EAAAA,UAAS,OAC9BwB,EAAUC,IAAezB,EAAAA,EAAAA,UAAS,OAEnC,QAAE0B,EAAO,UAAEC,IAAcC,EAAAA,EAAAA,KAEzBC,EAAe,CAAC,2BAA4B,4BAC5CC,EAAgC,WAAX,OAAXjC,QAAW,IAAXA,OAAW,EAAXA,EAAakC,OAAoBF,EAAaG,SAAoB,OAAXnC,QAAW,IAAXA,OAAW,EAAXA,EAAaoC,OAC9EC,EAAiC,YAAX,OAAXrC,QAAW,IAAXA,OAAW,EAAXA,EAAakC,OAAqBF,EAAaG,SAAoB,OAAXnC,QAAW,IAAXA,OAAW,EAAXA,EAAaoC,OAEhFE,GAAaC,EAAAA,EAAAA,SAAQ,IAAMC,KAAKC,IAAI,EAAGD,KAAKE,KAAKpC,EAAQI,IAAY,CAACJ,EAAOI,IAE7EiC,EAAOC,UACX1C,GAAW,GACX,IACE,MAAM,KAAE2C,EAAMvC,MAAOwC,SAAgBC,EAAAA,EAAAA,IAAW,CAC9CvC,OACAE,WACAC,SACAI,aACAE,SAGFZ,EAAQwC,GACRtC,EAASuC,EACX,CAAC,QAAW5C,GAAW,EAAQ,IAGjC8C,EAAAA,EAAAA,WAAU,KACR,WACE,IAAMlC,QAAoBmC,EAAAA,EAAAA,MAAoB,CAAE,MAAAC,GAAO,CACnDlD,SACI2C,GAET,EALD,IAOC,CAACnC,EAAMG,EAAQI,EAAYE,EAAKE,IAAKF,EAAKG,IAAKpB,IAElD,MAAMmD,EAAWC,KACXnB,KACAI,EAwBAgB,EAAaA,KACjB/B,EAAa,MACbE,EAAa,CAAC,GACdE,EAAU,MACVE,EAAY,OA6CR0B,EAAcnC,IAClBD,EAASqC,GAAOA,EAAEpC,MAAQA,EAAM,CAAEA,MAAKC,IAAe,QAAVmC,EAAEnC,IAAgB,OAAS,OAAU,CAAED,MAAKC,IAAK,SAG/F,OACEoC,EAAAA,EAAAA,KAAA,OAAAC,UACEC,EAAAA,EAAAA,MAAA,OAAKC,UAAU,QAAOF,SAAA,EACpBD,EAAAA,EAAAA,KAAA,OAAKG,UAAU,cAAaF,SAAC,sBAG3BxD,GAAWG,EAAKwD,OAAS,IACzBF,EAAAA,EAAAA,MAAA,OAAKG,MAAO,CAAEC,QAAS,OAAQC,oBAAqB,uCAAwCC,IAAK,MAAOC,aAAc,QAASR,SAAA,EAC7HC,EAAAA,EAAAA,MAAA,OAAKG,MAAO,CAAEK,WAAY,UAAWC,OAAQ,oBAAqBC,aAAc,MAAOC,QAAS,WAAYC,MAAO,UAAWC,SAAU,WAAYd,SAAA,EAClJD,EAAAA,EAAAA,KAAA,OAAKK,MAAO,CAAES,MAAO,UAAWC,SAAU,SAAUC,WAAY,OAAQf,SAAErD,EAAKqE,OAAO,CAACC,EAAKC,IAAMD,GAAOC,EAAEC,WAAa,GAAI,MAC5HpB,EAAAA,EAAAA,KAAA,OAAAC,SAAK,wBAEPC,EAAAA,EAAAA,MAAA,OAAKG,MAAO,CAAEK,WAAY,UAAWC,OAAQ,oBAAqBC,aAAc,MAAOC,QAAS,WAAYC,MAAO,UAAWC,SAAU,WAAYd,SAAA,EAClJD,EAAAA,EAAAA,KAAA,OAAKK,MAAO,CAAES,MAAO,UAAWC,SAAU,SAAUC,WAAY,OAAQf,SAAErD,EAAKqE,OAAO,CAACC,EAAKC,IAAMD,GAAOC,EAAEE,OAAS,GAAI,MACxHrB,EAAAA,EAAAA,KAAA,OAAAC,SAAK,oBAEPC,EAAAA,EAAAA,MAAA,OAAKG,MAAO,CAAEK,WAAY,UAAWC,OAAQ,oBAAqBC,aAAc,MAAOC,QAAS,WAAYC,MAAO,UAAWC,SAAU,WAAYd,SAAA,EAClJD,EAAAA,EAAAA,KAAA,OAAKK,MAAO,CAAES,MAAO,UAAWC,SAAU,SAAUC,WAAY,OAAQf,SAAErD,EAAKqE,OAAO,CAACC,EAAKC,IAAMD,GAAOC,EAAEG,gBAAkB,GAAI,MACjItB,EAAAA,EAAAA,KAAA,OAAAC,SAAK,uBAEPC,EAAAA,EAAAA,MAAA,OAAKG,MAAO,CAAEK,WAAY,UAAWC,OAAQ,oBAAqBC,aAAc,MAAOC,QAAS,WAAYC,MAAO,UAAWC,SAAU,WAAYd,SAAA,EAClJD,EAAAA,EAAAA,KAAA,OAAKK,MAAO,CAAES,MAAO,UAAWC,SAAU,SAAUC,WAAY,OAAQf,SAAErD,EAAKqE,OAAO,CAACC,EAAKC,IAAMD,GAAOC,EAAEI,aAAe,GAAI,MAC9HvB,EAAAA,EAAAA,KAAA,OAAAC,SAAK,oBAEPC,EAAAA,EAAAA,MAAA,OAAKG,MAAO,CAAEK,WAAY,UAAWC,OAAQ,oBAAqBC,aAAc,MAAOC,QAAS,WAAYC,MAAO,UAAWC,SAAU,WAAYd,SAAA,EAClJC,EAAAA,EAAAA,MAAA,OAAKG,MAAO,CAAES,MAAO,UAAWC,SAAU,SAAUC,WAAY,OAAQf,SAAA,CAAErD,EAAKwD,OAAO,IAAEtD,MACxFkD,EAAAA,EAAAA,KAAA,OAAAC,SAAK,sBAKXC,EAAAA,EAAAA,MAAA,OAAKC,UAAU,SAASE,MAAO,CAAEI,aAAc,GAAIR,SAAA,EACjDC,EAAAA,EAAAA,MAAA,OAAKC,UAAU,QAAQE,MAAO,CAAEQ,QAAS,WAAYZ,SAAA,EACnDD,EAAAA,EAAAA,KAAA,SAAOG,UAAU,QAAQE,MAAO,CAAEI,aAAc,UAAWR,SAAC,YAC5DD,EAAAA,EAAAA,KAAA,SAAOG,UAAU,QAAQqB,MAAOrE,EAAQsE,SAAWC,IAAQzE,EAAQ,GAAIG,EAAUsE,EAAEC,OAAOH,QAAWI,YAAY,qBAAqBvB,MAAO,CAAEU,SAAU,gBAE3Jb,EAAAA,EAAAA,MAAA,OAAKC,UAAU,QAAQE,MAAO,CAAEQ,QAAS,WAAYZ,SAAA,EACnDD,EAAAA,EAAAA,KAAA,SAAOG,UAAU,QAAQE,MAAO,CAAEI,aAAc,UAAWR,SAAC,cAC5DC,EAAAA,EAAAA,MAAA,UAAQC,UAAU,SAASqB,MAAOjE,GAAc,GAAIkE,SAAWC,IAAQzE,EAAQ,GAAIO,EAAckE,EAAEC,OAAOH,OAAS,OAAUnB,MAAO,CAAEU,SAAU,UAAWd,SAAA,EACzJD,EAAAA,EAAAA,KAAA,UAAQwB,MAAM,GAAEvB,SAAC,QAChB5C,EAAWwE,IAAIC,IAAK9B,EAAAA,EAAAA,KAAA,UAAmBwB,MAAOM,EAAEC,GAAG9B,SAAE6B,EAAEE,MAAtBF,EAAEC,eAK1C/B,EAAAA,EAAAA,KAAA,OAAKG,UAAU,UAAUE,MAAO,CAAEI,aAAc,IAAKR,UACnDD,EAAAA,EAAAA,KAAA,UAAQG,UAAU,cAAc8B,QAASA,IAAOC,OAAOC,SAASC,KAAO,sBAAuBnC,SAAC,6BAGjGD,EAAAA,EAAAA,KAAA,OAAKG,UAAU,QAAQE,MAAO,CAAEQ,QAAS,EAAGwB,UAAW,OAAQC,wBAAyB,SAAUrC,UAChGC,EAAAA,EAAAA,MAAA,SAAOC,UAAU,QAAQE,MAAO,CAAEkC,SAAU,SAAUC,eAAgB,WAAYC,cAAe,GAAIxC,SAAA,EACnGD,EAAAA,EAAAA,KAAA,SAAAC,UACEC,EAAAA,EAAAA,MAAA,MAAAD,SAAA,EACED,EAAAA,EAAAA,KAAA,MAAIK,MAAO,CAAEqC,MAAO,QAASzC,SAAC,WAC9BC,EAAAA,EAAAA,MAAA,MAAIG,MAAO,CAAEqC,MAAO,QAASC,OAAQ,WAAaV,QAASA,IAAMnC,EAAW,SAASG,SAAA,CAAC,SAAoB,UAAbxC,EAAKE,IAAgC,QAAbF,EAAKG,IAAgB,SAAM,SAAO,OACvJsC,EAAAA,EAAAA,MAAA,MAAIG,MAAO,CAAEqC,MAAO,QAASC,OAAQ,WAAaV,QAASA,IAAMnC,EAAW,UAAUG,SAAA,CAAC,UAAqB,WAAbxC,EAAKE,IAAiC,QAAbF,EAAKG,IAAgB,SAAM,SAAO,OAC1JoC,EAAAA,EAAAA,KAAA,MAAIK,MAAO,CAAEqC,MAAO,SAAUzC,SAAC,cAC/BC,EAAAA,EAAAA,MAAA,MAAIG,MAAO,CAAEqC,MAAO,QAASC,OAAQ,WAAaV,QAASA,IAAMnC,EAAW,QAAQG,SAAA,CAAC,QAAmB,SAAbxC,EAAKE,IAA+B,QAAbF,EAAKG,IAAgB,SAAM,SAAO,OACpJoC,EAAAA,EAAAA,KAAA,MAAIK,MAAO,CAAEqC,MAAO,SAAUzC,SAAC,WAC/BD,EAAAA,EAAAA,KAAA,MAAIK,MAAO,CAAEqC,MAAO,SAAUzC,SAAC,eAC/BC,EAAAA,EAAAA,MAAA,MAAIG,MAAO,CAAEqC,MAAO,QAASC,OAAQ,WAAaV,QAASA,IAAMnC,EAAW,aAAaG,SAAA,CAAC,aAAwB,cAAbxC,EAAKE,IAAoC,QAAbF,EAAKG,IAAgB,SAAM,SAAO,OACnKsC,EAAAA,EAAAA,MAAA,MAAIG,MAAO,CAAEqC,MAAO,OAAQC,OAAQ,UAAWjC,WAAY,0BAA2BkC,aAAc,qBAAuBX,QAASA,IAAMnC,EAAW,SAASG,SAAA,CAAC,SAAoB,UAAbxC,EAAKE,IAAgC,QAAbF,EAAKG,IAAgB,SAAM,SAAO,OAChOsC,EAAAA,EAAAA,MAAA,MAAIG,MAAO,CAAEqC,MAAO,OAAQC,OAAQ,UAAWjC,WAAY,2BAA4BkC,aAAc,qBAAuBX,QAASA,IAAMnC,EAAW,kBAAkBG,SAAA,CAAC,YAAuB,mBAAbxC,EAAKE,IAAyC,QAAbF,EAAKG,IAAgB,SAAM,SAAO,OACtPsC,EAAAA,EAAAA,MAAA,MAAIG,MAAO,CAAEqC,MAAO,OAAQC,OAAQ,UAAWjC,WAAY,yBAA0BkC,aAAc,qBAAuBX,QAASA,IAAMnC,EAAW,eAAeG,SAAA,CAAC,SAAoB,gBAAbxC,EAAKE,IAAsC,QAAbF,EAAKG,IAAgB,SAAM,SAAO,OAC3OoC,EAAAA,EAAAA,KAAA,MAAIK,MAAO,CAAEqC,MAAO,SAAUzC,SAAC,gBAC/BD,EAAAA,EAAAA,KAAA,MAAIK,MAAO,CAAEqC,MAAO,SAAUzC,SAAC,kBAGnCD,EAAAA,EAAAA,KAAA,SAAAC,SACGxD,GACCuD,EAAAA,EAAAA,KAAA,MAAAC,UAAID,EAAAA,EAAAA,KAAA,MAAI6C,QAAS,GAAIxC,MAAO,CAAES,MAAO,UAAWgC,UAAW,UAAW7C,SAAC,iBACrD,IAAhBrD,EAAKwD,QACPJ,EAAAA,EAAAA,KAAA,MAAAC,UAAID,EAAAA,EAAAA,KAAA,MAAI6C,QAAS,GAAIxC,MAAO,CAAES,MAAO,UAAWgC,UAAW,UAAW7C,SAAC,cACrErD,EAAKiF,IAAIjC,IAAG,IAAAmD,EAAA,OACd7C,EAAAA,EAAAA,MAAA,MAAAD,SAAA,EACED,EAAAA,EAAAA,KAAA,MAAAC,SAAKL,EAAIoD,WAAYhD,EAAAA,EAAAA,KAAA,OAAKiD,IAAKrD,EAAIoD,UAAWE,IAAI,QAAQ7C,MAAO,CAAEqC,MAAO,GAAIS,OAAQ,GAAIC,UAAW,QAASxC,aAAc,MAAUZ,EAAAA,EAAAA,KAAA,QAAMG,UAAU,QAAOF,SAAC,gBAC9JD,EAAAA,EAAAA,KAAA,MAAAC,SACGpC,IAAc+B,EAAImC,IACjB/B,EAAAA,EAAAA,KAAA,SAAOG,UAAU,QAAQqB,MAAOzD,EAAUsF,MAAO5B,SAAWC,GAAM1D,GAAYsF,EAAAA,EAAAA,IAAAA,EAAAA,EAAAA,GAAC,CAAC,EAAIvF,GAAS,IAAEsF,MAAO3B,EAAEC,OAAOH,WAC7G5B,EAAIyD,SAEVrD,EAAAA,EAAAA,KAAA,MAAAC,SACGpC,IAAc+B,EAAImC,IACjB/B,EAAAA,EAAAA,KAAA,SAAOG,UAAU,QAAQqB,MAAOzD,EAAUwF,OAAQ9B,SAAWC,GAAM1D,GAAYsF,EAAAA,EAAAA,IAAAA,EAAAA,EAAAA,GAAC,CAAC,EAAIvF,GAAS,IAAEwF,OAAQ7B,EAAEC,OAAOH,WAC/G5B,EAAI2D,UAEVvD,EAAAA,EAAAA,KAAA,MAAAC,SACGpC,IAAc+B,EAAImC,IACjB7B,EAAAA,EAAAA,MAAA,UAAQC,UAAU,SAASqB,MAAOzD,EAAUyF,aAAe,GAAI/B,SAAWC,GAAM1D,GAAYsF,EAAAA,EAAAA,IAAAA,EAAAA,EAAAA,GAAC,CAAC,EAAIvF,GAAS,IAAEyF,YAAa9B,EAAEC,OAAOH,OAAS,QAAQvB,SAAA,EAClJD,EAAAA,EAAAA,KAAA,UAAQwB,MAAM,GAAEvB,SAAC,kBAChB5C,EAAWwE,IAAIC,IAAK9B,EAAAA,EAAAA,KAAA,UAAmBwB,MAAOM,EAAEC,GAAG9B,SAAE6B,EAAEE,MAAtBF,EAAEC,SAEW,QAA9CgB,EAAA1F,EAAWoG,KAAK3B,GAAKA,EAAEC,KAAOnC,EAAI4D,oBAAY,IAAAT,OAAA,EAA9CA,EAAgDf,OAAQ,YAE/DhC,EAAAA,EAAAA,KAAA,MAAAC,SACGpC,IAAc+B,EAAImC,IACjB/B,EAAAA,EAAAA,KAAA,SAAOG,UAAU,QAAQqB,MAAOzD,EAAU2F,KAAMjC,SAAWC,GAAM1D,GAAYsF,EAAAA,EAAAA,IAAAA,EAAAA,EAAAA,GAAC,CAAC,EAAIvF,GAAS,IAAE2F,KAAMhC,EAAEC,OAAOH,WAC1G5B,EAAI8D,MAAQ,YAEnB1D,EAAAA,EAAAA,KAAA,MAAAC,SACGpC,IAAc+B,EAAImC,IACjB/B,EAAAA,EAAAA,KAAA,SAAOG,UAAU,QAAQwD,KAAK,SAAS/B,YAAY,QAAQJ,MAAOzD,EAAU6F,MAAOnC,SAAWC,GAAM1D,GAAYsF,EAAAA,EAAAA,IAAAA,EAAAA,EAAAA,GAAC,CAAC,EAAIvF,GAAS,IAAE6F,MAAOlC,EAAEC,OAAOH,WAC9I5B,EAAIgE,OAAS,YAEpB5D,EAAAA,EAAAA,KAAA,MAAAC,SACGpC,IAAc+B,EAAImC,IACjB/B,EAAAA,EAAAA,KAAA,SAAOG,UAAU,QAAQyB,YAAY,YAAYJ,MAAOzD,EAAU8F,UAAWpC,SAAWC,GAAM1D,GAAYsF,EAAAA,EAAAA,IAAAA,EAAAA,EAAAA,GAAC,CAAC,EAAIvF,GAAS,IAAE8F,UAAWnC,EAAEC,OAAOH,WAC5I5B,EAAIiE,WAAa,YAExB7D,EAAAA,EAAAA,KAAA,MAAAC,SAAKL,EAAIwB,WAAa,KACtBpB,EAAAA,EAAAA,KAAA,MAAIK,MAAO,CAAEW,WAAY,MAAOF,MAAO,WAAYb,SAAEL,EAAIyB,OAAS,KAClErB,EAAAA,EAAAA,KAAA,MAAIK,MAAO,CAAEW,WAAY,MAAOF,MAAO,WAAYb,SAAEL,EAAI0B,gBAAkB,KAC3EtB,EAAAA,EAAAA,KAAA,MAAIK,MAAO,CAAEW,WAAY,MAAOF,MAAO,WAAYb,SAAEL,EAAI2B,aAAe,KACxEvB,EAAAA,EAAAA,KAAA,MAAAC,SAAK,IAAI6D,KAAKlE,EAAImE,YAAYC,wBAC9BhE,EAAAA,EAAAA,KAAA,MAAAC,SACGpC,IAAc+B,EAAImC,IACjB7B,EAAAA,EAAAA,MAAA,OAAKG,MAAO,CAAEC,QAAS,OAAQ2D,cAAe,SAAUzD,IAAK,OAAQ+B,SAAU,SAAUtC,SAAA,EACvFC,EAAAA,EAAAA,MAAA,OAAAD,SAAA,EACED,EAAAA,EAAAA,KAAA,SAAOG,UAAU,QAAOF,SAAC,iBACzBC,EAAAA,EAAAA,MAAA,OACEC,UAAU,kBACV8B,QAASA,IAAMiC,SAASC,eAAe,aAADC,OAAcxE,EAAImC,KAAMsC,QAC9DhE,MAAO,CACLM,OAAQ,oBACRC,aAAc,MACdC,QAAS,WACT8B,OAAQ,UACRrC,QAAS,OACTgE,WAAY,SACZ9D,IAAK,MACLE,WAAYzC,EAAS,yBAA2B,cAChD6C,MAAO7C,EAAS,UAAY,UAC5BsG,WAAY,YACZtE,SAAA,EAEFD,EAAAA,EAAAA,KAAA,SACE+B,GAAE,aAAAqC,OAAexE,EAAImC,IACrB4B,KAAK,OACLa,OAAO,kBACP/C,SAAWC,IAAC,IAAA+C,EAAA,OAAKvG,GAAwB,QAAduG,EAAA/C,EAAEC,OAAO+C,aAAK,IAAAD,OAAA,EAAdA,EAAiB,KAAM,OAClDpE,MAAO,CAAEC,QAAS,UAEnBrC,GACCiC,EAAAA,EAAAA,MAAAyE,EAAAA,SAAA,CAAA1E,SAAA,CAAE,gBAAIhC,EAAO+D,KAAK4C,MAAM,EAAG,IAAK3G,EAAO+D,KAAK5B,OAAS,GAAK,MAAQ,OAElEJ,EAAAA,EAAAA,KAAA2E,EAAAA,SAAA,CAAA1E,SAAE,mCAIRC,EAAAA,EAAAA,MAAA,OAAAD,SAAA,EACED,EAAAA,EAAAA,KAAA,SAAOG,UAAU,QAAOF,SAAC,mBACzBC,EAAAA,EAAAA,MAAA,OACEC,UAAU,kBACV8B,QAASA,IAAMiC,SAASC,eAAe,eAADC,OAAgBxE,EAAImC,KAAMsC,QAChEhE,MAAO,CACLM,OAAQ,oBACRC,aAAc,MACdC,QAAS,WACT8B,OAAQ,UACRrC,QAAS,OACTgE,WAAY,SACZ9D,IAAK,MACLE,WAAYvC,EAAW,yBAA2B,cAClD2C,MAAO3C,EAAW,UAAY,UAC9BoG,WAAY,YACZtE,SAAA,EAEFD,EAAAA,EAAAA,KAAA,SACE+B,GAAE,eAAAqC,OAAiBxE,EAAImC,IACvB4B,KAAK,OACLa,OAAO,UACP/C,SAAWC,IAAC,IAAAmD,EAAA,OAAKzG,GAA0B,QAAdyG,EAAAnD,EAAEC,OAAO+C,aAAK,IAAAG,OAAA,EAAdA,EAAiB,KAAM,OACpDxE,MAAO,CAAEC,QAAS,UAEnBnC,GACC+B,EAAAA,EAAAA,MAAAyE,EAAAA,SAAA,CAAA1E,SAAA,CAAE,sBAAK9B,EAAS6D,KAAK4C,MAAM,EAAG,IAAKzG,EAAS6D,KAAK5B,OAAS,GAAK,MAAQ,OAEvEJ,EAAAA,EAAAA,KAAA2E,EAAAA,SAAA,CAAA1E,SAAE,2CAIRC,EAAAA,EAAAA,MAAA,OAAKG,MAAO,CAAEC,QAAS,OAAQE,IAAK,MAAOsE,UAAW,OAAQ7E,SAAA,EAC5DD,EAAAA,EAAAA,KAAA,UAAQG,UAAU,cAAc8B,QAASA,IApOhD7C,WACf,IAAKO,IAEH,YADArB,EAAU,CAAEqF,KAAM,QAASoB,QAAS,0CAGtC,MAAMC,GAAO1B,EAAAA,EAAAA,GAAA,GAAQvF,GAErB,UACQkH,EAAAA,EAAAA,IAAWrF,EAAImC,GAAI,CAAEiD,UAASE,WAAYjH,EAAQkH,aAAchH,EAAUiH,YAAaxF,EAAIyF,YACjGxF,UACMV,IACNb,EAAU,CAAEqF,KAAM,UAAWoB,QAAS,yBACxC,CAAE,MAAOrD,GACP4D,QAAQC,MAAM,yBAA0B7D,GACxCpD,EAAU,CAAEqF,KAAM,QAASoB,SAAU,OAADrD,QAAC,IAADA,OAAC,EAADA,EAAGqD,UAAW,0BACpD,GAqNqES,CAAS5F,GAAKK,SAAC,UAC9DD,EAAAA,EAAAA,KAAA,UAAQG,UAAU,MAAM8B,QAASpC,EAAWI,SAAC,kBAIjDC,EAAAA,EAAAA,MAAA,OAAKC,UAAU,UAASF,SAAA,EACtBD,EAAAA,EAAAA,KAAA,UACEG,UAAU,MACV8B,QAASA,IAvQdrC,KACZD,KAIL7B,EAAa8B,EAAImC,IACjB/D,EAAa,CACXqF,MAAOzD,EAAIyD,OAAS,GACpBE,OAAQ3D,EAAI2D,QAAU,GACtBG,KAAM9D,EAAI8D,MAAQ,GAClBF,YAAa5D,EAAI4D,aAAe,KAChCiC,SAAU7F,EAAI6F,UAAY,GAC1BC,KAAM9F,EAAI8F,MAAQ,GAClB9B,MAAOhE,EAAIgE,OAAS,GACpBC,UAAWjE,EAAIiE,WAAa,KAE9B3F,EAAU,MACVE,EAAY,OAfVE,EAAU,CAAEqF,KAAM,QAASoB,QAAS,mDAqQDY,CAAU/F,GACzBgG,UAAWjG,IAAaM,SACzB,UAGDD,EAAAA,EAAAA,KAAA,UACEG,UAAU,MACV8B,QAASA,IAjOZ7C,WACnB,IAAKO,IAEH,YADArB,EAAU,CAAEqF,KAAM,QAASoB,QAAS,4CAUtC,SAPiB1G,EAAQ,CACvBgF,MAAO,eACP0B,QAAQ,WAADX,OAAaxE,EAAIyD,MAAK,kDAC7BwC,aAAc,SACdC,YAAa,SACbC,QAAS,WAIX,UACQC,EAAAA,EAAAA,IAAW,CAAEjE,GAAInC,EAAImC,GAAIsD,UAAWzF,EAAIyF,kBACxClG,IACNb,EAAU,CAAEqF,KAAM,UAAWoB,QAAS,iBACxC,CAAE,MAAOrD,GACP4D,QAAQC,MAAM,yBAA0B7D,GACxCpD,EAAU,CAAEqF,KAAM,QAASoB,SAAU,OAADrD,QAAC,IAADA,OAAC,EAADA,EAAGqD,UAAW,0BACpD,GA4MqCkB,CAAarG,GAC5BgG,UAAWjG,IAAaM,SACzB,kBA7HAL,EAAImC,cAyIrB7B,EAAAA,EAAAA,MAAA,OAAKG,MAAO,CACVC,QAAS,OACT4F,eAAgB,SAChB5B,WAAY,SACZ9D,IAAK,OACLsE,UAAW,OACXrE,aAAc,QACdR,SAAA,EACAD,EAAAA,EAAAA,KAAA,UACEiC,QAASA,IAAMhF,EAAQkJ,GAAKnH,KAAKC,IAAI,EAAGkH,EAAI,IAC5CP,SAAU5I,GAAQ,EAClBqD,MAAO,CACLQ,QAAS,WACTH,WAAY1D,GAAQ,EAAI,UAAY,oDACpC8D,MAAO9D,GAAQ,EAAI,OAAS,OAC5B2D,OAAQ,OACRC,aAAc,MACd+B,OAAQ3F,GAAQ,EAAI,cAAgB,UACpC+D,SAAU,OACVC,WAAY,MACZuD,WAAY,WACZ6B,QAASpJ,GAAQ,EAAI,GAAM,GAC3BiD,SACH,iBAGDC,EAAAA,EAAAA,MAAA,QAAMG,MAAO,CAAES,MAAO,UAAWC,SAAU,OAAQC,WAAY,MAAOuB,SAAU,QAASO,UAAW,UAAW7C,SAAA,CAAC,QACxGjD,EAAK,OAAK8B,MAElBkB,EAAAA,EAAAA,KAAA,UACEiC,QAASA,IAAMhF,EAAQkJ,GAAKnH,KAAKqH,IAAIvH,EAAYqH,EAAI,IACrDP,SAAU5I,GAAQ8B,EAClBuB,MAAO,CACLQ,QAAS,WACTH,WAAY1D,GAAQ8B,EAAa,UAAY,oDAC7CgC,MAAO9D,GAAQ8B,EAAa,OAAS,OACrC6B,OAAQ,OACRC,aAAc,MACd+B,OAAQ3F,GAAQ8B,EAAa,cAAgB,UAC7CiC,SAAU,OACVC,WAAY,MACZuD,WAAY,WACZ6B,QAASpJ,GAAQ8B,EAAa,GAAM,GACpCmB,SACH,yB,kCC7XX,MA+OA,EA/O+B1D,IAAsB,IAArB,YAAEC,GAAaD,EAC7C,MAAOE,EAASC,IAAcC,EAAAA,EAAAA,WAAS,IAChCC,EAAMC,IAAWF,EAAAA,EAAAA,UAAS,KAC1BG,EAAOC,IAAYJ,EAAAA,EAAAA,UAAS,IAC5BK,EAAMC,IAAWN,EAAAA,EAAAA,UAAS,IAC1BO,IAAYP,EAAAA,EAAAA,UAAS,KACrBQ,EAAQC,IAAaT,EAAAA,EAAAA,UAAS,KAC9Bc,EAAMC,IAAWf,EAAAA,EAAAA,UAAS,CAAEgB,IAAK,aAAcC,IAAK,UACpDC,EAAWC,IAAgBnB,EAAAA,EAAAA,UAAS,OACpCoB,EAAWC,IAAgBrB,EAAAA,EAAAA,UAAS,CAAC,IACrCwB,EAAUC,IAAezB,EAAAA,EAAAA,UAAS,OAClC2J,EAAaC,IAAkB5J,EAAAA,EAAAA,UAAS,CAAC,IAE1C,QAAE0B,EAAO,UAAEC,IAAcC,EAAAA,EAAAA,KAEzBC,EAAe,CAAC,2BAA4B,4BAC5CC,EAAgC,WAAX,OAAXjC,QAAW,IAAXA,OAAW,EAAXA,EAAakC,OAAoBF,EAAaG,SAAoB,OAAXnC,QAAW,IAAXA,OAAW,EAAXA,EAAaoC,OAC9EC,EAAiC,YAAX,OAAXrC,QAAW,IAAXA,OAAW,EAAXA,EAAakC,OAAqBF,EAAaG,SAAoB,OAAXnC,QAAW,IAAXA,OAAW,EAAXA,EAAaoC,OAEhFE,GAAaC,EAAAA,EAAAA,SAAQ,IAAMC,KAAKC,IAAI,EAAGD,KAAKE,KAAKpC,EAAQI,IAAY,CAACJ,EAAOI,IAE7EiC,EAAOC,UACX1C,GAAW,GACX,IACE,MAAM,KAAE2C,EAAMvC,MAAOwC,SAAgBkH,EAAAA,EAAAA,IAAkB,CAAExJ,OAAME,WAAUC,SAAQM,SACjFZ,EAAQwC,GACRtC,EAASuC,GAGT,MAAMmH,EAAS,CAAC,EAChB,IAAK,MAAMC,KAAOrH,EAChBoH,EAAOC,EAAI3E,UAAY4E,EAAAA,EAAAA,IAA8BD,EAAI3E,IAE3DwE,EAAeE,EACjB,CAAC,QAAW/J,GAAW,EAAQ,IAGjC8C,EAAAA,EAAAA,WAAU,KACJhD,GAAa2C,KAChB,CAACnC,EAAMG,EAAQM,EAAKE,IAAKF,EAAKG,IAAKpB,IAEtC,MAAMmD,EAAWC,KACXnB,KACAI,EAqBAgB,EAAaA,KACjB/B,EAAa,MACbE,EAAa,CAAC,GACdI,EAAY,OA2DR0B,EAAcnC,IAClBD,EAASqC,GAAOA,EAAEpC,MAAQA,EAAM,CAAEA,MAAKC,IAAe,QAAVmC,EAAEnC,IAAgB,OAAS,OAAU,CAAED,MAAKC,IAAK,SAG/F,OACEoC,EAAAA,EAAAA,KAAA,OAAAC,UACEC,EAAAA,EAAAA,MAAA,OAAKC,UAAU,QAAOF,SAAA,EACpBD,EAAAA,EAAAA,KAAA,OAAKG,UAAU,cAAaF,SAAC,6BAG3BxD,GAAWG,EAAKwD,OAAS,IACzBF,EAAAA,EAAAA,MAAA,OAAKG,MAAO,CAAEC,QAAS,OAAQC,oBAAqB,uCAAwCC,IAAK,MAAOC,aAAc,QAASR,SAAA,EAC7HC,EAAAA,EAAAA,MAAA,OAAKG,MAAO,CAAEK,WAAY,UAAWC,OAAQ,oBAAqBC,aAAc,MAAOC,QAAS,WAAYC,MAAO,UAAWC,SAAU,WAAYd,SAAA,EAClJD,EAAAA,EAAAA,KAAA,OAAKK,MAAO,CAAES,MAAO,UAAWC,SAAU,SAAUC,WAAY,OAAQf,SAAErD,EAAKqE,OAAO,CAACC,EAAKC,IAAMD,GAAOC,EAAEE,OAAS,GAAI,MACxHrB,EAAAA,EAAAA,KAAA,OAAAC,SAAK,oBAEPC,EAAAA,EAAAA,MAAA,OAAKG,MAAO,CAAEK,WAAY,UAAWC,OAAQ,oBAAqBC,aAAc,MAAOC,QAAS,WAAYC,MAAO,UAAWC,SAAU,WAAYd,SAAA,EAClJD,EAAAA,EAAAA,KAAA,OAAKK,MAAO,CAAES,MAAO,UAAWC,SAAU,SAAUC,WAAY,OAAQf,SAAErD,EAAKqE,OAAO,CAACC,EAAKC,IAAMD,GAAOC,EAAEI,aAAe,GAAI,MAC9HvB,EAAAA,EAAAA,KAAA,OAAAC,SAAK,oBAEPC,EAAAA,EAAAA,MAAA,OAAKG,MAAO,CAAEK,WAAY,UAAWC,OAAQ,oBAAqBC,aAAc,MAAOC,QAAS,WAAYC,MAAO,UAAWC,SAAU,WAAYd,SAAA,EAClJC,EAAAA,EAAAA,MAAA,OAAKG,MAAO,CAAES,MAAO,UAAWC,SAAU,SAAUC,WAAY,OAAQf,SAAA,CAAErD,EAAKwD,OAAO,IAAEtD,MACxFkD,EAAAA,EAAAA,KAAA,OAAAC,SAAK,6BAKXC,EAAAA,EAAAA,MAAA,OAAKC,UAAU,QAAQE,MAAO,CAAEI,aAAc,GAAIR,SAAA,EAChDD,EAAAA,EAAAA,KAAA,SAAOG,UAAU,QAAOF,SAAC,YACzBD,EAAAA,EAAAA,KAAA,SAAOG,UAAU,QAAQqB,MAAOrE,EAAQsE,SAAWC,IAAQzE,EAAQ,GAAIG,EAAUsE,EAAEC,OAAOH,QAAWI,YAAY,sCAGnH5B,EAAAA,EAAAA,KAAA,OAAKG,UAAU,UAAUE,MAAO,CAAEI,aAAc,GAAIR,UAClDD,EAAAA,EAAAA,KAAA,UAAQG,UAAU,cAAc8B,QAASA,IAAOC,OAAOC,SAASC,KAAO,sBAAuBnC,SAAC,0BAGjGD,EAAAA,EAAAA,KAAA,OAAKG,UAAU,QAAQE,MAAO,CAAEQ,QAAS,EAAGwB,UAAW,QAASpC,UAC9DC,EAAAA,EAAAA,MAAA,SAAOC,UAAU,QAAQE,MAAO,CAAEkC,SAAU,UAAWtC,SAAA,EACrDD,EAAAA,EAAAA,KAAA,SAAAC,UACEC,EAAAA,EAAAA,MAAA,MAAAD,SAAA,EACED,EAAAA,EAAAA,KAAA,MAAIK,MAAO,CAAEqC,MAAO,QAASzC,SAAC,WAC9BC,EAAAA,EAAAA,MAAA,MAAIG,MAAO,CAAEqC,MAAO,QAASC,OAAQ,WAAaV,QAASA,IAAMnC,EAAW,QAAQG,SAAA,CAAC,QAAmB,SAAbxC,EAAKE,IAA+B,QAAbF,EAAKG,IAAgB,SAAM,SAAO,OACpJoC,EAAAA,EAAAA,KAAA,MAAIK,MAAO,CAAEqC,MAAO,SAAUzC,SAAC,iBAC/BD,EAAAA,EAAAA,KAAA,MAAIK,MAAO,CAAEqC,MAAO,SAAUzC,SAAC,cAC/BC,EAAAA,EAAAA,MAAA,MAAIG,MAAO,CAAEqC,MAAO,QAASC,OAAQ,WAAaV,QAASA,IAAMnC,EAAW,eAAeG,SAAA,CAAC,QAAmB,gBAAbxC,EAAKE,IAAsC,QAAbF,EAAKG,IAAgB,SAAM,SAAO,OAClKoC,EAAAA,EAAAA,KAAA,MAAIK,MAAO,CAAEqC,MAAO,SAAUzC,SAAC,cAC/BC,EAAAA,EAAAA,MAAA,MAAIG,MAAO,CAAEqC,MAAO,OAAQC,OAAQ,UAAWjC,WAAY,0BAA2BkC,aAAc,qBAAuBX,QAASA,IAAMnC,EAAW,eAAeG,SAAA,CAAC,SAAoB,gBAAbxC,EAAKE,IAAsC,QAAbF,EAAKG,IAAgB,SAAM,SAAO,OAC5OsC,EAAAA,EAAAA,MAAA,MAAIG,MAAO,CAAEqC,MAAO,OAAQC,OAAQ,UAAWjC,WAAY,yBAA0BkC,aAAc,qBAAuBX,QAASA,IAAMnC,EAAW,eAAeG,SAAA,CAAC,SAAoB,gBAAbxC,EAAKE,IAAsC,QAAbF,EAAKG,IAAgB,SAAM,SAAO,OAC3OoC,EAAAA,EAAAA,KAAA,MAAIK,MAAO,CAAEqC,MAAO,OAAQhC,WAAY,2BAA4BkC,aAAc,qBAAsB3C,SAAC,YACzGD,EAAAA,EAAAA,KAAA,MAAIK,MAAO,CAAEqC,MAAO,SAAUzC,SAAC,kBAGnCD,EAAAA,EAAAA,KAAA,SAAAC,SACGxD,GACCuD,EAAAA,EAAAA,KAAA,MAAAC,UAAID,EAAAA,EAAAA,KAAA,MAAI6C,QAAS,GAAIxC,MAAO,CAAEyC,UAAW,SAAUhC,MAAO,WAAYb,SAAC,iBACrD,IAAhBrD,EAAKwD,QACPJ,EAAAA,EAAAA,KAAA,MAAAC,UAAID,EAAAA,EAAAA,KAAA,MAAI6C,QAAS,GAAIxC,MAAO,CAAEyC,UAAW,SAAUhC,MAAO,WAAYb,SAAC,cACrErD,EAAKiF,IAAIjC,IAAG,IAAAgH,EAAAC,EAAA,OACd3G,EAAAA,EAAAA,MAAA,MAAAD,SAAA,EACED,EAAAA,EAAAA,KAAA,MAAAC,SAAKL,EAAIkH,iBAAkB9G,EAAAA,EAAAA,KAAA,OAAKiD,IAAKrD,EAAIkH,gBAAiB5D,IAAI,QAAQ7C,MAAO,CAAEqC,MAAO,GAAIS,OAAQ,GAAIC,UAAW,QAASxC,aAAc,MAAUZ,EAAAA,EAAAA,KAAA,QAAMG,UAAU,QAAOF,SAAC,gBAC1KD,EAAAA,EAAAA,KAAA,MAAAC,SACGpC,IAAc+B,EAAImC,IACjB/B,EAAAA,EAAAA,KAAA,SAAOG,UAAU,QAAQqB,MAAOzD,EAAUiE,KAAMP,SAAWC,GAAM1D,GAAYsF,EAAAA,EAAAA,IAAAA,EAAAA,EAAAA,GAAC,CAAC,EAAIvF,GAAS,IAAEiE,KAAMN,EAAEC,OAAOH,WAC3G5B,EAAIoC,QAEVhC,EAAAA,EAAAA,KAAA,MAAAC,SACGpC,IAAc+B,EAAImC,IACjB/B,EAAAA,EAAAA,KAAA,YAAUG,UAAU,QAAQvD,KAAM,EAAG4E,MAAOzD,EAAUgJ,YAAatF,SAAWC,GAAM1D,GAAYsF,EAAAA,EAAAA,IAAAA,EAAAA,EAAAA,GAAC,CAAC,EAAIvF,GAAS,IAAEgJ,YAAarF,EAAEC,OAAOH,YACrH,QAAfoF,EAAAhH,EAAImH,mBAAW,IAAAH,OAAA,EAAfA,EAAiBhC,MAAM,EAAG,OAAQ,YAEzC5E,EAAAA,EAAAA,KAAA,MAAAC,SACGpC,IAAc+B,EAAImC,IACjB/B,EAAAA,EAAAA,KAAA,SAAOG,UAAU,QAAQqB,MAAOzD,EAAUoE,SAAUV,SAAWC,GAAM1D,GAAYsF,EAAAA,EAAAA,IAAAA,EAAAA,EAAAA,GAAC,CAAC,EAAIvF,GAAS,IAAEoE,SAAUT,EAAEC,OAAOH,WAClH5B,EAAIuC,UAAY,YAEvBnC,EAAAA,EAAAA,KAAA,MAAAC,SACGpC,IAAc+B,EAAImC,IACjB/B,EAAAA,EAAAA,KAAA,SAAOG,UAAU,QAAQwD,KAAK,SAASnC,MAAOzD,EAAUiJ,YAAavF,SAAWC,GAAM1D,GAAYsF,EAAAA,EAAAA,IAAAA,EAAAA,EAAAA,GAAC,CAAC,EAAIvF,GAAS,IAAEiJ,YAAatF,EAAEC,OAAOH,WACtI5B,EAAIoH,aAAe,YAE1BhH,EAAAA,EAAAA,KAAA,MAAAC,UAAsB,QAAjB4G,EAAAjH,EAAIqH,qBAAa,IAAAJ,OAAA,EAAjBA,EAAmBK,mBAAoB,YAC5ClH,EAAAA,EAAAA,KAAA,MAAIK,MAAO,CAAEW,WAAY,MAAOF,MAAO,WAAYb,SAAEL,EAAIyB,OAAS,KAClErB,EAAAA,EAAAA,KAAA,MAAIK,MAAO,CAAEW,WAAY,MAAOF,MAAO,WAAYb,SAAEL,EAAI2B,aAAe,KACxEvB,EAAAA,EAAAA,KAAA,MAAIK,MAAO,CAAEW,WAAY,MAAOF,MAAO,WAAYb,SAAEqG,EAAY1G,EAAImC,KAAO,KAC5E/B,EAAAA,EAAAA,KAAA,MAAAC,SACGpC,IAAc+B,EAAImC,IACjB7B,EAAAA,EAAAA,MAAA,OAAKG,MAAO,CAAEC,QAAS,OAAQE,IAAK,MAAOyD,cAAe,UAAWhE,SAAA,EACnED,EAAAA,EAAAA,KAAA,UAAQG,UAAU,cAAc8B,QAASA,IA/I9C7C,WACf,IAAKO,IAEH,YADArB,EAAU,CAAEqF,KAAM,QAASoB,QAAS,wDAGtC,MAAMC,GAAO1B,EAAAA,EAAAA,GAAA,GAAQvF,GAGO,KAAxBiH,EAAQgC,kBAA8CG,IAAxBnC,EAAQgC,YACxChC,EAAQgC,YAAc,KAEtBhC,EAAQgC,YAAcI,OAAOpC,EAAQgC,aAGT,KAA1BhC,EAAQiC,oBAAkDE,IAA1BnC,EAAQiC,cAC1CjC,EAAQiC,cAAgB,KAExBjC,EAAQiC,cAAgBG,OAAOpC,EAAQiC,eAGzC,UACQI,EAAAA,EAAAA,IAAiBzH,EAAImC,GAAI,CAAEiD,UAASG,aAAchH,IACxD0B,UACMV,IACNb,EAAU,CAAEqF,KAAM,UAAWoB,QAAS,oCACxC,CAAE,MAAOrD,GACP4D,QAAQC,MAAM,+BAAgC7D,GAC9CpD,EAAU,CAAEqF,KAAM,QAASoB,SAAU,OAADrD,QAAC,IAADA,OAAC,EAADA,EAAGqD,UAAW,gCACpD,GAmHmES,CAAS5F,GAAKK,SAAC,UAC9DD,EAAAA,EAAAA,KAAA,UAAQG,UAAU,MAAM8B,QAASpC,EAAWI,SAAC,eAG/CC,EAAAA,EAAAA,MAAA,OAAKC,UAAU,UAASF,SAAA,EACtBD,EAAAA,EAAAA,KAAA,UAAQG,UAAU,MAAM8B,QAASA,IA3KpCrC,KACZD,KAIL7B,EAAa8B,EAAImC,IACjB/D,EAAa,CACXgE,KAAMpC,EAAIoC,MAAQ,GAClB+E,YAAanH,EAAImH,aAAe,GAChCO,YAAa1H,EAAI0H,aAAe,GAChCnF,SAAUvC,EAAIuC,UAAY,GAC1B6E,YAAapH,EAAIoH,aAAe,GAChCC,cAAerH,EAAIqH,eAAiB,KAEtC7I,EAAY,OAZVE,EAAU,CAAEqF,KAAM,QAASoB,QAAS,yDAyKqBY,CAAU/F,GAAMgG,UAAWjG,IAAaM,SAAC,UAChFD,EAAAA,EAAAA,KAAA,UAAQG,UAAU,MAAM8B,QAASA,IAtHlC7C,WACnB,IAAKO,IAEH,YADArB,EAAU,CAAEqF,KAAM,QAASoB,QAAS,mDAWtC,SAPiB1G,EAAQ,CACvBgF,MAAO,qBACP0B,QAAQ,WAADX,OAAaxE,EAAIoC,KAAI,yDAC5B6D,aAAc,SACdC,YAAa,SACbC,QAAS,WAIX,UACQwB,EAAAA,EAAAA,IAAiB,CAAExF,GAAInC,EAAImC,GAAI+E,gBAAiBlH,EAAIkH,wBACpD3H,IACNb,EAAU,CAAEqF,KAAM,UAAWoB,QAAS,uBACxC,CAAE,MAAOyC,GACPlC,QAAQC,MAAM,+BAAgCiC,GAC9ClJ,EAAU,CAAEqF,KAAM,QAASoB,SAAY,OAAHyC,QAAG,IAAHA,OAAG,EAAHA,EAAKzC,UAAW,gCACtD,GAgG2DkB,CAAarG,GAAMgG,UAAWjG,IAAaM,SAAC,kBAnClFL,EAAImC,cA6CrB7B,EAAAA,EAAAA,MAAA,OAAKC,UAAU,UAAUE,MAAO,CAAEyE,UAAW,GAAI7E,SAAA,EAC/CD,EAAAA,EAAAA,KAAA,UAAQG,UAAU,MAAMyF,SAAU5I,GAAQ,EAAGiF,QAASA,IAAMhF,EAAQkJ,GAAKnH,KAAKC,IAAI,EAAGkH,EAAI,IAAIlG,SAAC,UAC9FC,EAAAA,EAAAA,MAAA,QAAMG,MAAO,CAAES,MAAO,WAAYb,SAAA,CAAC,QAAMjD,EAAK,OAAK8B,MACnDkB,EAAAA,EAAAA,KAAA,UAAQG,UAAU,MAAMyF,SAAU5I,GAAQ8B,EAAYmD,QAASA,IAAMhF,EAAQkJ,GAAKnH,KAAKqH,IAAIvH,EAAYqH,EAAI,IAAIlG,SAAC,kBCzOpHwH,EAAmBC,IACvB,IAAKA,EAAW,MAAO,SACvB,IAEE,OADa,IAAI5D,KAAK4D,GACVR,eAAe,QAAS,CAClCxD,KAAM,UACNiE,MAAO,QACPC,IAAK,UACLC,KAAM,UACNC,OAAQ,UACRC,OAAQ,UACRC,QAAQ,EACRC,aAAc,SAElB,CAAE,MAAOvG,GACP,OAAOgG,CACT,GA+oBF,EA5oB6BnL,IAAsB,IAArB,YAAEC,GAAaD,EAC3C,MAAOE,EAASC,IAAcC,EAAAA,EAAAA,WAAS,IAChCC,EAAMC,IAAWF,EAAAA,EAAAA,UAAS,KAC1BG,EAAOC,IAAYJ,EAAAA,EAAAA,UAAS,IAC5BK,EAAMC,IAAWN,EAAAA,EAAAA,UAAS,IAC1BO,IAAYP,EAAAA,EAAAA,UAAS,KACrBQ,EAAQC,IAAaT,EAAAA,EAAAA,UAAS,KAC9BuL,EAAWC,IAAgBxL,EAAAA,EAAAA,UAAS,KACpCyL,EAAeC,IAAoB1L,EAAAA,EAAAA,UAAS,OAC5Cc,EAAMC,IAAWf,EAAAA,EAAAA,UAAS,CAAEgB,IAAK,aAAcC,IAAK,UACpDC,EAAWC,IAAgBnB,EAAAA,EAAAA,UAAS,OACpC2L,EAAaC,IAAkB5L,EAAAA,EAAAA,UAAS,IAAI6L,MAC5CC,EAAaC,IAAkB/L,EAAAA,EAAAA,UAAS,IAAI6L,MAC5CzK,EAAWC,IAAgBrB,EAAAA,EAAAA,UAAS,CAAC,IACrCsB,EAAQC,IAAavB,EAAAA,EAAAA,UAAS,OAC9BgM,EAAkBC,IAAuBjM,EAAAA,EAAAA,WAAS,IAClDkM,EAAeC,IAAoBnM,EAAAA,EAAAA,UAAS,KAC5CoM,EAAiBC,IAAsBrM,EAAAA,EAAAA,WAAS,IAChDsM,EAAgBC,IAAqBvM,EAAAA,EAAAA,WAAS,IAE/C,QAAE0B,EAAO,UAAEC,IAAcC,EAAAA,EAAAA,KAEzBE,EAAgC,WAAX,OAAXjC,QAAW,IAAXA,OAAW,EAAXA,EAAakC,MACvBG,EAAiC,YAAX,OAAXrC,QAAW,IAAXA,OAAW,EAAXA,EAAakC,MACxBI,GAAaC,EAAAA,EAAAA,SAAQ,IAAMC,KAAKC,IAAI,EAAGD,KAAKE,KAAKpC,EAAQI,IAAY,CAACJ,EAAOI,IAE7EiC,EAAOC,UACX1C,GAAW,GACX,IACE,MAAM,KAAE2C,EAAMvC,MAAOwC,SAAgB6J,EAAAA,EAAAA,IAAgB,CAAEnM,OAAME,WAAUC,SAAQiM,QAAShB,EAAe3K,SACvGZ,EAAQwC,GACRtC,EAASuC,EACX,CAAC,QAAW5C,GAAW,EAAQ,IAcjC8C,EAAAA,EAAAA,WAAU,KACR,WAAe,IAAM2I,QAAmBkB,EAAAA,EAAAA,MAAiB,CAAE,MAAA3J,GAAO,CAAG,EAArE,IACC,KAEHF,EAAAA,EAAAA,WAAU,KACJhD,GAAa2C,KAChB,CAACnC,EAAMG,EAAQiL,EAAe3K,EAAKE,IAAKF,EAAKG,IAAKpB,IAErD,MAAMmD,EAAWC,KACXnB,KACAI,EAmBAgB,EAAaA,KACjB/B,EAAa,MACbE,EAAa,CAAC,GACdE,EAAU,MACV0K,GAAoB,GACpBE,EAAiB,KA0DbQ,EAAkBA,KACtBN,GAAmB,GACnBhL,EAAa,CAAC,GACd4K,GAAoB,GACpBE,EAAiB,IACjBP,EAAe,IAAIC,KACnBU,GAAkB,IAoJdpJ,EAAcnC,GAAQD,EAASqC,GAAOA,EAAEpC,MAAQA,EAAM,CAAEA,MAAKC,IAAe,QAAVmC,EAAEnC,IAAgB,OAAS,OAAU,CAAED,MAAKC,IAAK,QAEzH,OACEoC,EAAAA,EAAAA,KAAA,OAAAC,UACEC,EAAAA,EAAAA,MAAA,OAAKC,UAAU,QAAOF,SAAA,EACpBD,EAAAA,EAAAA,KAAA,OAAKG,UAAU,cAAaF,SAAC,4BAG3BxD,GAAWG,EAAKwD,OAAS,IACzBF,EAAAA,EAAAA,MAAA,OAAKG,MAAO,CAAEC,QAAS,OAAQC,oBAAqB,uCAAwCC,IAAK,MAAOC,aAAc,QAASR,SAAA,EAC7HC,EAAAA,EAAAA,MAAA,OAAKG,MAAO,CAAEK,WAAY,UAAWC,OAAQ,oBAAqBC,aAAc,MAAOC,QAAS,WAAYC,MAAO,UAAWC,SAAU,WAAYd,SAAA,EAClJD,EAAAA,EAAAA,KAAA,OAAKK,MAAO,CAAES,MAAO,UAAWC,SAAU,SAAUC,WAAY,OAAQf,SAAErD,EAAKqE,OAAO,CAACC,EAAKC,IAAMD,GAAOC,EAAEoI,iBAAmB,GAAI,MAClIvJ,EAAAA,EAAAA,KAAA,OAAAC,SAAK,wBAEPC,EAAAA,EAAAA,MAAA,OAAKG,MAAO,CAAEK,WAAY,UAAWC,OAAQ,oBAAqBC,aAAc,MAAOC,QAAS,WAAYC,MAAO,UAAWC,SAAU,WAAYd,SAAA,EAClJD,EAAAA,EAAAA,KAAA,OAAKK,MAAO,CAAES,MAAO,UAAWC,SAAU,SAAUC,WAAY,OAAQf,SAAErD,EAAKqE,OAAO,CAACC,EAAKC,IAAMD,GAAOC,EAAEqI,aAAe,GAAI,MAC9HxJ,EAAAA,EAAAA,KAAA,OAAAC,SAAK,oBAEPC,EAAAA,EAAAA,MAAA,OAAKG,MAAO,CAAEK,WAAY,UAAWC,OAAQ,oBAAqBC,aAAc,MAAOC,QAAS,WAAYC,MAAO,UAAWC,SAAU,WAAYd,SAAA,EAClJC,EAAAA,EAAAA,MAAA,OAAKG,MAAO,CAAES,MAAO,UAAWC,SAAU,SAAUC,WAAY,OAAQf,SAAA,CAAErD,EAAKwD,OAAO,IAAEtD,MACxFkD,EAAAA,EAAAA,KAAA,OAAAC,SAAK,uBAKXC,EAAAA,EAAAA,MAAA,OAAKC,UAAU,SAASE,MAAO,CAAEI,aAAc,GAAIR,SAAA,EACjDC,EAAAA,EAAAA,MAAA,OAAKC,UAAU,QAAOF,SAAA,EACpBD,EAAAA,EAAAA,KAAA,SAAOG,UAAU,QAAOF,SAAC,YACzBD,EAAAA,EAAAA,KAAA,SAAOG,UAAU,QAAQqB,MAAOrE,EAAQsE,SAAWC,IAAQzE,EAAQ,GAAIG,EAAUsE,EAAEC,OAAOH,MAAMiI,SAAY7H,YAAY,6CAE1H1B,EAAAA,EAAAA,MAAA,OAAKC,UAAU,QAAOF,SAAA,EACpBD,EAAAA,EAAAA,KAAA,SAAOG,UAAU,QAAOF,SAAC,aACzBC,EAAAA,EAAAA,MAAA,UAAQC,UAAU,SAASqB,MAAO4G,GAAiB,GAAI3G,SAAWC,IAAQzE,EAAQ,GAAIoL,EAAiB3G,EAAEC,OAAOH,OAAS,OAASvB,SAAA,EAChID,EAAAA,EAAAA,KAAA,UAAQwB,MAAM,GAAEvB,SAAC,mBACjBD,EAAAA,EAAAA,KAAA,UAAQwB,MAAM,UAASvB,SAAC,YACvBiI,EAAUrG,IAAI6H,IAAK1J,EAAAA,EAAAA,KAAA,UAAgBwB,MAAOkI,EAAEzJ,SAAEyJ,GAAdA,cAIvCxJ,EAAAA,EAAAA,MAAA,OAAKC,UAAU,UAAUE,MAAO,CAAEI,aAAc,GAAIR,SAAA,EAClDD,EAAAA,EAAAA,KAAA,UAAQG,UAAU,cAAc8B,QAASA,IAAOC,OAAOC,SAASC,KAAO,sBAAuBnC,SAAC,wBAC7FgJ,IACAjJ,EAAAA,EAAAA,KAAA,UACEG,UAAU,MACV8B,QAASA,IAAMiH,GAAkB,GACjC7I,MAAO,CAAEK,WAAY,UAAWI,MAAO,WAAYb,SACpD,2BAIFgJ,IAAmBF,IAClB/I,EAAAA,EAAAA,KAAA,UACEG,UAAU,MACV8B,QAASA,KACPiH,GAAkB,GAClBX,EAAe,IAAIC,MAErBnI,MAAO,CAAEK,WAAY,UAAWI,MAAO,WAAYb,SACpD,+BAOJ8I,IACC7I,EAAAA,EAAAA,MAAA,OAAKG,MAAO,CACVK,WAAY,UACZC,OAAQ,oBACRC,aAAc,MACdC,QAAS,OACTJ,aAAc,QACdR,SAAA,EACAC,EAAAA,EAAAA,MAAA,OAAKG,MAAO,CAAEI,aAAc,OAAQH,QAAS,OAAQ4F,eAAgB,gBAAiB5B,WAAY,UAAWrE,SAAA,EAC3GC,EAAAA,EAAAA,MAAA,MAAIG,MAAO,CAAEsJ,OAAQ,EAAG7I,MAAO,WAAYb,SAAA,CAAC,QACpCqI,EAAYsB,KAAK,cAAiC,IAArBtB,EAAYsB,KAAa,IAAM,OAEpE5J,EAAAA,EAAAA,KAAA,UACEG,UAAU,MACV8B,QAASqH,EACTjJ,MAAO,CAAEK,WAAY,UAAWI,MAAO,WAAYb,SACpD,eAKHC,EAAAA,EAAAA,MAAA,OAAKC,UAAU,SAASE,MAAO,CAAEG,IAAK,OAAQC,aAAc,QAASR,SAAA,EACnEC,EAAAA,EAAAA,MAAA,OAAAD,SAAA,EACED,EAAAA,EAAAA,KAAA,SAAOG,UAAU,QAAQE,MAAO,CAAEU,SAAU,QAASd,SAAC,eACtDD,EAAAA,EAAAA,KAAA,SACEG,UAAU,QACVyB,YAAY,sBACZJ,MAAOzD,EAAU8L,WAAa,GAC9BpI,SAAWC,GAAM1D,GAAYsF,EAAAA,EAAAA,IAAAA,EAAAA,EAAAA,GAAC,CAAC,EAAIvF,GAAS,IAAE8L,UAAWnI,EAAEC,OAAOH,eAGtEtB,EAAAA,EAAAA,MAAA,OAAAD,SAAA,EACED,EAAAA,EAAAA,KAAA,SAAOG,UAAU,QAAQE,MAAO,CAAEU,SAAU,QAASd,SAAC,eACtDD,EAAAA,EAAAA,KAAA,SACEG,UAAU,QACVyB,YAAY,sBACZJ,MAAOzD,EAAU+L,WAAa,GAC9BrI,SAAWC,GAAM1D,GAAYsF,EAAAA,EAAAA,IAAAA,EAAAA,EAAAA,GAAC,CAAC,EAAIvF,GAAS,IAAE+L,UAAWpI,EAAEC,OAAOH,eAGtEtB,EAAAA,EAAAA,MAAA,OAAAD,SAAA,EACED,EAAAA,EAAAA,KAAA,SAAOG,UAAU,QAAQE,MAAO,CAAEU,SAAU,QAASd,SAAC,YACpD0I,GAUA3I,EAAAA,EAAAA,KAAA,SACEG,UAAU,QACVyB,YAAY,oBACZJ,MAAOqH,EACPpH,SAAWC,GAAMoH,EAAiBpH,EAAEC,OAAOH,UAb7CtB,EAAAA,EAAAA,MAAA,UACEC,UAAU,SACVqB,MAAOzD,EAAUqL,SAAW,GAC5B3H,SAAWC,GAAM1D,GAAYsF,EAAAA,EAAAA,IAAAA,EAAAA,EAAAA,GAAC,CAAC,EAAIvF,GAAS,IAAEqL,QAAS1H,EAAEC,OAAOH,SAASvB,SAAA,EAEzED,EAAAA,EAAAA,KAAA,UAAQwB,MAAM,GAAEvB,SAAC,wBAChBiI,GAAaA,EAAU9H,OAAS,EAAI8H,EAAUrG,IAAI6H,IAAK1J,EAAAA,EAAAA,KAAA,UAAgBwB,MAAOkI,EAAEzJ,SAAEyJ,GAAdA,KAA6B1J,EAAAA,EAAAA,KAAA,UAAQwB,MAAM,GAAEvB,SAAC,+BAUvHC,EAAAA,EAAAA,MAAA,OAAKG,MAAO,CAAEC,QAAS,OAAQgE,WAAY,SAAU9D,IAAK,MAAOsE,UAAW,MAAO/D,SAAU,QAASd,SAAA,EACpGD,EAAAA,EAAAA,KAAA,SACE2D,KAAK,WACL5B,GAAG,uBACHgI,QAASpB,EACTlH,SAAWC,IACTkH,EAAoBlH,EAAEC,OAAOoI,SACxBrI,EAAEC,OAAOoI,SACZjB,EAAiB,KAGrBzI,MAAO,CAAEqC,MAAO,OAAQS,OAAQ,OAAQR,OAAQ,cAElD3C,EAAAA,EAAAA,KAAA,SAAOgK,QAAQ,uBAAuB3J,MAAO,CAAES,MAAO,UAAW6B,OAAQ,WAAY1C,SAAC,8BAK1FC,EAAAA,EAAAA,MAAA,OAAAD,SAAA,EACED,EAAAA,EAAAA,KAAA,SAAOG,UAAU,QAAQE,MAAO,CAAEU,SAAU,QAASd,SAAC,UACtDD,EAAAA,EAAAA,KAAA,SACEG,UAAU,QACVwD,KAAK,SACL/B,YAAY,sBACZJ,MAAOzD,EAAU2F,MAAQ,GACzBjC,SAAWC,GAAM1D,GAAYsF,EAAAA,EAAAA,IAAAA,EAAAA,EAAAA,GAAC,CAAC,EAAIvF,GAAS,IAAE2F,KAAMhC,EAAEC,OAAOH,eAGjEtB,EAAAA,EAAAA,MAAA,OAAAD,SAAA,EACED,EAAAA,EAAAA,KAAA,SAAOG,UAAU,QAAQE,MAAO,CAAEU,SAAU,QAASd,SAAC,cACtDC,EAAAA,EAAAA,MAAA,UACEC,UAAU,SACVqB,MAAOzD,EAAUkM,UAAY,GAC7BxI,SAAWC,GAAM1D,GAAYsF,EAAAA,EAAAA,IAAAA,EAAAA,EAAAA,GAAC,CAAC,EAAIvF,GAAS,IAAEkM,SAAUvI,EAAEC,OAAOH,SAASvB,SAAA,EAE1ED,EAAAA,EAAAA,KAAA,UAAQwB,MAAM,GAAEvB,SAAC,yBACjBD,EAAAA,EAAAA,KAAA,UAAQwB,MAAM,IAAGvB,SAAC,OAClBD,EAAAA,EAAAA,KAAA,UAAQwB,MAAM,IAAGvB,SAAC,OAClBD,EAAAA,EAAAA,KAAA,UAAQwB,MAAM,IAAGvB,SAAC,aAGtBC,EAAAA,EAAAA,MAAA,OAAAD,SAAA,EACED,EAAAA,EAAAA,KAAA,SAAOG,UAAU,QAAQE,MAAO,CAAEU,SAAU,QAASd,SAAC,eACtDC,EAAAA,EAAAA,MAAA,UACEC,UAAU,SACVqB,MAAOzD,EAAUmM,WAAa,GAC9BzI,SAAWC,GAAM1D,GAAYsF,EAAAA,EAAAA,IAAAA,EAAAA,EAAAA,GAAC,CAAC,EAAIvF,GAAS,IAAEmM,UAAWxI,EAAEC,OAAOH,SAASvB,SAAA,EAE3ED,EAAAA,EAAAA,KAAA,UAAQwB,MAAM,GAAEvB,SAAC,yBACjBD,EAAAA,EAAAA,KAAA,UAAQwB,MAAM,OAAMvB,SAAC,UACrBD,EAAAA,EAAAA,KAAA,UAAQwB,MAAM,gBAAevB,SAAC,mBAC9BD,EAAAA,EAAAA,KAAA,UAAQwB,MAAM,MAAKvB,SAAC,SACpBD,EAAAA,EAAAA,KAAA,UAAQwB,MAAM,OAAMvB,SAAC,mBAK3BC,EAAAA,EAAAA,MAAA,OAAKG,MAAO,CAAEC,QAAS,OAAQE,IAAK,MAAO0F,eAAgB,YAAajG,SAAA,EACtEC,EAAAA,EAAAA,MAAA,UACEC,UAAU,cACV8B,QAzUQ7C,UACpB,GAAyB,IAArBkJ,EAAYsB,KAEd,YADAtL,EAAU,CAAEqF,KAAM,QAASoB,QAAS,6BAKtC,MAAMC,EAAU,CAAC,EAQjB,GAPIjH,EAAUqL,UAASpE,EAAQoE,QAAUrL,EAAUqL,UAAYT,EAAmBE,EAAgB9K,EAAUqL,UACxGrL,EAAU+L,YAAW9E,EAAQ8E,UAAY/L,EAAU+L,WACnD/L,EAAU8L,YAAW7E,EAAQ6E,UAAY9L,EAAU8L,WACnD9L,EAAU2F,OAAMsB,EAAQtB,KAAO3F,EAAU2F,MACzC3F,EAAUkM,WAAUjF,EAAQiF,SAAWlM,EAAUkM,UACjDlM,EAAUmM,YAAWlF,EAAQkF,UAAYnM,EAAUmM,WAEnB,IAAhCC,OAAOC,KAAKpF,GAAS5E,OAKzB,IACE,MAAMgJ,EAAUT,EAAmBE,EAAgB9K,EAAUqL,QAC7D,GAAIpE,EAAQoE,UAAYA,EAEtB,YADA9K,EAAU,CAAEqF,KAAM,QAASoB,QAAS,sCAKtC,MAAMsF,EAAiBC,MAAMC,KAAKjC,GAAazG,IAAIE,IACjD,MAAMyI,EAAY5N,EAAK6G,KAAKtC,GAAKA,EAAEY,KAAOA,GAC1C,MAAO,CAAEA,KAAI0I,OAAQD,KAIjBE,EAAaL,EAAeM,OAAOxE,IAAMA,EAAEsE,QAAQ5I,IAAIsE,GAAKA,EAAEpE,IACpE,IAAI6I,EAAmB,IAAIC,IAE3B,GAAIH,EAAWtK,OAAS,EAAG,CACzB,MAAQf,KAAMyL,SAA4B3B,EAAAA,EAAAA,IAAgB,CACxDnM,KAAM,EACNE,SAAU,IACVC,SACAiM,QAAShB,EACT3K,SAEFmN,EAAmB,IAAIC,IAAIC,EAAkBjJ,IAAIsE,GAAK,CAACA,EAAEpE,GAAIoE,IAC/D,CAGA,MAAM4E,EAAiB,GACjBC,EAAY,EAElB,IAAK,MAAM,GAAEjJ,EAAE,OAAE0I,KAAYJ,EAAgB,CAC3C,MAAMzK,EAAM6K,GAAUG,EAAiBK,IAAIlJ,GACtCnC,GAKLmL,EAAeG,MACbC,EAAAA,EAAAA,IAAgBpJ,EAAI,CAClBiD,SAAO1B,EAAAA,EAAAA,IAAAA,EAAAA,EAAAA,GAAA,GAAO0B,GAAO,IAAEoE,QAASpE,EAAQoE,SAAWA,IACnDlE,WAAY,KACZE,YAAaxF,EAAIyF,aAKjB0F,EAAe3K,QAAU4K,UACrBI,QAAQC,IAAIN,GAClBA,EAAe3K,OAAS,IAfxBkF,QAAQgG,KAAK,iBAADlH,OAAkBrC,EAAE,cAiBpC,CAGIgJ,EAAe3K,OAAS,SACpBgL,QAAQC,IAAIN,GAGpBzB,IAEA5M,GAAW,GACX,MAAM,KAAE2C,EAAMvC,MAAOwC,SAAgB6J,EAAAA,EAAAA,IAAgB,CAAEnM,OAAME,WAAUC,SAAQiM,QAAShB,EAAe3K,SACvGZ,EAAQwC,GACRtC,EAASuC,GACT5C,GAAW,GAEX4B,EAAU,CAAEqF,KAAM,UAAWoB,QAAQ,GAADX,OAAKkE,EAAYsB,KAAI,yCAC3D,CAAE,MAAOlI,GACP4D,QAAQC,MAAM,iCAAkC,OAAD7D,QAAC,IAADA,OAAC,EAADA,EAAGqD,UAAWrD,GAC7DpD,EAAU,CAAEqF,KAAM,QAASoB,SAAU,OAADrD,QAAC,IAADA,OAAC,EAADA,EAAGqD,UAAW,iCACpD,MA3EEzG,EAAU,CAAEqF,KAAM,QAASoB,QAAS,gDA0T1B1E,MAAO,CAAEK,WAAY,WAAYT,SAAA,CAClC,uBACsBqI,EAAYsB,KAAK,QAA2B,IAArBtB,EAAYsB,KAAa,IAAM,OAE7E5J,EAAAA,EAAAA,KAAA,UACEG,UAAU,MACV8B,QAASqH,EACTjJ,MAAO,CAAEK,WAAY,UAAWI,MAAO,WAAYb,SACpD,iBAQNqI,EAAYsB,KAAO,IAAMb,IACxB7I,EAAAA,EAAAA,MAAA,OAAKG,MAAO,CACVK,WAAY,UACZC,OAAQ,oBACRC,aAAc,MACdC,QAAS,OACTJ,aAAc,OACdH,QAAS,OACT4F,eAAgB,gBAChB5B,WAAY,UACZrE,SAAA,EACAC,EAAAA,EAAAA,MAAA,QAAMG,MAAO,CAAES,MAAO,WAAYb,SAAA,CAC/BqI,EAAYsB,KAAK,QAA2B,IAArBtB,EAAYsB,KAAa,IAAM,GAAG,gBAE5D1J,EAAAA,EAAAA,MAAA,OAAKG,MAAO,CAAEC,QAAS,OAAQE,IAAK,MAAO0F,eAAgB,YAAajG,SAAA,EACtEC,EAAAA,EAAAA,MAAA,UACEC,UAAU,cACV8B,QAlZSsJ,KACrB,GAAyB,IAArBjD,EAAYsB,KAEd,YADAtL,EAAU,CAAEqF,KAAM,QAASoB,QAAS,mDAOtC,MAAMyG,EAAqBlB,MAAMC,KAAKjC,GAAaqC,OAAO5I,GAAMnF,EAAK6O,KAAKtK,GAAKA,EAAEY,KAAOA,IACxF,GAAIyJ,EAAmBpL,OAAS,EAAG,CAMjC,IALuBoL,EAAmBE,MAAM3J,IAClCnF,EAAK6G,KAAKtC,GAAKA,EAAEY,KAAOA,GACpC,OAAOpC,MAKP,YADArB,EAAU,CAAEqF,KAAM,QAASoB,QAAS,wEAGxC,CAEAiE,GAAmB,GACnBhL,EAAa,CACXoL,QAAS,GAAIU,UAAW,GAAID,UAAW,GAAInG,KAAM,GAAIuG,SAAU,GAAIC,UAAW,KAEhFtB,GAAoB,GACpBE,EAAiB,KAwXLzI,MAAO,CAAEK,WAAY,WAAYT,SAAA,CAClC,kBACiBqI,EAAYsB,KAAK,QAEnC5J,EAAAA,EAAAA,KAAA,UACEG,UAAU,MACV8B,QAASA,IAAMsG,EAAe,IAAIC,KAClCnI,MAAO,CAAEK,WAAY,UAAWI,MAAO,WAAYb,SACpD,2BAOPD,EAAAA,EAAAA,KAAA,OAAKG,UAAU,QAAQE,MAAO,CAAEQ,QAAS,EAAGwB,UAAW,QAASpC,UAC9DC,EAAAA,EAAAA,MAAA,SAAOC,UAAU,QAAQE,MAAO,CAAEkC,SAAU,UAAWtC,SAAA,EACrDD,EAAAA,EAAAA,KAAA,SAAAC,UACEC,EAAAA,EAAAA,MAAA,MAAAD,SAAA,CACGgJ,IACCjJ,EAAAA,EAAAA,KAAA,MAAIK,MAAO,CAAEqC,MAAO,QAASzC,UAC3BD,EAAAA,EAAAA,KAAA,SACE2D,KAAK,WACLoG,QAASzB,EAAYsB,OAAS9M,GAASA,EAAQ,EAC/C2E,SAvbIkK,KAClBrD,EAAYsB,OAAS9M,GAASA,EAAQ,EAExCyL,EAAe,IAAIC,KA/DKpJ,WAC1B,IACE,MAAM,KAAEC,SAAe8J,EAAAA,EAAAA,IAAgB,CAAEnM,KAAM,EAAGE,SAAU,IAAOC,SAAQiM,QAAShB,EAAe3K,SACnG,OAAO,IAAI+K,IAAInJ,EAAKwC,IAAI+J,GAAQA,EAAK7J,IACvC,CAAE,MAAOwD,GAEP,OADAD,QAAQC,MAAM,uCAAwCA,GAC/C,IAAIiD,GACb,GA2DEqD,GAAsBC,KAAKC,IACzBxD,EAAewD,MAibD1L,MAAO,CAAEqC,MAAO,OAAQS,OAAQ,OAAQR,OAAQ,WAChDU,MAAOiF,EAAYsB,OAAS9M,GAASA,EAAQ,EAAI,eAAiB,mCAIxEkD,EAAAA,EAAAA,KAAA,MAAIK,MAAO,CAAEqC,MAAO,SAAUzC,SAAC,eAC/BC,EAAAA,EAAAA,MAAA,MAAIG,MAAO,CAAEqC,MAAO,QAASC,OAAQ,WAAaV,QAASA,IAAMnC,EAAW,aAAaG,SAAA,CAAC,aAAwB,cAAbxC,EAAKE,IAAoC,QAAbF,EAAKG,IAAgB,SAAM,SAAO,OACnKoC,EAAAA,EAAAA,KAAA,MAAIK,MAAO,CAAEqC,MAAO,SAAUzC,SAAC,aAC/BC,EAAAA,EAAAA,MAAA,MAAIG,MAAO,CAAEqC,MAAO,QAASC,OAAQ,WAAaV,QAASA,IAAMnC,EAAW,QAAQG,SAAA,CAAC,QAAmB,SAAbxC,EAAKE,IAA+B,QAAbF,EAAKG,IAAgB,SAAM,SAAO,OACpJoC,EAAAA,EAAAA,KAAA,MAAIK,MAAO,CAAEqC,MAAO,SAAUzC,SAAC,cAC/BD,EAAAA,EAAAA,KAAA,MAAIK,MAAO,CAAEqC,MAAO,SAAUzC,SAAC,eAC/BC,EAAAA,EAAAA,MAAA,MAAIG,MAAO,CAAEqC,MAAO,OAAQC,OAAQ,UAAWjC,WAAY,yBAA0BkC,aAAc,qBAAuBX,QAASA,IAAMnC,EAAW,eAAeG,SAAA,CAAC,SAAoB,gBAAbxC,EAAKE,IAAsC,QAAbF,EAAKG,IAAgB,SAAM,SAAO,OAC3OsC,EAAAA,EAAAA,MAAA,MAAIG,MAAO,CAAEqC,MAAO,QAASC,OAAQ,WAAaV,QAASA,IAAMnC,EAAW,mBAAmBG,SAAA,CAAC,aAAwB,oBAAbxC,EAAKE,IAA0C,QAAbF,EAAKG,IAAgB,SAAM,SAAO,OAC/KsC,EAAAA,EAAAA,MAAA,MAAIG,MAAO,CAAEqC,MAAO,QAASC,OAAQ,WAAaV,QAASA,IAAMnC,EAAW,cAAcG,SAAA,CAAC,YAAuB,eAAbxC,EAAKE,IAAqC,QAAbF,EAAKG,IAAgB,SAAM,SAAO,OACpKoC,EAAAA,EAAAA,KAAA,MAAIK,MAAO,CAAEqC,MAAO,SAAUzC,SAAC,iBAC/BD,EAAAA,EAAAA,KAAA,MAAIK,MAAO,CAAEqC,MAAO,SAAUzC,SAAC,kBAGnCD,EAAAA,EAAAA,KAAA,SAAAC,SACGxD,GACCuD,EAAAA,EAAAA,KAAA,MAAAC,UAAID,EAAAA,EAAAA,KAAA,MAAI6C,QAASoG,EAAiB,GAAK,GAAI5I,MAAO,CAAEyC,UAAW,SAAUhC,MAAO,WAAYb,SAAC,iBAC3E,IAAhBrD,EAAKwD,QACPJ,EAAAA,EAAAA,KAAA,MAAAC,UAAID,EAAAA,EAAAA,KAAA,MAAI6C,QAASoG,EAAiB,GAAK,GAAI5I,MAAO,CAAEyC,UAAW,SAAUhC,MAAO,WAAYb,SAAC,cAC3FrD,EAAKiF,IAAIjC,IAAG,IAAAoM,EAAAC,EAAAC,EAAA,OACdhM,EAAAA,EAAAA,MAAA,MAAiBG,MAAO,CAAEK,WAAY4H,EAAY6D,IAAIvM,EAAImC,IAAM,yBAA2B,eAAgB9B,SAAA,CACxGgJ,IACCjJ,EAAAA,EAAAA,KAAA,MAAIK,MAAO,CAAEyC,UAAW,UAAW7C,UACjCD,EAAAA,EAAAA,KAAA,SACE2D,KAAK,WACLoG,QAASzB,EAAY6D,IAAIvM,EAAImC,IAC7BN,SAAUA,KAAM2K,OAlebrK,EAke6BnC,EAAImC,QAjexDwG,EAAe8D,IACb,MAAMC,EAAS,IAAI9D,IAAI6D,GAMvB,OALIC,EAAOH,IAAIpK,GACbuK,EAAOC,OAAOxK,GAEduK,EAAOE,IAAIzK,GAENuK,IARcvK,OAmeH6D,SAAUmD,EACV1I,MAAO,CAAEqC,MAAO,OAAQS,OAAQ,OAAQR,OAAQ,gBAItD3C,EAAAA,EAAAA,KAAA,MAAIK,MAAO,CAAES,MAAOlB,EAAIiK,UAAY,UAAY,WAAY5J,SAAEpC,IAAc+B,EAAImC,IAAK/B,EAAAA,EAAAA,KAAA,SAAOG,UAAU,QAAQqB,MAAOzD,EAAU8L,UAAWpI,SAAWC,GAAM1D,GAAYsF,EAAAA,EAAAA,IAAAA,EAAAA,EAAAA,GAAC,CAAC,EAAIvF,GAAS,IAAE8L,UAAWnI,EAAEC,OAAOH,WAAgB5B,EAAIiK,WAAa,YAC7O7J,EAAAA,EAAAA,KAAA,MAAIK,MAAO,CAAES,MAAOlB,EAAIkK,UAAY,UAAY,WAAY7J,SAAEpC,IAAc+B,EAAImC,IAAK/B,EAAAA,EAAAA,KAAA,SAAOG,UAAU,QAAQqB,MAAOzD,EAAU+L,UAAWrI,SAAWC,GAAM1D,GAAYsF,EAAAA,EAAAA,IAAAA,EAAAA,EAAAA,GAAC,CAAC,EAAIvF,GAAS,IAAE+L,UAAWpI,EAAEC,OAAOH,WAAgB5B,EAAIkK,WAAa,YAC7O9J,EAAAA,EAAAA,KAAA,MAAIK,MAAO,CAAES,MAAOlB,EAAIwJ,QAAU,UAAY,WAAYnJ,SACvDpC,IAAc+B,EAAImC,IACjB7B,EAAAA,EAAAA,MAAA,OAAKG,MAAO,CAAEC,QAAS,OAAQ2D,cAAe,SAAUzD,IAAK,OAAQP,SAAA,CACjE0I,GAaA3I,EAAAA,EAAAA,KAAA,SACEG,UAAU,QACVyB,YAAY,8BACZJ,MAAOqH,EACPpH,SAAWC,GAAMoH,EAAiBpH,EAAEC,OAAOH,UAhB7CxB,EAAAA,EAAAA,KAAA2E,EAAAA,SAAA,CAAA1E,UACEC,EAAAA,EAAAA,MAAA,UACEC,UAAU,SACVqB,MAAOzD,EAAUqL,QACjB3H,SAAWC,GAAM1D,GAAYsF,EAAAA,EAAAA,IAAAA,EAAAA,EAAAA,GAAC,CAAC,EAAIvF,GAAS,IAAEqL,QAAS1H,EAAEC,OAAOH,SAChEnB,MAAO,CAAEI,aAAc,OAAQR,SAAA,EAE/BD,EAAAA,EAAAA,KAAA,UAAQwB,MAAM,GAAEvB,SAAC,mBAChBiI,GAAaA,EAAU9H,OAAS,EAAI8H,EAAUrG,IAAI6H,IAAK1J,EAAAA,EAAAA,KAAA,UAAgBwB,MAAOkI,EAAEzJ,SAAEyJ,GAAdA,KAA6B1J,EAAAA,EAAAA,KAAA,UAAQwB,MAAM,GAAEvB,SAAC,iCAWzHC,EAAAA,EAAAA,MAAA,OAAKG,MAAO,CAAEC,QAAS,OAAQgE,WAAY,SAAU9D,IAAK,MAAOO,SAAU,QAASd,SAAA,EAClFD,EAAAA,EAAAA,KAAA,SACE2D,KAAK,WACL5B,GAAE,kBAAAqC,OAAoBxE,EAAImC,IAC1BgI,QAASpB,EACTlH,SAAWC,IACTkH,EAAoBlH,EAAEC,OAAOoI,SACxBrI,EAAEC,OAAOoI,SACZjB,EAAiB,KAGrBzI,MAAO,CAAEqC,MAAO,OAAQS,OAAQ,OAAQR,OAAQ,cAElD3C,EAAAA,EAAAA,KAAA,SAAOgK,QAAO,kBAAA5F,OAAoBxE,EAAImC,IAAM1B,MAAO,CAAES,MAAO,UAAW6B,OAAQ,UAAW5B,SAAU,QAASd,SAAC,cAK/GL,EAAIwJ,SAAW,YAEtBpJ,EAAAA,EAAAA,KAAA,MAAIK,MAAO,CAAES,MAAOlB,EAAI8D,KAAO,UAAY,WAAYzD,SAAEpC,IAAc+B,EAAImC,IAAK/B,EAAAA,EAAAA,KAAA,SAAOG,UAAU,QAAQwD,KAAK,SAASnC,MAAOzD,EAAU2F,KAAMjC,SAAWC,GAAM1D,GAAYsF,EAAAA,EAAAA,IAAAA,EAAAA,EAAAA,GAAC,CAAC,EAAIvF,GAAS,IAAE2F,KAAMhC,EAAEC,OAAOH,WAAgB5B,EAAI8D,MAAQ,YACvO1D,EAAAA,EAAAA,KAAA,MAAAC,SAAKpC,IAAc+B,EAAImC,IAAK7B,EAAAA,EAAAA,MAAA,UAAQC,UAAU,SAASqB,MAAOzD,EAAUkM,SAAUxI,SAAWC,GAAM1D,GAAYsF,EAAAA,EAAAA,IAAAA,EAAAA,EAAAA,GAAC,CAAC,EAAIvF,GAAS,IAAEkM,SAAUvI,EAAEC,OAAOH,SAASvB,SAAA,EAACD,EAAAA,EAAAA,KAAA,UAAQwB,MAAM,GAAEvB,SAAC,YAAUD,EAAAA,EAAAA,KAAA,UAAQwB,MAAM,IAAGvB,SAAC,OAAUD,EAAAA,EAAAA,KAAA,UAAQwB,MAAM,IAAGvB,SAAC,OAAUD,EAAAA,EAAAA,KAAA,UAAQwB,MAAM,IAAGvB,SAAC,SAAuBL,EAAIqK,UAAY,YACzSjK,EAAAA,EAAAA,KAAA,MAAAC,SAAKpC,IAAc+B,EAAImC,IAAK7B,EAAAA,EAAAA,MAAA,UAAQC,UAAU,SAASqB,MAAOzD,EAAUmM,UAAWzI,SAAWC,GAAM1D,GAAYsF,EAAAA,EAAAA,IAAAA,EAAAA,EAAAA,GAAC,CAAC,EAAIvF,GAAS,IAAEmM,UAAWxI,EAAEC,OAAOH,SAASvB,SAAA,EAACD,EAAAA,EAAAA,KAAA,UAAQwB,MAAM,OAAMvB,SAAC,UAAaD,EAAAA,EAAAA,KAAA,UAAQwB,MAAM,gBAAevB,SAAC,mBAAsBD,EAAAA,EAAAA,KAAA,UAAQwB,MAAM,MAAKvB,SAAC,SAAYD,EAAAA,EAAAA,KAAA,UAAQwB,MAAM,OAAMvB,SAAC,YAA0BL,EAAIsK,WAAa,UACrVlK,EAAAA,EAAAA,KAAA,MAAIK,MAAO,CAAEW,WAAY,MAAOF,MAAO,WAAYb,SAAEL,EAAI4J,aAAe,KACxExJ,EAAAA,EAAAA,KAAA,MAAAC,SAAKL,EAAI2J,iBAAmB,KAC5BvJ,EAAAA,EAAAA,KAAA,MAAIK,MAAO,CAAES,MAAO,UAAWC,SAAU,QAASd,SAAEwH,EAAgB7H,EAAImE,eACxE/D,EAAAA,EAAAA,KAAA,MAAIK,MAAO,CAAES,MAAmB,QAAZkL,EAAApM,EAAI6M,gBAAQ,IAAAT,GAAZA,EAAcU,UAAY,UAAY,UAAW3L,SAAU,QAASd,UAAc,QAAZgM,EAAArM,EAAI6M,gBAAQ,IAAAR,OAAA,EAAZA,EAAcS,aAAyB,QAAhBR,EAAItM,EAAI6M,gBAAQ,IAAAP,OAAA,EAAZA,EAActN,QAAS,YAC5IoB,EAAAA,EAAAA,KAAA,MAAAC,SACGpC,IAAc+B,EAAImC,IACjB7B,EAAAA,EAAAA,MAAA,OAAKG,MAAO,CAAEC,QAAS,OAAQE,IAAK,MAAOyD,cAAe,UAAWhE,SAAA,EACnED,EAAAA,EAAAA,KAAA,UAAQG,UAAU,cAAc8B,QAASA,IAlY9C7C,WACf,IAAKO,IAEH,YADArB,EAAU,CAAEqF,KAAM,QAASoB,QAAS,wDAKtC,MAAMqE,EAAUT,EAAmBE,EAAgB9K,EAAUqL,QAC7D,IAAKA,EAEH,YADA9K,EAAU,CAAEqF,KAAM,QAASoB,QAAS,sCAItC,MAAMC,GAAO1B,EAAAA,EAAAA,IAAAA,EAAAA,EAAAA,GAAA,GAAQvF,GAAS,IAAEqL,YAEhC,UACQ+B,EAAAA,EAAAA,IAAgBvL,EAAImC,GAAI,CAAEiD,UAASE,WAAYjH,EAAQmH,YAAaxF,EAAIyF,YAC9ExF,UACMV,IACNb,EAAU,CAAEqF,KAAM,UAAWoB,QAAS,uBACxC,CAAE,MAAOrD,GACP4D,QAAQC,MAAM,gCAAiC,OAAD7D,QAAC,IAADA,OAAC,EAADA,EAAGqD,UAAWrD,GAC5DpD,EAAU,CAAEqF,KAAM,QAASoB,SAAU,OAADrD,QAAC,IAADA,OAAC,EAADA,EAAGqD,UAAW,gCACpD,GA2WmES,CAAS5F,GAAKK,SAAC,UAC9DD,EAAAA,EAAAA,KAAA,UAAQG,UAAU,MAAM8B,QAASpC,EAAWI,SAAC,eAG/CC,EAAAA,EAAAA,MAAA,OAAKC,UAAU,UAASF,SAAA,EACtBD,EAAAA,EAAAA,KAAA,UAAQG,UAAU,MAAM8B,QAASA,IA5jBpCrC,KACZD,KAIL7B,EAAa8B,EAAImC,IACjB/D,EAAa,CACXoL,QAASxJ,EAAIwJ,SAAW,GAAIU,UAAWlK,EAAIkK,WAAa,GAAID,UAAWjK,EAAIiK,WAAa,GACxFnG,KAAM9D,EAAI8D,MAAQ,GAAIuG,SAAUrK,EAAIqK,UAAY,GAAIC,UAAWtK,EAAIsK,WAAa,KAElFhM,EAAU,MACV0K,GAAoB,GACpBE,EAAiB,KAVfxK,EAAU,CAAEqF,KAAM,QAASoB,QAAS,yDA0jBqBY,CAAU/F,GAAMgG,UAAWjG,IAAaM,SAAC,UAChFD,EAAAA,EAAAA,KAAA,UAAQG,UAAU,MAAM8B,QAASA,IA9WlC7C,WACnB,IAAKO,IAEH,YADArB,EAAU,CAAEqF,KAAM,QAASoB,QAAS,kDAWtC,SAPiB1G,EAAQ,CACvBgF,MAAO,qBACP0B,QAAQ,WAADX,OAAaxE,EAAIkK,UAAS,OAAA1F,OAAMxE,EAAIiK,UAAS,oCACpDhE,aAAc,SACdC,YAAa,SACbC,QAAS,WAIX,UACQ4G,EAAAA,EAAAA,IAAgB,CAAE5K,GAAInC,EAAImC,GAAIsD,UAAWzF,EAAIyF,kBAC7ClG,IACNb,EAAU,CAAEqF,KAAM,UAAWoB,QAAS,uBACxC,CAAE,MAAOrD,GACP4D,QAAQC,MAAM,+BAAgC7D,GAC9CpD,EAAU,CAAEqF,KAAM,QAASoB,SAAU,OAADrD,QAAC,IAADA,OAAC,EAADA,EAAGqD,UAAW,gCACpD,GAwV2DkB,CAAarG,GAAMgG,UAAWjG,IAAaM,SAAC,kBAzElFL,EAAImC,cAkFrB7B,EAAAA,EAAAA,MAAA,OAAKC,UAAU,UAAUE,MAAO,CAAEyE,UAAW,GAAI7E,SAAA,EAC/CD,EAAAA,EAAAA,KAAA,UAAQG,UAAU,MAAMyF,SAAU5I,GAAQ,EAAGiF,QAASA,IAAMhF,EAAQkJ,GAAKnH,KAAKC,IAAI,EAAGkH,EAAI,IAAIlG,SAAC,UAC9FC,EAAAA,EAAAA,MAAA,QAAMG,MAAO,CAAES,MAAO,WAAYb,SAAA,CAAC,QAAMjD,EAAK,OAAK8B,MACnDkB,EAAAA,EAAAA,KAAA,UAAQG,UAAU,MAAMyF,SAAU5I,GAAQ8B,EAAYmD,QAASA,IAAMhF,EAAQkJ,GAAKnH,KAAKqH,IAAIvH,EAAYqH,EAAI,IAAIlG,SAAC,kB,wBCnMnHb,eAAewN,IAA2C,IAAdC,EAAKC,UAAA1M,OAAA,QAAA+G,IAAA2F,UAAA,GAAAA,UAAA,GAAG,IACzD,IACE,MAAM,KAAEzN,EAAI,MAAEkG,SAAgBwH,EAAAA,EAC3BxC,KAAK,2BACLyC,OAAO,KACPC,MAAM,mBAAoB,CAAEC,WAAW,IACvCL,MAAMA,GAET,GAAItH,EAAO,MAAMA,EACjB,OAAOlG,GAAQ,EACjB,CAAE,MAAOkG,GAEP,OADAD,QAAQC,MAAM,+CAAgDA,GACvD,EACT,CACF,CCjeA,MA+UA,EA/UgB4H,KACd,MAAOC,EAAOC,IAAY1Q,EAAAA,EAAAA,UAAS,OAC5B2Q,EAAiBC,IAAsB5Q,EAAAA,EAAAA,UAAS,CAAC,IACjDF,EAASC,IAAcC,EAAAA,EAAAA,WAAS,IAChC6Q,EAAYC,IAAiB9Q,EAAAA,EAAAA,UAAS,KACtC+Q,EAAQC,IAAahR,EAAAA,EAAAA,UAAS,eAC9BiR,EAAWC,IAAgBlR,EAAAA,EAAAA,UAAS,YAE3C6C,EAAAA,EAAAA,WAAU,KACR,MAAMsO,EAAW1O,UACf,IACE1C,GAAW,GACX,MAAOqR,EAAWC,SAAoB5C,QAAQC,IAAI,EAChD4C,EAAAA,EAAAA,MACArB,EAA6B,OAG/BS,EAASU,GAGT,MAAMG,EAAY,CAAC,EACnBF,EAAWG,QAAQC,IACjBF,EAAUE,EAAKC,aAAeD,IAEhCb,EAAmBW,EACrB,CAAE,MAAO3I,GACPD,QAAQC,MAAM,gCAAiCA,EACjD,CAAC,QACC7I,GAAW,EACb,GAGFoR,IACA,MAAMQ,EAAWC,YAAYT,EAAU,KACvC,MAAO,IAAMU,cAAcF,IAC1B,IAEH,MAAMG,GAAoB1P,EAAAA,EAAAA,SAAQ,KAChC,IAAKqO,IAAUA,EAAMsB,QAAS,MAAO,GAErC,IAAIC,EAAWvB,EAAMsB,QAAQ/D,OAAOpH,GAClCA,EAAOvB,KAAK4M,cAAcjQ,SAAS6O,EAAWoB,gBA2BhD,OAxBAD,EAASlR,KAAK,CAACoR,EAAGC,KAChB,MAAMC,EAAgBzB,EAAgBuB,EAAE7M,OAAS,CAAC,EAC5CgN,EAAgB1B,EAAgBwB,EAAE9M,OAAS,CAAC,EAElD,OAAQ0L,GACN,IAAK,aAcL,QACE,OAAQsB,EAAcC,kBAAoB,IAAMF,EAAcE,kBAAoB,GAbpF,IAAK,QACH,OAAOH,EAAEI,UAAYL,EAAEK,UACzB,IAAK,YACH,OAAOJ,EAAEK,eAAiBN,EAAEM,eAC9B,IAAK,YACH,OAAQH,EAAcI,iBAAmB,IAAML,EAAcK,iBAAmB,GAClF,IAAK,QACH,OAAQJ,EAAczN,aAAe,IAAMwN,EAAcxN,aAAe,GAC1E,IAAK,SACH,OAAO8N,WAAWP,EAAEQ,WAAa,GAAKD,WAAWR,EAAES,WAAa,GAClE,IAAK,OACH,OAAOT,EAAE7M,KAAKuN,cAAcT,EAAE9M,SAM7B2M,GACN,CAACvB,EAAOI,EAAYE,EAAQJ,IAEzBkC,GAAezQ,EAAAA,EAAAA,SAAQ,KAC3B,IAAKqO,IAAUA,EAAMsB,QAAS,MAAO,CACnCe,aAAc,EACdC,WAAY,EACZC,QAAS,EACTL,UAAW,EACXM,eAAgB,EAChBC,WAAY,EACZC,WAAY,EACZC,cAAe,GAGjB,MAAML,EAAatC,EAAMsB,QAAQzN,OAAO,CAACC,EAAK2N,IAAM3N,GAAO2N,EAAEK,WAAa,GAAI,GACxES,EAAUvC,EAAMsB,QAAQzN,OAAO,CAACC,EAAK2N,IAAM3N,GAAO2N,EAAEM,gBAAkB,GAAI,GAC1EG,EAAYlC,EAAMsB,QAAQtO,OAAS,GACpCgN,EAAMsB,QAAQzN,OAAO,CAACC,EAAK2N,IAAM3N,GAAOmO,WAAWR,EAAES,YAAc,GAAI,GAAKlC,EAAMsB,QAAQtO,QAAQ4P,QAAQ,GAC3G,EAGEJ,EAAiBzF,OAAO8F,OAAO3C,GAAiBrM,OAAO,CAACC,EAAKkN,IAASlN,GAAOkN,EAAKgB,iBAAmB,GAAI,GACzGS,EAAa1F,OAAO8F,OAAO3C,GAAiBrM,OAAO,CAACC,EAAKkN,IAASlN,GAAOkN,EAAK7M,aAAe,GAAI,GACjGuO,EAAa3F,OAAO8F,OAAO3C,GAAiBrM,OAAO,CAACC,EAAKkN,IAASlN,GAAOkN,EAAK8B,aAAe,GAAI,GACjGH,EAAgB5F,OAAO8F,OAAO3C,GAAiBrM,OAAO,CAACC,EAAKkN,IAASlN,GAAOkN,EAAK9M,gBAAkB,GAAI,GAE7G,MAAO,CACLmO,aAAcrC,EAAMsB,QAAQtO,OAC5BsP,aACAC,UACAL,YACAM,iBACAC,aACAC,aACAC,kBAED,CAAC3C,EAAOE,IAEX,OAAI7Q,GAEAuD,EAAAA,EAAAA,KAAA,OAAKG,UAAU,eAAcF,UAC3BC,EAAAA,EAAAA,MAAA,OAAKC,UAAU,kBAAiBF,SAAA,EAC9BD,EAAAA,EAAAA,KAAA,OAAKG,UAAU,qBACfH,EAAAA,EAAAA,KAAA,KAAAC,SAAG,kCAOTC,EAAAA,EAAAA,MAAA,OAAKC,UAAU,eAAcF,SAAA,EAE3BD,EAAAA,EAAAA,KAAA,OAAKG,UAAU,iBAAgBF,UAC7BC,EAAAA,EAAAA,MAAA,OAAKC,UAAU,wBAAuBF,SAAA,EACpCC,EAAAA,EAAAA,MAAA,MAAIC,UAAU,gBAAeF,SAAA,EAC3BD,EAAAA,EAAAA,KAACmQ,EAAAA,IAAY,IAAG,yBAElBnQ,EAAAA,EAAAA,KAAA,KAAGG,UAAU,mBAAkBF,SAAC,kEAKpCC,EAAAA,EAAAA,MAAA,OAAKC,UAAU,qBAAoBF,SAAA,EACjCC,EAAAA,EAAAA,MAAA,OAAKC,UAAU,oBAAmBF,SAAA,EAChCD,EAAAA,EAAAA,KAAA,OAAKG,UAAU,wCAAuCF,UACpDD,EAAAA,EAAAA,KAACoQ,EAAAA,IAAM,OAETlQ,EAAAA,EAAAA,MAAA,OAAKC,UAAU,uBAAsBF,SAAA,EACnCD,EAAAA,EAAAA,KAAA,OAAKG,UAAU,qBAAoBF,SAAC,mBACpCD,EAAAA,EAAAA,KAAA,OAAKG,UAAU,qBAAoBF,SAAEuP,EAAaC,sBAItDvP,EAAAA,EAAAA,MAAA,OAAKC,UAAU,oBAAmBF,SAAA,EAChCD,EAAAA,EAAAA,KAAA,OAAKG,UAAU,wCAAuCF,UACpDD,EAAAA,EAAAA,KAACoQ,EAAAA,IAAM,OAETlQ,EAAAA,EAAAA,MAAA,OAAKC,UAAU,uBAAsBF,SAAA,EACnCD,EAAAA,EAAAA,KAAA,OAAKG,UAAU,qBAAoBF,SAAC,iBACpCD,EAAAA,EAAAA,KAAA,OAAKG,UAAU,qBAAoBF,SAAEuP,EAAaE,oBAItDxP,EAAAA,EAAAA,MAAA,OAAKC,UAAU,oBAAmBF,SAAA,EAChCD,EAAAA,EAAAA,KAAA,OAAKG,UAAU,wCAAuCF,UACpDD,EAAAA,EAAAA,KAACqQ,EAAAA,IAAU,OAEbnQ,EAAAA,EAAAA,MAAA,OAAKC,UAAU,uBAAsBF,SAAA,EACnCD,EAAAA,EAAAA,KAAA,OAAKG,UAAU,qBAAoBF,SAAC,qBACpCD,EAAAA,EAAAA,KAAA,OAAKG,UAAU,qBAAoBF,SAAEuP,EAAaG,QAAQzI,0BAI9DhH,EAAAA,EAAAA,MAAA,OAAKC,UAAU,oBAAmBF,SAAA,EAChCD,EAAAA,EAAAA,KAAA,OAAKG,UAAU,wCAAuCF,UACpDD,EAAAA,EAAAA,KAACsQ,EAAAA,IAAM,OAETpQ,EAAAA,EAAAA,MAAA,OAAKC,UAAU,uBAAsBF,SAAA,EACnCD,EAAAA,EAAAA,KAAA,OAAKG,UAAU,qBAAoBF,SAAC,gBACpCC,EAAAA,EAAAA,MAAA,OAAKC,UAAU,qBAAoBF,SAAA,CAAEuP,EAAaF,UAAU,mBAIhEpP,EAAAA,EAAAA,MAAA,OAAKC,UAAU,oBAAmBF,SAAA,EAChCD,EAAAA,EAAAA,KAAA,OAAKG,UAAU,wCAAuCF,UACpDD,EAAAA,EAAAA,KAACuQ,EAAAA,IAAO,OAEVrQ,EAAAA,EAAAA,MAAA,OAAKC,UAAU,uBAAsBF,SAAA,EACnCD,EAAAA,EAAAA,KAAA,OAAKG,UAAU,qBAAoBF,SAAC,qBACpCD,EAAAA,EAAAA,KAAA,OAAKG,UAAU,qBAAoBF,SAAEuP,EAAaI,wBAItD1P,EAAAA,EAAAA,MAAA,OAAKC,UAAU,oBAAmBF,SAAA,EAChCD,EAAAA,EAAAA,KAAA,OAAKG,UAAU,wCAAuCF,UACpDD,EAAAA,EAAAA,KAACwQ,EAAAA,IAAgB,OAEnBtQ,EAAAA,EAAAA,MAAA,OAAKC,UAAU,uBAAsBF,SAAA,EACnCD,EAAAA,EAAAA,KAAA,OAAKG,UAAU,qBAAoBF,SAAC,iBACpCD,EAAAA,EAAAA,KAAA,OAAKG,UAAU,qBAAoBF,SAAEuP,EAAaK,oBAItD3P,EAAAA,EAAAA,MAAA,OAAKC,UAAU,oBAAmBF,SAAA,EAChCD,EAAAA,EAAAA,KAAA,OAAKG,UAAU,wCAAuCF,UACpDD,EAAAA,EAAAA,KAACyQ,EAAAA,IAAO,OAEVvQ,EAAAA,EAAAA,MAAA,OAAKC,UAAU,uBAAsBF,SAAA,EACnCD,EAAAA,EAAAA,KAAA,OAAKG,UAAU,qBAAoBF,SAAC,iBACpCD,EAAAA,EAAAA,KAAA,OAAKG,UAAU,qBAAoBF,SAAEuP,EAAaM,oBAItD5P,EAAAA,EAAAA,MAAA,OAAKC,UAAU,oBAAmBF,SAAA,EAChCD,EAAAA,EAAAA,KAAA,OAAKG,UAAU,wCAAuCF,UACpDD,EAAAA,EAAAA,KAAC0Q,EAAAA,IAAe,OAElBxQ,EAAAA,EAAAA,MAAA,OAAKC,UAAU,uBAAsBF,SAAA,EACnCD,EAAAA,EAAAA,KAAA,OAAKG,UAAU,qBAAoBF,SAAC,oBACpCD,EAAAA,EAAAA,KAAA,OAAKG,UAAU,qBAAoBF,SAAEuP,EAAaO,0BAMxD7P,EAAAA,EAAAA,MAAA,OAAKC,UAAU,mBAAkBF,SAAA,EAC/BC,EAAAA,EAAAA,MAAA,OAAKC,UAAU,wBAAuBF,SAAA,EACpCD,EAAAA,EAAAA,KAAA,SAAOG,UAAU,gBAAeF,SAAC,mBACjCC,EAAAA,EAAAA,MAAA,OAAKC,UAAU,yBAAwBF,SAAA,EACrCD,EAAAA,EAAAA,KAAC2Q,EAAAA,IAAQ,CAACxQ,UAAU,yBACpBH,EAAAA,EAAAA,KAAA,SACE2D,KAAK,OACL/B,YAAY,2BACZJ,MAAOgM,EACP/L,SAAWC,GAAM+L,EAAc/L,EAAEC,OAAOH,OACxCrB,UAAU,gCAKhBD,EAAAA,EAAAA,MAAA,OAAKC,UAAU,wBAAuBF,SAAA,EACpCD,EAAAA,EAAAA,KAAA,SAAOG,UAAU,gBAAeF,SAAC,aACjCC,EAAAA,EAAAA,MAAA,UACEsB,MAAOkM,EACPjM,SAAWC,GAAMiM,EAAUjM,EAAEC,OAAOH,OACpCrB,UAAU,iBAAgBF,SAAA,EAE1BD,EAAAA,EAAAA,KAAA,UAAQwB,MAAM,aAAYvB,SAAC,sBAC3BD,EAAAA,EAAAA,KAAA,UAAQwB,MAAM,YAAWvB,SAAC,eAC1BD,EAAAA,EAAAA,KAAA,UAAQwB,MAAM,QAAOvB,SAAC,WACtBD,EAAAA,EAAAA,KAAA,UAAQwB,MAAM,QAAOvB,SAAC,iBACtBD,EAAAA,EAAAA,KAAA,UAAQwB,MAAM,YAAWvB,SAAC,eAC1BD,EAAAA,EAAAA,KAAA,UAAQwB,MAAM,SAAQvB,SAAC,YACvBD,EAAAA,EAAAA,KAAA,UAAQwB,MAAM,OAAMvB,SAAC,yBAM3BD,EAAAA,EAAAA,KAAA,OAAKG,UAAU,wBAAuBF,UACpCC,EAAAA,EAAAA,MAAA,SAAOC,UAAU,gBAAeF,SAAA,EAC9BD,EAAAA,EAAAA,KAAA,SAAOG,UAAU,qBAAoBF,UACnCC,EAAAA,EAAAA,MAAA,MAAAD,SAAA,EACED,EAAAA,EAAAA,KAAA,MAAIG,UAAU,wCAAuCF,SAAC,UACtDD,EAAAA,EAAAA,KAAA,MAAIG,UAAU,wCAAuCF,SAAC,iBACtDD,EAAAA,EAAAA,KAAA,MAAIG,UAAU,uCAAsCF,SAAC,WACrDD,EAAAA,EAAAA,KAAA,MAAIG,UAAU,uCAAsCF,SAAC,eACrDD,EAAAA,EAAAA,KAAA,MAAIG,UAAU,uCAAsCF,SAAC,eACrDD,EAAAA,EAAAA,KAAA,MAAIG,UAAU,uCAAsCF,SAAC,WACrDD,EAAAA,EAAAA,KAAA,MAAIG,UAAU,uCAAsCF,SAAC,WACrDD,EAAAA,EAAAA,KAAA,MAAIG,UAAU,uCAAsCF,SAAC,YACrDD,EAAAA,EAAAA,KAAA,MAAIG,UAAU,uCAAsCF,SAAC,gBAGzDD,EAAAA,EAAAA,KAAA,SAAOG,UAAU,qBAAoBF,SAClCwO,EAAkBrO,OAAS,EAC1BqO,EAAkB5M,IAAI,CAAC0B,EAAQqN,KAC7B,MAAMC,EAASvD,EAAgB/J,EAAOvB,OAAS,CAAC,EAC1C8O,EAAWD,EAAO5B,kBAAoB,EACtC8B,EAAgB,IAARH,EAAY,eAAe,IAARA,EAAY,eAAe,IAARA,EAAY,eAAI,IAAAxM,OAAOwM,EAAM,GAEjF,OACE1Q,EAAAA,EAAAA,MAAA,MAAoBC,UAAU,oBAAmBF,SAAA,EAC/CD,EAAAA,EAAAA,KAAA,MAAIG,UAAU,sCAAqCF,UACjDD,EAAAA,EAAAA,KAAA,QAAMG,UAAU,qBAAoBF,SAAE8Q,OAExC/Q,EAAAA,EAAAA,KAAA,MAAIG,UAAU,sCAAqCF,UACjDD,EAAAA,EAAAA,KAAA,OAAKG,UAAU,sBAAqBF,SACjB,YAAhBsD,EAAOvB,KAAqB,8BAAsBuB,EAAOvB,UAG9DhC,EAAAA,EAAAA,KAAA,MAAIG,UAAU,qCAAoCF,UAChDD,EAAAA,EAAAA,KAAA,QAAMG,UAAU,2CAA0CF,SAAEsD,EAAO2L,eAErElP,EAAAA,EAAAA,KAAA,MAAIG,UAAU,qCAAoCF,UAChDD,EAAAA,EAAAA,KAAA,QAAMG,UAAU,+CAA8CF,SAAEsD,EAAO4L,oBAEzEnP,EAAAA,EAAAA,KAAA,MAAIG,UAAU,qCAAoCF,UAChDD,EAAAA,EAAAA,KAAA,QAAMG,UAAU,+CAA8CF,SAAE4Q,EAAOzB,iBAAmB,OAE5FpP,EAAAA,EAAAA,KAAA,MAAIG,UAAU,qCAAoCF,UAChDC,EAAAA,EAAAA,MAAA,QAAMC,UAAU,2CAA0CF,SAAA,EACxDD,EAAAA,EAAAA,KAACgR,EAAAA,IAAU,CAAC7Q,UAAU,wBACrB0Q,EAAOtP,aAAe,QAG3BvB,EAAAA,EAAAA,KAAA,MAAIG,UAAU,qCAAoCF,UAChDC,EAAAA,EAAAA,MAAA,QAAMC,UAAU,2CAA0CF,SAAA,EACxDD,EAAAA,EAAAA,KAACyQ,EAAAA,IAAO,CAACtQ,UAAU,wBAClB0Q,EAAOX,aAAe,QAG3BlQ,EAAAA,EAAAA,KAAA,MAAIG,UAAU,qCAAoCF,UAChDC,EAAAA,EAAAA,MAAA,QAAMC,UAAU,uBAAsBF,SAAA,CACnC4Q,EAAOI,eAAiB,EAAIJ,EAAOI,eAAejB,QAAQ,GAAK,SAAI,gBAGxEhQ,EAAAA,EAAAA,KAAA,MAAIG,UAAU,qCAAoCF,UAChDD,EAAAA,EAAAA,KAAA,QAAMG,UAAU,sBAAqBF,SAAE6Q,EAASd,QAAQ,SApCnDzM,EAAOxB,OA0CpB/B,EAAAA,EAAAA,KAAA,MAAIG,UAAU,sCAAqCF,UACjDC,EAAAA,EAAAA,MAAA,MAAI2C,QAAQ,IAAI1C,UAAU,2CAA0CF,SAAA,CAAC,8BACvCuN,EAAW,iBASnDxN,EAAAA,EAAAA,KAAA,OAAKG,UAAU,kBAAiBF,UAC9BC,EAAAA,EAAAA,MAAA,OAAKC,UAAU,uBAAsBF,SAAA,EACnCD,EAAAA,EAAAA,KAAA,QAAMG,UAAU,wBAAuBF,SAAC,aACxCC,EAAAA,EAAAA,MAAA,QAAMC,UAAU,wBAAuBF,SAAA,CAAEwO,EAAkBrO,OAAO,OAAKoP,EAAaC,iBACpFzP,EAAAA,EAAAA,KAAA,QAAMG,UAAU,wBAAuBF,SAAC,qBCtOlD,EAjE0B1D,IAAsB,IAArB,YAAEC,GAAaD,EACxC,MAAO2U,IAAgBC,EAAAA,EAAAA,OAChBC,EAAWC,IAAgB1U,EAAAA,EAAAA,UAAS,SAsB3C,OApBA6C,EAAAA,EAAAA,WAAU,KACR,MAAM8R,EAAWJ,EAAajG,IAAI,OAEhCoG,EADe,eAAbC,EACW,aACS,iBAAbA,EACI,eACS,YAAbA,EACI,UAEA,UAEd,CAACJ,IAEJK,EAAAA,UAAgB,KACd,MAAMC,EAAWtN,SAASuN,cAAc,SAGxC,OAFAD,EAASE,UAnDE,4oBAoDXxN,SAASyN,KAAKC,YAAYJ,GACnB,IAAMA,EAASK,UACrB,KAGD3R,EAAAA,EAAAA,MAAA,OAAAD,SAAA,EACEC,EAAAA,EAAAA,MAAA,OAAKC,UAAU,eAAcF,SAAA,EAC3BC,EAAAA,EAAAA,MAAA,UACEC,UAAS,eAAAiE,OAA+B,UAAdgN,EAAwB,SAAW,IAC7DnP,QAASA,IAAMoP,EAAa,SAASpR,SAAA,EAErCD,EAAAA,EAAAA,KAACoQ,EAAAA,IAAM,CAACxG,KAAM,KAAM,YAGtB1J,EAAAA,EAAAA,MAAA,UACEC,UAAS,eAAAiE,OAA+B,iBAAdgN,EAA+B,SAAW,IACpEnP,QAASA,IAAMoP,EAAa,gBAAgBpR,SAAA,EAE5CD,EAAAA,EAAAA,KAAC8R,EAAAA,IAAQ,CAAClI,KAAM,KAAM,mBAGxB1J,EAAAA,EAAAA,MAAA,UACEC,UAAS,eAAAiE,OAA+B,eAAdgN,EAA6B,SAAW,IAClEnP,QAASA,IAAMoP,EAAa,cAAcpR,SAAA,EAE1CD,EAAAA,EAAAA,KAAC+R,EAAAA,IAAU,CAACnI,KAAM,KAAM,kBAG1B1J,EAAAA,EAAAA,MAAA,UACEC,UAAS,eAAAiE,OAA+B,YAAdgN,EAA0B,SAAW,IAC/DnP,QAASA,IAAMoP,EAAa,WAAWpR,SAAA,EAEvCD,EAAAA,EAAAA,KAACgS,EAAAA,IAAU,CAACpI,KAAM,KAAM,gBAKb,UAAdwH,IAAyBpR,EAAAA,EAAAA,KAACiS,EAAK,CAACzV,YAAaA,IAC/B,iBAAd4U,IAAgCpR,EAAAA,EAAAA,KAACkS,EAAsB,CAAC1V,YAAaA,IACvD,eAAd4U,IAA8BpR,EAAAA,EAAAA,KAACmS,EAAoB,CAAC3V,YAAaA,IACnD,YAAd4U,IAA2BpR,EAAAA,EAAAA,KAACmN,EAAO,O,+FChG1C,MAAMiF,GAAoB,EAKnBhT,eAAeiT,EAAsBC,GAAoB,IAAbzF,EAAKC,UAAA1M,OAAA,QAAA+G,IAAA2F,UAAA,GAAAA,UAAA,GAAG,GACzD,IAEE,IAAI,KAAEzN,EAAI,MAAEkG,SAAgBwH,EAAAA,EACzBwF,IAAI,0BAA2B,CAAEC,QAASF,EAAOG,QAAS5F,IAE7D,GAAItH,EAAO,MAAMA,EACjB,GAAQ,OAAJlG,QAAI,IAAJA,GAAAA,EAAMe,OAAQ,OAAOf,EAGzB,MAAMqT,QA0CVtT,eAA2CkT,GAAoB,IAAbzF,EAAKC,UAAA1M,OAAA,QAAA+G,IAAA2F,UAAA,GAAAA,UAAA,GAAG,GACxD,IACE,MAAM6F,EAAS,+DAAAvO,OAAkEwO,mBAAmBN,EAAQ,eAAc,WAAAlO,OAAUyI,EAAK,qCACnIgG,QAAiBC,MAAMH,GAE7B,IAAKE,EAASE,GAAI,MAAO,GAEzB,MAAM1T,QAAawT,EAASG,OAEtBC,EAAS5T,EAAK,IAAM,GACpB6T,EAAe7T,EAAK,IAAM,GAC1B8T,EAAO9T,EAAK,IAAM,GAExB,OAAO4T,EACJtI,OAAOtH,GAASA,EAAMuL,cAAcjQ,SAAS,eAAiB0E,EAAMuL,cAAcjQ,SAAS,YAC3FkD,IAAI,CAACwB,EAAO+P,KAAK,CAChBpR,KAAMqB,EACN0D,YAAamM,EAAaE,IAAU,GACpC9L,YAAa6L,EAAKC,IAAU,KAElC,CAAE,MAAO7N,GAEP,OADAD,QAAQC,MAAM,6BAA8BA,GACrC,EACT,CACF,CAlE8B8N,CAA4Bf,EAAOzF,GAC7D,GAAI6F,EAAYtS,OAAS,EAKvB,aAHMgL,QAAQC,IAAIqH,EAAY7Q,IAAI6E,GAChC4M,EAA2B5M,EAAI1E,KAAM0E,EAAK,eAErCgM,EAIT,GAAIN,EACF,IACE,MAAMS,QAAiBC,MAAM,GAAD1O,OAAImP,EAAAA,EAAO,iCAAAnP,OAAgCwO,mBAAmBN,GAAM,WAAAlO,OAAUyI,IAE1G,GAAIgG,EAASE,GAAI,CACf,MACMS,SADaX,EAASG,QACFQ,cAAgB,GAS1C,OANIA,EAAapT,OAAS,SAClBgL,QAAQC,IAAImI,EAAa3R,IAAI6E,GACjC4M,EAA2B5M,EAAI1E,KAAM0E,EAAK,kBAIvC8M,CACT,CACF,CAAE,MAAOC,GACPnO,QAAQgG,KAAK,6BAA8BmI,EAAW1O,QACxD,CAGF,MAAO,EACT,CAAE,MAAOQ,GAEP,OADAD,QAAQC,MAAM,oCAAqCA,GAC5C,EACT,CACF,CAqJOnG,eAAesU,EAAqBC,GACzC,IAAK,IAADC,EAAAC,EAAAC,EACF,MAAMzQ,GAASsQ,GAAkB,IAAIlK,OAAOsK,QAAQ,OAAQ,KAC5D,IAAK1Q,EAAO,MAAO,GAEnB,MAAM2Q,EAAO,gGAAA5P,OAAmGwO,mBAAmBvP,IAC7H4Q,QAAgBnB,MAAMkB,GAC5B,IAAKC,EAAQlB,GAAI,MAAO,GACxB,MAAMmB,QAAiBD,EAAQjB,OAGzBmB,GAAiB,QAARN,GADO,OAARK,QAAQ,IAARA,GAAe,QAAPN,EAARM,EAAU5B,aAAK,IAAAsB,GAAfA,EAAiBhQ,MAAQuG,OAAO8F,OAAOiE,EAAS5B,MAAM1O,OAAS,IACxD,UAAE,IAAAiQ,OAAA,EAARA,EAAUM,SAAU,GACnC,IAAKA,EAAO/T,OAAQ,MAAO,GAE3B,MAAMgU,EAAaD,EAChBtS,IAAKwS,GAAW,OAAHA,QAAG,IAAHA,OAAG,EAAHA,EAAKhR,OAClBsH,OAAO2J,SACP1P,MAAM,EAAG,IACT2P,KAAK,KAER,IAAKH,EAAY,MAAO,GAExB,MAAMI,EAAO,8GAAApQ,OAAiHwO,mBAAmBwB,IAC3IK,QAAgB3B,MAAM0B,GAC5B,IAAKC,EAAQ1B,GAAI,MAAO,GACxB,MAAM2B,QAAiBD,EAAQzB,OAGzBG,GADoB,OAARuB,QAAQ,IAARA,GAAe,QAAPZ,EAARY,EAAUpC,aAAK,IAAAwB,GAAfA,EAAiBlQ,MAAQuG,OAAO8F,OAAOyE,EAASpC,MAAM1O,OAAS,IAE9E/B,IAAKsE,IAAC,IAAAwO,EAAAC,EAAA,OAAM,OAADzO,QAAC,IAADA,GAAY,QAAXwO,EAADxO,EAAG0O,iBAAS,IAAAF,GAAK,QAALC,EAAZD,EAAe,UAAE,IAAAC,OAAhB,EAADA,EAAmBE,MAC9BnK,OAAQoK,GAAmB,kBAANA,GAAkB,0BAA0BC,KAAKD,IAOzE,OALoB5B,EAAK1V,KAAK,CAACoR,EAAGC,KAChC,MAAMmG,EAAgBlV,GAAM,iCAAiCiV,KAAKjV,GAAK,EAAI,EAC3E,OAAOkV,EAAapG,GAAKoG,EAAanG,KAGrBlK,MAAM,EAAG,EAC9B,CAAE,MAAOlD,GAEP,OADA4D,QAAQC,MAAM,mCAAoC7D,GAC3C,EACT,CACF,CAKOtC,eAAe8V,EAAoBvB,GACxC,GAAIvB,EACF,IACE,MAAMS,QAAiBC,MAAM,GAAD1O,OAAImP,EAAAA,EAAO,iCAAAnP,OAAgCwO,mBAAmBe,KAE1F,GAAId,EAASE,GAAI,CAAC,IAADoC,EAEf,OAAkB,QAAXA,SADYtC,EAASG,QAChBmB,cAAM,IAAAgB,OAAA,EAAXA,EAAatT,IAAIwS,GAAOA,EAAIS,OAAQ,EAC7C,CACF,CAAE,MAAOvP,GACPD,QAAQC,MAAM,4CAA6CA,EAC7D,CAGF,MAAO,EACT,CAKOnG,eAAegW,EAAoBC,EAAUC,GAClD,IACE,MAAMzC,QAAiBC,MAAMuC,GAC7B,IAAKxC,EAASE,GAAI,MAAM,IAAIwC,MAAM,4BAElC,MAAMC,QAAa3C,EAAS2C,OAE5B,OADa,IAAIC,KAAK,CAACD,GAAOF,EAAU,CAAE3R,KAAM6R,EAAK7R,MAEvD,CAAE,MAAO4B,GAEP,OADAD,QAAQC,MAAM,2BAA4BA,GACnC,IACT,CACF,CAKOnG,eAAekU,EAA2BK,EAAgBtU,GAA0B,IAApBqW,EAAM5I,UAAA1M,OAAA,QAAA+G,IAAA2F,UAAA,GAAAA,UAAA,GAAG,SAC9E,IACE,MAAM,MAAEvH,SAAgBwH,EAAAA,EACrBxC,KAAK,4BACLoL,OAAO,CACNC,gBAAiBjC,EACjBtU,KAAMA,EACNqW,OAAQA,EACRG,YAAY,IAAI/R,MAAOgS,gBAG3B,GAAIvQ,EAAO,MAAMA,EACjB,OAAO,CACT,CAAE,MAAOA,GAEP,OADAD,QAAQC,MAAM,8BAA+BA,IACtC,CACT,CACF,CAyIOnG,eAAe2W,EAAuBpC,GAC3C,IAEE,IAAItU,QApWDD,eAAwCuU,GAC7C,IACE,MAAM,KAAEtU,EAAI,MAAEkG,SAAgBwH,EAAAA,EAC3BwF,IAAI,8BAA+B,CAClCyD,kBAAmBrC,IAGvB,GAAIpO,EAAO,MAAMA,EACjB,OAAOlG,CACT,CAAE,MAAOkG,GAEP,OADAD,QAAQC,MAAM,+BAAgCA,GACvC,IACT,CACF,CAuVqB0Q,CAAyBtC,GAC1C,GAAItU,EAAM,OAAOA,EAGjB,MAAM6W,QA1TH9W,eAAgDuU,GACrD,IAAK,IAADwC,EACF,MAAMrB,EAAG,qDAAA1Q,OAAwDwO,mBAAmBe,IAC9EyC,QAAYtD,MAAMgC,GACxB,IAAKsB,EAAIrD,GAAI,OAAO,KACpB,MAAMC,QAAaoD,EAAIpD,OAEvB,MAAO,CACLhR,KAAMgR,EAAK3P,OAASsQ,EACpB5M,YAAaiM,EAAKqD,SAAW,GAC7B/O,YAAa,GACbnF,SAAU,GACV6E,YAAa,KACbC,cAAe,KACfqP,aAA4B,QAAdH,EAAAnD,EAAKuD,iBAAS,IAAAJ,GAAdA,EAAgBT,OAAS,CAAC1C,EAAKuD,UAAUb,QAAU,GAErE,CAAE,MAAOhU,GAEP,OADA4D,QAAQC,MAAM,sCAAuC7D,GAC9C,IACT,CACF,CAsS8B8U,CAAiC7C,GACrD8C,QAlSHrX,eAA+CuU,GACpD,IAAK,IAAD+C,EAAAC,EAAAC,EAAAC,EACF,MAAMC,EAAW,gbAAA1S,OAS+BuP,EAAc,2JAMxDmB,EAAG,2CAAA1Q,OAA8CwO,mBAAmBkE,GAAY,gBAChFjE,QAAiBC,MAAMgC,GAC7B,IAAKjC,EAASE,GAAI,OAAO,KAEzB,MACMgE,SADalE,EAASG,QACPgE,QAAQC,SAAS,GAEtC,OAAKF,EAEE,CACL/U,KAAM+U,EAAQG,UAAU1V,MACxBuF,YAAa,GACbO,aAA4B,QAAfoP,EAAAK,EAAQI,eAAO,IAAAT,OAAA,EAAfA,EAAiBlV,QAAS,GACvCW,UAA+B,QAArBwU,EAAAI,EAAQK,qBAAa,IAAAT,OAAA,EAArBA,EAAuBnV,QAAS,GAC1CwF,YAAgC,QAAnB4P,EAAAG,EAAQ/P,mBAAW,IAAA4P,GAAnBA,EAAqBpV,MAAQ,IAAIsC,KAAKiT,EAAQ/P,YAAYxF,OAAO6V,cAAgB,KAC9FpQ,eAAmC,QAApB4P,EAAAE,EAAQO,oBAAY,IAAAT,OAAA,EAApBA,EAAsBrV,QAAS,KAC9C8U,aAAc,IATK,IAWvB,CAAE,MAAO/Q,GAEP,OADAD,QAAQC,MAAM,gCAAiCA,GACxC,IACT,CACF,CA2P2BgS,CAAgC5D,GAEvD,GAAIuC,GAAeO,EAAU,CAAC,IAADla,EAAAib,EAAAC,EAU3BpY,EATe,CACb2C,KAA4D,QAAxDzF,GAAc,OAAX2Z,QAAW,IAAXA,OAAW,EAAXA,EAAalU,QAAgB,OAARyU,QAAQ,IAARA,OAAQ,EAARA,EAAUzU,OAAQ2R,SAAc,IAAApX,EAAAA,EAAKoX,EACjE5M,aAAwB,OAAXmP,QAAW,IAAXA,OAAW,EAAXA,EAAanP,cAAe,GACzCO,aAAqB,OAARmP,QAAQ,IAARA,OAAQ,EAARA,EAAUnP,cAAe,GACtCnF,UAAkB,OAARsU,QAAQ,IAARA,OAAQ,EAARA,EAAUtU,WAAY,GAChC6E,YAAkC,QAAvBwQ,EAAU,OAARf,QAAQ,IAARA,OAAQ,EAARA,EAAUzP,mBAAW,IAAAwQ,EAAAA,EAAI,KACtCvQ,cAAsC,QAAzBwQ,EAAU,OAARhB,QAAQ,IAARA,OAAQ,EAARA,EAAUxP,qBAAa,IAAAwQ,EAAAA,EAAI,KAC1CnB,cAAyB,OAAXJ,QAAW,IAAXA,OAAW,EAAXA,EAAaI,eAAgB,GAG/C,CAQA,GALKjX,IACHA,QAxWCD,eAA6CuU,GAClD,GAAIvB,EACF,IACE,MAAMS,QAAiBC,MAAM,GAAD1O,OAAImP,EAAAA,EAAO,iCAAAnP,OAAgCwO,mBAAmBe,KAE1F,GAAId,EAASE,GAAI,CACf,MAAM1T,QAAawT,EAASG,OAC5B,MAAO,CACLhR,KAAM3C,EAAKqY,WAAW1V,MAAQ2R,EAC9B5M,YAAa1H,EAAKqY,WAAW3Q,aAAe,GAC5CO,YAAajI,EAAKqY,WAAWpQ,aAAe,GAC5CnF,SAAU9C,EAAKqY,WAAWvV,UAAY,GACtC6E,YAAa,KACbC,cAAe,KACfqP,aAAcjX,EAAKqY,WAAWC,MAAQ,CAACtY,EAAKqY,WAAWC,OAAS,GAEpE,CACF,CAAE,MAAOpS,GACPD,QAAQC,MAAM,wCAAyCA,EACzD,CAGF,OAAO,IACT,CAiVmBqS,CAA8BjE,IAIzCtU,KAAUA,EAAKiX,cAA6C,IAA7BjX,EAAKiX,aAAalW,QAAe,CAClE,MAAMyX,QAAgBnE,EAAqBrU,EAAK2C,MAAQ2R,GACxD,GAAIkE,EAAQzX,OACVf,EAAKiX,aAAeuB,MACf,CACL,MAAMC,QAAiB5C,EAAoB7V,EAAK2C,MAAQ2R,GACxDtU,EAAKiX,aAAewB,CACtB,CACF,CAOA,OAJIzY,SACIiU,EAA2BK,EAAgBtU,EAAM,sBAIvDA,GAAQ,CACN2C,KAAM2R,EACN5M,YAAa,GACbO,YAAa,GACbnF,SAAU,GACV6E,YAAa,KACbC,cAAe,KACfqP,aAAc,GAGpB,CAAE,MAAO/Q,GAEP,OADAD,QAAQC,MAAM,sCAAuCA,GAC9C,CACLvD,KAAM2R,EACN5M,YAAa,GACbO,YAAa,GACbnF,SAAU,GACV6E,YAAa,KACbC,cAAe,KACfqP,aAAc,GAElB,CACF,C","sources":["SomaLux/Books/Admin/pages/Books.jsx","SomaLux/Books/Admin/pages/UniversitiesManagement.jsx","SomaLux/Books/Admin/pages/PastPapersManagement.jsx","SomaLux/Books/Admin/authorInteractionsApi.js","SomaLux/Books/Admin/pages/Authors.jsx","SomaLux/Books/Admin/pages/ContentManagement.jsx","SomaLux/Books/Admin/universityPrefillApi.js"],"sourcesContent":["import React, { useEffect, useMemo, useState } from 'react';\r\nimport { fetchBooks, fetchCategories, deleteBook, updateBook } from '../api';\r\nimport { useAdminUI } from '../AdminUIContext';\r\n\r\nconst Books = ({ userProfile }) => {\r\n  const [loading, setLoading] = useState(true);\r\n  const [rows, setRows] = useState([]);\r\n  const [count, setCount] = useState(0);\r\n  const [page, setPage] = useState(1);\r\n  const [pageSize] = useState(23);\r\n  const [search, setSearch] = useState('');\r\n  const [categories, setCategories] = useState([]);\r\n  const [categoryId, setCategoryId] = useState(null);\r\n  const [sort, setSort] = useState({ col: 'created_at', dir: 'desc' });\r\n  const [editingId, setEditingId] = useState(null);\r\n  const [editDraft, setEditDraft] = useState({});\r\n  const [newPdf, setNewPdf] = useState(null);\r\n  const [newCover, setNewCover] = useState(null);\r\n\r\n  const { confirm, showToast } = useAdminUI();\r\n\r\n  const ADMIN_EMAILS = ['campuslives254@gmail.com', 'paltechsomalux@gmail.com'];\r\n  const isAdmin = userProfile?.role === 'admin' || ADMIN_EMAILS.includes(userProfile?.email);\r\n  const isEditor = userProfile?.role === 'editor' || ADMIN_EMAILS.includes(userProfile?.email);\r\n\r\n  const totalPages = useMemo(() => Math.max(1, Math.ceil(count / pageSize)), [count, pageSize]);\r\n\r\n  const load = async () => {\r\n    setLoading(true);\r\n    try {\r\n      const { data, count: total } = await fetchBooks({ \r\n        page, \r\n        pageSize, \r\n        search, \r\n        categoryId, \r\n        sort\r\n      });\r\n      \r\n      setRows(data);\r\n      setCount(total);\r\n    } finally { setLoading(false); }\r\n  };\r\n\r\n  useEffect(() => {\r\n    (async () => {\r\n      try { setCategories(await fetchCategories()); } catch {}\r\n      if (userProfile) {\r\n        await load();\r\n      }\r\n    })();\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  }, [page, search, categoryId, sort.col, sort.dir, userProfile]);\r\n\r\n  const canEdit = (row) => {\r\n    if (isAdmin) return true;\r\n    if (isEditor) return true;\r\n    return false;\r\n  };\r\n\r\n  const startEdit = (row) => {\r\n    if (!canEdit(row)) {\r\n      showToast({ type: 'error', message: 'You do not have permission to edit this book.' });\r\n      return;\r\n    }\r\n    setEditingId(row.id);\r\n    setEditDraft({\r\n      title: row.title || '',\r\n      author: row.author || '',\r\n      year: row.year || '',\r\n      category_id: row.category_id || null,\r\n      language: row.language || '',\r\n      isbn: row.isbn || '',\r\n      pages: row.pages || '',\r\n      publisher: row.publisher || ''\r\n    });\r\n    setNewPdf(null);\r\n    setNewCover(null);\r\n  };\r\n\r\n  const cancelEdit = () => {\r\n    setEditingId(null);\r\n    setEditDraft({});\r\n    setNewPdf(null);\r\n    setNewCover(null);\r\n  };\r\n\r\n  const saveEdit = async (row) => {\r\n    if (!canEdit(row)) {\r\n      showToast({ type: 'error', message: 'You can only edit books you uploaded.' });\r\n      return;\r\n    }\r\n    const updates = { ...editDraft };\r\n\r\n    try {\r\n      await updateBook(row.id, { updates, newPdfFile: newPdf, newCoverFile: newCover, oldFilePath: row.file_path });\r\n      cancelEdit();\r\n      await load();\r\n      showToast({ type: 'success', message: 'Book details updated.' });\r\n    } catch (e) {\r\n      console.error('Failed to update book:', e);\r\n      showToast({ type: 'error', message: e?.message || 'Failed to update book.' });\r\n    }\r\n  };\r\n\r\n  const handleDelete = async (row) => {\r\n    if (!canEdit(row)) {\r\n      showToast({ type: 'error', message: 'You can only delete books you uploaded.' });\r\n      return;\r\n    }\r\n    const ok = await confirm({\r\n      title: 'Delete book?',\r\n      message: `Delete \"${row.title}\" and its files? This action cannot be undone.`,\r\n      confirmLabel: 'Delete',\r\n      cancelLabel: 'Cancel',\r\n      variant: 'danger',\r\n    });\r\n    if (!ok) return;\r\n\r\n    try {\r\n      await deleteBook({ id: row.id, file_path: row.file_path });\r\n      await load();\r\n      showToast({ type: 'success', message: 'Book deleted.' });\r\n    } catch (e) {\r\n      console.error('Failed to delete book:', e);\r\n      showToast({ type: 'error', message: e?.message || 'Failed to delete book.' });\r\n    }\r\n  };\r\n\r\n  const toggleSort = (col) => {\r\n    setSort((s) => (s.col === col ? { col, dir: s.dir === 'asc' ? 'desc' : 'asc' } : { col, dir: 'asc' }));\r\n  };\r\n\r\n  return (\r\n    <div>\r\n      <div className=\"panel\">\r\n        <div className=\"panel-title\">Books Management</div>\r\n\r\n        {/* Stats Summary */}\r\n        {!loading && rows.length > 0 && (\r\n          <div style={{ display: 'grid', gridTemplateColumns: 'repeat(auto-fit, minmax(150px, 1fr))', gap: '8px', marginBottom: '12px' }}>\r\n            <div style={{ background: '#1a2332', border: '1px solid #2a3f56', borderRadius: '6px', padding: '8px 12px', color: '#8696a0', fontSize: '0.85rem' }}>\r\n              <div style={{ color: '#00a884', fontSize: '1.2rem', fontWeight: '600' }}>{rows.reduce((sum, r) => sum + (r.downloads || 0), 0)}</div>\r\n              <div>Total Downloads</div>\r\n            </div>\r\n            <div style={{ background: '#1a2332', border: '1px solid #2a3f56', borderRadius: '6px', padding: '8px 12px', color: '#8696a0', fontSize: '0.85rem' }}>\r\n              <div style={{ color: '#34B7F1', fontSize: '1.2rem', fontWeight: '600' }}>{rows.reduce((sum, r) => sum + (r.views || 0), 0)}</div>\r\n              <div>Total Views</div>\r\n            </div>\r\n            <div style={{ background: '#1a2332', border: '1px solid #2a3f56', borderRadius: '6px', padding: '8px 12px', color: '#8696a0', fontSize: '0.85rem' }}>\r\n              <div style={{ color: '#FF6B9D', fontSize: '1.2rem', fontWeight: '600' }}>{rows.reduce((sum, r) => sum + (r.comments_count || 0), 0)}</div>\r\n              <div>Total Comments</div>\r\n            </div>\r\n            <div style={{ background: '#1a2332', border: '1px solid #2a3f56', borderRadius: '6px', padding: '8px 12px', color: '#8696a0', fontSize: '0.85rem' }}>\r\n              <div style={{ color: '#F44336', fontSize: '1.2rem', fontWeight: '600' }}>{rows.reduce((sum, r) => sum + (r.likes_count || 0), 0)}</div>\r\n              <div>Total Likes</div>\r\n            </div>\r\n            <div style={{ background: '#1a2332', border: '1px solid #2a3f56', borderRadius: '6px', padding: '8px 12px', color: '#8696a0', fontSize: '0.85rem' }}>\r\n              <div style={{ color: '#FFCC00', fontSize: '1.2rem', fontWeight: '600' }}>{rows.length}/{count}</div>\r\n              <div>Page Books</div>\r\n            </div>\r\n          </div>\r\n        )}\r\n\r\n        <div className=\"grid-2\" style={{ marginBottom: 6 }}>\r\n          <div className=\"panel\" style={{ padding: '6px 8px' }}>\r\n            <label className=\"label\" style={{ marginBottom: '0.2rem' }}>Search</label>\r\n            <input className=\"input\" value={search} onChange={(e) => { setPage(1); setSearch(e.target.value); }} placeholder=\"Search by title...\" style={{ fontSize: '0.9rem' }} />\r\n          </div>\r\n          <div className=\"panel\" style={{ padding: '6px 8px' }}>\r\n            <label className=\"label\" style={{ marginBottom: '0.2rem' }}>Category</label>\r\n            <select className=\"select\" value={categoryId || ''} onChange={(e) => { setPage(1); setCategoryId(e.target.value || null); }} style={{ fontSize: '0.9rem' }}>\r\n              <option value=\"\">All</option>\r\n              {categories.map(c => <option key={c.id} value={c.id}>{c.name}</option>)}\r\n            </select>\r\n          </div>\r\n        </div>\r\n\r\n        <div className=\"actions\" style={{ marginBottom: 10 }}>\r\n          <button className=\"btn primary\" onClick={() => (window.location.href = '/books/admin/upload')}>Add / Upload New Book</button>\r\n        </div>\r\n\r\n        <div className=\"panel\" style={{ padding: 0, overflowX: 'auto', WebkitOverflowScrolling: 'touch' }}>\r\n          <table className=\"table\" style={{ minWidth: '1620px', borderCollapse: 'separate', borderSpacing: 0 }}>\r\n            <thead>\r\n              <tr>\r\n                <th style={{ width: '60px' }}>Cover</th>\r\n                <th style={{ width: '300px', cursor: 'pointer' }} onClick={() => toggleSort('title')}>Title {sort.col === 'title' ? (sort.dir === 'asc' ? '' : '') : ''}</th>\r\n                <th style={{ width: '200px', cursor: 'pointer' }} onClick={() => toggleSort('author')}>Author {sort.col === 'author' ? (sort.dir === 'asc' ? '' : '') : ''}</th>\r\n                <th style={{ width: '120px' }}>Category</th>\r\n                <th style={{ width: '100px', cursor: 'pointer' }} onClick={() => toggleSort('year')}>Year {sort.col === 'year' ? (sort.dir === 'asc' ? '' : '') : ''}</th>\r\n                <th style={{ width: '100px' }}>Pages</th>\r\n                <th style={{ width: '180px' }}>Publisher</th>\r\n                <th style={{ width: '100px', cursor: 'pointer' }} onClick={() => toggleSort('downloads')}>Downloads {sort.col === 'downloads' ? (sort.dir === 'asc' ? '' : '') : ''}</th>\r\n                <th style={{ width: '80px', cursor: 'pointer', background: 'rgba(52, 183, 241, 0.1)', borderBottom: '2px solid #34B7F1' }} onClick={() => toggleSort('views')}>Views {sort.col === 'views' ? (sort.dir === 'asc' ? '' : '') : ''}</th>\r\n                <th style={{ width: '80px', cursor: 'pointer', background: 'rgba(255, 107, 157, 0.1)', borderBottom: '2px solid #FF6B9D' }} onClick={() => toggleSort('comments_count')}>Comments {sort.col === 'comments_count' ? (sort.dir === 'asc' ? '' : '') : ''}</th>\r\n                <th style={{ width: '80px', cursor: 'pointer', background: 'rgba(244, 67, 54, 0.1)', borderBottom: '2px solid #F44336' }} onClick={() => toggleSort('likes_count')}>Likes {sort.col === 'likes_count' ? (sort.dir === 'asc' ? '' : '') : ''}</th>\r\n                <th style={{ width: '100px' }}>Date Added</th>\r\n                <th style={{ width: '200px' }}>Actions</th>\r\n              </tr>\r\n            </thead>\r\n            <tbody>\r\n              {loading ? (\r\n                <tr><td colSpan={13} style={{ color: '#8696a0', textAlign: 'center' }}>Loading...</td></tr>\r\n              ) : rows.length === 0 ? (\r\n                <tr><td colSpan={13} style={{ color: '#8696a0', textAlign: 'center' }}>No data</td></tr>\r\n              ) : rows.map(row => (\r\n                <tr key={row.id}>\r\n                  <td>{row.cover_url ? <img src={row.cover_url} alt=\"cover\" style={{ width: 36, height: 48, objectFit: 'cover', borderRadius: 4 }} /> : <span className=\"badge\">No cover</span>}</td>\r\n                  <td>\r\n                    {editingId === row.id ? (\r\n                      <input className=\"input\" value={editDraft.title} onChange={(e) => setEditDraft({ ...editDraft, title: e.target.value })} />\r\n                    ) : row.title}\r\n                  </td>\r\n                  <td>\r\n                    {editingId === row.id ? (\r\n                      <input className=\"input\" value={editDraft.author} onChange={(e) => setEditDraft({ ...editDraft, author: e.target.value })} />\r\n                    ) : row.author}\r\n                  </td>\r\n                  <td>\r\n                    {editingId === row.id ? (\r\n                      <select className=\"select\" value={editDraft.category_id || ''} onChange={(e) => setEditDraft({ ...editDraft, category_id: e.target.value || null })}>\r\n                        <option value=\"\">Uncategorized</option>\r\n                        {categories.map(c => <option key={c.id} value={c.id}>{c.name}</option>)}\r\n                      </select>\r\n                    ) : (categories.find(c => c.id === row.category_id)?.name || '')}\r\n                  </td>\r\n                  <td>\r\n                    {editingId === row.id ? (\r\n                      <input className=\"input\" value={editDraft.year} onChange={(e) => setEditDraft({ ...editDraft, year: e.target.value })} />\r\n                    ) : (row.year || '')}\r\n                  </td>\r\n                  <td>\r\n                    {editingId === row.id ? (\r\n                      <input className=\"input\" type=\"number\" placeholder=\"Pages\" value={editDraft.pages} onChange={(e) => setEditDraft({ ...editDraft, pages: e.target.value })} />\r\n                    ) : (row.pages || '')}\r\n                  </td>\r\n                  <td>\r\n                    {editingId === row.id ? (\r\n                      <input className=\"input\" placeholder=\"Publisher\" value={editDraft.publisher} onChange={(e) => setEditDraft({ ...editDraft, publisher: e.target.value })} />\r\n                    ) : (row.publisher || '')}\r\n                  </td>\r\n                  <td>{row.downloads || 0}</td>\r\n                  <td style={{ fontWeight: '500', color: '#00a884' }}>{row.views || 0}</td>\r\n                  <td style={{ fontWeight: '500', color: '#FF6B9D' }}>{row.comments_count || 0}</td>\r\n                  <td style={{ fontWeight: '500', color: '#F44336' }}>{row.likes_count || 0}</td>\r\n                  <td>{new Date(row.created_at).toLocaleDateString()}</td>\r\n                  <td>\r\n                    {editingId === row.id ? (\r\n                      <div style={{ display: 'flex', flexDirection: 'column', gap: '10px', minWidth: '180px' }}>\r\n                        <div>\r\n                          <label className=\"label\">Replace PDF</label>\r\n                          <div\r\n                            className=\"file-upload-btn\"\r\n                            onClick={() => document.getElementById(`pdf-input-${row.id}`).click()}\r\n                            style={{\r\n                              border: '1px solid #374151',\r\n                              borderRadius: '6px',\r\n                              padding: '6px 12px',\r\n                              cursor: 'pointer',\r\n                              display: 'flex',\r\n                              alignItems: 'center',\r\n                              gap: '8px',\r\n                              background: newPdf ? 'rgba(0, 168, 132, 0.1)' : 'transparent',\r\n                              color: newPdf ? '#00a884' : '#e9edef',\r\n                              transition: 'all 0.2s'\r\n                            }}\r\n                          >\r\n                            <input\r\n                              id={`pdf-input-${row.id}`}\r\n                              type=\"file\"\r\n                              accept=\"application/pdf\"\r\n                              onChange={(e) => setNewPdf(e.target.files?.[0] || null)}\r\n                              style={{ display: 'none' }}\r\n                            />\r\n                            {newPdf ? (\r\n                              <> {newPdf.name.slice(0, 20)}{newPdf.name.length > 20 ? '...' : ''}</>\r\n                            ) : (\r\n                              <> Choose PDF</>\r\n                            )}\r\n                          </div>\r\n                        </div>\r\n                        <div>\r\n                          <label className=\"label\">Replace Cover</label>\r\n                          <div\r\n                            className=\"file-upload-btn\"\r\n                            onClick={() => document.getElementById(`cover-input-${row.id}`).click()}\r\n                            style={{\r\n                              border: '1px solid #374151',\r\n                              borderRadius: '6px',\r\n                              padding: '6px 12px',\r\n                              cursor: 'pointer',\r\n                              display: 'flex',\r\n                              alignItems: 'center',\r\n                              gap: '8px',\r\n                              background: newCover ? 'rgba(0, 168, 132, 0.1)' : 'transparent',\r\n                              color: newCover ? '#00a884' : '#e9edef',\r\n                              transition: 'all 0.2s'\r\n                            }}\r\n                          >\r\n                            <input\r\n                              id={`cover-input-${row.id}`}\r\n                              type=\"file\"\r\n                              accept=\"image/*\"\r\n                              onChange={(e) => setNewCover(e.target.files?.[0] || null)}\r\n                              style={{ display: 'none' }}\r\n                            />\r\n                            {newCover ? (\r\n                              <> {newCover.name.slice(0, 20)}{newCover.name.length > 20 ? '...' : ''}</>\r\n                            ) : (\r\n                              <> Choose Image</>\r\n                            )}\r\n                          </div>\r\n                        </div>\r\n                        <div style={{ display: 'flex', gap: '8px', marginTop: '4px' }}>\r\n                          <button className=\"btn primary\" onClick={() => saveEdit(row)}>Save</button>\r\n                          <button className=\"btn\" onClick={cancelEdit}>Cancel</button>\r\n                        </div>\r\n                      </div>\r\n                    ) : (\r\n                      <div className=\"actions\">\r\n                        <button \r\n                          className=\"btn\" \r\n                          onClick={() => startEdit(row)}\r\n                          disabled={!canEdit(row)}\r\n                        >\r\n                          Edit\r\n                        </button>\r\n                        <button \r\n                          className=\"btn\" \r\n                          onClick={() => handleDelete(row)}\r\n                          disabled={!canEdit(row)}\r\n                        >\r\n                          Delete\r\n                        </button>\r\n                      </div>\r\n                    )}\r\n                  </td>\r\n                </tr>\r\n              ))}\r\n            </tbody>\r\n          </table>\r\n        </div>\r\n\r\n        <div style={{\r\n          display: 'flex',\r\n          justifyContent: 'center',\r\n          alignItems: 'center',\r\n          gap: '12px',\r\n          marginTop: '24px',\r\n          marginBottom: '20px'\r\n        }}>\r\n          <button\r\n            onClick={() => setPage(p => Math.max(1, p - 1))}\r\n            disabled={page <= 1}\r\n            style={{\r\n              padding: '8px 16px',\r\n              background: page <= 1 ? '#e0e0e0' : 'linear-gradient(135deg, #00a884 0%, #008060 100%)',\r\n              color: page <= 1 ? '#999' : '#fff',\r\n              border: 'none',\r\n              borderRadius: '6px',\r\n              cursor: page <= 1 ? 'not-allowed' : 'pointer',\r\n              fontSize: '14px',\r\n              fontWeight: '600',\r\n              transition: 'all 0.2s',\r\n              opacity: page <= 1 ? 0.6 : 1\r\n            }}\r\n          >\r\n             Prev\r\n          </button>\r\n          <span style={{ color: '#cfd8dc', fontSize: '14px', fontWeight: '500', minWidth: '120px', textAlign: 'center' }}>\r\n            Page {page} of {totalPages}\r\n          </span>\r\n          <button\r\n            onClick={() => setPage(p => Math.min(totalPages, p + 1))}\r\n            disabled={page >= totalPages}\r\n            style={{\r\n              padding: '8px 16px',\r\n              background: page >= totalPages ? '#e0e0e0' : 'linear-gradient(135deg, #00a884 0%, #008060 100%)',\r\n              color: page >= totalPages ? '#999' : '#fff',\r\n              border: 'none',\r\n              borderRadius: '6px',\r\n              cursor: page >= totalPages ? 'not-allowed' : 'pointer',\r\n              fontSize: '14px',\r\n              fontWeight: '600',\r\n              transition: 'all 0.2s',\r\n              opacity: page >= totalPages ? 0.6 : 1\r\n            }}\r\n          >\r\n            Next \r\n          </button>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Books;\r\n","import React, { useEffect, useMemo, useState } from 'react';\nimport { fetchUniversities, deleteUniversity, updateUniversity } from '../campusApi';\nimport { getUniversityImages, deleteUniversityImage } from '../universityPrefillApi';\nimport { getPastPaperCountByUniversity } from '../pastPapersApi';\nimport { useAdminUI } from '../AdminUIContext';\n\nconst UniversitiesManagement = ({ userProfile }) => {\n  const [loading, setLoading] = useState(true);\n  const [rows, setRows] = useState([]);\n  const [count, setCount] = useState(0);\n  const [page, setPage] = useState(1);\n  const [pageSize] = useState(10);\n  const [search, setSearch] = useState('');\n  const [sort, setSort] = useState({ col: 'created_at', dir: 'desc' });\n  const [editingId, setEditingId] = useState(null);\n  const [editDraft, setEditDraft] = useState({});\n  const [newCover, setNewCover] = useState(null);\n  const [paperCounts, setPaperCounts] = useState({});\n\n  const { confirm, showToast } = useAdminUI();\n\n  const ADMIN_EMAILS = ['campuslives254@gmail.com', 'paltechsomalux@gmail.com'];\n  const isAdmin = userProfile?.role === 'admin' || ADMIN_EMAILS.includes(userProfile?.email);\n  const isEditor = userProfile?.role === 'editor' || ADMIN_EMAILS.includes(userProfile?.email);\n\n  const totalPages = useMemo(() => Math.max(1, Math.ceil(count / pageSize)), [count, pageSize]);\n\n  const load = async () => {\n    setLoading(true);\n    try {\n      const { data, count: total } = await fetchUniversities({ page, pageSize, search, sort });\n      setRows(data);\n      setCount(total);\n      \n      // Fetch paper counts for each university\n      const counts = {};\n      for (const uni of data) {\n        counts[uni.id] = await getPastPaperCountByUniversity(uni.id);\n      }\n      setPaperCounts(counts);\n    } finally { setLoading(false); }\n  };\n\n  useEffect(() => {\n    if (userProfile) load();\n  }, [page, search, sort.col, sort.dir, userProfile]);\n\n  const canEdit = (row) => {\n    if (isAdmin) return true;\n    if (isEditor) return true;\n    return false;\n  };\n\n  const startEdit = (row) => {\n    if (!canEdit(row)) {\n      showToast({ type: 'error', message: 'You do not have permission to edit this university.' });\n      return;\n    }\n    setEditingId(row.id);\n    setEditDraft({\n      name: row.name || '',\n      description: row.description || '',\n      website_url: row.website_url || '',\n      location: row.location || '',\n      established: row.established || '',\n      student_count: row.student_count || ''\n    });\n    setNewCover(null);\n  };\n\n  const cancelEdit = () => {\n    setEditingId(null);\n    setEditDraft({});\n    setNewCover(null);\n  };\n\n  const saveEdit = async (row) => {\n    if (!canEdit(row)) {\n      showToast({ type: 'error', message: 'You do not have permission to edit this university.' });\n      return;\n    }\n    const updates = { ...editDraft };\n\n    // Normalize numeric fields so we don't send \"\" to integer columns\n    if (updates.established === '' || updates.established === undefined) {\n      updates.established = null;\n    } else {\n      updates.established = Number(updates.established);\n    }\n\n    if (updates.student_count === '' || updates.student_count === undefined) {\n      updates.student_count = null;\n    } else {\n      updates.student_count = Number(updates.student_count);\n    }\n\n    try {\n      await updateUniversity(row.id, { updates, newCoverFile: newCover });\n      cancelEdit();\n      await load();\n      showToast({ type: 'success', message: 'University updated successfully.' });\n    } catch (e) {\n      console.error('Failed to update university:', e);\n      showToast({ type: 'error', message: e?.message || 'Failed to update university.' });\n    }\n  };\n\n  const handleDelete = async (row) => {\n    if (!canEdit(row)) {\n      showToast({ type: 'error', message: 'You can only delete universities you uploaded.' });\n      return;\n    }\n\n    const ok = await confirm({\n      title: 'Delete university?',\n      message: `Delete \"${row.name}\" and its related data? This action cannot be undone.`,\n      confirmLabel: 'Delete',\n      cancelLabel: 'Cancel',\n      variant: 'danger',\n    });\n    if (!ok) return;\n\n    try {\n      await deleteUniversity({ id: row.id, cover_image_url: row.cover_image_url });\n      await load();\n      showToast({ type: 'success', message: 'University deleted.' });\n    } catch (err) {\n      console.error('Failed to delete university:', err);\n      showToast({ type: 'error', message: err?.message || 'Failed to delete university.' });\n    }\n  };\n\n  const toggleSort = (col) => {\n    setSort((s) => (s.col === col ? { col, dir: s.dir === 'asc' ? 'desc' : 'asc' } : { col, dir: 'asc' }));\n  };\n\n  return (\n    <div>\n      <div className=\"panel\">\n        <div className=\"panel-title\">Universities Management</div>\n\n        {/* Stats Summary */}\n        {!loading && rows.length > 0 && (\n          <div style={{ display: 'grid', gridTemplateColumns: 'repeat(auto-fit, minmax(150px, 1fr))', gap: '8px', marginBottom: '12px' }}>\n            <div style={{ background: '#1a2332', border: '1px solid #2a3f56', borderRadius: '6px', padding: '8px 12px', color: '#8696a0', fontSize: '0.85rem' }}>\n              <div style={{ color: '#34B7F1', fontSize: '1.2rem', fontWeight: '600' }}>{rows.reduce((sum, r) => sum + (r.views || 0), 0)}</div>\n              <div>Total Views</div>\n            </div>\n            <div style={{ background: '#1a2332', border: '1px solid #2a3f56', borderRadius: '6px', padding: '8px 12px', color: '#8696a0', fontSize: '0.85rem' }}>\n              <div style={{ color: '#E74C3C', fontSize: '1.2rem', fontWeight: '600' }}>{rows.reduce((sum, r) => sum + (r.likes_count || 0), 0)}</div>\n              <div>Total Likes</div>\n            </div>\n            <div style={{ background: '#1a2332', border: '1px solid #2a3f56', borderRadius: '6px', padding: '8px 12px', color: '#8696a0', fontSize: '0.85rem' }}>\n              <div style={{ color: '#FFCC00', fontSize: '1.2rem', fontWeight: '600' }}>{rows.length}/{count}</div>\n              <div>Page Universities</div>\n            </div>\n          </div>\n        )}\n\n        <div className=\"panel\" style={{ marginBottom: 6 }}>\n          <label className=\"label\">Search</label>\n          <input className=\"input\" value={search} onChange={(e) => { setPage(1); setSearch(e.target.value); }} placeholder=\"Search by name or location...\" />\n        </div>\n\n        <div className=\"actions\" style={{ marginBottom: 6 }}>\n          <button className=\"btn primary\" onClick={() => (window.location.href = '/books/admin/upload')}>Add New University</button>\n        </div>\n\n        <div className=\"panel\" style={{ padding: 0, overflowX: 'auto' }}>\n          <table className=\"table\" style={{ minWidth: '1200px' }}>\n            <thead>\n              <tr>\n                <th style={{ width: '60px' }}>Cover</th>\n                <th style={{ width: '250px', cursor: 'pointer' }} onClick={() => toggleSort('name')}>Name {sort.col === 'name' ? (sort.dir === 'asc' ? '' : '') : ''}</th>\n                <th style={{ width: '300px' }}>Description</th>\n                <th style={{ width: '150px' }}>Location</th>\n                <th style={{ width: '100px', cursor: 'pointer' }} onClick={() => toggleSort('established')}>Est. {sort.col === 'established' ? (sort.dir === 'asc' ? '' : '') : ''}</th>\n                <th style={{ width: '100px' }}>Students</th>\n                <th style={{ width: '80px', cursor: 'pointer', background: 'rgba(52, 183, 241, 0.1)', borderBottom: '2px solid #34B7F1' }} onClick={() => toggleSort('views_count')}>Views {sort.col === 'views_count' ? (sort.dir === 'asc' ? '' : '') : ''}</th>\n                <th style={{ width: '80px', cursor: 'pointer', background: 'rgba(231, 76, 60, 0.1)', borderBottom: '2px solid #E74C3C' }} onClick={() => toggleSort('likes_count')}>Likes {sort.col === 'likes_count' ? (sort.dir === 'asc' ? '' : '') : ''}</th>\n                <th style={{ width: '80px', background: 'rgba(102, 187, 106, 0.1)', borderBottom: '2px solid #66BB6A' }}>Papers</th>\n                <th style={{ width: '180px' }}>Actions</th>\n              </tr>\n            </thead>\n            <tbody>\n              {loading ? (\n                <tr><td colSpan={10} style={{ textAlign: 'center', color: '#8696a0' }}>Loading...</td></tr>\n              ) : rows.length === 0 ? (\n                <tr><td colSpan={10} style={{ textAlign: 'center', color: '#8696a0' }}>No data</td></tr>\n              ) : rows.map(row => (\n                <tr key={row.id}>\n                  <td>{row.cover_image_url ? <img src={row.cover_image_url} alt=\"cover\" style={{ width: 36, height: 36, objectFit: 'cover', borderRadius: 4 }} /> : <span className=\"badge\">No cover</span>}</td>\n                  <td>\n                    {editingId === row.id ? (\n                      <input className=\"input\" value={editDraft.name} onChange={(e) => setEditDraft({ ...editDraft, name: e.target.value })} />\n                    ) : row.name}\n                  </td>\n                  <td>\n                    {editingId === row.id ? (\n                      <textarea className=\"input\" rows={2} value={editDraft.description} onChange={(e) => setEditDraft({ ...editDraft, description: e.target.value })} />\n                    ) : (row.description?.slice(0, 100) || '')}\n                  </td>\n                  <td>\n                    {editingId === row.id ? (\n                      <input className=\"input\" value={editDraft.location} onChange={(e) => setEditDraft({ ...editDraft, location: e.target.value })} />\n                    ) : (row.location || '')}\n                  </td>\n                  <td>\n                    {editingId === row.id ? (\n                      <input className=\"input\" type=\"number\" value={editDraft.established} onChange={(e) => setEditDraft({ ...editDraft, established: e.target.value })} />\n                    ) : (row.established || '')}\n                  </td>\n                  <td>{row.student_count?.toLocaleString() || ''}</td>\n                  <td style={{ fontWeight: '500', color: '#00a884' }}>{row.views || 0}</td>\n                  <td style={{ fontWeight: '500', color: '#E74C3C' }}>{row.likes_count || 0}</td>\n                  <td style={{ fontWeight: '500', color: '#66BB6A' }}>{paperCounts[row.id] || 0}</td>\n                  <td>\n                    {editingId === row.id ? (\n                      <div style={{ display: 'flex', gap: '4px', flexDirection: 'column' }}>\n                        <button className=\"btn primary\" onClick={() => saveEdit(row)}>Save</button>\n                        <button className=\"btn\" onClick={cancelEdit}>Cancel</button>\n                      </div>\n                    ) : (\n                      <div className=\"actions\">\n                        <button className=\"btn\" onClick={() => startEdit(row)} disabled={!canEdit(row)}>Edit</button>\n                        <button className=\"btn\" onClick={() => handleDelete(row)} disabled={!canEdit(row)}>Delete</button>\n                      </div>\n                    )}\n                  </td>\n                </tr>\n              ))}\n            </tbody>\n          </table>\n        </div>\n\n        <div className=\"actions\" style={{ marginTop: 6 }}>\n          <button className=\"btn\" disabled={page <= 1} onClick={() => setPage(p => Math.max(1, p - 1))}>Prev</button>\n          <span style={{ color: '#cfd8dc' }}>Page {page} of {totalPages}</span>\n          <button className=\"btn\" disabled={page >= totalPages} onClick={() => setPage(p => Math.min(totalPages, p + 1))}>Next</button>\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default UniversitiesManagement;\n","import React, { useEffect, useMemo, useState } from 'react';\r\nimport { fetchPastPapers, deletePastPaper, updatePastPaper, getFaculties } from '../pastPapersApi';\r\nimport { useAdminUI } from '../AdminUIContext';\r\n\r\n// Format timestamp to local time with timezone handling\r\nconst formatTimestamp = (isoString) => {\r\n  if (!isoString) return '';\r\n  try {\r\n    const date = new Date(isoString);\r\n    return date.toLocaleString('en-US', { \r\n      year: 'numeric', \r\n      month: 'short', \r\n      day: 'numeric', \r\n      hour: '2-digit', \r\n      minute: '2-digit', \r\n      second: '2-digit',\r\n      hour12: true,\r\n      timeZoneName: 'short'\r\n    });\r\n  } catch (e) {\r\n    return isoString;\r\n  }\r\n};\r\n\r\nconst PastPapersManagement = ({ userProfile }) => {\r\n  const [loading, setLoading] = useState(true);\r\n  const [rows, setRows] = useState([]);\r\n  const [count, setCount] = useState(0);\r\n  const [page, setPage] = useState(1);\r\n  const [pageSize] = useState(10);\r\n  const [search, setSearch] = useState('');\r\n  const [faculties, setFaculties] = useState([]);\r\n  const [facultyFilter, setFacultyFilter] = useState(null);\r\n  const [sort, setSort] = useState({ col: 'created_at', dir: 'desc' });\r\n  const [editingId, setEditingId] = useState(null);\r\n  const [selectedIds, setSelectedIds] = useState(new Set());\r\n  const [allPaperIds, setAllPaperIds] = useState(new Set()); // Track ALL papers across all pages\r\n  const [editDraft, setEditDraft] = useState({});\r\n  const [newPdf, setNewPdf] = useState(null);\r\n  const [useCustomFaculty, setUseCustomFaculty] = useState(false);\r\n  const [customFaculty, setCustomFaculty] = useState('');\r\n  const [isMultiEditMode, setIsMultiEditMode] = useState(false);\r\n  const [showCheckboxes, setShowCheckboxes] = useState(false);\r\n\r\n  const { confirm, showToast } = useAdminUI();\r\n\r\n  const isAdmin = userProfile?.role === 'admin';\r\n  const isEditor = userProfile?.role === 'editor';\r\n  const totalPages = useMemo(() => Math.max(1, Math.ceil(count / pageSize)), [count, pageSize]);\r\n\r\n  const load = async () => {\r\n    setLoading(true);\r\n    try {\r\n      const { data, count: total } = await fetchPastPapers({ page, pageSize, search, faculty: facultyFilter, sort });\r\n      setRows(data);\r\n      setCount(total);\r\n    } finally { setLoading(false); }\r\n  };\r\n\r\n  // Fetch all paper IDs matching current filters (no pagination)\r\n  const fetchAllMatchingIds = async () => {\r\n    try {\r\n      const { data } = await fetchPastPapers({ page: 1, pageSize: 10000, search, faculty: facultyFilter, sort });\r\n      return new Set(data.map(item => item.id));\r\n    } catch (error) {\r\n      console.error('Failed to fetch all matching papers:', error);\r\n      return new Set();\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    (async () => { try { setFaculties(await getFaculties()); } catch {} })();\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    if (userProfile) load();\r\n  }, [page, search, facultyFilter, sort.col, sort.dir, userProfile]);\r\n\r\n  const canEdit = (row) => {\r\n    if (isAdmin) return true;\r\n    if (isEditor) return true;\r\n    return false;\r\n  };\r\n\r\n  const startEdit = (row) => {\r\n    if (!canEdit(row)) {\r\n      showToast({ type: 'error', message: 'You do not have permission to edit this past paper.' });\r\n      return;\r\n    }\r\n    setEditingId(row.id);\r\n    setEditDraft({\r\n      faculty: row.faculty || '', unit_code: row.unit_code || '', unit_name: row.unit_name || '',\r\n      year: row.year || '', semester: row.semester || '', exam_type: row.exam_type || ''\r\n    });\r\n    setNewPdf(null);\r\n    setUseCustomFaculty(false);\r\n    setCustomFaculty('');\r\n  };\r\n\r\n  const cancelEdit = () => { \r\n    setEditingId(null); \r\n    setEditDraft({}); \r\n    setNewPdf(null); \r\n    setUseCustomFaculty(false);\r\n    setCustomFaculty('');\r\n  };\r\n\r\n  // Multi-select handlers\r\n  const toggleSelectRow = (id) => {\r\n    setSelectedIds(prev => {\r\n      const newSet = new Set(prev);\r\n      if (newSet.has(id)) {\r\n        newSet.delete(id);\r\n      } else {\r\n        newSet.add(id);\r\n      }\r\n      return newSet;\r\n    });\r\n  };\r\n\r\n  const toggleSelectAll = () => {\r\n    if (selectedIds.size === count && count > 0) {\r\n      // Unselect all\r\n      setSelectedIds(new Set());\r\n    } else {\r\n      // Select all matching papers across all pages\r\n      fetchAllMatchingIds().then(allIds => {\r\n        setSelectedIds(allIds);\r\n      });\r\n    }\r\n  };\r\n\r\n  const startMultiEdit = () => {\r\n    if (selectedIds.size === 0) {\r\n      showToast({ type: 'error', message: 'Please select at least one past paper to edit.' });\r\n      return;\r\n    }\r\n    \r\n    // For permission check, only validate papers we can see on current page\r\n    // Users can proceed with multi-edit if they have permission on at least the current visible selections\r\n    // Full permission check will happen in saveMultiEdit\r\n    const visibleSelectedIds = Array.from(selectedIds).filter(id => rows.some(r => r.id === id));\r\n    if (visibleSelectedIds.length > 0) {\r\n      const canEditVisible = visibleSelectedIds.every(id => {\r\n        const row = rows.find(r => r.id === id);\r\n        return canEdit(row);\r\n      });\r\n\r\n      if (!canEditVisible) {\r\n        showToast({ type: 'error', message: 'You do not have permission to edit some of the selected past papers.' });\r\n        return;\r\n      }\r\n    }\r\n\r\n    setIsMultiEditMode(true);\r\n    setEditDraft({\r\n      faculty: '', unit_code: '', unit_name: '', year: '', semester: '', exam_type: ''\r\n    });\r\n    setUseCustomFaculty(false);\r\n    setCustomFaculty('');\r\n  };\r\n\r\n  const cancelMultiEdit = () => {\r\n    setIsMultiEditMode(false);\r\n    setEditDraft({});\r\n    setUseCustomFaculty(false);\r\n    setCustomFaculty('');\r\n    setSelectedIds(new Set());\r\n    setShowCheckboxes(false);\r\n  };\r\n\r\n  const saveMultiEdit = async () => {\r\n    if (selectedIds.size === 0) {\r\n      showToast({ type: 'error', message: 'No past papers selected.' });\r\n      return;\r\n    }\r\n\r\n    // Get the values that were actually changed\r\n    const updates = {};\r\n    if (editDraft.faculty) updates.faculty = editDraft.faculty || (useCustomFaculty ? customFaculty : editDraft.faculty);\r\n    if (editDraft.unit_code) updates.unit_code = editDraft.unit_code;\r\n    if (editDraft.unit_name) updates.unit_name = editDraft.unit_name;\r\n    if (editDraft.year) updates.year = editDraft.year;\r\n    if (editDraft.semester) updates.semester = editDraft.semester;\r\n    if (editDraft.exam_type) updates.exam_type = editDraft.exam_type;\r\n\r\n    if (Object.keys(updates).length === 0) {\r\n      showToast({ type: 'error', message: 'Please enter at least one field to update.' });\r\n      return;\r\n    }\r\n\r\n    try {\r\n      const faculty = useCustomFaculty ? customFaculty : editDraft.faculty;\r\n      if (updates.faculty && !faculty) {\r\n        showToast({ type: 'error', message: 'Please select or enter a faculty.' });\r\n        return;\r\n      }\r\n\r\n      // Fetch all selected papers in parallel with current page (use cached data from current page if available)\r\n      const papersToUpdate = Array.from(selectedIds).map(id => {\r\n        const cachedRow = rows.find(r => r.id === id);\r\n        return { id, cached: cachedRow };\r\n      });\r\n\r\n      // Only fetch papers not in current view\r\n      const missingIds = papersToUpdate.filter(p => !p.cached).map(p => p.id);\r\n      let missingPapersMap = new Map();\r\n      \r\n      if (missingIds.length > 0) {\r\n        const { data: allSelectedPapers } = await fetchPastPapers({ \r\n          page: 1, \r\n          pageSize: 10000, \r\n          search, \r\n          faculty: facultyFilter, \r\n          sort \r\n        });\r\n        missingPapersMap = new Map(allSelectedPapers.map(p => [p.id, p]));\r\n      }\r\n\r\n      // Update all in parallel (up to 5 concurrent requests)\r\n      const updatePromises = [];\r\n      const batchSize = 5;\r\n      \r\n      for (const { id, cached } of papersToUpdate) {\r\n        const row = cached || missingPapersMap.get(id);\r\n        if (!row) {\r\n          console.warn(`Paper with ID ${id} not found`);\r\n          continue;\r\n        }\r\n        \r\n        updatePromises.push(\r\n          updatePastPaper(id, { \r\n            updates: { ...updates, faculty: updates.faculty || faculty }, \r\n            newPdfFile: null, \r\n            oldFilePath: row.file_path \r\n          })\r\n        );\r\n\r\n        // Batch requests to avoid overwhelming the server\r\n        if (updatePromises.length >= batchSize) {\r\n          await Promise.all(updatePromises);\r\n          updatePromises.length = 0;\r\n        }\r\n      }\r\n\r\n      // Complete remaining requests\r\n      if (updatePromises.length > 0) {\r\n        await Promise.all(updatePromises);\r\n      }\r\n\r\n      cancelMultiEdit();\r\n      // Reload only current page data instead of all\r\n      setLoading(true);\r\n      const { data, count: total } = await fetchPastPapers({ page, pageSize, search, faculty: facultyFilter, sort });\r\n      setRows(data);\r\n      setCount(total);\r\n      setLoading(false);\r\n      \r\n      showToast({ type: 'success', message: `${selectedIds.size} past paper(s) updated successfully.` });\r\n    } catch (e) {\r\n      console.error('Failed to update past papers:', e?.message || e);\r\n      showToast({ type: 'error', message: e?.message || 'Failed to update past papers.' });\r\n    }\r\n  };\r\n\r\n  const saveEdit = async (row) => {\r\n    if (!canEdit(row)) {\r\n      showToast({ type: 'error', message: 'You do not have permission to edit this past paper.' });\r\n      return;\r\n    }\r\n    \r\n    // Use custom faculty if selected, otherwise use the one from edit draft\r\n    const faculty = useCustomFaculty ? customFaculty : editDraft.faculty;\r\n    if (!faculty) {\r\n      showToast({ type: 'error', message: 'Please select or enter a faculty.' });\r\n      return;\r\n    }\r\n    \r\n    const updates = { ...editDraft, faculty };\r\n\r\n    try {\r\n      await updatePastPaper(row.id, { updates, newPdfFile: newPdf, oldFilePath: row.file_path });\r\n      cancelEdit();\r\n      await load();\r\n      showToast({ type: 'success', message: 'Past paper updated.' });\r\n    } catch (e) {\r\n      console.error('Failed to update past paper:', e?.message || e);\r\n      showToast({ type: 'error', message: e?.message || 'Failed to update past paper.' });\r\n    }\r\n  };\r\n\r\n  const handleDelete = async (row) => {\r\n    if (!canEdit(row)) {\r\n      showToast({ type: 'error', message: 'You can only delete past papers you uploaded.' });\r\n      return;\r\n    }\r\n\r\n    const ok = await confirm({\r\n      title: 'Delete past paper?',\r\n      message: `Delete \"${row.unit_code} - ${row.unit_name}\"? This action cannot be undone.`,\r\n      confirmLabel: 'Delete',\r\n      cancelLabel: 'Cancel',\r\n      variant: 'danger',\r\n    });\r\n    if (!ok) return;\r\n\r\n    try {\r\n      await deletePastPaper({ id: row.id, file_path: row.file_path });\r\n      await load();\r\n      showToast({ type: 'success', message: 'Past paper deleted.' });\r\n    } catch (e) {\r\n      console.error('Failed to delete past paper:', e);\r\n      showToast({ type: 'error', message: e?.message || 'Failed to delete past paper.' });\r\n    }\r\n  };\r\n\r\n  const toggleSort = (col) => setSort((s) => (s.col === col ? { col, dir: s.dir === 'asc' ? 'desc' : 'asc' } : { col, dir: 'asc' }));\r\n\r\n  return (\r\n    <div>\r\n      <div className=\"panel\">\r\n        <div className=\"panel-title\">Past Papers Management</div>\r\n\r\n        {/* Stats Summary */}\r\n        {!loading && rows.length > 0 && (\r\n          <div style={{ display: 'grid', gridTemplateColumns: 'repeat(auto-fit, minmax(150px, 1fr))', gap: '8px', marginBottom: '12px' }}>\r\n            <div style={{ background: '#1a2332', border: '1px solid #2a3f56', borderRadius: '6px', padding: '8px 12px', color: '#8696a0', fontSize: '0.85rem' }}>\r\n              <div style={{ color: '#00a884', fontSize: '1.2rem', fontWeight: '600' }}>{rows.reduce((sum, r) => sum + (r.downloads_count || 0), 0)}</div>\r\n              <div>Total Downloads</div>\r\n            </div>\r\n            <div style={{ background: '#1a2332', border: '1px solid #2a3f56', borderRadius: '6px', padding: '8px 12px', color: '#8696a0', fontSize: '0.85rem' }}>\r\n              <div style={{ color: '#34B7F1', fontSize: '1.2rem', fontWeight: '600' }}>{rows.reduce((sum, r) => sum + (r.views_count || 0), 0)}</div>\r\n              <div>Total Views</div>\r\n            </div>\r\n            <div style={{ background: '#1a2332', border: '1px solid #2a3f56', borderRadius: '6px', padding: '8px 12px', color: '#8696a0', fontSize: '0.85rem' }}>\r\n              <div style={{ color: '#FFCC00', fontSize: '1.2rem', fontWeight: '600' }}>{rows.length}/{count}</div>\r\n              <div>Page Papers</div>\r\n            </div>\r\n          </div>\r\n        )}\r\n\r\n        <div className=\"grid-2\" style={{ marginBottom: 6 }}>\r\n          <div className=\"panel\">\r\n            <label className=\"label\">Search</label>\r\n            <input className=\"input\" value={search} onChange={(e) => { setPage(1); setSearch(e.target.value.trim()); }} placeholder=\"e.g., MENT 130 or Introduction to...\" />\r\n          </div>\r\n          <div className=\"panel\">\r\n            <label className=\"label\">Faculty</label>\r\n            <select className=\"select\" value={facultyFilter || ''} onChange={(e) => { setPage(1); setFacultyFilter(e.target.value || null); }}>\r\n              <option value=\"\">All Faculties</option>\r\n              <option value=\"Unknown\">Unknown</option>\r\n              {faculties.map(f => <option key={f} value={f}>{f}</option>)}\r\n            </select>\r\n          </div>\r\n        </div>\r\n        <div className=\"actions\" style={{ marginBottom: 6 }}>\r\n          <button className=\"btn primary\" onClick={() => (window.location.href = '/books/admin/upload')}>Add New Past Paper</button>\r\n          {!showCheckboxes && (\r\n            <button \r\n              className=\"btn\" \r\n              onClick={() => setShowCheckboxes(true)}\r\n              style={{ background: '#00a884', color: '#e9edef' }}\r\n            >\r\n               Bulk Edit\r\n            </button>\r\n          )}\r\n          {showCheckboxes && !isMultiEditMode && (\r\n            <button \r\n              className=\"btn\" \r\n              onClick={() => {\r\n                setShowCheckboxes(false);\r\n                setSelectedIds(new Set());\r\n              }}\r\n              style={{ background: '#2a3f56', color: '#e9edef' }}\r\n            >\r\n               Cancel Selection\r\n            </button>\r\n          )}\r\n        </div>\r\n\r\n        {/* Multi-Edit Mode Toolbar */}\r\n        {isMultiEditMode && (\r\n          <div style={{ \r\n            background: '#1a2332', \r\n            border: '1px solid #2a3f56', \r\n            borderRadius: '6px', \r\n            padding: '12px',\r\n            marginBottom: '12px'\r\n          }}>\r\n            <div style={{ marginBottom: '12px', display: 'flex', justifyContent: 'space-between', alignItems: 'center' }}>\r\n              <h3 style={{ margin: 0, color: '#00a884' }}>\r\n                Edit {selectedIds.size} Past Paper{selectedIds.size !== 1 ? 's' : ''}\r\n              </h3>\r\n              <button \r\n                className=\"btn\" \r\n                onClick={cancelMultiEdit}\r\n                style={{ background: '#2a3f56', color: '#e9edef' }}\r\n              >\r\n                Cancel\r\n              </button>\r\n            </div>\r\n\r\n            <div className=\"grid-2\" style={{ gap: '12px', marginBottom: '12px' }}>\r\n              <div>\r\n                <label className=\"label\" style={{ fontSize: '13px' }}>Unit Name</label>\r\n                <input \r\n                  className=\"input\" \r\n                  placeholder=\"Leave blank to skip\" \r\n                  value={editDraft.unit_name || ''} \r\n                  onChange={(e) => setEditDraft({ ...editDraft, unit_name: e.target.value })} \r\n                />\r\n              </div>\r\n              <div>\r\n                <label className=\"label\" style={{ fontSize: '13px' }}>Unit Code</label>\r\n                <input \r\n                  className=\"input\" \r\n                  placeholder=\"Leave blank to skip\" \r\n                  value={editDraft.unit_code || ''} \r\n                  onChange={(e) => setEditDraft({ ...editDraft, unit_code: e.target.value })} \r\n                />\r\n              </div>\r\n              <div>\r\n                <label className=\"label\" style={{ fontSize: '13px' }}>Faculty</label>\r\n                {!useCustomFaculty ? (\r\n                  <select \r\n                    className=\"select\" \r\n                    value={editDraft.faculty || ''} \r\n                    onChange={(e) => setEditDraft({ ...editDraft, faculty: e.target.value })}\r\n                  >\r\n                    <option value=\"\">Leave blank to skip</option>\r\n                    {faculties && faculties.length > 0 ? faculties.map(f => <option key={f} value={f}>{f}</option>) : <option value=\"\">No faculties available</option>}\r\n                  </select>\r\n                ) : (\r\n                  <input \r\n                    className=\"input\" \r\n                    placeholder=\"e.g., Engineering\" \r\n                    value={customFaculty} \r\n                    onChange={(e) => setCustomFaculty(e.target.value)}\r\n                  />\r\n                )}\r\n                <div style={{ display: 'flex', alignItems: 'center', gap: '4px', marginTop: '4px', fontSize: '12px' }}>\r\n                  <input \r\n                    type=\"checkbox\" \r\n                    id=\"custom-faculty-multi\"\r\n                    checked={useCustomFaculty}\r\n                    onChange={(e) => {\r\n                      setUseCustomFaculty(e.target.checked);\r\n                      if (!e.target.checked) {\r\n                        setCustomFaculty('');\r\n                      }\r\n                    }}\r\n                    style={{ width: '14px', height: '14px', cursor: 'pointer' }}\r\n                  />\r\n                  <label htmlFor=\"custom-faculty-multi\" style={{ color: '#8696a0', cursor: 'pointer' }}>\r\n                    Add custom faculty\r\n                  </label>\r\n                </div>\r\n              </div>\r\n              <div>\r\n                <label className=\"label\" style={{ fontSize: '13px' }}>Year</label>\r\n                <input \r\n                  className=\"input\" \r\n                  type=\"number\" \r\n                  placeholder=\"Leave blank to skip\" \r\n                  value={editDraft.year || ''} \r\n                  onChange={(e) => setEditDraft({ ...editDraft, year: e.target.value })} \r\n                />\r\n              </div>\r\n              <div>\r\n                <label className=\"label\" style={{ fontSize: '13px' }}>Semester</label>\r\n                <select \r\n                  className=\"select\" \r\n                  value={editDraft.semester || ''} \r\n                  onChange={(e) => setEditDraft({ ...editDraft, semester: e.target.value })}\r\n                >\r\n                  <option value=\"\">Leave blank to skip</option>\r\n                  <option value=\"1\">1</option>\r\n                  <option value=\"2\">2</option>\r\n                  <option value=\"3\">3</option>\r\n                </select>\r\n              </div>\r\n              <div>\r\n                <label className=\"label\" style={{ fontSize: '13px' }}>Exam Type</label>\r\n                <select \r\n                  className=\"select\" \r\n                  value={editDraft.exam_type || ''} \r\n                  onChange={(e) => setEditDraft({ ...editDraft, exam_type: e.target.value })}\r\n                >\r\n                  <option value=\"\">Leave blank to skip</option>\r\n                  <option value=\"Main\">Main</option>\r\n                  <option value=\"Supplementary\">Supplementary</option>\r\n                  <option value=\"CAT\">CAT</option>\r\n                  <option value=\"Mock\">Mock</option>\r\n                </select>\r\n              </div>\r\n            </div>\r\n\r\n            <div style={{ display: 'flex', gap: '8px', justifyContent: 'flex-end' }}>\r\n              <button \r\n                className=\"btn primary\" \r\n                onClick={saveMultiEdit}\r\n                style={{ background: '#00a884' }}\r\n              >\r\n                Save Changes to All {selectedIds.size} Item{selectedIds.size !== 1 ? 's' : ''}\r\n              </button>\r\n              <button \r\n                className=\"btn\" \r\n                onClick={cancelMultiEdit}\r\n                style={{ background: '#2a3f56', color: '#e9edef' }}\r\n              >\r\n                Cancel\r\n              </button>\r\n            </div>\r\n          </div>\r\n        )}\r\n\r\n        {/* Selection Toolbar */}\r\n        {selectedIds.size > 0 && !isMultiEditMode && (\r\n          <div style={{ \r\n            background: '#1a2332', \r\n            border: '1px solid #2a3f56', \r\n            borderRadius: '6px', \r\n            padding: '12px',\r\n            marginBottom: '12px',\r\n            display: 'flex',\r\n            justifyContent: 'space-between',\r\n            alignItems: 'center'\r\n          }}>\r\n            <span style={{ color: '#8696a0' }}>\r\n              {selectedIds.size} item{selectedIds.size !== 1 ? 's' : ''} selected\r\n            </span>\r\n            <div style={{ display: 'flex', gap: '8px', justifyContent: 'flex-end' }}>\r\n              <button \r\n                className=\"btn primary\" \r\n                onClick={startMultiEdit}\r\n                style={{ background: '#00a884' }}\r\n              >\r\n                Edit Selected ({selectedIds.size})\r\n              </button>\r\n              <button \r\n                className=\"btn\" \r\n                onClick={() => setSelectedIds(new Set())}\r\n                style={{ background: '#2a3f56', color: '#e9edef' }}\r\n              >\r\n                Clear Selection\r\n              </button>\r\n            </div>\r\n          </div>\r\n        )}\r\n\r\n        <div className=\"panel\" style={{ padding: 0, overflowX: 'auto' }}>\r\n          <table className=\"table\" style={{ minWidth: '1200px' }}>\r\n            <thead>\r\n              <tr>\r\n                {showCheckboxes && (\r\n                  <th style={{ width: '40px' }}>\r\n                    <input\r\n                      type=\"checkbox\"\r\n                      checked={selectedIds.size === count && count > 0}\r\n                      onChange={toggleSelectAll}\r\n                      style={{ width: '16px', height: '16px', cursor: 'pointer' }}\r\n                      title={selectedIds.size === count && count > 0 ? 'Unselect all' : 'Select all across all pages'}\r\n                    />\r\n                  </th>\r\n                )}\r\n                <th style={{ width: '250px' }}>Unit Name</th>\r\n                <th style={{ width: '150px', cursor: 'pointer' }} onClick={() => toggleSort('unit_code')}>Unit Code {sort.col === 'unit_code' ? (sort.dir === 'asc' ? '' : '') : ''}</th>\r\n                <th style={{ width: '150px' }}>Faculty</th>\r\n                <th style={{ width: '100px', cursor: 'pointer' }} onClick={() => toggleSort('year')}>Year {sort.col === 'year' ? (sort.dir === 'asc' ? '' : '') : ''}</th>\r\n                <th style={{ width: '100px' }}>Semester</th>\r\n                <th style={{ width: '120px' }}>Exam Type</th>\r\n                <th style={{ width: '80px', cursor: 'pointer', background: 'rgba(0, 168, 132, 0.1)', borderBottom: '2px solid #00a884' }} onClick={() => toggleSort('views_count')}>Views {sort.col === 'views_count' ? (sort.dir === 'asc' ? '' : '') : ''}</th>\r\n                <th style={{ width: '100px', cursor: 'pointer' }} onClick={() => toggleSort('downloads_count')}>Downloads {sort.col === 'downloads_count' ? (sort.dir === 'asc' ? '' : '') : ''}</th>\r\n                <th style={{ width: '180px', cursor: 'pointer' }} onClick={() => toggleSort('created_at')}>Uploaded {sort.col === 'created_at' ? (sort.dir === 'asc' ? '' : '') : ''}</th>\r\n                <th style={{ width: '150px' }}>Uploaded By</th>\r\n                <th style={{ width: '200px' }}>Actions</th>\r\n              </tr>\r\n            </thead>\r\n            <tbody>\r\n              {loading ? (\r\n                <tr><td colSpan={showCheckboxes ? 13 : 12} style={{ textAlign: 'center', color: '#8696a0' }}>Loading...</td></tr>\r\n              ) : rows.length === 0 ? (\r\n                <tr><td colSpan={showCheckboxes ? 13 : 12} style={{ textAlign: 'center', color: '#8696a0' }}>No data</td></tr>\r\n              ) : rows.map(row => (\r\n                <tr key={row.id} style={{ background: selectedIds.has(row.id) ? 'rgba(0, 168, 132, 0.1)' : 'transparent' }}>\r\n                  {showCheckboxes && (\r\n                    <td style={{ textAlign: 'center' }}>\r\n                      <input\r\n                        type=\"checkbox\"\r\n                        checked={selectedIds.has(row.id)}\r\n                        onChange={() => toggleSelectRow(row.id)}\r\n                        disabled={isMultiEditMode}\r\n                        style={{ width: '16px', height: '16px', cursor: 'pointer' }}\r\n                      />\r\n                    </td>\r\n                  )}\r\n                  <td style={{ color: row.unit_name ? '#e9edef' : '#8696a0' }}>{editingId === row.id ? <input className=\"input\" value={editDraft.unit_name} onChange={(e) => setEditDraft({ ...editDraft, unit_name: e.target.value })} /> : (row.unit_name || '')}</td>\r\n                  <td style={{ color: row.unit_code ? '#e9edef' : '#8696a0' }}>{editingId === row.id ? <input className=\"input\" value={editDraft.unit_code} onChange={(e) => setEditDraft({ ...editDraft, unit_code: e.target.value })} /> : (row.unit_code || '')}</td>\r\n                  <td style={{ color: row.faculty ? '#e9edef' : '#8696a0' }}>\r\n                    {editingId === row.id ? (\r\n                      <div style={{ display: 'flex', flexDirection: 'column', gap: '4px' }}>\r\n                        {!useCustomFaculty ? (\r\n                          <>\r\n                            <select \r\n                              className=\"select\" \r\n                              value={editDraft.faculty} \r\n                              onChange={(e) => setEditDraft({ ...editDraft, faculty: e.target.value })}\r\n                              style={{ marginBottom: '4px' }}\r\n                            >\r\n                              <option value=\"\">Select Faculty</option>\r\n                              {faculties && faculties.length > 0 ? faculties.map(f => <option key={f} value={f}>{f}</option>) : <option value=\"\">No faculties available</option>}\r\n                            </select>\r\n                          </>\r\n                        ) : (\r\n                          <input \r\n                            className=\"input\" \r\n                            placeholder=\"e.g., Engineering, Business\" \r\n                            value={customFaculty} \r\n                            onChange={(e) => setCustomFaculty(e.target.value)}\r\n                          />\r\n                        )}\r\n                        <div style={{ display: 'flex', alignItems: 'center', gap: '4px', fontSize: '11px' }}>\r\n                          <input \r\n                            type=\"checkbox\" \r\n                            id={`custom-faculty-${row.id}`}\r\n                            checked={useCustomFaculty}\r\n                            onChange={(e) => {\r\n                              setUseCustomFaculty(e.target.checked);\r\n                              if (!e.target.checked) {\r\n                                setCustomFaculty('');\r\n                              }\r\n                            }}\r\n                            style={{ width: '14px', height: '14px', cursor: 'pointer' }}\r\n                          />\r\n                          <label htmlFor={`custom-faculty-${row.id}`} style={{ color: '#8696a0', cursor: 'pointer', fontSize: '11px' }}>\r\n                            Add\r\n                          </label>\r\n                        </div>\r\n                      </div>\r\n                    ) : (row.faculty || '')}\r\n                  </td>\r\n                  <td style={{ color: row.year ? '#e9edef' : '#8696a0' }}>{editingId === row.id ? <input className=\"input\" type=\"number\" value={editDraft.year} onChange={(e) => setEditDraft({ ...editDraft, year: e.target.value })} /> : (row.year || '')}</td>\r\n                  <td>{editingId === row.id ? <select className=\"select\" value={editDraft.semester} onChange={(e) => setEditDraft({ ...editDraft, semester: e.target.value })}><option value=\"\"></option><option value=\"1\">1</option><option value=\"2\">2</option><option value=\"3\">3</option></select> : (row.semester || '')}</td>\r\n                  <td>{editingId === row.id ? <select className=\"select\" value={editDraft.exam_type} onChange={(e) => setEditDraft({ ...editDraft, exam_type: e.target.value })}><option value=\"Main\">Main</option><option value=\"Supplementary\">Supplementary</option><option value=\"CAT\">CAT</option><option value=\"Mock\">Mock</option></select> : (row.exam_type || 'Main')}</td>\r\n                  <td style={{ fontWeight: '500', color: '#00a884' }}>{row.views_count || 0}</td>\r\n                  <td>{row.downloads_count || 0}</td>\r\n                  <td style={{ color: '#8696a0', fontSize: '12px' }}>{formatTimestamp(row.created_at)}</td>\r\n                  <td style={{ color: row.profiles?.full_name ? '#e9edef' : '#8696a0', fontSize: '13px' }}>{row.profiles?.full_name || row.profiles?.email || ''}</td>\r\n                  <td>\r\n                    {editingId === row.id ? (\r\n                      <div style={{ display: 'flex', gap: '4px', flexDirection: 'column' }}>\r\n                        <button className=\"btn primary\" onClick={() => saveEdit(row)}>Save</button>\r\n                        <button className=\"btn\" onClick={cancelEdit}>Cancel</button>\r\n                      </div>\r\n                    ) : (\r\n                      <div className=\"actions\">\r\n                        <button className=\"btn\" onClick={() => startEdit(row)} disabled={!canEdit(row)}>Edit</button>\r\n                        <button className=\"btn\" onClick={() => handleDelete(row)} disabled={!canEdit(row)}>Delete</button>\r\n                      </div>\r\n                    )}\r\n                  </td>\r\n                </tr>\r\n              ))}\r\n            </tbody>\r\n          </table>\r\n        </div>\r\n        <div className=\"actions\" style={{ marginTop: 6 }}>\r\n          <button className=\"btn\" disabled={page <= 1} onClick={() => setPage(p => Math.max(1, p - 1))}>Prev</button>\r\n          <span style={{ color: '#cfd8dc' }}>Page {page} of {totalPages}</span>\r\n          <button className=\"btn\" disabled={page >= totalPages} onClick={() => setPage(p => Math.min(totalPages, p + 1))}>Next</button>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default PastPapersManagement;\r\n","/**\r\n * Author Interactions API\r\n * Handles: followers, likes, loves, comments, ratings, shares\r\n */\r\n\r\nimport { supabase } from '../../Books/supabaseClient';\r\n\r\n// ============================================\r\n// FOLLOWERS MANAGEMENT\r\n// ============================================\r\n\r\nexport async function toggleAuthorFollow(authorId, userId) {\r\n  try {\r\n    if (!userId) throw new Error('User ID required');\r\n    \r\n    const { data, error } = await supabase\r\n      .rpc('toggle_author_follow', {\r\n        p_follower_id: userId,\r\n        p_author_id: authorId\r\n      });\r\n    \r\n    if (error) throw error;\r\n    return { success: true, isFollowing: data };\r\n  } catch (error) {\r\n    console.error('Error toggling author follow:', error);\r\n    throw error;\r\n  }\r\n}\r\n\r\nexport async function getAuthorFollowers(authorId) {\r\n  try {\r\n    const { data, error } = await supabase\r\n      .from('author_followers')\r\n      .select('id, follower_id, profiles(id, username, avatar_url), followed_at')\r\n      .eq('author_id', authorId)\r\n      .order('followed_at', { ascending: false });\r\n    \r\n    if (error) throw error;\r\n    return data || [];\r\n  } catch (error) {\r\n    console.error('Error fetching author followers:', error);\r\n    return [];\r\n  }\r\n}\r\n\r\nexport async function getFollowersCount(authorId) {\r\n  try {\r\n    const { count, error } = await supabase\r\n      .from('author_followers')\r\n      .select('id', { count: 'exact' })\r\n      .eq('author_id', authorId);\r\n    \r\n    if (error) throw error;\r\n    return count || 0;\r\n  } catch (error) {\r\n    console.error('Error fetching followers count:', error);\r\n    return 0;\r\n  }\r\n}\r\n\r\n// ============================================\r\n// LIKES MANAGEMENT\r\n// ============================================\r\n\r\nexport async function toggleAuthorLike(authorId, userId) {\r\n  try {\r\n    if (!userId) throw new Error('User ID required');\r\n    \r\n    const { data, error } = await supabase\r\n      .rpc('toggle_author_like', {\r\n        p_user_id: userId,\r\n        p_author_id: authorId\r\n      });\r\n    \r\n    if (error) throw error;\r\n    return { success: true, isLiked: data };\r\n  } catch (error) {\r\n    console.error('Error toggling author like:', error);\r\n    throw error;\r\n  }\r\n}\r\n\r\nexport async function getAuthorLikes(authorId) {\r\n  try {\r\n    const { data, error } = await supabase\r\n      .from('author_likes')\r\n      .select('id, user_id, profiles(id, username, avatar_url), liked_at')\r\n      .eq('author_id', authorId)\r\n      .order('liked_at', { ascending: false });\r\n    \r\n    if (error) throw error;\r\n    return data || [];\r\n  } catch (error) {\r\n    console.error('Error fetching author likes:', error);\r\n    return [];\r\n  }\r\n}\r\n\r\nexport async function getLikesCount(authorId) {\r\n  try {\r\n    const { count, error } = await supabase\r\n      .from('author_likes')\r\n      .select('id', { count: 'exact' })\r\n      .eq('author_id', authorId);\r\n    \r\n    if (error) throw error;\r\n    return count || 0;\r\n  } catch (error) {\r\n    console.error('Error fetching likes count:', error);\r\n    return 0;\r\n  }\r\n}\r\n\r\n// ============================================\r\n// LOVES MANAGEMENT\r\n// ============================================\r\n\r\nexport async function toggleAuthorLove(authorId, userId) {\r\n  try {\r\n    if (!userId) throw new Error('User ID required');\r\n    \r\n    const { data, error } = await supabase\r\n      .rpc('toggle_author_love', {\r\n        p_user_id: userId,\r\n        p_author_id: authorId\r\n      });\r\n    \r\n    if (error) throw error;\r\n    return { success: true, isLoved: data };\r\n  } catch (error) {\r\n    console.error('Error toggling author love:', error);\r\n    throw error;\r\n  }\r\n}\r\n\r\nexport async function getAuthorLoves(authorId) {\r\n  try {\r\n    const { data, error } = await supabase\r\n      .from('author_loves')\r\n      .select('id, user_id, profiles(id, username, avatar_url), loved_at')\r\n      .eq('author_id', authorId)\r\n      .order('loved_at', { ascending: false });\r\n    \r\n    if (error) throw error;\r\n    return data || [];\r\n  } catch (error) {\r\n    console.error('Error fetching author loves:', error);\r\n    return [];\r\n  }\r\n}\r\n\r\nexport async function getLovesCount(authorId) {\r\n  try {\r\n    const { count, error } = await supabase\r\n      .from('author_loves')\r\n      .select('id', { count: 'exact' })\r\n      .eq('author_id', authorId);\r\n    \r\n    if (error) throw error;\r\n    return count || 0;\r\n  } catch (error) {\r\n    console.error('Error fetching loves count:', error);\r\n    return 0;\r\n  }\r\n}\r\n\r\n// ============================================\r\n// COMMENTS MANAGEMENT\r\n// ============================================\r\n\r\nexport async function addAuthorComment(authorId, userId, content, parentCommentId = null) {\r\n  try {\r\n    if (!userId) throw new Error('User ID required');\r\n    if (!content || content.trim().length === 0) throw new Error('Comment content required');\r\n\r\n    const { data, error } = await supabase\r\n      .from('author_comments')\r\n      .insert({\r\n        author_id: authorId,\r\n        user_id: userId,\r\n        content,\r\n        parent_comment_id: parentCommentId\r\n      })\r\n      .select('*, profiles(id, username, avatar_url)')\r\n      .single();\r\n\r\n    if (error) throw error;\r\n    return data;\r\n  } catch (error) {\r\n    console.error('Error adding author comment:', error);\r\n    throw error;\r\n  }\r\n}\r\n\r\nexport async function getAuthorComments(authorId, limit = 50) {\r\n  try {\r\n    const { data, error } = await supabase\r\n      .from('author_comments')\r\n      .select('id, user_id, content, parent_comment_id, likes_count, created_at, updated_at, profiles(id, username, avatar_url, tier)')\r\n      .eq('author_id', authorId)\r\n      .is('parent_comment_id', null)\r\n      .order('created_at', { ascending: false })\r\n      .limit(limit);\r\n\r\n    if (error) throw error;\r\n    return data || [];\r\n  } catch (error) {\r\n    console.error('Error fetching author comments:', error);\r\n    return [];\r\n  }\r\n}\r\n\r\nexport async function deleteAuthorComment(commentId, userId) {\r\n  try {\r\n    // Verify ownership\r\n    const { data: comment, error: fetchError } = await supabase\r\n      .from('author_comments')\r\n      .select('user_id')\r\n      .eq('id', commentId)\r\n      .single();\r\n\r\n    if (fetchError) throw fetchError;\r\n    if (comment.user_id !== userId) throw new Error('Unauthorized');\r\n\r\n    const { error } = await supabase\r\n      .from('author_comments')\r\n      .delete()\r\n      .eq('id', commentId);\r\n\r\n    if (error) throw error;\r\n    return { success: true };\r\n  } catch (error) {\r\n    console.error('Error deleting author comment:', error);\r\n    throw error;\r\n  }\r\n}\r\n\r\nexport async function getCommentsCount(authorId) {\r\n  try {\r\n    const { count, error } = await supabase\r\n      .from('author_comments')\r\n      .select('id', { count: 'exact' })\r\n      .eq('author_id', authorId)\r\n      .is('parent_comment_id', null);\r\n\r\n    if (error) throw error;\r\n    return count || 0;\r\n  } catch (error) {\r\n    console.error('Error fetching comments count:', error);\r\n    return 0;\r\n  }\r\n}\r\n\r\n// ============================================\r\n// RATINGS MANAGEMENT\r\n// ============================================\r\n\r\nexport async function rateAuthor(authorId, userId, rating, review = '') {\r\n  try {\r\n    if (!userId) throw new Error('User ID required');\r\n    if (rating < 1 || rating > 5) throw new Error('Rating must be between 1 and 5');\r\n\r\n    const { data, error } = await supabase\r\n      .from('author_ratings')\r\n      .upsert(\r\n        {\r\n          author_id: authorId,\r\n          user_id: userId,\r\n          rating,\r\n          review: review || null\r\n        },\r\n        { onConflict: 'user_id,author_id' }\r\n      )\r\n      .select('*, profiles(id, username, avatar_url)')\r\n      .single();\r\n\r\n    if (error) throw error;\r\n    return data;\r\n  } catch (error) {\r\n    console.error('Error rating author:', error);\r\n    throw error;\r\n  }\r\n}\r\n\r\nexport async function getAuthorRatings(authorId, limit = 20) {\r\n  try {\r\n    const { data, error } = await supabase\r\n      .from('author_ratings')\r\n      .select('id, user_id, rating, review, helpful_count, created_at, profiles(id, username, avatar_url, tier)')\r\n      .eq('author_id', authorId)\r\n      .order('helpful_count', { ascending: false })\r\n      .order('created_at', { ascending: false })\r\n      .limit(limit);\r\n\r\n    if (error) throw error;\r\n    return data || [];\r\n  } catch (error) {\r\n    console.error('Error fetching author ratings:', error);\r\n    return [];\r\n  }\r\n}\r\n\r\nexport async function getRatingsCount(authorId) {\r\n  try {\r\n    const { count, error } = await supabase\r\n      .from('author_ratings')\r\n      .select('id', { count: 'exact' })\r\n      .eq('author_id', authorId);\r\n\r\n    if (error) throw error;\r\n    return count || 0;\r\n  } catch (error) {\r\n    console.error('Error fetching ratings count:', error);\r\n    return 0;\r\n  }\r\n}\r\n\r\nexport async function getAverageRating(authorId) {\r\n  try {\r\n    const { data, error } = await supabase\r\n      .from('author_ratings')\r\n      .select('rating')\r\n      .eq('author_id', authorId);\r\n\r\n    if (error) throw error;\r\n    if (!data || data.length === 0) return 0;\r\n\r\n    const average = data.reduce((sum, r) => sum + r.rating, 0) / data.length;\r\n    return Math.round(average * 10) / 10;\r\n  } catch (error) {\r\n    console.error('Error calculating average rating:', error);\r\n    return 0;\r\n  }\r\n}\r\n\r\nexport async function deleteAuthorRating(authorId, userId) {\r\n  try {\r\n    const { error } = await supabase\r\n      .from('author_ratings')\r\n      .delete()\r\n      .eq('author_id', authorId)\r\n      .eq('user_id', userId);\r\n\r\n    if (error) throw error;\r\n    return { success: true };\r\n  } catch (error) {\r\n    console.error('Error deleting rating:', error);\r\n    throw error;\r\n  }\r\n}\r\n\r\n// ============================================\r\n// SHARES MANAGEMENT\r\n// ============================================\r\n\r\nexport async function recordAuthorShare(authorId, userId, shareType, platform = null) {\r\n  try {\r\n    const { data, error } = await supabase\r\n      .from('author_shares')\r\n      .insert({\r\n        author_id: authorId,\r\n        user_id: userId || null,\r\n        share_type: shareType,\r\n        platform: platform || null\r\n      })\r\n      .select()\r\n      .single();\r\n\r\n    if (error) throw error;\r\n    return data;\r\n  } catch (error) {\r\n    console.error('Error recording author share:', error);\r\n    throw error;\r\n  }\r\n}\r\n\r\nexport async function getSharesCount(authorId) {\r\n  try {\r\n    const { count, error } = await supabase\r\n      .from('author_shares')\r\n      .select('id', { count: 'exact' })\r\n      .eq('author_id', authorId);\r\n\r\n    if (error) throw error;\r\n    return count || 0;\r\n  } catch (error) {\r\n    console.error('Error fetching shares count:', error);\r\n    return 0;\r\n  }\r\n}\r\n\r\n// ============================================\r\n// USER INTERACTION STATUS\r\n// ============================================\r\n\r\nexport async function getUserAuthorInteractionStatus(authorId, userId) {\r\n  try {\r\n    if (!userId) {\r\n      return {\r\n        isFollower: false,\r\n        hasLiked: false,\r\n        hasLoved: false,\r\n        userRating: null\r\n      };\r\n    }\r\n\r\n    const { data, error } = await supabase\r\n      .rpc('get_author_interaction_status', {\r\n        p_user_id: userId,\r\n        p_author_id: authorId\r\n      })\r\n      .single();\r\n\r\n    if (error) {\r\n      console.error('Error fetching user interaction status:', error);\r\n      return {\r\n        isFollower: false,\r\n        hasLiked: false,\r\n        hasLoved: false,\r\n        userRating: null\r\n      };\r\n    }\r\n\r\n    return {\r\n      isFollower: data.is_follower || false,\r\n      hasLiked: data.has_liked || false,\r\n      hasLoved: data.has_loved || false,\r\n      userRating: data.user_rating\r\n    };\r\n  } catch (error) {\r\n    console.error('Error in getUserAuthorInteractionStatus:', error);\r\n    return {\r\n      isFollower: false,\r\n      hasLiked: false,\r\n      hasLoved: false,\r\n      userRating: null\r\n    };\r\n  }\r\n}\r\n\r\n// ============================================\r\n// AUTHOR ENGAGEMENT STATISTICS\r\n// ============================================\r\n\r\nexport async function getAuthorEngagementStats(authorId) {\r\n  try {\r\n    const { data, error } = await supabase\r\n      .from('author_engagement_stats')\r\n      .select('*')\r\n      .eq('author_id', authorId)\r\n      .single();\r\n\r\n    if (error && error.code !== 'PGRST116') throw error;\r\n\r\n    return data || {\r\n      author_id: authorId,\r\n      books_count: 0,\r\n      total_downloads: 0,\r\n      total_views: 0,\r\n      average_rating: 0,\r\n      followers_count: 0,\r\n      likes_count: 0,\r\n      loves_count: 0,\r\n      comments_count: 0,\r\n      ratings_count: 0,\r\n      shares_count: 0,\r\n      engagement_score: 0\r\n    };\r\n  } catch (error) {\r\n    console.error('Error fetching author engagement stats:', error);\r\n    return null;\r\n  }\r\n}\r\n\r\nexport async function getAllAuthorsEngagementStats(limit = 100) {\r\n  try {\r\n    const { data, error } = await supabase\r\n      .from('author_engagement_stats')\r\n      .select('*')\r\n      .order('engagement_score', { ascending: false })\r\n      .limit(limit);\r\n\r\n    if (error) throw error;\r\n    return data || [];\r\n  } catch (error) {\r\n    console.error('Error fetching all authors engagement stats:', error);\r\n    return [];\r\n  }\r\n}\r\n\r\nexport async function getTopAuthors(limit = 10) {\r\n  try {\r\n    const { data, error } = await supabase\r\n      .from('author_engagement_stats')\r\n      .select('*')\r\n      .order('engagement_score', { ascending: false })\r\n      .limit(limit);\r\n\r\n    if (error) throw error;\r\n    return data || [];\r\n  } catch (error) {\r\n    console.error('Error fetching top authors:', error);\r\n    return [];\r\n  }\r\n}\r\n\r\n// ============================================\r\n// AUTHOR PROFILE ENRICHMENT\r\n// ============================================\r\n\r\nexport async function enrichAuthorWithInteractions(author, userId = null) {\r\n  try {\r\n    const stats = await getAuthorEngagementStats(author.name || author.author_id);\r\n    const interactions = userId \r\n      ? await getUserAuthorInteractionStatus(author.name || author.author_id, userId)\r\n      : null;\r\n\r\n    return {\r\n      ...author,\r\n      ...stats,\r\n      interactions\r\n    };\r\n  } catch (error) {\r\n    console.error('Error enriching author:', error);\r\n    return author;\r\n  }\r\n}\r\n\r\nexport async function enrichAuthorsWithInteractions(authors, userId = null) {\r\n  try {\r\n    return Promise.all(\r\n      authors.map(author => enrichAuthorWithInteractions(author, userId))\r\n    );\r\n  } catch (error) {\r\n    console.error('Error enriching authors:', error);\r\n    return authors;\r\n  }\r\n}\r\n","import React, { useEffect, useState, useMemo } from 'react';\r\nimport { FiBook, FiDownload, FiStar, FiSearch, FiTrendingUp, FiHeart, FiUsers, FiMessageSquare, FiThumbsUp } from 'react-icons/fi';\r\nimport { MdFavoriteBorder } from 'react-icons/md';\r\nimport { fetchStats } from '../api';\r\nimport { getAllAuthorsEngagementStats } from '../authorInteractionsApi';\r\nimport './Authors.css';\r\n\r\nconst Authors = () => {\r\n  const [stats, setStats] = useState(null);\r\n  const [engagementStats, setEngagementStats] = useState({});\r\n  const [loading, setLoading] = useState(true);\r\n  const [searchTerm, setSearchTerm] = useState('');\r\n  const [sortBy, setSortBy] = useState('engagement');\r\n  const [timeRange, setTimeRange] = useState('monthly');\r\n\r\n  useEffect(() => {\r\n    const loadData = async () => {\r\n      try {\r\n        setLoading(true);\r\n        const [statsData, engageData] = await Promise.all([\r\n          fetchStats(),\r\n          getAllAuthorsEngagementStats(100)\r\n        ]);\r\n        \r\n        setStats(statsData);\r\n        \r\n        // Create engagement stats map for quick lookup by author name\r\n        const engageMap = {};\r\n        engageData.forEach(stat => {\r\n          engageMap[stat.author_name] = stat;\r\n        });\r\n        setEngagementStats(engageMap);\r\n      } catch (error) {\r\n        console.error('Failed to load authors stats:', error);\r\n      } finally {\r\n        setLoading(false);\r\n      }\r\n    };\r\n\r\n    loadData();\r\n    const interval = setInterval(loadData, 30000); // Refresh every 30 seconds\r\n    return () => clearInterval(interval);\r\n  }, []);\r\n\r\n  const filteredAndSorted = useMemo(() => {\r\n    if (!stats || !stats.authors) return [];\r\n\r\n    let filtered = stats.authors.filter(author =>\r\n      author.name.toLowerCase().includes(searchTerm.toLowerCase())\r\n    );\r\n\r\n    filtered.sort((a, b) => {\r\n      const authorEngageA = engagementStats[a.name] || {};\r\n      const authorEngageB = engagementStats[b.name] || {};\r\n\r\n      switch (sortBy) {\r\n        case 'engagement':\r\n          return (authorEngageB.engagement_score || 0) - (authorEngageA.engagement_score || 0);\r\n        case 'books':\r\n          return b.bookCount - a.bookCount;\r\n        case 'downloads':\r\n          return b.totalDownloads - a.totalDownloads;\r\n        case 'followers':\r\n          return (authorEngageB.followers_count || 0) - (authorEngageA.followers_count || 0);\r\n        case 'likes':\r\n          return (authorEngageB.likes_count || 0) - (authorEngageA.likes_count || 0);\r\n        case 'rating':\r\n          return parseFloat(b.avgRating || 0) - parseFloat(a.avgRating || 0);\r\n        case 'name':\r\n          return a.name.localeCompare(b.name);\r\n        default:\r\n          return (authorEngageB.engagement_score || 0) - (authorEngageA.engagement_score || 0);\r\n      }\r\n    });\r\n\r\n    return filtered;\r\n  }, [stats, searchTerm, sortBy, engagementStats]);\r\n\r\n  const overallStats = useMemo(() => {\r\n    if (!stats || !stats.authors) return { \r\n      totalAuthors: 0, \r\n      totalBooks: 0, \r\n      totalDL: 0, \r\n      avgRating: 0,\r\n      totalFollowers: 0,\r\n      totalLikes: 0,\r\n      totalLoves: 0,\r\n      totalComments: 0\r\n    };\r\n\r\n    const totalBooks = stats.authors.reduce((sum, a) => sum + (a.bookCount || 0), 0);\r\n    const totalDL = stats.authors.reduce((sum, a) => sum + (a.totalDownloads || 0), 0);\r\n    const avgRating = stats.authors.length > 0\r\n      ? (stats.authors.reduce((sum, a) => sum + (parseFloat(a.avgRating) || 0), 0) / stats.authors.length).toFixed(1)\r\n      : 0;\r\n    \r\n    // Sum engagement metrics\r\n    const totalFollowers = Object.values(engagementStats).reduce((sum, stat) => sum + (stat.followers_count || 0), 0);\r\n    const totalLikes = Object.values(engagementStats).reduce((sum, stat) => sum + (stat.likes_count || 0), 0);\r\n    const totalLoves = Object.values(engagementStats).reduce((sum, stat) => sum + (stat.loves_count || 0), 0);\r\n    const totalComments = Object.values(engagementStats).reduce((sum, stat) => sum + (stat.comments_count || 0), 0);\r\n\r\n    return {\r\n      totalAuthors: stats.authors.length,\r\n      totalBooks,\r\n      totalDL,\r\n      avgRating,\r\n      totalFollowers,\r\n      totalLikes,\r\n      totalLoves,\r\n      totalComments\r\n    };\r\n  }, [stats, engagementStats]);\r\n\r\n  if (loading) {\r\n    return (\r\n      <div className=\"authors-page\">\r\n        <div className=\"authors-loading\">\r\n          <div className=\"authors-spinner\"></div>\r\n          <p>Loading authors data...</p>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className=\"authors-page\">\r\n      {/* Header */}\r\n      <div className=\"authors-header\">\r\n        <div className=\"authors-title-section\">\r\n          <h1 className=\"authors-title\">\r\n            <FiTrendingUp /> Authors Analytics\r\n          </h1>\r\n          <p className=\"authors-subtitle\">Comprehensive author performance and engagement metrics</p>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Stats Cards */}\r\n      <div className=\"authors-stats-grid\">\r\n        <div className=\"authors-stat-card\">\r\n          <div className=\"authors-stat-icon authors-stat-icon-1\">\r\n            <FiBook />\r\n          </div>\r\n          <div className=\"authors-stat-content\">\r\n            <div className=\"authors-stat-label\">Total Authors</div>\r\n            <div className=\"authors-stat-value\">{overallStats.totalAuthors}</div>\r\n          </div>\r\n        </div>\r\n\r\n        <div className=\"authors-stat-card\">\r\n          <div className=\"authors-stat-icon authors-stat-icon-2\">\r\n            <FiBook />\r\n          </div>\r\n          <div className=\"authors-stat-content\">\r\n            <div className=\"authors-stat-label\">Total Books</div>\r\n            <div className=\"authors-stat-value\">{overallStats.totalBooks}</div>\r\n          </div>\r\n        </div>\r\n\r\n        <div className=\"authors-stat-card\">\r\n          <div className=\"authors-stat-icon authors-stat-icon-3\">\r\n            <FiDownload />\r\n          </div>\r\n          <div className=\"authors-stat-content\">\r\n            <div className=\"authors-stat-label\">Total Downloads</div>\r\n            <div className=\"authors-stat-value\">{overallStats.totalDL.toLocaleString()}</div>\r\n          </div>\r\n        </div>\r\n\r\n        <div className=\"authors-stat-card\">\r\n          <div className=\"authors-stat-icon authors-stat-icon-4\">\r\n            <FiStar />\r\n          </div>\r\n          <div className=\"authors-stat-content\">\r\n            <div className=\"authors-stat-label\">Avg Rating</div>\r\n            <div className=\"authors-stat-value\">{overallStats.avgRating}</div>\r\n          </div>\r\n        </div>\r\n\r\n        <div className=\"authors-stat-card\">\r\n          <div className=\"authors-stat-icon authors-stat-icon-5\">\r\n            <FiUsers />\r\n          </div>\r\n          <div className=\"authors-stat-content\">\r\n            <div className=\"authors-stat-label\">Total Followers</div>\r\n            <div className=\"authors-stat-value\">{overallStats.totalFollowers}</div>\r\n          </div>\r\n        </div>\r\n\r\n        <div className=\"authors-stat-card\">\r\n          <div className=\"authors-stat-icon authors-stat-icon-6\">\r\n            <MdFavoriteBorder />\r\n          </div>\r\n          <div className=\"authors-stat-content\">\r\n            <div className=\"authors-stat-label\">Total Likes</div>\r\n            <div className=\"authors-stat-value\">{overallStats.totalLikes}</div>\r\n          </div>\r\n        </div>\r\n\r\n        <div className=\"authors-stat-card\">\r\n          <div className=\"authors-stat-icon authors-stat-icon-7\">\r\n            <FiHeart />\r\n          </div>\r\n          <div className=\"authors-stat-content\">\r\n            <div className=\"authors-stat-label\">Total Loves</div>\r\n            <div className=\"authors-stat-value\">{overallStats.totalLoves}</div>\r\n          </div>\r\n        </div>\r\n\r\n        <div className=\"authors-stat-card\">\r\n          <div className=\"authors-stat-icon authors-stat-icon-8\">\r\n            <FiMessageSquare />\r\n          </div>\r\n          <div className=\"authors-stat-content\">\r\n            <div className=\"authors-stat-label\">Total Comments</div>\r\n            <div className=\"authors-stat-value\">{overallStats.totalComments}</div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Controls */}\r\n      <div className=\"authors-controls\">\r\n        <div className=\"authors-control-group\">\r\n          <label className=\"authors-label\">Search Author</label>\r\n          <div className=\"authors-search-wrapper\">\r\n            <FiSearch className=\"authors-search-icon\" />\r\n            <input\r\n              type=\"text\"\r\n              placeholder=\"Search by author name...\"\r\n              value={searchTerm}\r\n              onChange={(e) => setSearchTerm(e.target.value)}\r\n              className=\"authors-search-input\"\r\n            />\r\n          </div>\r\n        </div>\r\n\r\n        <div className=\"authors-control-group\">\r\n          <label className=\"authors-label\">Sort By</label>\r\n          <select\r\n            value={sortBy}\r\n            onChange={(e) => setSortBy(e.target.value)}\r\n            className=\"authors-select\"\r\n          >\r\n            <option value=\"engagement\">Engagement Score</option>\r\n            <option value=\"followers\">Followers</option>\r\n            <option value=\"likes\">Likes</option>\r\n            <option value=\"books\">Books Count</option>\r\n            <option value=\"downloads\">Downloads</option>\r\n            <option value=\"rating\">Rating</option>\r\n            <option value=\"name\">Name (A-Z)</option>\r\n          </select>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Table */}\r\n      <div className=\"authors-table-wrapper\">\r\n        <table className=\"authors-table\">\r\n          <thead className=\"authors-table-head\">\r\n            <tr>\r\n              <th className=\"authors-table-header authors-rank-col\">Rank</th>\r\n              <th className=\"authors-table-header authors-name-col\">Author Name</th>\r\n              <th className=\"authors-table-header authors-num-col\">Books</th>\r\n              <th className=\"authors-table-header authors-num-col\">Downloads</th>\r\n              <th className=\"authors-table-header authors-num-col\">Followers</th>\r\n              <th className=\"authors-table-header authors-num-col\">Likes</th>\r\n              <th className=\"authors-table-header authors-num-col\">Loves</th>\r\n              <th className=\"authors-table-header authors-num-col\">Rating</th>\r\n              <th className=\"authors-table-header authors-num-col\">Score</th>\r\n            </tr>\r\n          </thead>\r\n          <tbody className=\"authors-table-body\">\r\n            {filteredAndSorted.length > 0 ? (\r\n              filteredAndSorted.map((author, idx) => {\r\n                const engage = engagementStats[author.name] || {};\r\n                const engScore = engage.engagement_score || 0;\r\n                const medal = idx === 0 ? '' : idx === 1 ? '' : idx === 2 ? '' : `#${idx + 1}`;\r\n\r\n                return (\r\n                  <tr key={author.id} className=\"authors-table-row\">\r\n                    <td className=\"authors-table-cell authors-rank-col\">\r\n                      <span className=\"authors-rank-badge\">{medal}</span>\r\n                    </td>\r\n                    <td className=\"authors-table-cell authors-name-col\">\r\n                      <div className=\"authors-author-name\">\r\n                        {author.name === 'Unknown' ? ' Unknown Author' : author.name}\r\n                      </div>\r\n                    </td>\r\n                    <td className=\"authors-table-cell authors-num-col\">\r\n                      <span className=\"authors-metric-plain authors-books-count\">{author.bookCount}</span>\r\n                    </td>\r\n                    <td className=\"authors-table-cell authors-num-col\">\r\n                      <span className=\"authors-metric-plain authors-downloads-count\">{author.totalDownloads}</span>\r\n                    </td>\r\n                    <td className=\"authors-table-cell authors-num-col\">\r\n                      <span className=\"authors-metric-plain authors-followers-count\">{engage.followers_count || 0}</span>\r\n                    </td>\r\n                    <td className=\"authors-table-cell authors-num-col\">\r\n                      <span className=\"authors-metric-plain authors-likes-count\">\r\n                        <FiThumbsUp className=\"authors-metric-icon\" />\r\n                        {engage.likes_count || 0}\r\n                      </span>\r\n                    </td>\r\n                    <td className=\"authors-table-cell authors-num-col\">\r\n                      <span className=\"authors-metric-plain authors-loves-count\">\r\n                        <FiHeart className=\"authors-metric-icon\" />\r\n                        {engage.loves_count || 0}\r\n                      </span>\r\n                    </td>\r\n                    <td className=\"authors-table-cell authors-num-col\">\r\n                      <span className=\"authors-rating-plain\">\r\n                        {engage.average_rating > 0 ? engage.average_rating.toFixed(1) : ''} \r\n                      </span>\r\n                    </td>\r\n                    <td className=\"authors-table-cell authors-num-col\">\r\n                      <span className=\"authors-score-plain\">{engScore.toFixed(2)}</span>\r\n                    </td>\r\n                  </tr>\r\n                );\r\n              })\r\n            ) : (\r\n              <tr className=\"authors-table-row authors-empty-row\">\r\n                <td colSpan=\"9\" className=\"authors-table-cell authors-empty-message\">\r\n                  No authors found matching \"{searchTerm}\"\r\n                </td>\r\n              </tr>\r\n            )}\r\n          </tbody>\r\n        </table>\r\n      </div>\r\n\r\n      {/* Summary */}\r\n      <div className=\"authors-summary\">\r\n        <div className=\"authors-summary-item\">\r\n          <span className=\"authors-summary-label\">Showing</span>\r\n          <span className=\"authors-summary-value\">{filteredAndSorted.length} of {overallStats.totalAuthors}</span>\r\n          <span className=\"authors-summary-label\">authors</span>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Authors;\r\n","import React, { useState, useEffect } from 'react';\nimport { useSearchParams } from 'react-router-dom';\nimport { FiBook, FiMapPin, FiFileText, FiBookOpen } from 'react-icons/fi';\nimport Books from './Books';\nimport UniversitiesManagement from './UniversitiesManagement';\nimport PastPapersManagement from './PastPapersManagement';\nimport Authors from './Authors';\n\nconst tabStyles = `\n  .content-tabs {\n    display: flex;\n    gap: 4px;\n    margin-bottom: 8px;\n    border-bottom: 1px solid #374151;\n  }\n  .content-tab {\n    display: flex;\n    align-items: center;\n    gap: 4px;\n    padding: 6px 12px;\n    background: transparent;\n    border: none;\n    color: #8696a0;\n    cursor: pointer;\n    font-size: 14px;\n    font-weight: 500;\n    transition: all 0.3s ease;\n    border-bottom: 2px solid transparent;\n    margin-bottom: -1px;\n  }\n  .content-tab:hover {\n    color: #e9edef;\n    background: rgba(0, 168, 132, 0.05);\n  }\n  .content-tab.active {\n    color: #00a884;\n    border-bottom-color: #00a884;\n  }\n`;\n\nconst ContentManagement = ({ userProfile }) => {\n  const [searchParams] = useSearchParams();\n  const [activeTab, setActiveTab] = useState('books');\n\n  useEffect(() => {\n    const tabParam = searchParams.get('tab');\n    if (tabParam === 'pastpapers') {\n      setActiveTab('pastpapers');\n    } else if (tabParam === 'universities') {\n      setActiveTab('universities');\n    } else if (tabParam === 'authors') {\n      setActiveTab('authors');\n    } else {\n      setActiveTab('books');\n    }\n  }, [searchParams]);\n\n  React.useEffect(() => {\n    const styleTag = document.createElement('style');\n    styleTag.innerHTML = tabStyles;\n    document.head.appendChild(styleTag);\n    return () => styleTag.remove();\n  }, []);\n\n  return (\n    <div>\n      <div className=\"content-tabs\">\n        <button \n          className={`content-tab ${activeTab === 'books' ? 'active' : ''}`}\n          onClick={() => setActiveTab('books')}\n        >\n          <FiBook size={20} />\n          Books\n        </button>\n        <button \n          className={`content-tab ${activeTab === 'universities' ? 'active' : ''}`}\n          onClick={() => setActiveTab('universities')}\n        >\n          <FiMapPin size={20} />\n          Universities\n        </button>\n        <button \n          className={`content-tab ${activeTab === 'pastpapers' ? 'active' : ''}`}\n          onClick={() => setActiveTab('pastpapers')}\n        >\n          <FiFileText size={20} />\n          Past Papers\n        </button>\n        <button \n          className={`content-tab ${activeTab === 'authors' ? 'active' : ''}`}\n          onClick={() => setActiveTab('authors')}\n        >\n          <FiBookOpen size={20} />\n          Authors\n        </button>\n      </div>\n\n      {activeTab === 'books' && <Books userProfile={userProfile} />}\n      {activeTab === 'universities' && <UniversitiesManagement userProfile={userProfile} />}\n      {activeTab === 'pastpapers' && <PastPapersManagement userProfile={userProfile} />}\n      {activeTab === 'authors' && <Authors />}\n    </div>\n  );\n};\n\nexport default ContentManagement;","import { supabase } from '../supabaseClient';\nimport { API_URL } from '../../../config';\n\n// API Configuration\nconst USE_BACKEND_PROXY = true; // Set to false to use direct API calls\n\n/**\n * Search for university names for autocomplete\n */\nexport async function searchUniversityNames(query, limit = 10) {\n  try {\n    // Check cache first\n    let { data, error } = await supabase\n      .rpc('search_university_names', { p_query: query, p_limit: limit });\n\n    if (error) throw error;\n    if (data?.length) return data;\n\n    // Try Wikipedia/Wikidata search as primary method (more reliable, no API key needed)\n    const wikiResults = await searchWikipediaUniversities(query, limit);\n    if (wikiResults.length > 0) {\n      // Cache results\n      await Promise.all(wikiResults.map(uni => \n        cacheUniversityPrefillData(uni.name, uni, 'wikipedia')\n      ));\n      return wikiResults;\n    }\n\n    // Try backend proxy for Google Knowledge Graph (if enabled)\n    if (USE_BACKEND_PROXY) {\n      try {\n        const response = await fetch(`${API_URL}/api/university/search?query=${encodeURIComponent(query)}&limit=${limit}`);\n        \n        if (response.ok) {\n          const data = await response.json();\n          const universities = data.universities || [];\n          \n          // Cache results\n          if (universities.length > 0) {\n            await Promise.all(universities.map(uni => \n              cacheUniversityPrefillData(uni.name, uni, 'google_proxy')\n            ));\n          }\n          \n          return universities;\n        }\n      } catch (proxyError) {\n        console.warn('Backend proxy unavailable:', proxyError.message);\n      }\n    }\n\n    return [];\n  } catch (error) {\n    console.error('Error searching university names:', error);\n    return [];\n  }\n}\n\n/**\n * Search for universities using Wikipedia API (more reliable, no API key needed)\n */\nasync function searchWikipediaUniversities(query, limit = 10) {\n  try {\n    const searchUrl = `https://en.wikipedia.org/w/api.php?action=opensearch&search=${encodeURIComponent(query + ' university')}&limit=${limit}&namespace=0&format=json&origin=*`;\n    const response = await fetch(searchUrl);\n    \n    if (!response.ok) return [];\n    \n    const data = await response.json();\n    // data[0] = query, data[1] = titles, data[2] = descriptions, data[3] = urls\n    const titles = data[1] || [];\n    const descriptions = data[2] || [];\n    const urls = data[3] || [];\n    \n    return titles\n      .filter(title => title.toLowerCase().includes('university') || title.toLowerCase().includes('college'))\n      .map((title, index) => ({\n        name: title,\n        description: descriptions[index] || '',\n        website_url: urls[index] || '',\n      }));\n  } catch (error) {\n    console.error('Error searching Wikipedia:', error);\n    return [];\n  }\n}\n\n/**\n * Get prefill data for a university by name from cache\n */\nexport async function getUniversityPrefillData(universityName) {\n  try {\n    const { data, error } = await supabase\n      .rpc('get_university_prefill_data', {\n        p_university_name: universityName,\n      });\n\n    if (error) throw error;\n    return data;\n  } catch (error) {\n    console.error('Error fetching prefill data:', error);\n    return null;\n  }\n}\n\n/**\n * Fetch university data from Google Knowledge Graph (via backend proxy)\n */\nexport async function fetchUniversityDataFromGoogle(universityName) {\n  if (USE_BACKEND_PROXY) {\n    try {\n      const response = await fetch(`${API_URL}/api/university/details?name=${encodeURIComponent(universityName)}`);\n      \n      if (response.ok) {\n        const data = await response.json();\n        return {\n          name: data.university.name || universityName,\n          description: data.university.description || '',\n          website_url: data.university.website_url || '',\n          location: data.university.location || '',\n          established: null,\n          student_count: null,\n          cover_images: data.university.image ? [data.university.image] : [],\n        };\n      }\n    } catch (error) {\n      console.error('Error fetching from Google via proxy:', error);\n    }\n  }\n  \n  return null;\n}\n\n/**\n * Fetch university summary from Wikipedia REST API\n */\nexport async function fetchUniversityDataFromWikipedia(universityName) {\n  try {\n    const url = `https://en.wikipedia.org/api/rest_v1/page/summary/${encodeURIComponent(universityName)}`;\n    const res = await fetch(url);\n    if (!res.ok) return null;\n    const json = await res.json();\n\n    return {\n      name: json.title || universityName,\n      description: json.extract || '',\n      website_url: '',\n      location: '',\n      established: null,\n      student_count: null,\n      cover_images: json.thumbnail?.source ? [json.thumbnail.source] : [],\n    };\n  } catch (e) {\n    console.error('Error fetching from Wikipedia REST:', e);\n    return null;\n  }\n}\n\n/**\n * Fetch university data from Wikidata\n */\nexport async function fetchUniversityDataFromWikidata(universityName) {\n  try {\n    const sparqlQuery = `\n      SELECT ?item ?itemLabel ?locationLabel ?established ?studentCount ?website\n      WHERE {\n        ?item wdt:P31/wdt:P279* wd:Q3918;\n              rdfs:label ?itemLabel.\n        OPTIONAL { ?item wdt:P131 ?location. }\n        OPTIONAL { ?item wdt:P571 ?established. }\n        OPTIONAL { ?item wdt:P2196 ?studentCount. }\n        OPTIONAL { ?item wdt:P856 ?website. }\n        FILTER(CONTAINS(LCASE(?itemLabel), LCASE(\"${universityName}\")))\n        FILTER(LANG(?itemLabel) = \"en\")\n        SERVICE wikibase:label { bd:serviceParam wikibase:language \"en\". }\n      }\n      LIMIT 1\n    `;\n    const url = `https://query.wikidata.org/sparql?query=${encodeURIComponent(sparqlQuery)}&format=json`;\n    const response = await fetch(url);\n    if (!response.ok) return null;\n\n    const data = await response.json();\n    const binding = data.results.bindings[0];\n\n    if (!binding) return null;\n\n    return {\n      name: binding.itemLabel.value,\n      description: '',\n      website_url: binding.website?.value || '',\n      location: binding.locationLabel?.value || '',\n      established: binding.established?.value ? new Date(binding.established.value).getFullYear() : null,\n      student_count: binding.studentCount?.value || null,\n      cover_images: [],\n    };\n  } catch (error) {\n    console.error('Error fetching from Wikidata:', error);\n    return null;\n  }\n}\n\n/**\n * Fetch Wikimedia Commons images for a university\n */\nexport async function fetchWikimediaImages(universityName) {\n  try {\n    const title = (universityName || '').trim().replace(/\\s+/g, '_');\n    if (!title) return [];\n\n    const listUrl = `https://commons.wikimedia.org/w/api.php?action=query&format=json&origin=*&prop=images&titles=${encodeURIComponent(title)}`;\n    const listRes = await fetch(listUrl);\n    if (!listRes.ok) return [];\n    const listJson = await listRes.json();\n\n    const pages = listJson?.query?.pages ? Object.values(listJson.query.pages) : [];\n    const images = pages[0]?.images || [];\n    if (!images.length) return [];\n\n    const fileTitles = images\n      .map((img) => img?.title)\n      .filter(Boolean)\n      .slice(0, 50)\n      .join('|');\n\n    if (!fileTitles) return [];\n\n    const infoUrl = `https://commons.wikimedia.org/w/api.php?action=query&format=json&origin=*&prop=imageinfo&iiprop=url&titles=${encodeURIComponent(fileTitles)}`;\n    const infoRes = await fetch(infoUrl);\n    if (!infoRes.ok) return [];\n    const infoJson = await infoRes.json();\n\n    const filePages = infoJson?.query?.pages ? Object.values(infoJson.query.pages) : [];\n    const urls = filePages\n      .map((p) => p?.imageinfo?.[0]?.url)\n      .filter((u) => typeof u === 'string' && /\\.(jpg|jpeg|png|webp)$/i.test(u));\n\n    const prioritized = urls.sort((a, b) => {\n      const deprioritize = (s) => /logo|seal|coat_of_arms|emblem/i.test(s) ? 1 : 0;\n      return deprioritize(a) - deprioritize(b);\n    });\n\n    return prioritized.slice(0, 5);\n  } catch (e) {\n    console.error('Error fetching Wikimedia images:', e);\n    return [];\n  }\n}\n\n/**\n * Fetch images from Unsplash (via backend proxy if enabled)\n */\nexport async function fetchUnsplashImages(universityName) {\n  if (USE_BACKEND_PROXY) {\n    try {\n      const response = await fetch(`${API_URL}/api/university/images?query=${encodeURIComponent(universityName)}`);\n      \n      if (response.ok) {\n        const data = await response.json();\n        return data.images?.map(img => img.url) || [];\n      }\n    } catch (error) {\n      console.error('Error fetching Unsplash images via proxy:', error);\n    }\n  }\n  \n  return [];\n}\n\n/**\n * Download image from URL and convert to File object\n */\nexport async function downloadImageAsFile(imageUrl, fileName) {\n  try {\n    const response = await fetch(imageUrl);\n    if (!response.ok) throw new Error('Failed to download image');\n\n    const blob = await response.blob();\n    const file = new File([blob], fileName, { type: blob.type });\n    return file;\n  } catch (error) {\n    console.error('Error downloading image:', error);\n    return null;\n  }\n}\n\n/**\n * Cache university prefill data\n */\nexport async function cacheUniversityPrefillData(universityName, data, source = 'manual') {\n  try {\n    const { error } = await supabase\n      .from('university_prefill_cache')\n      .upsert({\n        university_name: universityName,\n        data: data,\n        source: source,\n        updated_at: new Date().toISOString(),\n      });\n\n    if (error) throw error;\n    return true;\n  } catch (error) {\n    console.error('Error caching prefill data:', error);\n    return false;\n  }\n}\n\n/**\n * Upload multiple images for a university\n */\nexport async function uploadUniversityImages(universityId, imageFiles) {\n  try {\n    const uploadedImages = [];\n    const bucket = 'university-covers';\n\n    for (let i = 0; i < imageFiles.length; i++) {\n      const file = imageFiles[i];\n      const fileExt = file.name.split('.').pop();\n      const fileName = `${universityId}/image_${i + 1}_${Date.now()}.${fileExt}`;\n\n      const { error: uploadError } = await supabase.storage\n        .from(bucket)\n        .upload(fileName, file, {\n          cacheControl: '3600',\n          upsert: false,\n        });\n\n      if (uploadError) {\n        console.error('Error uploading image:', uploadError);\n        continue;\n      }\n\n      const { data: urlData } = supabase.storage\n        .from(bucket)\n        .getPublicUrl(fileName);\n\n      uploadedImages.push({\n        url: urlData.publicUrl,\n        fileName: fileName,\n      });\n    }\n\n    return uploadedImages;\n  } catch (error) {\n    console.error('Error uploading multiple images:', error);\n    throw error;\n  }\n}\n\n/**\n * Add image record to university_images table\n */\nexport async function addUniversityImage(universityId, imageUrl, caption = null, isPrimary = false, displayOrder = 0) {\n  try {\n    const { data, error } = await supabase\n      .rpc('add_university_image', {\n        p_university_id: universityId,\n        p_image_url: imageUrl,\n        p_caption: caption,\n        p_is_primary: isPrimary,\n        p_display_order: displayOrder,\n      });\n\n    if (error) throw error;\n    return data;\n  } catch (error) {\n    console.error('Error adding university image:', error);\n    throw error;\n  }\n}\n\n/**\n * Get all images for a university\n */\nexport async function getUniversityImages(universityId) {\n  try {\n    const { data, error } = await supabase\n      .from('university_images')\n      .select('*')\n      .eq('university_id', universityId)\n      .order('is_primary', { ascending: false })\n      .order('display_order', { ascending: true });\n\n    if (error) throw error;\n    return data || [];\n  } catch (error) {\n    console.error('Error fetching university images:', error);\n    throw error;\n  }\n}\n\n/**\n * Set image as primary\n */\nexport async function setPrimaryUniversityImage(imageId) {\n  try {\n    const { error } = await supabase\n      .rpc('set_primary_university_image', {\n        p_image_id: imageId,\n      });\n\n    if (error) throw error;\n    return true;\n  } catch (error) {\n    console.error('Error setting primary image:', error);\n    return false;\n  }\n}\n\n/**\n * Delete university image\n */\nexport async function deleteUniversityImage(imageId, imageUrl) {\n  try {\n    const urlParts = imageUrl.split('/');\n    const bucket = 'university-covers';\n    const filePath = urlParts.slice(urlParts.indexOf(bucket) + 1).join('/');\n\n    const { error: storageError } = await supabase.storage\n      .from(bucket)\n      .remove([filePath]);\n\n    if (storageError) {\n      console.error('Error deleting from storage:', storageError);\n    }\n\n    const { error: dbError } = await supabase\n      .from('university_images')\n      .delete()\n      .eq('id', imageId);\n\n    if (dbError) throw dbError;\n    return true;\n  } catch (error) {\n    console.error('Error deleting university image:', error);\n    throw error;\n  }\n}\n\n/**\n * Main auto-fill function triggered on tab/input\n */\nexport async function autoFillUniversityData(universityName) {\n  try {\n    // Check cache first\n    let data = await getUniversityPrefillData(universityName);\n    if (data) return data;\n\n    // Prefer Wikipedia + Wikidata for accuracy (no API keys needed)\n    const wikiSummary = await fetchUniversityDataFromWikipedia(universityName);\n    const wikidata = await fetchUniversityDataFromWikidata(universityName);\n\n    if (wikiSummary || wikidata) {\n      const merged = {\n        name: (wikiSummary?.name || wikidata?.name || universityName) ?? universityName,\n        description: wikiSummary?.description || '',\n        website_url: wikidata?.website_url || '',\n        location: wikidata?.location || '',\n        established: wikidata?.established ?? null,\n        student_count: wikidata?.student_count ?? null,\n        cover_images: wikiSummary?.cover_images || [],\n      };\n      data = merged;\n    }\n\n    // Try Google as last resort (via proxy if enabled)\n    if (!data) {\n      data = await fetchUniversityDataFromGoogle(universityName);\n    }\n\n    // Fetch images\n    if (data && (!data.cover_images || data.cover_images.length === 0)) {\n      const commons = await fetchWikimediaImages(data.name || universityName);\n      if (commons.length) {\n        data.cover_images = commons;\n      } else {\n        const unsplash = await fetchUnsplashImages(data.name || universityName);\n        data.cover_images = unsplash;\n      }\n    }\n\n    // Cache the result\n    if (data) {\n      await cacheUniversityPrefillData(universityName, data, 'wikipedia_wikidata');\n    }\n\n    return (\n      data || {\n        name: universityName,\n        description: '',\n        website_url: '',\n        location: '',\n        established: null,\n        student_count: null,\n        cover_images: [],\n      }\n    );\n  } catch (error) {\n    console.error('Error auto-filling university data:', error);\n    return {\n      name: universityName,\n      description: '',\n      website_url: '',\n      location: '',\n      established: null,\n      student_count: null,\n      cover_images: [],\n    };\n  }\n}\n\n/**\n * Get all cached universities for dropdown/autocomplete\n */\nexport async function getAllCachedUniversities() {\n  try {\n    const { data, error } = await supabase\n      .from('university_prefill_cache')\n      .select('university_name')\n      .order('university_name');\n\n    if (error) throw error;\n    return data?.map(u => u.university_name) || [];\n  } catch (error) {\n    console.error('Error fetching cached universities:', error);\n    return [];\n  }\n}\n\n/**\n * Debounce utility\n */\nfunction debounce(func, wait) {\n  let timeout;\n  return (...args) => {\n    clearTimeout(timeout);\n    timeout = setTimeout(() => func(...args), wait);\n  };\n}\n\n/**\n * Frontend integration for auto-fill\n */\nexport function setupAutoFill(inputElement, resultContainer) {\n  inputElement.addEventListener(\n    'input',\n    debounce(async () => {\n      const query = inputElement.value.trim();\n      if (query.length < 3) return;\n\n      const suggestions = await searchUniversityNames(query);\n      console.log('Suggestions:', suggestions);\n      \n      const datalist = document.createElement('datalist');\n      datalist.id = 'university-suggestions';\n      suggestions.forEach(s => {\n        const option = document.createElement('option');\n        option.value = s.name;\n        datalist.appendChild(option);\n      });\n      inputElement.setAttribute('list', 'university-suggestions');\n      inputElement.parentNode.appendChild(datalist);\n    }, 300)\n  );\n\n  inputElement.addEventListener('keydown', async (event) => {\n    if (event.key === 'Tab') {\n      event.preventDefault();\n      const universityName = inputElement.value.trim();\n      if (!universityName) return;\n\n      const data = await autoFillUniversityData(universityName);\n      if (data) {\n        resultContainer.innerHTML = `\n          <h3>${data.name}</h3>\n          <p>${data.description || 'No description available'}</p>\n          <a href=\"${data.website_url || '#'}\" target=\"_blank\">Website</a>\n          <p>Location: ${data.location || 'N/A'}</p>\n          <p>Established: ${data.established || 'N/A'}</p>\n          <p>Students: ${data.student_count || 'N/A'}</p>\n          <div>\n            ${data.cover_images\n              .map(img => `<img src=\"${img}\" alt=\"${data.name} campus\" width=\"200\" style=\"margin-right: 10px;\" />`)\n              .join('')}\n          </div>\n        `;\n      }\n    }\n  });\n}"],"names":["_ref","userProfile","loading","setLoading","useState","rows","setRows","count","setCount","page","setPage","pageSize","search","setSearch","categories","setCategories","categoryId","setCategoryId","sort","setSort","col","dir","editingId","setEditingId","editDraft","setEditDraft","newPdf","setNewPdf","newCover","setNewCover","confirm","showToast","useAdminUI","ADMIN_EMAILS","isAdmin","role","includes","email","isEditor","totalPages","useMemo","Math","max","ceil","load","async","data","total","fetchBooks","useEffect","fetchCategories","_unused","canEdit","row","cancelEdit","toggleSort","s","_jsx","children","_jsxs","className","length","style","display","gridTemplateColumns","gap","marginBottom","background","border","borderRadius","padding","color","fontSize","fontWeight","reduce","sum","r","downloads","views","comments_count","likes_count","value","onChange","e","target","placeholder","map","c","id","name","onClick","window","location","href","overflowX","WebkitOverflowScrolling","minWidth","borderCollapse","borderSpacing","width","cursor","borderBottom","colSpan","textAlign","_categories$find","cover_url","src","alt","height","objectFit","title","_objectSpread","author","category_id","find","year","type","pages","publisher","Date","created_at","toLocaleDateString","flexDirection","document","getElementById","concat","click","alignItems","transition","accept","_e$target$files","files","_Fragment","slice","_e$target$files2","marginTop","message","updates","updateBook","newPdfFile","newCoverFile","oldFilePath","file_path","console","error","saveEdit","language","isbn","startEdit","disabled","confirmLabel","cancelLabel","variant","deleteBook","handleDelete","justifyContent","p","opacity","min","paperCounts","setPaperCounts","fetchUniversities","counts","uni","getPastPaperCountByUniversity","_row$description","_row$student_count","cover_image_url","description","established","student_count","toLocaleString","undefined","Number","updateUniversity","website_url","deleteUniversity","err","formatTimestamp","isoString","month","day","hour","minute","second","hour12","timeZoneName","faculties","setFaculties","facultyFilter","setFacultyFilter","selectedIds","setSelectedIds","Set","allPaperIds","setAllPaperIds","useCustomFaculty","setUseCustomFaculty","customFaculty","setCustomFaculty","isMultiEditMode","setIsMultiEditMode","showCheckboxes","setShowCheckboxes","fetchPastPapers","faculty","getFaculties","cancelMultiEdit","downloads_count","views_count","trim","f","margin","size","unit_name","unit_code","checked","htmlFor","semester","exam_type","Object","keys","papersToUpdate","Array","from","cachedRow","cached","missingIds","filter","missingPapersMap","Map","allSelectedPapers","updatePromises","batchSize","get","push","updatePastPaper","Promise","all","warn","startMultiEdit","visibleSelectedIds","some","every","toggleSelectAll","item","fetchAllMatchingIds","then","allIds","_row$profiles","_row$profiles2","_row$profiles3","has","toggleSelectRow","prev","newSet","delete","add","profiles","full_name","deletePastPaper","getAllAuthorsEngagementStats","limit","arguments","supabase","select","order","ascending","Authors","stats","setStats","engagementStats","setEngagementStats","searchTerm","setSearchTerm","sortBy","setSortBy","timeRange","setTimeRange","loadData","statsData","engageData","fetchStats","engageMap","forEach","stat","author_name","interval","setInterval","clearInterval","filteredAndSorted","authors","filtered","toLowerCase","a","b","authorEngageA","authorEngageB","engagement_score","bookCount","totalDownloads","followers_count","parseFloat","avgRating","localeCompare","overallStats","totalAuthors","totalBooks","totalDL","totalFollowers","totalLikes","totalLoves","totalComments","toFixed","values","loves_count","FiTrendingUp","FiBook","FiDownload","FiStar","FiUsers","MdFavoriteBorder","FiHeart","FiMessageSquare","FiSearch","idx","engage","engScore","medal","FiThumbsUp","average_rating","searchParams","useSearchParams","activeTab","setActiveTab","tabParam","React","styleTag","createElement","innerHTML","head","appendChild","remove","FiMapPin","FiFileText","FiBookOpen","Books","UniversitiesManagement","PastPapersManagement","USE_BACKEND_PROXY","searchUniversityNames","query","rpc","p_query","p_limit","wikiResults","searchUrl","encodeURIComponent","response","fetch","ok","json","titles","descriptions","urls","index","searchWikipediaUniversities","cacheUniversityPrefillData","API_URL","universities","proxyError","fetchWikimediaImages","universityName","_listJson$query","_pages$","_infoJson$query","replace","listUrl","listRes","listJson","images","fileTitles","img","Boolean","join","infoUrl","infoRes","infoJson","_p$imageinfo","_p$imageinfo$","imageinfo","url","u","test","deprioritize","fetchUnsplashImages","_data$images","downloadImageAsFile","imageUrl","fileName","Error","blob","File","source","upsert","university_name","updated_at","toISOString","autoFillUniversityData","p_university_name","getUniversityPrefillData","wikiSummary","_json$thumbnail","res","extract","cover_images","thumbnail","fetchUniversityDataFromWikipedia","wikidata","_binding$website","_binding$locationLabe","_binding$established","_binding$studentCount","sparqlQuery","binding","results","bindings","itemLabel","website","locationLabel","getFullYear","studentCount","fetchUniversityDataFromWikidata","_wikidata$established","_wikidata$student_cou","university","image","fetchUniversityDataFromGoogle","commons","unsplash"],"ignoreList":[],"sourceRoot":""}