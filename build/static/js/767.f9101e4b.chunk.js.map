{"version":3,"file":"static/js/767.f9101e4b.chunk.js","mappings":"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","sources":["SomaLux/Books/Admin/pages/Books.jsx","SomaLux/Books/Admin/pages/UniversitiesManagement.jsx","SomaLux/Books/Admin/pages/PastPapersManagement.jsx","SomaLux/Books/Admin/authorInteractionsApi.js","SomaLux/Books/Admin/pages/Authors.jsx","SomaLux/Books/Admin/pages/ContentManagement.jsx","SomaLux/Books/Admin/universityPrefillApi.js"],"sourcesContent":["import React, { useEffect, useMemo, useState } from 'react';\r\nimport { fetchBooks, fetchCategories, deleteBook, updateBook } from '../api';\r\nimport { useAdminUI } from '../AdminUIContext';\r\n\r\nconst Books = ({ userProfile }) => {\r\n  const [loading, setLoading] = useState(true);\r\n  const [rows, setRows] = useState([]);\r\n  const [count, setCount] = useState(0);\r\n  const [page, setPage] = useState(1);\r\n  const [pageSize] = useState(23);\r\n  const [search, setSearch] = useState('');\r\n  const [categories, setCategories] = useState([]);\r\n  const [categoryId, setCategoryId] = useState(null);\r\n  const [sort, setSort] = useState({ col: 'created_at', dir: 'desc' });\r\n  const [editingId, setEditingId] = useState(null);\r\n  const [selectedIds, setSelectedIds] = useState(new Set());\r\n  const [editDraft, setEditDraft] = useState({});\r\n  const [newPdf, setNewPdf] = useState(null);\r\n  const [newCover, setNewCover] = useState(null);\r\n  const [isMultiEditMode, setIsMultiEditMode] = useState(false);\r\n  const [showCheckboxes, setShowCheckboxes] = useState(false);\r\n  const [useCustomCategory, setUseCustomCategory] = useState(false);\r\n  const [customCategory, setCustomCategory] = useState('');\r\n\r\n  const { confirm, showToast } = useAdminUI();\r\n\r\n  const ADMIN_EMAILS = ['campuslives254@gmail.com', 'paltechsomalux@gmail.com'];\r\n  const isAdmin = userProfile?.role === 'admin' || ADMIN_EMAILS.includes(userProfile?.email);\r\n  const isEditor = userProfile?.role === 'editor' || ADMIN_EMAILS.includes(userProfile?.email);\r\n\r\n  const totalPages = useMemo(() => Math.max(1, Math.ceil(count / pageSize)), [count, pageSize]);\r\n\r\n  const load = async () => {\r\n    setLoading(true);\r\n    try {\r\n      const fetchParams = { \r\n        page, \r\n        pageSize, \r\n        search, \r\n        sort\r\n      };\r\n      // Handle uncategorized filter\r\n      if (categoryId === 'uncategorized') {\r\n        fetchParams.uncategorized = true;\r\n      } else if (categoryId) {\r\n        fetchParams.categoryId = categoryId;\r\n      }\r\n      \r\n      const { data, count: total } = await fetchBooks(fetchParams);\r\n      \r\n      setRows(data);\r\n      setCount(total);\r\n    } finally { setLoading(false); }\r\n  };\r\n\r\n  // Fetch all book IDs matching current filters (no pagination)\r\n  const fetchAllMatchingIds = async () => {\r\n    try {\r\n      const fetchParams = { \r\n        page: 1, \r\n        pageSize: 10000, \r\n        search, \r\n        sort \r\n      };\r\n      // Handle uncategorized filter\r\n      if (categoryId === 'uncategorized') {\r\n        fetchParams.uncategorized = true;\r\n      } else if (categoryId) {\r\n        fetchParams.categoryId = categoryId;\r\n      }\r\n      \r\n      const { data } = await fetchBooks(fetchParams);\r\n      return new Set(data.map(item => item.id));\r\n    } catch (error) {\r\n      console.error('Failed to fetch all matching books:', error);\r\n      return new Set();\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    (async () => {\r\n      try { setCategories(await fetchCategories()); } catch {}\r\n      if (userProfile) {\r\n        await load();\r\n      }\r\n    })();\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  }, [page, search, categoryId, sort.col, sort.dir, userProfile]);\r\n\r\n  const canEdit = (row) => {\r\n    if (isAdmin) return true;\r\n    if (isEditor) return true;\r\n    return false;\r\n  };\r\n\r\n  const startEdit = (row) => {\r\n    if (!canEdit(row)) {\r\n      showToast({ type: 'error', message: 'You do not have permission to edit this book.' });\r\n      return;\r\n    }\r\n    setEditingId(row.id);\r\n    setEditDraft({\r\n      title: row.title || '',\r\n      author: row.author || '',\r\n      year: row.year || '',\r\n      category_id: row.category_id || null,\r\n      language: row.language || '',\r\n      isbn: row.isbn || '',\r\n      pages: row.pages || '',\r\n      publisher: row.publisher || ''\r\n    });\r\n    setNewPdf(null);\r\n    setNewCover(null);\r\n  };\r\n\r\n  const cancelEdit = () => {\r\n    setEditingId(null);\r\n    setEditDraft({});\r\n    setNewPdf(null);\r\n    setNewCover(null);\r\n    setUseCustomCategory(false);\r\n    setCustomCategory('');\r\n  };\r\n\r\n  // Multi-select handlers\r\n  const toggleSelectRow = (id) => {\r\n    setSelectedIds(prev => {\r\n      const newSet = new Set(prev);\r\n      if (newSet.has(id)) {\r\n        newSet.delete(id);\r\n      } else {\r\n        newSet.add(id);\r\n      }\r\n      return newSet;\r\n    });\r\n  };\r\n\r\n  const toggleSelectAll = () => {\r\n    if (selectedIds.size === count && count > 0) {\r\n      setSelectedIds(new Set());\r\n    } else {\r\n      fetchAllMatchingIds().then(allIds => {\r\n        setSelectedIds(allIds);\r\n      });\r\n    }\r\n  };\r\n\r\n  const startMultiEdit = () => {\r\n    if (selectedIds.size === 0) {\r\n      showToast({ type: 'error', message: 'Please select at least one book to edit.' });\r\n      return;\r\n    }\r\n    \r\n    const visibleSelectedIds = Array.from(selectedIds).filter(id => rows.some(r => r.id === id));\r\n    if (visibleSelectedIds.length > 0) {\r\n      const canEditVisible = visibleSelectedIds.every(id => {\r\n        const row = rows.find(r => r.id === id);\r\n        return canEdit(row);\r\n      });\r\n\r\n      if (!canEditVisible) {\r\n        showToast({ type: 'error', message: 'You do not have permission to edit some of the selected books.' });\r\n        return;\r\n      }\r\n    }\r\n\r\n    setIsMultiEditMode(true);\r\n    setEditDraft({\r\n      title: '', author: '', category_id: '', year: '', publisher: ''\r\n    });\r\n  };\r\n\r\n  const cancelMultiEdit = () => {\r\n    setIsMultiEditMode(false);\r\n    setEditDraft({});\r\n    setSelectedIds(new Set());\r\n    setShowCheckboxes(false);\r\n    setUseCustomCategory(false);\r\n    setCustomCategory('');\r\n  };\r\n\r\n  const saveMultiEdit = async () => {\r\n    if (selectedIds.size === 0) {\r\n      showToast({ type: 'error', message: 'No books selected.' });\r\n      return;\r\n    }\r\n\r\n    const updates = {};\r\n    if (editDraft.title) updates.title = editDraft.title;\r\n    if (editDraft.author) updates.author = editDraft.author;\r\n    if (editDraft.category_id !== '' || useCustomCategory) updates.category_id = useCustomCategory ? customCategory : editDraft.category_id;\r\n    if (editDraft.year) updates.year = editDraft.year;\r\n    if (editDraft.publisher) updates.publisher = editDraft.publisher;\r\n\r\n    if (Object.keys(updates).length === 0) {\r\n      showToast({ type: 'error', message: 'Please enter at least one field to update.' });\r\n      return;\r\n    }\r\n\r\n    try {\r\n      const booksToUpdate = Array.from(selectedIds).map(id => {\r\n        const cachedRow = rows.find(r => r.id === id);\r\n        return { id, cached: cachedRow };\r\n      });\r\n\r\n      const missingIds = booksToUpdate.filter(p => !p.cached).map(p => p.id);\r\n      let missingBooksMap = new Map();\r\n      \r\n      if (missingIds.length > 0) {\r\n        const { data: allSelectedBooks } = await fetchBooks({ \r\n          page: 1, \r\n          pageSize: 10000, \r\n          search, \r\n          categoryId, \r\n          sort \r\n        });\r\n        missingBooksMap = new Map(allSelectedBooks.map(p => [p.id, p]));\r\n      }\r\n\r\n      const updatePromises = [];\r\n      const batchSize = 5;\r\n      \r\n      for (const { id, cached } of booksToUpdate) {\r\n        const row = cached || missingBooksMap.get(id);\r\n        if (!row) {\r\n          console.warn(`Book with ID ${id} not found`);\r\n          continue;\r\n        }\r\n        \r\n        updatePromises.push(\r\n          updateBook(id, { \r\n            updates, \r\n            newPdfFile: null, \r\n            newCoverFile: null, \r\n            oldFilePath: row.file_path \r\n          })\r\n        );\r\n\r\n        if (updatePromises.length >= batchSize) {\r\n          await Promise.all(updatePromises);\r\n          updatePromises.length = 0;\r\n        }\r\n      }\r\n\r\n      if (updatePromises.length > 0) {\r\n        await Promise.all(updatePromises);\r\n      }\r\n\r\n      cancelMultiEdit();\r\n      setLoading(true);\r\n      const { data, count: total } = await fetchBooks({ page, pageSize, search, categoryId, sort });\r\n      setRows(data);\r\n      setCount(total);\r\n      setLoading(false);\r\n      \r\n      showToast({ type: 'success', message: `${selectedIds.size} book(s) updated successfully.` });\r\n    } catch (e) {\r\n      console.error('Failed to update books:', e?.message || e);\r\n      showToast({ type: 'error', message: e?.message || 'Failed to update books.' });\r\n    }\r\n  };\r\n\r\n  const saveEdit = async (row) => {\r\n    if (!canEdit(row)) {\r\n      showToast({ type: 'error', message: 'You can only edit books you uploaded.' });\r\n      return;\r\n    }\r\n    const updates = { ...editDraft };\r\n    // Use custom category if selected, otherwise use the one from edit draft\r\n    if (useCustomCategory && customCategory) {\r\n      updates.category_id = customCategory;\r\n    }\r\n\r\n    try {\r\n      await updateBook(row.id, { updates, newPdfFile: newPdf, newCoverFile: newCover, oldFilePath: row.file_path });\r\n      cancelEdit();\r\n      await load();\r\n      showToast({ type: 'success', message: 'Book details updated.' });\r\n    } catch (e) {\r\n      console.error('Failed to update book:', e);\r\n      showToast({ type: 'error', message: e?.message || 'Failed to update book.' });\r\n    }\r\n  };\r\n\r\n  const handleDelete = async (row) => {\r\n    if (!canEdit(row)) {\r\n      showToast({ type: 'error', message: 'You can only delete books you uploaded.' });\r\n      return;\r\n    }\r\n    const ok = await confirm({\r\n      title: 'Delete book?',\r\n      message: `Delete \"${row.title}\" and its files? This action cannot be undone.`,\r\n      confirmLabel: 'Delete',\r\n      cancelLabel: 'Cancel',\r\n      variant: 'danger',\r\n    });\r\n    if (!ok) return;\r\n\r\n    try {\r\n      await deleteBook({ id: row.id, file_path: row.file_path });\r\n      await load();\r\n      showToast({ type: 'success', message: 'Book deleted.' });\r\n    } catch (e) {\r\n      console.error('Failed to delete book:', e);\r\n      showToast({ type: 'error', message: e?.message || 'Failed to delete book.' });\r\n    }\r\n  };\r\n\r\n  const toggleSort = (col) => {\r\n    setSort((s) => (s.col === col ? { col, dir: s.dir === 'asc' ? 'desc' : 'asc' } : { col, dir: 'asc' }));\r\n  };\r\n\r\n  return (\r\n    <div>\r\n      <div className=\"panel\">\r\n        <div className=\"panel-title\">Books Management</div>\r\n\r\n        {/* Stats Summary */}\r\n        {!loading && rows.length > 0 && (\r\n          <div style={{ display: 'grid', gridTemplateColumns: 'repeat(auto-fit, minmax(150px, 1fr))', gap: '8px', marginBottom: '12px' }}>\r\n            <div style={{ background: '#0b1216', boxShadow: '0 2px 8px rgba(0, 0, 0, 0.3)', borderRadius: '6px', padding: '8px 12px', color: '#8696a0', fontSize: '0.85rem' }}>\r\n              <div style={{ color: '#00a884', fontSize: '1.2rem', fontWeight: '600' }}>{rows.reduce((sum, r) => sum + (r.downloads || 0), 0)}</div>\r\n              <div>Total Downloads</div>\r\n            </div>\r\n            <div style={{ background: '#0b1216', boxShadow: '0 2px 8px rgba(0, 0, 0, 0.3)', borderRadius: '6px', padding: '8px 12px', color: '#8696a0', fontSize: '0.85rem' }}>\r\n              <div style={{ color: '#34B7F1', fontSize: '1.2rem', fontWeight: '600' }}>{rows.reduce((sum, r) => sum + (r.views || 0), 0)}</div>\r\n              <div>Total Views</div>\r\n            </div>\r\n            <div style={{ background: '#0b1216', boxShadow: '0 2px 8px rgba(0, 0, 0, 0.3)', borderRadius: '6px', padding: '8px 12px', color: '#8696a0', fontSize: '0.85rem' }}>\r\n              <div style={{ color: '#FF6B9D', fontSize: '1.2rem', fontWeight: '600' }}>{rows.reduce((sum, r) => sum + (r.comments_count || 0), 0)}</div>\r\n              <div>Total Comments</div>\r\n            </div>\r\n            <div style={{ background: '#0b1216', boxShadow: '0 2px 8px rgba(0, 0, 0, 0.3)', borderRadius: '6px', padding: '8px 12px', color: '#8696a0', fontSize: '0.85rem' }}>\r\n              <div style={{ color: '#F44336', fontSize: '1.2rem', fontWeight: '600' }}>{rows.reduce((sum, r) => sum + (r.likes_count || 0), 0)}</div>\r\n              <div>Total Likes</div>\r\n            </div>\r\n            <div style={{ background: '#0b1216', boxShadow: '0 2px 8px rgba(0, 0, 0, 0.3)', borderRadius: '6px', padding: '8px 12px', color: '#8696a0', fontSize: '0.85rem' }}>\r\n              <div style={{ color: '#FFCC00', fontSize: '1.2rem', fontWeight: '600' }}>{rows.length}/{count}</div>\r\n              <div>Page Books</div>\r\n            </div>\r\n          </div>\r\n        )}\r\n\r\n        <div className=\"grid-2\" style={{ marginBottom: 6 }}>\r\n          <div className=\"panel\" style={{ padding: '6px 8px' }}>\r\n            <label className=\"label\" style={{ marginBottom: '0.2rem' }}>Search</label>\r\n            <input className=\"input\" value={search} onChange={(e) => { setPage(1); setSearch(e.target.value); }} placeholder=\"Search by title...\" style={{ fontSize: '0.9rem' }} />\r\n          </div>\r\n          <div className=\"panel\" style={{ padding: '6px 8px' }}>\r\n            <label className=\"label\" style={{ marginBottom: '0.2rem' }}>Category</label>\r\n            <select className=\"select\" value={categoryId || ''} onChange={(e) => { setPage(1); setCategoryId(e.target.value || null); }} style={{ fontSize: '0.9rem' }}>\r\n              <option value=\"\">All</option>\r\n              <option value=\"uncategorized\">Uncategorized</option>\r\n              {categories.map(c => <option key={c.id} value={c.id}>{c.name}</option>)}\r\n            </select>\r\n          </div>\r\n        </div>\r\n\r\n        <div className=\"actions\" style={{ marginBottom: 10 }}>\r\n          <button className=\"btn primary\" onClick={() => (window.location.href = '/books/admin/upload')}>Add / Upload New Book</button>\r\n          {!showCheckboxes && (\r\n            <button \r\n              className=\"btn\" \r\n              onClick={() => setShowCheckboxes(true)}\r\n              style={{ background: '#00a884', color: '#e9edef' }}\r\n            >\r\n               Bulk Edit\r\n            </button>\r\n          )}\r\n          {showCheckboxes && !isMultiEditMode && (\r\n            <button \r\n              className=\"btn\" \r\n              onClick={() => {\r\n                setShowCheckboxes(false);\r\n                setSelectedIds(new Set());\r\n              }}\r\n              style={{ background: '#2a3f56', color: '#e9edef' }}\r\n            >\r\n               Cancel Selection\r\n            </button>\r\n          )}\r\n        </div>\r\n\r\n        {/* Multi-Edit Mode Toolbar */}\r\n        {isMultiEditMode && (\r\n          <div style={{ \r\n            background: '#0b1216', \r\n            borderRadius: '6px', \r\n            padding: '12px',\r\n            marginBottom: '12px',\r\n            boxShadow: '0 4px 12px rgba(0, 0, 0, 0.4)'\r\n          }}>\r\n            <div style={{ marginBottom: '12px', display: 'flex', justifyContent: 'space-between', alignItems: 'center' }}>\r\n              <h3 style={{ margin: 0, color: '#00a884' }}>\r\n                Edit {selectedIds.size} Book{selectedIds.size !== 1 ? 's' : ''}\r\n              </h3>\r\n              <button \r\n                className=\"btn\" \r\n                onClick={cancelMultiEdit}\r\n                style={{ background: '#2a3f56', color: '#e9edef' }}\r\n              >\r\n                Cancel\r\n              </button>\r\n            </div>\r\n\r\n            <div className=\"grid-2\" style={{ gap: '12px', marginBottom: '12px' }}>\r\n              <div>\r\n                <label className=\"label\" style={{ fontSize: '13px' }}>Title</label>\r\n                <input \r\n                  className=\"input\" \r\n                  placeholder=\"Leave blank to skip\" \r\n                  value={editDraft.title || ''} \r\n                  onChange={(e) => setEditDraft({ ...editDraft, title: e.target.value })} \r\n                />\r\n              </div>\r\n              <div>\r\n                <label className=\"label\" style={{ fontSize: '13px' }}>Author</label>\r\n                <input \r\n                  className=\"input\" \r\n                  placeholder=\"Leave blank to skip\" \r\n                  value={editDraft.author || ''} \r\n                  onChange={(e) => setEditDraft({ ...editDraft, author: e.target.value })} \r\n                />\r\n              </div>\r\n              <div>\r\n                <label className=\"label\" style={{ fontSize: '13px' }}>Category</label>\r\n                {!useCustomCategory ? (\r\n                  <select \r\n                    className=\"select\" \r\n                    value={editDraft.category_id || ''} \r\n                    onChange={(e) => setEditDraft({ ...editDraft, category_id: e.target.value })}\r\n                  >\r\n                    <option value=\"\">Leave blank to skip</option>\r\n                    {categories && categories.length > 0 ? categories.map(c => <option key={c.id} value={c.id}>{c.name}</option>) : <option value=\"\">No categories available</option>}\r\n                  </select>\r\n                ) : (\r\n                  <input \r\n                    className=\"input\" \r\n                    placeholder=\"e.g., Engineering\" \r\n                    value={customCategory} \r\n                    onChange={(e) => setCustomCategory(e.target.value)}\r\n                  />\r\n                )}\r\n                <div style={{ display: 'flex', alignItems: 'center', gap: '4px', marginTop: '4px', fontSize: '12px' }}>\r\n                  <input \r\n                    type=\"checkbox\" \r\n                    id=\"custom-category-multi\"\r\n                    checked={useCustomCategory}\r\n                    onChange={(e) => {\r\n                      setUseCustomCategory(e.target.checked);\r\n                      if (!e.target.checked) {\r\n                        setCustomCategory('');\r\n                      }\r\n                    }}\r\n                    style={{ width: '14px', height: '14px', cursor: 'pointer' }}\r\n                  />\r\n                  <label htmlFor=\"custom-category-multi\" style={{ color: '#8696a0', cursor: 'pointer' }}>\r\n                    Add custom category\r\n                  </label>\r\n                </div>\r\n              </div>\r\n              <div>\r\n                <label className=\"label\" style={{ fontSize: '13px' }}>Year</label>\r\n                <input \r\n                  className=\"input\" \r\n                  placeholder=\"Leave blank to skip\" \r\n                  value={editDraft.year || ''} \r\n                  onChange={(e) => setEditDraft({ ...editDraft, year: e.target.value })} \r\n                />\r\n              </div>\r\n              <div>\r\n                <label className=\"label\" style={{ fontSize: '13px' }}>Publisher</label>\r\n                <input \r\n                  className=\"input\" \r\n                  placeholder=\"Leave blank to skip\" \r\n                  value={editDraft.publisher || ''} \r\n                  onChange={(e) => setEditDraft({ ...editDraft, publisher: e.target.value })} \r\n                />\r\n              </div>\r\n            </div>\r\n\r\n            <div style={{ display: 'flex', gap: '8px', justifyContent: 'flex-end' }}>\r\n              <button \r\n                className=\"btn primary\" \r\n                onClick={saveMultiEdit}\r\n                style={{ background: '#00a884' }}\r\n              >\r\n                Save Changes to All {selectedIds.size} Book{selectedIds.size !== 1 ? 's' : ''}\r\n              </button>\r\n              <button \r\n                className=\"btn\" \r\n                onClick={cancelMultiEdit}\r\n                style={{ background: '#2a3f56', color: '#e9edef' }}\r\n              >\r\n                Cancel\r\n              </button>\r\n            </div>\r\n          </div>\r\n        )}\r\n\r\n        {/* Selection Toolbar */}\r\n        {selectedIds.size > 0 && !isMultiEditMode && (\r\n          <div style={{ \r\n            background: '#0b1216', \r\n            borderRadius: '6px', \r\n            padding: '12px',\r\n            marginBottom: '12px',\r\n            display: 'flex',\r\n            justifyContent: 'space-between',\r\n            alignItems: 'center',\r\n            boxShadow: '0 4px 12px rgba(0, 0, 0, 0.4)'\r\n          }}>\r\n            <span style={{ color: '#8696a0' }}>\r\n              {selectedIds.size} item{selectedIds.size !== 1 ? 's' : ''} selected\r\n            </span>\r\n            <div style={{ display: 'flex', gap: '8px' }}>\r\n              <button \r\n                className=\"btn primary\" \r\n                onClick={startMultiEdit}\r\n                style={{ background: '#00a884' }}\r\n              >\r\n                Edit Selected ({selectedIds.size})\r\n              </button>\r\n              <button \r\n                className=\"btn\" \r\n                onClick={() => setSelectedIds(new Set())}\r\n                style={{ background: '#2a3f56', color: '#e9edef' }}\r\n              >\r\n                Clear Selection\r\n              </button>\r\n            </div>\r\n          </div>\r\n        )}\r\n\r\n        <div className=\"panel\" style={{ padding: 0, overflowX: 'auto', WebkitOverflowScrolling: 'touch' }}>\r\n          <table className=\"table\" style={{ minWidth: '1620px', borderCollapse: 'separate', borderSpacing: 0 }}>\r\n            <thead>\r\n              <tr>\r\n                {showCheckboxes && (\r\n                  <th style={{ width: '40px' }}>\r\n                    <input\r\n                      type=\"checkbox\"\r\n                      checked={selectedIds.size === count && count > 0}\r\n                      onChange={toggleSelectAll}\r\n                      style={{ width: '16px', height: '16px', cursor: 'pointer' }}\r\n                      title={selectedIds.size === count && count > 0 ? 'Unselect all' : 'Select all across all pages'}\r\n                    />\r\n                  </th>\r\n                )}\r\n                <th style={{ width: '60px' }}>Cover</th>\r\n                <th style={{ width: '300px', cursor: 'pointer' }} onClick={() => toggleSort('title')}>Title {sort.col === 'title' ? (sort.dir === 'asc' ? '' : '') : ''}</th>\r\n                <th style={{ width: '200px', cursor: 'pointer' }} onClick={() => toggleSort('author')}>Author {sort.col === 'author' ? (sort.dir === 'asc' ? '' : '') : ''}</th>\r\n                <th style={{ width: '120px' }}>Category</th>\r\n                <th style={{ width: '100px', cursor: 'pointer' }} onClick={() => toggleSort('year')}>Year {sort.col === 'year' ? (sort.dir === 'asc' ? '' : '') : ''}</th>\r\n                <th style={{ width: '100px' }}>Pages</th>\r\n                <th style={{ width: '180px' }}>Publisher</th>\r\n                <th style={{ width: '100px', cursor: 'pointer' }} onClick={() => toggleSort('downloads')}>Downloads {sort.col === 'downloads' ? (sort.dir === 'asc' ? '' : '') : ''}</th>\r\n                <th style={{ width: '80px', cursor: 'pointer', background: 'rgba(52, 183, 241, 0.1)', borderBottom: '2px solid #34B7F1' }} onClick={() => toggleSort('views')}>Views {sort.col === 'views' ? (sort.dir === 'asc' ? '' : '') : ''}</th>\r\n                <th style={{ width: '80px', cursor: 'pointer', background: 'rgba(255, 107, 157, 0.1)', borderBottom: '2px solid #FF6B9D' }} onClick={() => toggleSort('comments_count')}>Comments {sort.col === 'comments_count' ? (sort.dir === 'asc' ? '' : '') : ''}</th>\r\n                <th style={{ width: '80px', cursor: 'pointer', background: 'rgba(244, 67, 54, 0.1)', borderBottom: '2px solid #F44336' }} onClick={() => toggleSort('likes_count')}>Likes {sort.col === 'likes_count' ? (sort.dir === 'asc' ? '' : '') : ''}</th>\r\n                <th style={{ width: '100px' }}>Date Added</th>\r\n                <th style={{ width: '200px' }}>Actions</th>\r\n              </tr>\r\n            </thead>\r\n            <tbody>\r\n              {loading ? (\r\n                <tr><td colSpan={showCheckboxes ? 14 : 13} style={{ color: '#8696a0', textAlign: 'center' }}>Loading...</td></tr>\r\n              ) : rows.length === 0 ? (\r\n                <tr><td colSpan={showCheckboxes ? 14 : 13} style={{ color: '#8696a0', textAlign: 'center' }}>No data</td></tr>\r\n              ) : rows.map(row => (\r\n                <tr key={row.id} style={{ background: selectedIds.has(row.id) ? 'rgba(0, 168, 132, 0.1)' : 'transparent' }}>\r\n                  {showCheckboxes && (\r\n                    <td style={{ textAlign: 'center' }}>\r\n                      <input\r\n                        type=\"checkbox\"\r\n                        checked={selectedIds.has(row.id)}\r\n                        onChange={() => toggleSelectRow(row.id)}\r\n                        disabled={isMultiEditMode}\r\n                        style={{ width: '16px', height: '16px', cursor: 'pointer' }}\r\n                      />\r\n                    </td>\r\n                  )}\r\n                  <td>{row.cover_url ? <img src={row.cover_url} alt=\"cover\" style={{ width: 36, height: 48, objectFit: 'cover', borderRadius: 4 }} /> : <span className=\"badge\">No cover</span>}</td>\r\n                  <td>\r\n                    {editingId === row.id ? (\r\n                      <input className=\"input\" value={editDraft.title} onChange={(e) => setEditDraft({ ...editDraft, title: e.target.value })} />\r\n                    ) : row.title}\r\n                  </td>\r\n                  <td>\r\n                    {editingId === row.id ? (\r\n                      <input className=\"input\" value={editDraft.author} onChange={(e) => setEditDraft({ ...editDraft, author: e.target.value })} />\r\n                    ) : row.author}\r\n                  </td>\r\n                  <td>\r\n                    {editingId === row.id ? (\r\n                      <div style={{ display: 'flex', flexDirection: 'column', gap: '4px' }}>\r\n                        {!useCustomCategory ? (\r\n                          <select className=\"select\" value={editDraft.category_id || ''} onChange={(e) => setEditDraft({ ...editDraft, category_id: e.target.value || null })}>\r\n                            <option value=\"\">Uncategorized</option>\r\n                            {categories.map(c => <option key={c.id} value={c.id}>{c.name}</option>)}\r\n                          </select>\r\n                        ) : (\r\n                          <input \r\n                            className=\"input\" \r\n                            placeholder=\"e.g., Engineering\" \r\n                            value={customCategory} \r\n                            onChange={(e) => setCustomCategory(e.target.value)}\r\n                          />\r\n                        )}\r\n                        <div style={{ display: 'flex', alignItems: 'center', gap: '4px', fontSize: '12px' }}>\r\n                          <input \r\n                            type=\"checkbox\" \r\n                            id=\"custom-category-edit\"\r\n                            checked={useCustomCategory}\r\n                            onChange={(e) => {\r\n                              setUseCustomCategory(e.target.checked);\r\n                              if (!e.target.checked) {\r\n                                setCustomCategory('');\r\n                              }\r\n                            }}\r\n                            style={{ width: '14px', height: '14px', cursor: 'pointer' }}\r\n                          />\r\n                          <label htmlFor=\"custom-category-edit\" style={{ color: '#8696a0', cursor: 'pointer' }}>\r\n                            Custom\r\n                          </label>\r\n                        </div>\r\n                      </div>\r\n                    ) : (categories.find(c => c.id === row.category_id)?.name || '')}\r\n                  </td>\r\n                  <td>\r\n                    {editingId === row.id ? (\r\n                      <input className=\"input\" value={editDraft.year} onChange={(e) => setEditDraft({ ...editDraft, year: e.target.value })} />\r\n                    ) : (row.year || '')}\r\n                  </td>\r\n                  <td>\r\n                    {editingId === row.id ? (\r\n                      <input className=\"input\" type=\"number\" placeholder=\"Pages\" value={editDraft.pages} onChange={(e) => setEditDraft({ ...editDraft, pages: e.target.value })} />\r\n                    ) : (row.pages || '')}\r\n                  </td>\r\n                  <td>\r\n                    {editingId === row.id ? (\r\n                      <input className=\"input\" placeholder=\"Publisher\" value={editDraft.publisher} onChange={(e) => setEditDraft({ ...editDraft, publisher: e.target.value })} />\r\n                    ) : (row.publisher || '')}\r\n                  </td>\r\n                  <td>{row.downloads || 0}</td>\r\n                  <td style={{ fontWeight: '500', color: '#00a884' }}>{row.views || 0}</td>\r\n                  <td style={{ fontWeight: '500', color: '#FF6B9D' }}>{row.comments_count || 0}</td>\r\n                  <td style={{ fontWeight: '500', color: '#F44336' }}>{row.likes_count || 0}</td>\r\n                  <td>{new Date(row.created_at).toLocaleDateString()}</td>\r\n                  <td>\r\n                    {editingId === row.id ? (\r\n                      <div style={{ display: 'flex', flexDirection: 'column', gap: '10px', minWidth: '180px' }}>\r\n                        <div>\r\n                          <label className=\"label\">Replace PDF</label>\r\n                          <div\r\n                            className=\"file-upload-btn\"\r\n                            onClick={() => document.getElementById(`pdf-input-${row.id}`).click()}\r\n                            style={{\r\n                              border: '1px solid #374151',\r\n                              borderRadius: '6px',\r\n                              padding: '6px 12px',\r\n                              cursor: 'pointer',\r\n                              display: 'flex',\r\n                              alignItems: 'center',\r\n                              gap: '8px',\r\n                              background: newPdf ? 'rgba(0, 168, 132, 0.1)' : 'transparent',\r\n                              color: newPdf ? '#00a884' : '#e9edef',\r\n                              transition: 'all 0.2s'\r\n                            }}\r\n                          >\r\n                            <input\r\n                              id={`pdf-input-${row.id}`}\r\n                              type=\"file\"\r\n                              accept=\"application/pdf\"\r\n                              onChange={(e) => setNewPdf(e.target.files?.[0] || null)}\r\n                              style={{ display: 'none' }}\r\n                            />\r\n                            {newPdf ? (\r\n                              <> {newPdf.name.slice(0, 20)}{newPdf.name.length > 20 ? '...' : ''}</>\r\n                            ) : (\r\n                              <> Choose PDF</>\r\n                            )}\r\n                          </div>\r\n                        </div>\r\n                        <div>\r\n                          <label className=\"label\">Replace Cover</label>\r\n                          <div\r\n                            className=\"file-upload-btn\"\r\n                            onClick={() => document.getElementById(`cover-input-${row.id}`).click()}\r\n                            style={{\r\n                              border: '1px solid #374151',\r\n                              borderRadius: '6px',\r\n                              padding: '6px 12px',\r\n                              cursor: 'pointer',\r\n                              display: 'flex',\r\n                              alignItems: 'center',\r\n                              gap: '8px',\r\n                              background: newCover ? 'rgba(0, 168, 132, 0.1)' : 'transparent',\r\n                              color: newCover ? '#00a884' : '#e9edef',\r\n                              transition: 'all 0.2s'\r\n                            }}\r\n                          >\r\n                            <input\r\n                              id={`cover-input-${row.id}`}\r\n                              type=\"file\"\r\n                              accept=\"image/*\"\r\n                              onChange={(e) => setNewCover(e.target.files?.[0] || null)}\r\n                              style={{ display: 'none' }}\r\n                            />\r\n                            {newCover ? (\r\n                              <> {newCover.name.slice(0, 20)}{newCover.name.length > 20 ? '...' : ''}</>\r\n                            ) : (\r\n                              <> Choose Image</>\r\n                            )}\r\n                          </div>\r\n                        </div>\r\n                        <div style={{ display: 'flex', gap: '8px', marginTop: '4px' }}>\r\n                          <button className=\"btn primary\" onClick={() => saveEdit(row)}>Save</button>\r\n                          <button className=\"btn\" onClick={cancelEdit}>Cancel</button>\r\n                        </div>\r\n                      </div>\r\n                    ) : (\r\n                      <div className=\"actions\">\r\n                        <button \r\n                          className=\"btn\" \r\n                          onClick={() => startEdit(row)}\r\n                          disabled={!canEdit(row)}\r\n                        >\r\n                          Edit\r\n                        </button>\r\n                        <button \r\n                          className=\"btn\" \r\n                          onClick={() => handleDelete(row)}\r\n                          disabled={!canEdit(row)}\r\n                        >\r\n                          Delete\r\n                        </button>\r\n                      </div>\r\n                    )}\r\n                  </td>\r\n                </tr>\r\n              ))}\r\n            </tbody>\r\n          </table>\r\n        </div>\r\n\r\n        <div className=\"actions\" style={{ marginTop: 10, justifyContent: 'center', gap: '24px' }}>\r\n          <button className=\"btn\" disabled={page <= 1} onClick={() => setPage(p => Math.max(1, p - 1))}> Prev</button>\r\n          <span style={{ color: '#cfd8dc' }}>Page {page} of {totalPages}</span>\r\n          <button className=\"btn\" disabled={page >= totalPages} onClick={() => setPage(p => Math.min(totalPages, p + 1))}>Next </button>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Books;\r\n","import React, { useEffect, useMemo, useState } from 'react';\nimport { fetchUniversities, deleteUniversity, updateUniversity } from '../campusApi';\nimport { getUniversityImages, deleteUniversityImage } from '../universityPrefillApi';\nimport { getPastPaperCountByUniversity } from '../pastPapersApi';\nimport { useAdminUI } from '../AdminUIContext';\n\nconst UniversitiesManagement = ({ userProfile }) => {\n  const [loading, setLoading] = useState(true);\n  const [rows, setRows] = useState([]);\n  const [count, setCount] = useState(0);\n  const [page, setPage] = useState(1);\n  const [pageSize] = useState(10);\n  const [search, setSearch] = useState('');\n  const [sort, setSort] = useState({ col: 'created_at', dir: 'desc' });\n  const [editingId, setEditingId] = useState(null);\n  const [editDraft, setEditDraft] = useState({});\n  const [newCover, setNewCover] = useState(null);\n  const [paperCounts, setPaperCounts] = useState({});\n\n  const { confirm, showToast } = useAdminUI();\n\n  const ADMIN_EMAILS = ['campuslives254@gmail.com', 'paltechsomalux@gmail.com'];\n  const isAdmin = userProfile?.role === 'admin' || ADMIN_EMAILS.includes(userProfile?.email);\n  const isEditor = userProfile?.role === 'editor' || ADMIN_EMAILS.includes(userProfile?.email);\n\n  const totalPages = useMemo(() => Math.max(1, Math.ceil(count / pageSize)), [count, pageSize]);\n\n  const load = async () => {\n    setLoading(true);\n    try {\n      const { data, count: total } = await fetchUniversities({ page, pageSize, search, sort });\n      setRows(data);\n      setCount(total);\n      \n      // Fetch paper counts for each university in batches (non-blocking)\n      const counts = {};\n      const BATCH_SIZE = 3;\n      for (let i = 0; i < data.length; i += BATCH_SIZE) {\n        const batch = data.slice(i, i + BATCH_SIZE);\n        const countPromises = batch.map(uni =>\n          getPastPaperCountByUniversity(uni.id)\n            .then(count => ({ id: uni.id, count }))\n            .catch(() => ({ id: uni.id, count: 0 }))\n        );\n        const results = await Promise.all(countPromises);\n        results.forEach(({ id, count }) => {\n          counts[id] = count;\n        });\n        // Update counts progressively\n        setPaperCounts(prevCounts => ({ ...prevCounts, ...counts }));\n      }\n    } finally { setLoading(false); }\n  };\n\n  useEffect(() => {\n    if (userProfile) load();\n  }, [page, search, sort.col, sort.dir, userProfile]);\n\n  const canEdit = (row) => {\n    if (isAdmin) return true;\n    if (isEditor) return true;\n    return false;\n  };\n\n  const startEdit = (row) => {\n    if (!canEdit(row)) {\n      showToast({ type: 'error', message: 'You do not have permission to edit this university.' });\n      return;\n    }\n    setEditingId(row.id);\n    setEditDraft({\n      name: row.name || '',\n      description: row.description || '',\n      website_url: row.website_url || '',\n      location: row.location || '',\n      established: row.established || '',\n      student_count: row.student_count || ''\n    });\n    setNewCover(null);\n  };\n\n  const cancelEdit = () => {\n    setEditingId(null);\n    setEditDraft({});\n    setNewCover(null);\n  };\n\n  const saveEdit = async (row) => {\n    if (!canEdit(row)) {\n      showToast({ type: 'error', message: 'You do not have permission to edit this university.' });\n      return;\n    }\n    const updates = { ...editDraft };\n\n    // Normalize numeric fields so we don't send \"\" to integer columns\n    if (updates.established === '' || updates.established === undefined) {\n      updates.established = null;\n    } else {\n      updates.established = Number(updates.established);\n    }\n\n    if (updates.student_count === '' || updates.student_count === undefined) {\n      updates.student_count = null;\n    } else {\n      updates.student_count = Number(updates.student_count);\n    }\n\n    try {\n      await updateUniversity(row.id, { updates, newCoverFile: newCover });\n      cancelEdit();\n      await load();\n      showToast({ type: 'success', message: 'University updated successfully.' });\n    } catch (e) {\n      console.error('Failed to update university:', e);\n      showToast({ type: 'error', message: e?.message || 'Failed to update university.' });\n    }\n  };\n\n  const handleDelete = async (row) => {\n    if (!canEdit(row)) {\n      showToast({ type: 'error', message: 'You can only delete universities you uploaded.' });\n      return;\n    }\n\n    const ok = await confirm({\n      title: 'Delete university?',\n      message: `Delete \"${row.name}\" and its related data? This action cannot be undone.`,\n      confirmLabel: 'Delete',\n      cancelLabel: 'Cancel',\n      variant: 'danger',\n    });\n    if (!ok) return;\n\n    try {\n      await deleteUniversity({ id: row.id, cover_image_url: row.cover_image_url });\n      await load();\n      showToast({ type: 'success', message: 'University deleted.' });\n    } catch (err) {\n      console.error('Failed to delete university:', err);\n      showToast({ type: 'error', message: err?.message || 'Failed to delete university.' });\n    }\n  };\n\n  const toggleSort = (col) => {\n    setSort((s) => (s.col === col ? { col, dir: s.dir === 'asc' ? 'desc' : 'asc' } : { col, dir: 'asc' }));\n  };\n\n  return (\n    <div>\n      <div className=\"panel\">\n        <div className=\"panel-title\">Universities Management</div>\n\n        {/* Stats Summary */}\n        {!loading && rows.length > 0 && (\n          <div style={{ display: 'grid', gridTemplateColumns: 'repeat(auto-fit, minmax(150px, 1fr))', gap: '8px', marginBottom: '12px' }}>\n            <div style={{ background: '#1a2332', border: '1px solid #2a3f56', borderRadius: '6px', padding: '8px 12px', color: '#8696a0', fontSize: '0.85rem' }}>\n              <div style={{ color: '#34B7F1', fontSize: '1.2rem', fontWeight: '600' }}>{rows.reduce((sum, r) => sum + (r.views || 0), 0)}</div>\n              <div>Total Views</div>\n            </div>\n            <div style={{ background: '#1a2332', border: '1px solid #2a3f56', borderRadius: '6px', padding: '8px 12px', color: '#8696a0', fontSize: '0.85rem' }}>\n              <div style={{ color: '#E74C3C', fontSize: '1.2rem', fontWeight: '600' }}>{rows.reduce((sum, r) => sum + (r.likes_count || 0), 0)}</div>\n              <div>Total Likes</div>\n            </div>\n            <div style={{ background: '#1a2332', border: '1px solid #2a3f56', borderRadius: '6px', padding: '8px 12px', color: '#8696a0', fontSize: '0.85rem' }}>\n              <div style={{ color: '#FFCC00', fontSize: '1.2rem', fontWeight: '600' }}>{rows.length}/{count}</div>\n              <div>Page Universities</div>\n            </div>\n          </div>\n        )}\n\n        <div className=\"panel\" style={{ marginBottom: 6 }}>\n          <label className=\"label\">Search</label>\n          <input className=\"input\" value={search} onChange={(e) => { setPage(1); setSearch(e.target.value); }} placeholder=\"Search by name or location...\" />\n        </div>\n\n        <div className=\"actions\" style={{ marginBottom: 6 }}>\n          <button className=\"btn primary\" onClick={() => (window.location.href = '/books/admin/upload')}>Add New University</button>\n        </div>\n\n        <div className=\"panel\" style={{ padding: 0, overflowX: 'auto' }}>\n          <table className=\"table\" style={{ minWidth: '1200px' }}>\n            <thead>\n              <tr>\n                <th style={{ width: '60px' }}>Cover</th>\n                <th style={{ width: '250px', cursor: 'pointer' }} onClick={() => toggleSort('name')}>Name {sort.col === 'name' ? (sort.dir === 'asc' ? '' : '') : ''}</th>\n                <th style={{ width: '300px' }}>Description</th>\n                <th style={{ width: '150px' }}>Location</th>\n                <th style={{ width: '100px', cursor: 'pointer' }} onClick={() => toggleSort('established')}>Est. {sort.col === 'established' ? (sort.dir === 'asc' ? '' : '') : ''}</th>\n                <th style={{ width: '100px' }}>Students</th>\n                <th style={{ width: '80px', cursor: 'pointer', background: 'rgba(52, 183, 241, 0.1)', borderBottom: '2px solid #34B7F1' }} onClick={() => toggleSort('views_count')}>Views {sort.col === 'views_count' ? (sort.dir === 'asc' ? '' : '') : ''}</th>\n                <th style={{ width: '80px', cursor: 'pointer', background: 'rgba(231, 76, 60, 0.1)', borderBottom: '2px solid #E74C3C' }} onClick={() => toggleSort('likes_count')}>Likes {sort.col === 'likes_count' ? (sort.dir === 'asc' ? '' : '') : ''}</th>\n                <th style={{ width: '80px', background: 'rgba(102, 187, 106, 0.1)', borderBottom: '2px solid #66BB6A' }}>Papers</th>\n                <th style={{ width: '180px' }}>Actions</th>\n              </tr>\n            </thead>\n            <tbody>\n              {loading ? (\n                <tr><td colSpan={10} style={{ textAlign: 'center', color: '#8696a0' }}>Loading...</td></tr>\n              ) : rows.length === 0 ? (\n                <tr><td colSpan={10} style={{ textAlign: 'center', color: '#8696a0' }}>No data</td></tr>\n              ) : rows.map(row => (\n                <tr key={row.id}>\n                  <td>{row.cover_image_url ? <img src={row.cover_image_url} alt=\"cover\" style={{ width: 36, height: 36, objectFit: 'cover', borderRadius: 4 }} /> : <span className=\"badge\">No cover</span>}</td>\n                  <td>\n                    {editingId === row.id ? (\n                      <input className=\"input\" value={editDraft.name} onChange={(e) => setEditDraft({ ...editDraft, name: e.target.value })} />\n                    ) : row.name}\n                  </td>\n                  <td>\n                    {editingId === row.id ? (\n                      <textarea className=\"input\" rows={2} value={editDraft.description} onChange={(e) => setEditDraft({ ...editDraft, description: e.target.value })} />\n                    ) : (row.description?.slice(0, 100) || '')}\n                  </td>\n                  <td>\n                    {editingId === row.id ? (\n                      <input className=\"input\" value={editDraft.location} onChange={(e) => setEditDraft({ ...editDraft, location: e.target.value })} />\n                    ) : (row.location || '')}\n                  </td>\n                  <td>\n                    {editingId === row.id ? (\n                      <input className=\"input\" type=\"number\" value={editDraft.established} onChange={(e) => setEditDraft({ ...editDraft, established: e.target.value })} />\n                    ) : (row.established || '')}\n                  </td>\n                  <td>{row.student_count?.toLocaleString() || ''}</td>\n                  <td style={{ fontWeight: '500', color: '#00a884' }}>{row.views || 0}</td>\n                  <td style={{ fontWeight: '500', color: '#E74C3C' }}>{row.likes_count || 0}</td>\n                  <td style={{ fontWeight: '500', color: '#66BB6A' }}>{paperCounts[row.id] || 0}</td>\n                  <td>\n                    {editingId === row.id ? (\n                      <div style={{ display: 'flex', gap: '4px', flexDirection: 'column' }}>\n                        <button className=\"btn primary\" onClick={() => saveEdit(row)}>Save</button>\n                        <button className=\"btn\" onClick={cancelEdit}>Cancel</button>\n                      </div>\n                    ) : (\n                      <div className=\"actions\">\n                        <button className=\"btn\" onClick={() => startEdit(row)} disabled={!canEdit(row)}>Edit</button>\n                        <button className=\"btn\" onClick={() => handleDelete(row)} disabled={!canEdit(row)}>Delete</button>\n                      </div>\n                    )}\n                  </td>\n                </tr>\n              ))}\n            </tbody>\n          </table>\n        </div>\n\n        <div className=\"actions\" style={{ marginTop: 6 }}>\n          <button className=\"btn\" disabled={page <= 1} onClick={() => setPage(p => Math.max(1, p - 1))}>Prev</button>\n          <span style={{ color: '#cfd8dc' }}>Page {page} of {totalPages}</span>\n          <button className=\"btn\" disabled={page >= totalPages} onClick={() => setPage(p => Math.min(totalPages, p + 1))}>Next</button>\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default UniversitiesManagement;\n","import React, { useEffect, useMemo, useState } from 'react';\r\nimport { fetchPastPapers, deletePastPaper, updatePastPaper, getFaculties } from '../pastPapersApi';\r\nimport { useAdminUI } from '../AdminUIContext';\r\n\r\n// Format timestamp to local time with timezone handling\r\nconst formatTimestamp = (isoString) => {\r\n  if (!isoString) return '';\r\n  try {\r\n    const date = new Date(isoString);\r\n    return date.toLocaleString('en-US', { \r\n      year: 'numeric', \r\n      month: 'short', \r\n      day: 'numeric', \r\n      hour: '2-digit', \r\n      minute: '2-digit', \r\n      second: '2-digit',\r\n      hour12: true,\r\n      timeZoneName: 'short'\r\n    });\r\n  } catch (e) {\r\n    return isoString;\r\n  }\r\n};\r\n\r\nconst PastPapersManagement = ({ userProfile }) => {\r\n  const [loading, setLoading] = useState(true);\r\n  const [rows, setRows] = useState([]);\r\n  const [count, setCount] = useState(0);\r\n  const [page, setPage] = useState(1);\r\n  const [pageSize] = useState(10);\r\n  const [search, setSearch] = useState('');\r\n  const [faculties, setFaculties] = useState([]);\r\n  const [facultyFilter, setFacultyFilter] = useState(null);\r\n  const [sort, setSort] = useState({ col: 'created_at', dir: 'desc' });\r\n  const [editingId, setEditingId] = useState(null);\r\n  const [selectedIds, setSelectedIds] = useState(new Set());\r\n  const [allPaperIds, setAllPaperIds] = useState(new Set()); // Track ALL papers across all pages\r\n  const [editDraft, setEditDraft] = useState({});\r\n  const [newPdf, setNewPdf] = useState(null);\r\n  const [useCustomFaculty, setUseCustomFaculty] = useState(false);\r\n  const [customFaculty, setCustomFaculty] = useState('');\r\n  const [isMultiEditMode, setIsMultiEditMode] = useState(false);\r\n  const [showCheckboxes, setShowCheckboxes] = useState(false);\r\n\r\n  const { confirm, showToast } = useAdminUI();\r\n\r\n  const isAdmin = userProfile?.role === 'admin';\r\n  const isEditor = userProfile?.role === 'editor';\r\n  const totalPages = useMemo(() => Math.max(1, Math.ceil(count / pageSize)), [count, pageSize]);\r\n\r\n  const load = async () => {\r\n    setLoading(true);\r\n    try {\r\n      const { data, count: total } = await fetchPastPapers({ page, pageSize, search, faculty: facultyFilter, sort });\r\n      setRows(data);\r\n      setCount(total);\r\n    } finally { setLoading(false); }\r\n  };\r\n\r\n  // Fetch all paper IDs matching current filters (no pagination)\r\n  const fetchAllMatchingIds = async () => {\r\n    try {\r\n      const { data } = await fetchPastPapers({ page: 1, pageSize: 10000, search, faculty: facultyFilter, sort });\r\n      return new Set(data.map(item => item.id));\r\n    } catch (error) {\r\n      console.error('Failed to fetch all matching papers:', error);\r\n      return new Set();\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    (async () => { try { setFaculties(await getFaculties()); } catch {} })();\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    if (userProfile) load();\r\n  }, [page, search, facultyFilter, sort.col, sort.dir, userProfile]);\r\n\r\n  const canEdit = (row) => {\r\n    if (isAdmin) return true;\r\n    if (isEditor) return true;\r\n    return false;\r\n  };\r\n\r\n  const startEdit = (row) => {\r\n    if (!canEdit(row)) {\r\n      showToast({ type: 'error', message: 'You do not have permission to edit this past paper.' });\r\n      return;\r\n    }\r\n    setEditingId(row.id);\r\n    setEditDraft({\r\n      faculty: row.faculty || '', unit_code: row.unit_code || '', unit_name: row.unit_name || '',\r\n      year: row.year || '', semester: row.semester || '', exam_type: row.exam_type || ''\r\n    });\r\n    setNewPdf(null);\r\n    setUseCustomFaculty(false);\r\n    setCustomFaculty('');\r\n  };\r\n\r\n  const cancelEdit = () => { \r\n    setEditingId(null); \r\n    setEditDraft({}); \r\n    setNewPdf(null); \r\n    setUseCustomFaculty(false);\r\n    setCustomFaculty('');\r\n  };\r\n\r\n  // Multi-select handlers\r\n  const toggleSelectRow = (id) => {\r\n    setSelectedIds(prev => {\r\n      const newSet = new Set(prev);\r\n      if (newSet.has(id)) {\r\n        newSet.delete(id);\r\n      } else {\r\n        newSet.add(id);\r\n      }\r\n      return newSet;\r\n    });\r\n  };\r\n\r\n  const toggleSelectAll = () => {\r\n    if (selectedIds.size === count && count > 0) {\r\n      // Unselect all\r\n      setSelectedIds(new Set());\r\n    } else {\r\n      // Select all matching papers across all pages\r\n      fetchAllMatchingIds().then(allIds => {\r\n        setSelectedIds(allIds);\r\n      });\r\n    }\r\n  };\r\n\r\n  const startMultiEdit = () => {\r\n    if (selectedIds.size === 0) {\r\n      showToast({ type: 'error', message: 'Please select at least one past paper to edit.' });\r\n      return;\r\n    }\r\n    \r\n    // For permission check, only validate papers we can see on current page\r\n    // Users can proceed with multi-edit if they have permission on at least the current visible selections\r\n    // Full permission check will happen in saveMultiEdit\r\n    const visibleSelectedIds = Array.from(selectedIds).filter(id => rows.some(r => r.id === id));\r\n    if (visibleSelectedIds.length > 0) {\r\n      const canEditVisible = visibleSelectedIds.every(id => {\r\n        const row = rows.find(r => r.id === id);\r\n        return canEdit(row);\r\n      });\r\n\r\n      if (!canEditVisible) {\r\n        showToast({ type: 'error', message: 'You do not have permission to edit some of the selected past papers.' });\r\n        return;\r\n      }\r\n    }\r\n\r\n    setIsMultiEditMode(true);\r\n    setEditDraft({\r\n      faculty: '', unit_code: '', unit_name: '', year: '', semester: '', exam_type: ''\r\n    });\r\n    setUseCustomFaculty(false);\r\n    setCustomFaculty('');\r\n  };\r\n\r\n  const cancelMultiEdit = () => {\r\n    setIsMultiEditMode(false);\r\n    setEditDraft({});\r\n    setUseCustomFaculty(false);\r\n    setCustomFaculty('');\r\n    setSelectedIds(new Set());\r\n    setShowCheckboxes(false);\r\n  };\r\n\r\n  const saveMultiEdit = async () => {\r\n    if (selectedIds.size === 0) {\r\n      showToast({ type: 'error', message: 'No past papers selected.' });\r\n      return;\r\n    }\r\n\r\n    // Get the values that were actually changed\r\n    const updates = {};\r\n    if (editDraft.faculty) updates.faculty = editDraft.faculty || (useCustomFaculty ? customFaculty : editDraft.faculty);\r\n    if (editDraft.unit_code) updates.unit_code = editDraft.unit_code;\r\n    if (editDraft.unit_name) updates.unit_name = editDraft.unit_name;\r\n    if (editDraft.year) updates.year = editDraft.year;\r\n    if (editDraft.semester) updates.semester = editDraft.semester;\r\n    if (editDraft.exam_type) updates.exam_type = editDraft.exam_type;\r\n\r\n    if (Object.keys(updates).length === 0) {\r\n      showToast({ type: 'error', message: 'Please enter at least one field to update.' });\r\n      return;\r\n    }\r\n\r\n    try {\r\n      const faculty = useCustomFaculty ? customFaculty : editDraft.faculty;\r\n      if (updates.faculty && !faculty) {\r\n        showToast({ type: 'error', message: 'Please select or enter a faculty.' });\r\n        return;\r\n      }\r\n\r\n      // Fetch all selected papers in parallel with current page (use cached data from current page if available)\r\n      const papersToUpdate = Array.from(selectedIds).map(id => {\r\n        const cachedRow = rows.find(r => r.id === id);\r\n        return { id, cached: cachedRow };\r\n      });\r\n\r\n      // Only fetch papers not in current view\r\n      const missingIds = papersToUpdate.filter(p => !p.cached).map(p => p.id);\r\n      let missingPapersMap = new Map();\r\n      \r\n      if (missingIds.length > 0) {\r\n        const { data: allSelectedPapers } = await fetchPastPapers({ \r\n          page: 1, \r\n          pageSize: 10000, \r\n          search, \r\n          faculty: facultyFilter, \r\n          sort \r\n        });\r\n        missingPapersMap = new Map(allSelectedPapers.map(p => [p.id, p]));\r\n      }\r\n\r\n      // Update all in parallel (up to 5 concurrent requests)\r\n      const updatePromises = [];\r\n      const batchSize = 5;\r\n      \r\n      for (const { id, cached } of papersToUpdate) {\r\n        const row = cached || missingPapersMap.get(id);\r\n        if (!row) {\r\n          console.warn(`Paper with ID ${id} not found`);\r\n          continue;\r\n        }\r\n        \r\n        updatePromises.push(\r\n          updatePastPaper(id, { \r\n            updates: { ...updates, faculty: updates.faculty || faculty }, \r\n            newPdfFile: null, \r\n            oldFilePath: row.file_path \r\n          })\r\n        );\r\n\r\n        // Batch requests to avoid overwhelming the server\r\n        if (updatePromises.length >= batchSize) {\r\n          await Promise.all(updatePromises);\r\n          updatePromises.length = 0;\r\n        }\r\n      }\r\n\r\n      // Complete remaining requests\r\n      if (updatePromises.length > 0) {\r\n        await Promise.all(updatePromises);\r\n      }\r\n\r\n      cancelMultiEdit();\r\n      // Reload only current page data instead of all\r\n      setLoading(true);\r\n      const { data, count: total } = await fetchPastPapers({ page, pageSize, search, faculty: facultyFilter, sort });\r\n      setRows(data);\r\n      setCount(total);\r\n      setLoading(false);\r\n      \r\n      showToast({ type: 'success', message: `${selectedIds.size} past paper(s) updated successfully.` });\r\n    } catch (e) {\r\n      console.error('Failed to update past papers:', e?.message || e);\r\n      showToast({ type: 'error', message: e?.message || 'Failed to update past papers.' });\r\n    }\r\n  };\r\n\r\n  const saveEdit = async (row) => {\r\n    if (!canEdit(row)) {\r\n      showToast({ type: 'error', message: 'You do not have permission to edit this past paper.' });\r\n      return;\r\n    }\r\n    \r\n    // Use custom faculty if selected, otherwise use the one from edit draft\r\n    const faculty = useCustomFaculty ? customFaculty : editDraft.faculty;\r\n    if (!faculty) {\r\n      showToast({ type: 'error', message: 'Please select or enter a faculty.' });\r\n      return;\r\n    }\r\n    \r\n    const updates = { ...editDraft, faculty };\r\n\r\n    try {\r\n      await updatePastPaper(row.id, { updates, newPdfFile: newPdf, oldFilePath: row.file_path });\r\n      cancelEdit();\r\n      await load();\r\n      showToast({ type: 'success', message: 'Past paper updated.' });\r\n    } catch (e) {\r\n      console.error('Failed to update past paper:', e?.message || e);\r\n      showToast({ type: 'error', message: e?.message || 'Failed to update past paper.' });\r\n    }\r\n  };\r\n\r\n  const handleDelete = async (row) => {\r\n    if (!canEdit(row)) {\r\n      showToast({ type: 'error', message: 'You can only delete past papers you uploaded.' });\r\n      return;\r\n    }\r\n\r\n    const ok = await confirm({\r\n      title: 'Delete past paper?',\r\n      message: `Delete \"${row.unit_code} - ${row.unit_name}\"? This action cannot be undone.`,\r\n      confirmLabel: 'Delete',\r\n      cancelLabel: 'Cancel',\r\n      variant: 'danger',\r\n    });\r\n    if (!ok) return;\r\n\r\n    try {\r\n      await deletePastPaper({ id: row.id, file_path: row.file_path });\r\n      await load();\r\n      showToast({ type: 'success', message: 'Past paper deleted.' });\r\n    } catch (e) {\r\n      console.error('Failed to delete past paper:', e);\r\n      showToast({ type: 'error', message: e?.message || 'Failed to delete past paper.' });\r\n    }\r\n  };\r\n\r\n  const toggleSort = (col) => setSort((s) => (s.col === col ? { col, dir: s.dir === 'asc' ? 'desc' : 'asc' } : { col, dir: 'asc' }));\r\n\r\n  return (\r\n    <div>\r\n      <div className=\"panel\">\r\n        <div className=\"panel-title\">Past Papers Management</div>\r\n\r\n        {/* Stats Summary */}\r\n        {!loading && rows.length > 0 && (\r\n          <div style={{ display: 'grid', gridTemplateColumns: 'repeat(auto-fit, minmax(150px, 1fr))', gap: '8px', marginBottom: '12px' }}>\r\n            <div style={{ background: '#0b1216', boxShadow: '0 2px 8px rgba(0, 0, 0, 0.3)', borderRadius: '6px', padding: '8px 12px', color: '#8696a0', fontSize: '0.85rem' }}>\r\n              <div style={{ color: '#00a884', fontSize: '1.2rem', fontWeight: '600' }}>{rows.reduce((sum, r) => sum + (r.downloads_count || 0), 0)}</div>\r\n              <div>Total Downloads</div>\r\n            </div>\r\n            <div style={{ background: '#0b1216', boxShadow: '0 2px 8px rgba(0, 0, 0, 0.3)', borderRadius: '6px', padding: '8px 12px', color: '#8696a0', fontSize: '0.85rem' }}>\r\n              <div style={{ color: '#34B7F1', fontSize: '1.2rem', fontWeight: '600' }}>{rows.reduce((sum, r) => sum + (r.views_count || 0), 0)}</div>\r\n              <div>Total Views</div>\r\n            </div>\r\n            <div style={{ background: '#0b1216', boxShadow: '0 2px 8px rgba(0, 0, 0, 0.3)', borderRadius: '6px', padding: '8px 12px', color: '#8696a0', fontSize: '0.85rem' }}>\r\n              <div style={{ color: '#FFCC00', fontSize: '1.2rem', fontWeight: '600' }}>{rows.length}/{count}</div>\r\n              <div>Page Papers</div>\r\n            </div>\r\n          </div>\r\n        )}\r\n\r\n        <div className=\"grid-2\" style={{ marginBottom: 6 }}>\r\n          <div className=\"panel\">\r\n            <label className=\"label\">Search</label>\r\n            <input className=\"input\" value={search} onChange={(e) => { setPage(1); setSearch(e.target.value.trim()); }} placeholder=\"e.g., MENT 130 or Introduction to...\" />\r\n          </div>\r\n          <div className=\"panel\">\r\n            <label className=\"label\">Faculty</label>\r\n            <select className=\"select\" value={facultyFilter || ''} onChange={(e) => { setPage(1); setFacultyFilter(e.target.value || null); }}>\r\n              <option value=\"\">All Faculties</option>\r\n              <option value=\"Unknown\">Unknown</option>\r\n              {faculties.map(f => <option key={f} value={f}>{f}</option>)}\r\n            </select>\r\n          </div>\r\n        </div>\r\n        <div className=\"actions\" style={{ marginBottom: 6 }}>\r\n          <button className=\"btn primary\" onClick={() => (window.location.href = '/books/admin/upload')}>Add New Past Paper</button>\r\n          {!showCheckboxes && (\r\n            <button \r\n              className=\"btn\" \r\n              onClick={() => setShowCheckboxes(true)}\r\n              style={{ background: '#00a884', color: '#e9edef' }}\r\n            >\r\n               Bulk Edit\r\n            </button>\r\n          )}\r\n          {showCheckboxes && !isMultiEditMode && (\r\n            <button \r\n              className=\"btn\" \r\n              onClick={() => {\r\n                setShowCheckboxes(false);\r\n                setSelectedIds(new Set());\r\n              }}\r\n              style={{ background: '#2a3f56', color: '#e9edef' }}\r\n            >\r\n               Cancel Selection\r\n            </button>\r\n          )}\r\n        </div>\r\n\r\n        {/* Multi-Edit Mode Toolbar */}\r\n        {isMultiEditMode && (\r\n          <div style={{ \r\n            background: '#0b1216', \r\n            borderRadius: '6px', \r\n            padding: '12px',\r\n            marginBottom: '12px',\r\n            boxShadow: '0 4px 12px rgba(0, 0, 0, 0.4)'\r\n          }}>\r\n            <div style={{ marginBottom: '12px', display: 'flex', justifyContent: 'space-between', alignItems: 'center' }}>\r\n              <h3 style={{ margin: 0, color: '#00a884' }}>\r\n                Edit {selectedIds.size} Past Paper{selectedIds.size !== 1 ? 's' : ''}\r\n              </h3>\r\n              <button \r\n                className=\"btn\" \r\n                onClick={cancelMultiEdit}\r\n                style={{ background: '#2a3f56', color: '#e9edef' }}\r\n              >\r\n                Cancel\r\n              </button>\r\n            </div>\r\n\r\n            <div className=\"grid-2\" style={{ gap: '12px', marginBottom: '12px' }}>\r\n              <div>\r\n                <label className=\"label\" style={{ fontSize: '13px' }}>Unit Name</label>\r\n                <input \r\n                  className=\"input\" \r\n                  placeholder=\"Leave blank to skip\" \r\n                  value={editDraft.unit_name || ''} \r\n                  onChange={(e) => setEditDraft({ ...editDraft, unit_name: e.target.value })} \r\n                />\r\n              </div>\r\n              <div>\r\n                <label className=\"label\" style={{ fontSize: '13px' }}>Unit Code</label>\r\n                <input \r\n                  className=\"input\" \r\n                  placeholder=\"Leave blank to skip\" \r\n                  value={editDraft.unit_code || ''} \r\n                  onChange={(e) => setEditDraft({ ...editDraft, unit_code: e.target.value })} \r\n                />\r\n              </div>\r\n              <div>\r\n                <label className=\"label\" style={{ fontSize: '13px' }}>Faculty</label>\r\n                {!useCustomFaculty ? (\r\n                  <select \r\n                    className=\"select\" \r\n                    value={editDraft.faculty || ''} \r\n                    onChange={(e) => setEditDraft({ ...editDraft, faculty: e.target.value })}\r\n                  >\r\n                    <option value=\"\">Leave blank to skip</option>\r\n                    {faculties && faculties.length > 0 ? faculties.map(f => <option key={f} value={f}>{f}</option>) : <option value=\"\">No faculties available</option>}\r\n                  </select>\r\n                ) : (\r\n                  <input \r\n                    className=\"input\" \r\n                    placeholder=\"e.g., Engineering\" \r\n                    value={customFaculty} \r\n                    onChange={(e) => setCustomFaculty(e.target.value)}\r\n                  />\r\n                )}\r\n                <div style={{ display: 'flex', alignItems: 'center', gap: '4px', marginTop: '4px', fontSize: '12px' }}>\r\n                  <input \r\n                    type=\"checkbox\" \r\n                    id=\"custom-faculty-multi\"\r\n                    checked={useCustomFaculty}\r\n                    onChange={(e) => {\r\n                      setUseCustomFaculty(e.target.checked);\r\n                      if (!e.target.checked) {\r\n                        setCustomFaculty('');\r\n                      }\r\n                    }}\r\n                    style={{ width: '14px', height: '14px', cursor: 'pointer' }}\r\n                  />\r\n                  <label htmlFor=\"custom-faculty-multi\" style={{ color: '#8696a0', cursor: 'pointer' }}>\r\n                    Add custom faculty\r\n                  </label>\r\n                </div>\r\n              </div>\r\n              <div>\r\n                <label className=\"label\" style={{ fontSize: '13px' }}>Year</label>\r\n                <input \r\n                  className=\"input\" \r\n                  type=\"number\" \r\n                  placeholder=\"Leave blank to skip\" \r\n                  value={editDraft.year || ''} \r\n                  onChange={(e) => setEditDraft({ ...editDraft, year: e.target.value })} \r\n                />\r\n              </div>\r\n              <div>\r\n                <label className=\"label\" style={{ fontSize: '13px' }}>Semester</label>\r\n                <select \r\n                  className=\"select\" \r\n                  value={editDraft.semester || ''} \r\n                  onChange={(e) => setEditDraft({ ...editDraft, semester: e.target.value })}\r\n                >\r\n                  <option value=\"\">Leave blank to skip</option>\r\n                  <option value=\"1\">1</option>\r\n                  <option value=\"2\">2</option>\r\n                  <option value=\"3\">3</option>\r\n                </select>\r\n              </div>\r\n              <div>\r\n                <label className=\"label\" style={{ fontSize: '13px' }}>Exam Type</label>\r\n                <select \r\n                  className=\"select\" \r\n                  value={editDraft.exam_type || ''} \r\n                  onChange={(e) => setEditDraft({ ...editDraft, exam_type: e.target.value })}\r\n                >\r\n                  <option value=\"\">Leave blank to skip</option>\r\n                  <option value=\"Main\">Main</option>\r\n                  <option value=\"Supplementary\">Supplementary</option>\r\n                  <option value=\"CAT\">CAT</option>\r\n                  <option value=\"Mock\">Mock</option>\r\n                </select>\r\n              </div>\r\n            </div>\r\n\r\n            <div style={{ display: 'flex', gap: '8px', justifyContent: 'flex-end' }}>\r\n              <button \r\n                className=\"btn primary\" \r\n                onClick={saveMultiEdit}\r\n                style={{ background: '#00a884' }}\r\n              >\r\n                Save Changes to All {selectedIds.size} Item{selectedIds.size !== 1 ? 's' : ''}\r\n              </button>\r\n              <button \r\n                className=\"btn\" \r\n                onClick={cancelMultiEdit}\r\n                style={{ background: '#2a3f56', color: '#e9edef' }}\r\n              >\r\n                Cancel\r\n              </button>\r\n            </div>\r\n          </div>\r\n        )}\r\n\r\n        {/* Selection Toolbar */}\r\n        {selectedIds.size > 0 && !isMultiEditMode && (\r\n          <div style={{ \r\n            background: '#0b1216', \r\n            borderRadius: '6px', \r\n            padding: '12px',\r\n            marginBottom: '12px',\r\n            display: 'flex',\r\n            justifyContent: 'space-between',\r\n            alignItems: 'center',\r\n            boxShadow: '0 4px 12px rgba(0, 0, 0, 0.4)'\r\n          }}>\r\n            <span style={{ color: '#8696a0' }}>\r\n              {selectedIds.size} item{selectedIds.size !== 1 ? 's' : ''} selected\r\n            </span>\r\n            <div style={{ display: 'flex', gap: '8px', justifyContent: 'flex-end' }}>\r\n              <button \r\n                className=\"btn primary\" \r\n                onClick={startMultiEdit}\r\n                style={{ background: '#00a884' }}\r\n              >\r\n                Edit Selected ({selectedIds.size})\r\n              </button>\r\n              <button \r\n                className=\"btn\" \r\n                onClick={() => setSelectedIds(new Set())}\r\n                style={{ background: '#2a3f56', color: '#e9edef' }}\r\n              >\r\n                Clear Selection\r\n              </button>\r\n            </div>\r\n          </div>\r\n        )}\r\n\r\n        <div className=\"panel\" style={{ padding: 0, overflowX: 'auto' }}>\r\n          <table className=\"table\" style={{ minWidth: '1200px' }}>\r\n            <thead>\r\n              <tr>\r\n                {showCheckboxes && (\r\n                  <th style={{ width: '40px' }}>\r\n                    <input\r\n                      type=\"checkbox\"\r\n                      checked={selectedIds.size === count && count > 0}\r\n                      onChange={toggleSelectAll}\r\n                      style={{ width: '16px', height: '16px', cursor: 'pointer' }}\r\n                      title={selectedIds.size === count && count > 0 ? 'Unselect all' : 'Select all across all pages'}\r\n                    />\r\n                  </th>\r\n                )}\r\n                <th style={{ width: '250px' }}>Unit Name</th>\r\n                <th style={{ width: '150px', cursor: 'pointer' }} onClick={() => toggleSort('unit_code')}>Unit Code {sort.col === 'unit_code' ? (sort.dir === 'asc' ? '' : '') : ''}</th>\r\n                <th style={{ width: '150px' }}>Faculty</th>\r\n                <th style={{ width: '100px', cursor: 'pointer' }} onClick={() => toggleSort('year')}>Year {sort.col === 'year' ? (sort.dir === 'asc' ? '' : '') : ''}</th>\r\n                <th style={{ width: '100px' }}>Semester</th>\r\n                <th style={{ width: '120px' }}>Exam Type</th>\r\n                <th style={{ width: '80px', cursor: 'pointer', background: 'rgba(0, 168, 132, 0.1)', borderBottom: '2px solid #00a884' }} onClick={() => toggleSort('views_count')}>Views {sort.col === 'views_count' ? (sort.dir === 'asc' ? '' : '') : ''}</th>\r\n                <th style={{ width: '100px', cursor: 'pointer' }} onClick={() => toggleSort('downloads_count')}>Downloads {sort.col === 'downloads_count' ? (sort.dir === 'asc' ? '' : '') : ''}</th>\r\n                <th style={{ width: '180px', cursor: 'pointer' }} onClick={() => toggleSort('created_at')}>Uploaded {sort.col === 'created_at' ? (sort.dir === 'asc' ? '' : '') : ''}</th>\r\n                <th style={{ width: '150px' }}>Uploaded By</th>\r\n                <th style={{ width: '200px' }}>Actions</th>\r\n              </tr>\r\n            </thead>\r\n            <tbody>\r\n              {loading ? (\r\n                <tr><td colSpan={showCheckboxes ? 13 : 12} style={{ textAlign: 'center', color: '#8696a0' }}>Loading...</td></tr>\r\n              ) : rows.length === 0 ? (\r\n                <tr><td colSpan={showCheckboxes ? 13 : 12} style={{ textAlign: 'center', color: '#8696a0' }}>No data</td></tr>\r\n              ) : rows.map(row => (\r\n                <tr key={row.id} style={{ background: selectedIds.has(row.id) ? 'rgba(0, 168, 132, 0.1)' : 'transparent' }}>\r\n                  {showCheckboxes && (\r\n                    <td style={{ textAlign: 'center' }}>\r\n                      <input\r\n                        type=\"checkbox\"\r\n                        checked={selectedIds.has(row.id)}\r\n                        onChange={() => toggleSelectRow(row.id)}\r\n                        disabled={isMultiEditMode}\r\n                        style={{ width: '16px', height: '16px', cursor: 'pointer' }}\r\n                      />\r\n                    </td>\r\n                  )}\r\n                  <td style={{ color: row.unit_name ? '#e9edef' : '#8696a0' }}>{editingId === row.id ? <input className=\"input\" value={editDraft.unit_name} onChange={(e) => setEditDraft({ ...editDraft, unit_name: e.target.value })} /> : (row.unit_name || '')}</td>\r\n                  <td style={{ color: row.unit_code ? '#e9edef' : '#8696a0' }}>{editingId === row.id ? <input className=\"input\" value={editDraft.unit_code} onChange={(e) => setEditDraft({ ...editDraft, unit_code: e.target.value })} /> : (row.unit_code || '')}</td>\r\n                  <td style={{ color: row.faculty ? '#e9edef' : '#8696a0' }}>\r\n                    {editingId === row.id ? (\r\n                      <div style={{ display: 'flex', flexDirection: 'column', gap: '4px' }}>\r\n                        {!useCustomFaculty ? (\r\n                          <>\r\n                            <select \r\n                              className=\"select\" \r\n                              value={editDraft.faculty} \r\n                              onChange={(e) => setEditDraft({ ...editDraft, faculty: e.target.value })}\r\n                              style={{ marginBottom: '4px' }}\r\n                            >\r\n                              <option value=\"\">Select Faculty</option>\r\n                              {faculties && faculties.length > 0 ? faculties.map(f => <option key={f} value={f}>{f}</option>) : <option value=\"\">No faculties available</option>}\r\n                            </select>\r\n                          </>\r\n                        ) : (\r\n                          <input \r\n                            className=\"input\" \r\n                            placeholder=\"e.g., Engineering, Business\" \r\n                            value={customFaculty} \r\n                            onChange={(e) => setCustomFaculty(e.target.value)}\r\n                          />\r\n                        )}\r\n                        <div style={{ display: 'flex', alignItems: 'center', gap: '4px', fontSize: '11px' }}>\r\n                          <input \r\n                            type=\"checkbox\" \r\n                            id={`custom-faculty-${row.id}`}\r\n                            checked={useCustomFaculty}\r\n                            onChange={(e) => {\r\n                              setUseCustomFaculty(e.target.checked);\r\n                              if (!e.target.checked) {\r\n                                setCustomFaculty('');\r\n                              }\r\n                            }}\r\n                            style={{ width: '14px', height: '14px', cursor: 'pointer' }}\r\n                          />\r\n                          <label htmlFor={`custom-faculty-${row.id}`} style={{ color: '#8696a0', cursor: 'pointer', fontSize: '11px' }}>\r\n                            Add\r\n                          </label>\r\n                        </div>\r\n                      </div>\r\n                    ) : (row.faculty || '')}\r\n                  </td>\r\n                  <td style={{ color: row.year ? '#e9edef' : '#8696a0' }}>{editingId === row.id ? <input className=\"input\" type=\"number\" value={editDraft.year} onChange={(e) => setEditDraft({ ...editDraft, year: e.target.value })} /> : (row.year || '')}</td>\r\n                  <td>{editingId === row.id ? <select className=\"select\" value={editDraft.semester} onChange={(e) => setEditDraft({ ...editDraft, semester: e.target.value })}><option value=\"\"></option><option value=\"1\">1</option><option value=\"2\">2</option><option value=\"3\">3</option></select> : (row.semester || '')}</td>\r\n                  <td>{editingId === row.id ? <select className=\"select\" value={editDraft.exam_type} onChange={(e) => setEditDraft({ ...editDraft, exam_type: e.target.value })}><option value=\"Main\">Main</option><option value=\"Supplementary\">Supplementary</option><option value=\"CAT\">CAT</option><option value=\"Mock\">Mock</option></select> : (row.exam_type || 'Main')}</td>\r\n                  <td style={{ fontWeight: '500', color: '#00a884' }}>{row.views_count || 0}</td>\r\n                  <td>{row.downloads_count || 0}</td>\r\n                  <td style={{ color: '#8696a0', fontSize: '12px' }}>{formatTimestamp(row.created_at)}</td>\r\n                  <td style={{ color: row.profiles?.full_name ? '#e9edef' : '#8696a0', fontSize: '13px' }}>{row.profiles?.full_name || row.profiles?.email || ''}</td>\r\n                  <td>\r\n                    {editingId === row.id ? (\r\n                      <div style={{ display: 'flex', gap: '4px', flexDirection: 'column' }}>\r\n                        <button className=\"btn primary\" onClick={() => saveEdit(row)}>Save</button>\r\n                        <button className=\"btn\" onClick={cancelEdit}>Cancel</button>\r\n                      </div>\r\n                    ) : (\r\n                      <div className=\"actions\">\r\n                        <button className=\"btn\" onClick={() => startEdit(row)} disabled={!canEdit(row)}>Edit</button>\r\n                        <button className=\"btn\" onClick={() => handleDelete(row)} disabled={!canEdit(row)}>Delete</button>\r\n                      </div>\r\n                    )}\r\n                  </td>\r\n                </tr>\r\n              ))}\r\n            </tbody>\r\n          </table>\r\n        </div>\r\n        <div className=\"actions\" style={{ marginTop: 6 }}>\r\n          <button className=\"btn\" disabled={page <= 1} onClick={() => setPage(p => Math.max(1, p - 1))}>Prev</button>\r\n          <span style={{ color: '#cfd8dc' }}>Page {page} of {totalPages}</span>\r\n          <button className=\"btn\" disabled={page >= totalPages} onClick={() => setPage(p => Math.min(totalPages, p + 1))}>Next</button>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default PastPapersManagement;\r\n","/**\r\n * Author Interactions API\r\n * Handles: followers, likes, loves, comments, ratings, shares\r\n */\r\n\r\nimport { supabase } from '../../Books/supabaseClient';\r\n\r\n// ============================================\r\n// FOLLOWERS MANAGEMENT\r\n// ============================================\r\n\r\nexport async function toggleAuthorFollow(authorId, userId) {\r\n  try {\r\n    if (!userId) throw new Error('User ID required');\r\n    \r\n    const { data, error } = await supabase\r\n      .rpc('toggle_author_follow', {\r\n        p_follower_id: userId,\r\n        p_author_id: authorId\r\n      });\r\n    \r\n    if (error) throw error;\r\n    return { success: true, isFollowing: data };\r\n  } catch (error) {\r\n    console.error('Error toggling author follow:', error);\r\n    throw error;\r\n  }\r\n}\r\n\r\nexport async function getAuthorFollowers(authorId) {\r\n  try {\r\n    const { data, error } = await supabase\r\n      .from('author_followers')\r\n      .select('id, follower_id, profiles(id, username, avatar_url), followed_at')\r\n      .eq('author_id', authorId)\r\n      .order('followed_at', { ascending: false });\r\n    \r\n    if (error) throw error;\r\n    return data || [];\r\n  } catch (error) {\r\n    console.error('Error fetching author followers:', error);\r\n    return [];\r\n  }\r\n}\r\n\r\nexport async function getFollowersCount(authorId) {\r\n  try {\r\n    const { count, error } = await supabase\r\n      .from('author_followers')\r\n      .select('id', { count: 'exact' })\r\n      .eq('author_id', authorId);\r\n    \r\n    if (error) throw error;\r\n    return count || 0;\r\n  } catch (error) {\r\n    console.error('Error fetching followers count:', error);\r\n    return 0;\r\n  }\r\n}\r\n\r\n// ============================================\r\n// LIKES MANAGEMENT\r\n// ============================================\r\n\r\nexport async function toggleAuthorLike(authorId, userId) {\r\n  try {\r\n    if (!userId) throw new Error('User ID required');\r\n    \r\n    const { data, error } = await supabase\r\n      .rpc('toggle_author_like', {\r\n        p_user_id: userId,\r\n        p_author_id: authorId\r\n      });\r\n    \r\n    if (error) throw error;\r\n    return { success: true, isLiked: data };\r\n  } catch (error) {\r\n    console.error('Error toggling author like:', error);\r\n    throw error;\r\n  }\r\n}\r\n\r\nexport async function getAuthorLikes(authorId) {\r\n  try {\r\n    const { data, error } = await supabase\r\n      .from('author_likes')\r\n      .select('id, user_id, profiles(id, username, avatar_url), liked_at')\r\n      .eq('author_id', authorId)\r\n      .order('liked_at', { ascending: false });\r\n    \r\n    if (error) throw error;\r\n    return data || [];\r\n  } catch (error) {\r\n    console.error('Error fetching author likes:', error);\r\n    return [];\r\n  }\r\n}\r\n\r\nexport async function getLikesCount(authorId) {\r\n  try {\r\n    const { count, error } = await supabase\r\n      .from('author_likes')\r\n      .select('id', { count: 'exact' })\r\n      .eq('author_id', authorId);\r\n    \r\n    if (error) throw error;\r\n    return count || 0;\r\n  } catch (error) {\r\n    console.error('Error fetching likes count:', error);\r\n    return 0;\r\n  }\r\n}\r\n\r\n// ============================================\r\n// LOVES MANAGEMENT\r\n// ============================================\r\n\r\nexport async function toggleAuthorLove(authorId, userId) {\r\n  try {\r\n    if (!userId) throw new Error('User ID required');\r\n    \r\n    const { data, error } = await supabase\r\n      .rpc('toggle_author_love', {\r\n        p_user_id: userId,\r\n        p_author_id: authorId\r\n      });\r\n    \r\n    if (error) throw error;\r\n    return { success: true, isLoved: data };\r\n  } catch (error) {\r\n    console.error('Error toggling author love:', error);\r\n    throw error;\r\n  }\r\n}\r\n\r\nexport async function getAuthorLoves(authorId) {\r\n  try {\r\n    const { data, error } = await supabase\r\n      .from('author_loves')\r\n      .select('id, user_id, profiles(id, username, avatar_url), loved_at')\r\n      .eq('author_id', authorId)\r\n      .order('loved_at', { ascending: false });\r\n    \r\n    if (error) throw error;\r\n    return data || [];\r\n  } catch (error) {\r\n    console.error('Error fetching author loves:', error);\r\n    return [];\r\n  }\r\n}\r\n\r\nexport async function getLovesCount(authorId) {\r\n  try {\r\n    const { count, error } = await supabase\r\n      .from('author_loves')\r\n      .select('id', { count: 'exact' })\r\n      .eq('author_id', authorId);\r\n    \r\n    if (error) throw error;\r\n    return count || 0;\r\n  } catch (error) {\r\n    console.error('Error fetching loves count:', error);\r\n    return 0;\r\n  }\r\n}\r\n\r\n// ============================================\r\n// COMMENTS MANAGEMENT\r\n// ============================================\r\n\r\nexport async function addAuthorComment(authorId, userId, content, parentCommentId = null) {\r\n  try {\r\n    if (!userId) throw new Error('User ID required');\r\n    if (!content || content.trim().length === 0) throw new Error('Comment content required');\r\n\r\n    const { data, error } = await supabase\r\n      .from('author_comments')\r\n      .insert({\r\n        author_id: authorId,\r\n        user_id: userId,\r\n        content,\r\n        parent_comment_id: parentCommentId\r\n      })\r\n      .select('*, profiles(id, username, avatar_url)')\r\n      .single();\r\n\r\n    if (error) throw error;\r\n    return data;\r\n  } catch (error) {\r\n    console.error('Error adding author comment:', error);\r\n    throw error;\r\n  }\r\n}\r\n\r\nexport async function getAuthorComments(authorId, limit = 50) {\r\n  try {\r\n    const { data, error } = await supabase\r\n      .from('author_comments')\r\n      .select('id, user_id, content, parent_comment_id, likes_count, created_at, updated_at, profiles(id, username, avatar_url, tier)')\r\n      .eq('author_id', authorId)\r\n      .is('parent_comment_id', null)\r\n      .order('created_at', { ascending: false })\r\n      .limit(limit);\r\n\r\n    if (error) throw error;\r\n    return data || [];\r\n  } catch (error) {\r\n    console.error('Error fetching author comments:', error);\r\n    return [];\r\n  }\r\n}\r\n\r\nexport async function deleteAuthorComment(commentId, userId) {\r\n  try {\r\n    // Verify ownership\r\n    const { data: comment, error: fetchError } = await supabase\r\n      .from('author_comments')\r\n      .select('user_id')\r\n      .eq('id', commentId)\r\n      .single();\r\n\r\n    if (fetchError) throw fetchError;\r\n    if (comment.user_id !== userId) throw new Error('Unauthorized');\r\n\r\n    const { error } = await supabase\r\n      .from('author_comments')\r\n      .delete()\r\n      .eq('id', commentId);\r\n\r\n    if (error) throw error;\r\n    return { success: true };\r\n  } catch (error) {\r\n    console.error('Error deleting author comment:', error);\r\n    throw error;\r\n  }\r\n}\r\n\r\nexport async function getCommentsCount(authorId) {\r\n  try {\r\n    const { count, error } = await supabase\r\n      .from('author_comments')\r\n      .select('id', { count: 'exact' })\r\n      .eq('author_id', authorId)\r\n      .is('parent_comment_id', null);\r\n\r\n    if (error) throw error;\r\n    return count || 0;\r\n  } catch (error) {\r\n    console.error('Error fetching comments count:', error);\r\n    return 0;\r\n  }\r\n}\r\n\r\n// ============================================\r\n// RATINGS MANAGEMENT\r\n// ============================================\r\n\r\nexport async function rateAuthor(authorId, userId, rating, review = '') {\r\n  try {\r\n    if (!userId) throw new Error('User ID required');\r\n    if (rating < 1 || rating > 5) throw new Error('Rating must be between 1 and 5');\r\n\r\n    const { data, error } = await supabase\r\n      .from('author_ratings')\r\n      .upsert(\r\n        {\r\n          author_id: authorId,\r\n          user_id: userId,\r\n          rating,\r\n          review: review || null\r\n        },\r\n        { onConflict: 'user_id,author_id' }\r\n      )\r\n      .select('*, profiles(id, username, avatar_url)')\r\n      .single();\r\n\r\n    if (error) throw error;\r\n    return data;\r\n  } catch (error) {\r\n    console.error('Error rating author:', error);\r\n    throw error;\r\n  }\r\n}\r\n\r\nexport async function getAuthorRatings(authorId, limit = 20) {\r\n  try {\r\n    const { data, error } = await supabase\r\n      .from('author_ratings')\r\n      .select('id, user_id, rating, review, helpful_count, created_at, profiles(id, username, avatar_url, tier)')\r\n      .eq('author_id', authorId)\r\n      .order('helpful_count', { ascending: false })\r\n      .order('created_at', { ascending: false })\r\n      .limit(limit);\r\n\r\n    if (error) throw error;\r\n    return data || [];\r\n  } catch (error) {\r\n    console.error('Error fetching author ratings:', error);\r\n    return [];\r\n  }\r\n}\r\n\r\nexport async function getRatingsCount(authorId) {\r\n  try {\r\n    const { count, error } = await supabase\r\n      .from('author_ratings')\r\n      .select('id', { count: 'exact' })\r\n      .eq('author_id', authorId);\r\n\r\n    if (error) throw error;\r\n    return count || 0;\r\n  } catch (error) {\r\n    console.error('Error fetching ratings count:', error);\r\n    return 0;\r\n  }\r\n}\r\n\r\nexport async function getAverageRating(authorId) {\r\n  try {\r\n    const { data, error } = await supabase\r\n      .from('author_ratings')\r\n      .select('rating')\r\n      .eq('author_id', authorId);\r\n\r\n    if (error) throw error;\r\n    if (!data || data.length === 0) return 0;\r\n\r\n    const average = data.reduce((sum, r) => sum + r.rating, 0) / data.length;\r\n    return Math.round(average * 10) / 10;\r\n  } catch (error) {\r\n    console.error('Error calculating average rating:', error);\r\n    return 0;\r\n  }\r\n}\r\n\r\nexport async function deleteAuthorRating(authorId, userId) {\r\n  try {\r\n    const { error } = await supabase\r\n      .from('author_ratings')\r\n      .delete()\r\n      .eq('author_id', authorId)\r\n      .eq('user_id', userId);\r\n\r\n    if (error) throw error;\r\n    return { success: true };\r\n  } catch (error) {\r\n    console.error('Error deleting rating:', error);\r\n    throw error;\r\n  }\r\n}\r\n\r\n// ============================================\r\n// SHARES MANAGEMENT\r\n// ============================================\r\n\r\nexport async function recordAuthorShare(authorId, userId, shareType, platform = null) {\r\n  try {\r\n    const { data, error } = await supabase\r\n      .from('author_shares')\r\n      .insert({\r\n        author_id: authorId,\r\n        user_id: userId || null,\r\n        share_type: shareType,\r\n        platform: platform || null\r\n      })\r\n      .select()\r\n      .single();\r\n\r\n    if (error) throw error;\r\n    return data;\r\n  } catch (error) {\r\n    console.error('Error recording author share:', error);\r\n    throw error;\r\n  }\r\n}\r\n\r\nexport async function getSharesCount(authorId) {\r\n  try {\r\n    const { count, error } = await supabase\r\n      .from('author_shares')\r\n      .select('id', { count: 'exact' })\r\n      .eq('author_id', authorId);\r\n\r\n    if (error) throw error;\r\n    return count || 0;\r\n  } catch (error) {\r\n    console.error('Error fetching shares count:', error);\r\n    return 0;\r\n  }\r\n}\r\n\r\n// ============================================\r\n// USER INTERACTION STATUS\r\n// ============================================\r\n\r\nexport async function getUserAuthorInteractionStatus(authorId, userId) {\r\n  try {\r\n    if (!userId) {\r\n      return {\r\n        isFollower: false,\r\n        hasLiked: false,\r\n        hasLoved: false,\r\n        userRating: null\r\n      };\r\n    }\r\n\r\n    const { data, error } = await supabase\r\n      .rpc('get_author_interaction_status', {\r\n        p_user_id: userId,\r\n        p_author_id: authorId\r\n      })\r\n      .single();\r\n\r\n    if (error) {\r\n      console.error('Error fetching user interaction status:', error);\r\n      return {\r\n        isFollower: false,\r\n        hasLiked: false,\r\n        hasLoved: false,\r\n        userRating: null\r\n      };\r\n    }\r\n\r\n    return {\r\n      isFollower: data.is_follower || false,\r\n      hasLiked: data.has_liked || false,\r\n      hasLoved: data.has_loved || false,\r\n      userRating: data.user_rating\r\n    };\r\n  } catch (error) {\r\n    console.error('Error in getUserAuthorInteractionStatus:', error);\r\n    return {\r\n      isFollower: false,\r\n      hasLiked: false,\r\n      hasLoved: false,\r\n      userRating: null\r\n    };\r\n  }\r\n}\r\n\r\n// ============================================\r\n// AUTHOR ENGAGEMENT STATISTICS\r\n// ============================================\r\n\r\nexport async function getAuthorEngagementStats(authorId) {\r\n  try {\r\n    const { data, error } = await supabase\r\n      .from('author_engagement_stats')\r\n      .select('*')\r\n      .eq('author_id', authorId)\r\n      .single();\r\n\r\n    if (error && error.code !== 'PGRST116') throw error;\r\n\r\n    return data || {\r\n      author_id: authorId,\r\n      books_count: 0,\r\n      total_downloads: 0,\r\n      total_views: 0,\r\n      average_rating: 0,\r\n      followers_count: 0,\r\n      likes_count: 0,\r\n      loves_count: 0,\r\n      comments_count: 0,\r\n      ratings_count: 0,\r\n      shares_count: 0,\r\n      engagement_score: 0\r\n    };\r\n  } catch (error) {\r\n    console.error('Error fetching author engagement stats:', error);\r\n    return null;\r\n  }\r\n}\r\n\r\nexport async function getAllAuthorsEngagementStats(limit = 100) {\r\n  try {\r\n    const { data, error } = await supabase\r\n      .from('author_engagement_stats')\r\n      .select('*')\r\n      .order('engagement_score', { ascending: false })\r\n      .limit(limit);\r\n\r\n    if (error) throw error;\r\n    return data || [];\r\n  } catch (error) {\r\n    console.error('Error fetching all authors engagement stats:', error);\r\n    return [];\r\n  }\r\n}\r\n\r\nexport async function getTopAuthors(limit = 10) {\r\n  try {\r\n    const { data, error } = await supabase\r\n      .from('author_engagement_stats')\r\n      .select('*')\r\n      .order('engagement_score', { ascending: false })\r\n      .limit(limit);\r\n\r\n    if (error) throw error;\r\n    return data || [];\r\n  } catch (error) {\r\n    console.error('Error fetching top authors:', error);\r\n    return [];\r\n  }\r\n}\r\n\r\n// ============================================\r\n// AUTHOR PROFILE ENRICHMENT\r\n// ============================================\r\n\r\nexport async function enrichAuthorWithInteractions(author, userId = null) {\r\n  try {\r\n    const stats = await getAuthorEngagementStats(author.name || author.author_id);\r\n    const interactions = userId \r\n      ? await getUserAuthorInteractionStatus(author.name || author.author_id, userId)\r\n      : null;\r\n\r\n    return {\r\n      ...author,\r\n      ...stats,\r\n      interactions\r\n    };\r\n  } catch (error) {\r\n    console.error('Error enriching author:', error);\r\n    return author;\r\n  }\r\n}\r\n\r\nexport async function enrichAuthorsWithInteractions(authors, userId = null) {\r\n  try {\r\n    return Promise.all(\r\n      authors.map(author => enrichAuthorWithInteractions(author, userId))\r\n    );\r\n  } catch (error) {\r\n    console.error('Error enriching authors:', error);\r\n    return authors;\r\n  }\r\n}\r\n","import React, { useEffect, useState, useMemo } from 'react';\r\nimport { FiBook, FiDownload, FiStar, FiSearch, FiTrendingUp, FiHeart, FiUsers, FiMessageSquare, FiThumbsUp } from 'react-icons/fi';\r\nimport { MdFavoriteBorder } from 'react-icons/md';\r\nimport { fetchStats } from '../api';\r\nimport { getAllAuthorsEngagementStats } from '../authorInteractionsApi';\r\nimport './Authors.css';\r\n\r\nconst Authors = () => {\r\n  const [stats, setStats] = useState(null);\r\n  const [engagementStats, setEngagementStats] = useState({});\r\n  const [loading, setLoading] = useState(true);\r\n  const [searchTerm, setSearchTerm] = useState('');\r\n  const [sortBy, setSortBy] = useState('engagement');\r\n  const [timeRange, setTimeRange] = useState('monthly');\r\n\r\n  useEffect(() => {\r\n    const loadData = async () => {\r\n      try {\r\n        setLoading(true);\r\n        const [statsData, engageData] = await Promise.all([\r\n          fetchStats(),\r\n          getAllAuthorsEngagementStats(100)\r\n        ]);\r\n        \r\n        setStats(statsData);\r\n        \r\n        // Create engagement stats map for quick lookup by author name\r\n        const engageMap = {};\r\n        engageData.forEach(stat => {\r\n          engageMap[stat.author_name] = stat;\r\n        });\r\n        setEngagementStats(engageMap);\r\n      } catch (error) {\r\n        console.error('Failed to load authors stats:', error);\r\n      } finally {\r\n        setLoading(false);\r\n      }\r\n    };\r\n\r\n    loadData();\r\n    const interval = setInterval(loadData, 30000); // Refresh every 30 seconds\r\n    return () => clearInterval(interval);\r\n  }, []);\r\n\r\n  const filteredAndSorted = useMemo(() => {\r\n    if (!stats || !stats.authors) return [];\r\n\r\n    let filtered = stats.authors.filter(author =>\r\n      author.name.toLowerCase().includes(searchTerm.toLowerCase())\r\n    );\r\n\r\n    filtered.sort((a, b) => {\r\n      const authorEngageA = engagementStats[a.name] || {};\r\n      const authorEngageB = engagementStats[b.name] || {};\r\n\r\n      switch (sortBy) {\r\n        case 'engagement':\r\n          return (authorEngageB.engagement_score || 0) - (authorEngageA.engagement_score || 0);\r\n        case 'books':\r\n          return b.bookCount - a.bookCount;\r\n        case 'downloads':\r\n          return b.totalDownloads - a.totalDownloads;\r\n        case 'followers':\r\n          return (authorEngageB.followers_count || 0) - (authorEngageA.followers_count || 0);\r\n        case 'likes':\r\n          return (authorEngageB.likes_count || 0) - (authorEngageA.likes_count || 0);\r\n        case 'rating':\r\n          return parseFloat(b.avgRating || 0) - parseFloat(a.avgRating || 0);\r\n        case 'name':\r\n          return a.name.localeCompare(b.name);\r\n        default:\r\n          return (authorEngageB.engagement_score || 0) - (authorEngageA.engagement_score || 0);\r\n      }\r\n    });\r\n\r\n    return filtered;\r\n  }, [stats, searchTerm, sortBy, engagementStats]);\r\n\r\n  const overallStats = useMemo(() => {\r\n    if (!stats || !stats.authors) return { \r\n      totalAuthors: 0, \r\n      totalBooks: 0, \r\n      totalDL: 0, \r\n      avgRating: 0,\r\n      totalFollowers: 0,\r\n      totalLikes: 0,\r\n      totalLoves: 0,\r\n      totalComments: 0\r\n    };\r\n\r\n    const totalBooks = stats.authors.reduce((sum, a) => sum + (a.bookCount || 0), 0);\r\n    const totalDL = stats.authors.reduce((sum, a) => sum + (a.totalDownloads || 0), 0);\r\n    const avgRating = stats.authors.length > 0\r\n      ? (stats.authors.reduce((sum, a) => sum + (parseFloat(a.avgRating) || 0), 0) / stats.authors.length).toFixed(1)\r\n      : 0;\r\n    \r\n    // Sum engagement metrics\r\n    const totalFollowers = Object.values(engagementStats).reduce((sum, stat) => sum + (stat.followers_count || 0), 0);\r\n    const totalLikes = Object.values(engagementStats).reduce((sum, stat) => sum + (stat.likes_count || 0), 0);\r\n    const totalLoves = Object.values(engagementStats).reduce((sum, stat) => sum + (stat.loves_count || 0), 0);\r\n    const totalComments = Object.values(engagementStats).reduce((sum, stat) => sum + (stat.comments_count || 0), 0);\r\n\r\n    return {\r\n      totalAuthors: stats.authors.length,\r\n      totalBooks,\r\n      totalDL,\r\n      avgRating,\r\n      totalFollowers,\r\n      totalLikes,\r\n      totalLoves,\r\n      totalComments\r\n    };\r\n  }, [stats, engagementStats]);\r\n\r\n  if (loading) {\r\n    return (\r\n      <div className=\"authors-page\">\r\n        <div className=\"authors-loading\">\r\n          <div className=\"authors-spinner\"></div>\r\n          <p>Loading authors data...</p>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className=\"authors-page\">\r\n      {/* Header */}\r\n      <div className=\"authors-header\">\r\n        <div className=\"authors-title-section\">\r\n          <h1 className=\"authors-title\">\r\n            <FiTrendingUp /> Authors Analytics\r\n          </h1>\r\n          <p className=\"authors-subtitle\">Comprehensive author performance and engagement metrics</p>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Stats Cards */}\r\n      <div className=\"authors-stats-grid\">\r\n        <div className=\"authors-stat-card\">\r\n          <div className=\"authors-stat-icon authors-stat-icon-1\">\r\n            <FiBook />\r\n          </div>\r\n          <div className=\"authors-stat-content\">\r\n            <div className=\"authors-stat-label\">Total Authors</div>\r\n            <div className=\"authors-stat-value\">{overallStats.totalAuthors}</div>\r\n          </div>\r\n        </div>\r\n\r\n        <div className=\"authors-stat-card\">\r\n          <div className=\"authors-stat-icon authors-stat-icon-2\">\r\n            <FiBook />\r\n          </div>\r\n          <div className=\"authors-stat-content\">\r\n            <div className=\"authors-stat-label\">Total Books</div>\r\n            <div className=\"authors-stat-value\">{overallStats.totalBooks}</div>\r\n          </div>\r\n        </div>\r\n\r\n        <div className=\"authors-stat-card\">\r\n          <div className=\"authors-stat-icon authors-stat-icon-3\">\r\n            <FiDownload />\r\n          </div>\r\n          <div className=\"authors-stat-content\">\r\n            <div className=\"authors-stat-label\">Total Downloads</div>\r\n            <div className=\"authors-stat-value\">{overallStats.totalDL.toLocaleString()}</div>\r\n          </div>\r\n        </div>\r\n\r\n        <div className=\"authors-stat-card\">\r\n          <div className=\"authors-stat-icon authors-stat-icon-4\">\r\n            <FiStar />\r\n          </div>\r\n          <div className=\"authors-stat-content\">\r\n            <div className=\"authors-stat-label\">Avg Rating</div>\r\n            <div className=\"authors-stat-value\">{overallStats.avgRating}</div>\r\n          </div>\r\n        </div>\r\n\r\n        <div className=\"authors-stat-card\">\r\n          <div className=\"authors-stat-icon authors-stat-icon-5\">\r\n            <FiUsers />\r\n          </div>\r\n          <div className=\"authors-stat-content\">\r\n            <div className=\"authors-stat-label\">Total Followers</div>\r\n            <div className=\"authors-stat-value\">{overallStats.totalFollowers}</div>\r\n          </div>\r\n        </div>\r\n\r\n        <div className=\"authors-stat-card\">\r\n          <div className=\"authors-stat-icon authors-stat-icon-6\">\r\n            <MdFavoriteBorder />\r\n          </div>\r\n          <div className=\"authors-stat-content\">\r\n            <div className=\"authors-stat-label\">Total Likes</div>\r\n            <div className=\"authors-stat-value\">{overallStats.totalLikes}</div>\r\n          </div>\r\n        </div>\r\n\r\n        <div className=\"authors-stat-card\">\r\n          <div className=\"authors-stat-icon authors-stat-icon-7\">\r\n            <FiHeart />\r\n          </div>\r\n          <div className=\"authors-stat-content\">\r\n            <div className=\"authors-stat-label\">Total Loves</div>\r\n            <div className=\"authors-stat-value\">{overallStats.totalLoves}</div>\r\n          </div>\r\n        </div>\r\n\r\n        <div className=\"authors-stat-card\">\r\n          <div className=\"authors-stat-icon authors-stat-icon-8\">\r\n            <FiMessageSquare />\r\n          </div>\r\n          <div className=\"authors-stat-content\">\r\n            <div className=\"authors-stat-label\">Total Comments</div>\r\n            <div className=\"authors-stat-value\">{overallStats.totalComments}</div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Controls */}\r\n      <div className=\"authors-controls\">\r\n        <div className=\"authors-control-group\">\r\n          <label className=\"authors-label\">Search Author</label>\r\n          <div className=\"authors-search-wrapper\">\r\n            <FiSearch className=\"authors-search-icon\" />\r\n            <input\r\n              type=\"text\"\r\n              placeholder=\"Search by author name...\"\r\n              value={searchTerm}\r\n              onChange={(e) => setSearchTerm(e.target.value)}\r\n              className=\"authors-search-input\"\r\n            />\r\n          </div>\r\n        </div>\r\n\r\n        <div className=\"authors-control-group\">\r\n          <label className=\"authors-label\">Sort By</label>\r\n          <select\r\n            value={sortBy}\r\n            onChange={(e) => setSortBy(e.target.value)}\r\n            className=\"authors-select\"\r\n          >\r\n            <option value=\"engagement\">Engagement Score</option>\r\n            <option value=\"followers\">Followers</option>\r\n            <option value=\"likes\">Likes</option>\r\n            <option value=\"books\">Books Count</option>\r\n            <option value=\"downloads\">Downloads</option>\r\n            <option value=\"rating\">Rating</option>\r\n            <option value=\"name\">Name (A-Z)</option>\r\n          </select>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Table */}\r\n      <div className=\"authors-table-wrapper\">\r\n        <table className=\"authors-table\">\r\n          <thead className=\"authors-table-head\">\r\n            <tr>\r\n              <th className=\"authors-table-header authors-rank-col\">Rank</th>\r\n              <th className=\"authors-table-header authors-name-col\">Author Name</th>\r\n              <th className=\"authors-table-header authors-num-col\">Books</th>\r\n              <th className=\"authors-table-header authors-num-col\">Downloads</th>\r\n              <th className=\"authors-table-header authors-num-col\">Followers</th>\r\n              <th className=\"authors-table-header authors-num-col\">Likes</th>\r\n              <th className=\"authors-table-header authors-num-col\">Loves</th>\r\n              <th className=\"authors-table-header authors-num-col\">Rating</th>\r\n              <th className=\"authors-table-header authors-num-col\">Score</th>\r\n            </tr>\r\n          </thead>\r\n          <tbody className=\"authors-table-body\">\r\n            {filteredAndSorted.length > 0 ? (\r\n              filteredAndSorted.map((author, idx) => {\r\n                const engage = engagementStats[author.name] || {};\r\n                const engScore = engage.engagement_score || 0;\r\n                const medal = idx === 0 ? '' : idx === 1 ? '' : idx === 2 ? '' : `#${idx + 1}`;\r\n\r\n                return (\r\n                  <tr key={author.id} className=\"authors-table-row\">\r\n                    <td className=\"authors-table-cell authors-rank-col\">\r\n                      <span className=\"authors-rank-badge\">{medal}</span>\r\n                    </td>\r\n                    <td className=\"authors-table-cell authors-name-col\">\r\n                      <div className=\"authors-author-name\">\r\n                        {author.name === 'Unknown' ? ' Unknown Author' : author.name}\r\n                      </div>\r\n                    </td>\r\n                    <td className=\"authors-table-cell authors-num-col\">\r\n                      <span className=\"authors-metric-plain authors-books-count\">{author.bookCount}</span>\r\n                    </td>\r\n                    <td className=\"authors-table-cell authors-num-col\">\r\n                      <span className=\"authors-metric-plain authors-downloads-count\">{author.totalDownloads}</span>\r\n                    </td>\r\n                    <td className=\"authors-table-cell authors-num-col\">\r\n                      <span className=\"authors-metric-plain authors-followers-count\">{engage.followers_count || 0}</span>\r\n                    </td>\r\n                    <td className=\"authors-table-cell authors-num-col\">\r\n                      <span className=\"authors-metric-plain authors-likes-count\">\r\n                        <FiThumbsUp className=\"authors-metric-icon\" />\r\n                        {engage.likes_count || 0}\r\n                      </span>\r\n                    </td>\r\n                    <td className=\"authors-table-cell authors-num-col\">\r\n                      <span className=\"authors-metric-plain authors-loves-count\">\r\n                        <FiHeart className=\"authors-metric-icon\" />\r\n                        {engage.loves_count || 0}\r\n                      </span>\r\n                    </td>\r\n                    <td className=\"authors-table-cell authors-num-col\">\r\n                      <span className=\"authors-rating-plain\">\r\n                        {engage.average_rating > 0 ? engage.average_rating.toFixed(1) : ''} \r\n                      </span>\r\n                    </td>\r\n                    <td className=\"authors-table-cell authors-num-col\">\r\n                      <span className=\"authors-score-plain\">{engScore.toFixed(2)}</span>\r\n                    </td>\r\n                  </tr>\r\n                );\r\n              })\r\n            ) : (\r\n              <tr className=\"authors-table-row authors-empty-row\">\r\n                <td colSpan=\"9\" className=\"authors-table-cell authors-empty-message\">\r\n                  No authors found matching \"{searchTerm}\"\r\n                </td>\r\n              </tr>\r\n            )}\r\n          </tbody>\r\n        </table>\r\n      </div>\r\n\r\n      {/* Summary */}\r\n      <div className=\"authors-summary\">\r\n        <div className=\"authors-summary-item\">\r\n          <span className=\"authors-summary-label\">Showing</span>\r\n          <span className=\"authors-summary-value\">{filteredAndSorted.length} of {overallStats.totalAuthors}</span>\r\n          <span className=\"authors-summary-label\">authors</span>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Authors;\r\n","import React, { useState, useEffect } from 'react';\nimport { useSearchParams } from 'react-router-dom';\nimport { FiBook, FiMapPin, FiFileText, FiBookOpen } from 'react-icons/fi';\nimport Books from './Books';\nimport UniversitiesManagement from './UniversitiesManagement';\nimport PastPapersManagement from './PastPapersManagement';\nimport Authors from './Authors';\n\nconst tabStyles = `\n  .content-tabs {\n    display: flex;\n    gap: 4px;\n    margin-bottom: 8px;\n    border-bottom: 1px solid #374151;\n  }\n  .content-tab {\n    display: flex;\n    align-items: center;\n    gap: 4px;\n    padding: 6px 12px;\n    background: transparent;\n    border: none;\n    color: #8696a0;\n    cursor: pointer;\n    font-size: 14px;\n    font-weight: 500;\n    transition: all 0.3s ease;\n    border-bottom: 2px solid transparent;\n    margin-bottom: -1px;\n  }\n  .content-tab:hover {\n    color: #e9edef;\n    background: rgba(0, 168, 132, 0.05);\n  }\n  .content-tab.active {\n    color: #00a884;\n    border-bottom-color: #00a884;\n  }\n`;\n\nconst ContentManagement = ({ userProfile }) => {\n  const [searchParams] = useSearchParams();\n  const [activeTab, setActiveTab] = useState('books');\n\n  useEffect(() => {\n    const tabParam = searchParams.get('tab');\n    if (tabParam === 'pastpapers') {\n      setActiveTab('pastpapers');\n    } else if (tabParam === 'universities') {\n      setActiveTab('universities');\n    } else if (tabParam === 'authors') {\n      setActiveTab('authors');\n    } else {\n      setActiveTab('books');\n    }\n  }, [searchParams]);\n\n  React.useEffect(() => {\n    const styleTag = document.createElement('style');\n    styleTag.innerHTML = tabStyles;\n    document.head.appendChild(styleTag);\n    return () => styleTag.remove();\n  }, []);\n\n  return (\n    <div>\n      <div className=\"content-tabs\">\n        <button \n          className={`content-tab ${activeTab === 'books' ? 'active' : ''}`}\n          onClick={() => setActiveTab('books')}\n        >\n          <FiBook size={20} />\n          Books\n        </button>\n        <button \n          className={`content-tab ${activeTab === 'universities' ? 'active' : ''}`}\n          onClick={() => setActiveTab('universities')}\n        >\n          <FiMapPin size={20} />\n          Universities\n        </button>\n        <button \n          className={`content-tab ${activeTab === 'pastpapers' ? 'active' : ''}`}\n          onClick={() => setActiveTab('pastpapers')}\n        >\n          <FiFileText size={20} />\n          Past Papers\n        </button>\n        <button \n          className={`content-tab ${activeTab === 'authors' ? 'active' : ''}`}\n          onClick={() => setActiveTab('authors')}\n        >\n          <FiBookOpen size={20} />\n          Authors\n        </button>\n      </div>\n\n      {activeTab === 'books' && <Books userProfile={userProfile} />}\n      {activeTab === 'universities' && <UniversitiesManagement userProfile={userProfile} />}\n      {activeTab === 'pastpapers' && <PastPapersManagement userProfile={userProfile} />}\n      {activeTab === 'authors' && <Authors />}\n    </div>\n  );\n};\n\nexport default ContentManagement;","import { supabase } from '../supabaseClient';\nimport { API_URL } from '../../../config';\n\n// API Configuration\nconst USE_BACKEND_PROXY = true; // Set to false to use direct API calls\n\n/**\n * Search for university names for autocomplete\n */\nexport async function searchUniversityNames(query, limit = 10) {\n  try {\n    // Check cache first\n    let { data, error } = await supabase\n      .rpc('search_university_names', { p_query: query, p_limit: limit });\n\n    if (error) throw error;\n    if (data?.length) return data;\n\n    // Try Wikipedia/Wikidata search as primary method (more reliable, no API key needed)\n    const wikiResults = await searchWikipediaUniversities(query, limit);\n    if (wikiResults.length > 0) {\n      // Cache results\n      await Promise.all(wikiResults.map(uni => \n        cacheUniversityPrefillData(uni.name, uni, 'wikipedia')\n      ));\n      return wikiResults;\n    }\n\n    // Try backend proxy for Google Knowledge Graph (if enabled)\n    if (USE_BACKEND_PROXY) {\n      try {\n        const response = await fetch(`${API_URL}/api/university/search?query=${encodeURIComponent(query)}&limit=${limit}`);\n        \n        if (response.ok) {\n          const data = await response.json();\n          const universities = data.universities || [];\n          \n          // Cache results\n          if (universities.length > 0) {\n            await Promise.all(universities.map(uni => \n              cacheUniversityPrefillData(uni.name, uni, 'google_proxy')\n            ));\n          }\n          \n          return universities;\n        }\n      } catch (proxyError) {\n        console.warn('Backend proxy unavailable:', proxyError.message);\n      }\n    }\n\n    return [];\n  } catch (error) {\n    console.error('Error searching university names:', error);\n    return [];\n  }\n}\n\n/**\n * Search for universities using Wikipedia API (more reliable, no API key needed)\n */\nasync function searchWikipediaUniversities(query, limit = 10) {\n  try {\n    const searchUrl = `https://en.wikipedia.org/w/api.php?action=opensearch&search=${encodeURIComponent(query + ' university')}&limit=${limit}&namespace=0&format=json&origin=*`;\n    const response = await fetch(searchUrl);\n    \n    if (!response.ok) return [];\n    \n    const data = await response.json();\n    // data[0] = query, data[1] = titles, data[2] = descriptions, data[3] = urls\n    const titles = data[1] || [];\n    const descriptions = data[2] || [];\n    const urls = data[3] || [];\n    \n    return titles\n      .filter(title => title.toLowerCase().includes('university') || title.toLowerCase().includes('college'))\n      .map((title, index) => ({\n        name: title,\n        description: descriptions[index] || '',\n        website_url: urls[index] || '',\n      }));\n  } catch (error) {\n    console.error('Error searching Wikipedia:', error);\n    return [];\n  }\n}\n\n/**\n * Get prefill data for a university by name from cache\n */\nexport async function getUniversityPrefillData(universityName) {\n  try {\n    const { data, error } = await supabase\n      .rpc('get_university_prefill_data', {\n        p_university_name: universityName,\n      });\n\n    if (error) throw error;\n    return data;\n  } catch (error) {\n    console.error('Error fetching prefill data:', error);\n    return null;\n  }\n}\n\n/**\n * Fetch university data from Google Knowledge Graph (via backend proxy)\n */\nexport async function fetchUniversityDataFromGoogle(universityName) {\n  if (USE_BACKEND_PROXY) {\n    try {\n      const response = await fetch(`${API_URL}/api/university/details?name=${encodeURIComponent(universityName)}`);\n      \n      if (response.ok) {\n        const data = await response.json();\n        return {\n          name: data.university.name || universityName,\n          description: data.university.description || '',\n          website_url: data.university.website_url || '',\n          location: data.university.location || '',\n          established: null,\n          student_count: null,\n          cover_images: data.university.image ? [data.university.image] : [],\n        };\n      }\n    } catch (error) {\n      console.error('Error fetching from Google via proxy:', error);\n    }\n  }\n  \n  return null;\n}\n\n/**\n * Fetch university summary from Wikipedia REST API\n */\nexport async function fetchUniversityDataFromWikipedia(universityName) {\n  try {\n    const url = `https://en.wikipedia.org/api/rest_v1/page/summary/${encodeURIComponent(universityName)}`;\n    const res = await fetch(url);\n    if (!res.ok) return null;\n    const json = await res.json();\n\n    return {\n      name: json.title || universityName,\n      description: json.extract || '',\n      website_url: '',\n      location: '',\n      established: null,\n      student_count: null,\n      cover_images: json.thumbnail?.source ? [json.thumbnail.source] : [],\n    };\n  } catch (e) {\n    console.error('Error fetching from Wikipedia REST:', e);\n    return null;\n  }\n}\n\n/**\n * Fetch university data from Wikidata\n */\nexport async function fetchUniversityDataFromWikidata(universityName) {\n  try {\n    const sparqlQuery = `\n      SELECT ?item ?itemLabel ?locationLabel ?established ?studentCount ?website\n      WHERE {\n        ?item wdt:P31/wdt:P279* wd:Q3918;\n              rdfs:label ?itemLabel.\n        OPTIONAL { ?item wdt:P131 ?location. }\n        OPTIONAL { ?item wdt:P571 ?established. }\n        OPTIONAL { ?item wdt:P2196 ?studentCount. }\n        OPTIONAL { ?item wdt:P856 ?website. }\n        FILTER(CONTAINS(LCASE(?itemLabel), LCASE(\"${universityName}\")))\n        FILTER(LANG(?itemLabel) = \"en\")\n        SERVICE wikibase:label { bd:serviceParam wikibase:language \"en\". }\n      }\n      LIMIT 1\n    `;\n    const url = `https://query.wikidata.org/sparql?query=${encodeURIComponent(sparqlQuery)}&format=json`;\n    const response = await fetch(url);\n    if (!response.ok) return null;\n\n    const data = await response.json();\n    const binding = data.results.bindings[0];\n\n    if (!binding) return null;\n\n    return {\n      name: binding.itemLabel.value,\n      description: '',\n      website_url: binding.website?.value || '',\n      location: binding.locationLabel?.value || '',\n      established: binding.established?.value ? new Date(binding.established.value).getFullYear() : null,\n      student_count: binding.studentCount?.value || null,\n      cover_images: [],\n    };\n  } catch (error) {\n    console.error('Error fetching from Wikidata:', error);\n    return null;\n  }\n}\n\n/**\n * Fetch Wikimedia Commons images for a university\n */\nexport async function fetchWikimediaImages(universityName) {\n  try {\n    const title = (universityName || '').trim().replace(/\\s+/g, '_');\n    if (!title) return [];\n\n    const listUrl = `https://commons.wikimedia.org/w/api.php?action=query&format=json&origin=*&prop=images&titles=${encodeURIComponent(title)}`;\n    const listRes = await fetch(listUrl);\n    if (!listRes.ok) return [];\n    const listJson = await listRes.json();\n\n    const pages = listJson?.query?.pages ? Object.values(listJson.query.pages) : [];\n    const images = pages[0]?.images || [];\n    if (!images.length) return [];\n\n    const fileTitles = images\n      .map((img) => img?.title)\n      .filter(Boolean)\n      .slice(0, 50)\n      .join('|');\n\n    if (!fileTitles) return [];\n\n    const infoUrl = `https://commons.wikimedia.org/w/api.php?action=query&format=json&origin=*&prop=imageinfo&iiprop=url&titles=${encodeURIComponent(fileTitles)}`;\n    const infoRes = await fetch(infoUrl);\n    if (!infoRes.ok) return [];\n    const infoJson = await infoRes.json();\n\n    const filePages = infoJson?.query?.pages ? Object.values(infoJson.query.pages) : [];\n    const urls = filePages\n      .map((p) => p?.imageinfo?.[0]?.url)\n      .filter((u) => typeof u === 'string' && /\\.(jpg|jpeg|png|webp)$/i.test(u));\n\n    const prioritized = urls.sort((a, b) => {\n      const deprioritize = (s) => /logo|seal|coat_of_arms|emblem/i.test(s) ? 1 : 0;\n      return deprioritize(a) - deprioritize(b);\n    });\n\n    return prioritized.slice(0, 5);\n  } catch (e) {\n    console.error('Error fetching Wikimedia images:', e);\n    return [];\n  }\n}\n\n/**\n * Fetch images from Unsplash (via backend proxy if enabled)\n */\nexport async function fetchUnsplashImages(universityName) {\n  if (USE_BACKEND_PROXY) {\n    try {\n      const response = await fetch(`${API_URL}/api/university/images?query=${encodeURIComponent(universityName)}`);\n      \n      if (response.ok) {\n        const data = await response.json();\n        return data.images?.map(img => img.url) || [];\n      }\n    } catch (error) {\n      console.error('Error fetching Unsplash images via proxy:', error);\n    }\n  }\n  \n  return [];\n}\n\n/**\n * Download image from URL and convert to File object\n */\nexport async function downloadImageAsFile(imageUrl, fileName) {\n  try {\n    const response = await fetch(imageUrl);\n    if (!response.ok) throw new Error('Failed to download image');\n\n    const blob = await response.blob();\n    const file = new File([blob], fileName, { type: blob.type });\n    return file;\n  } catch (error) {\n    console.error('Error downloading image:', error);\n    return null;\n  }\n}\n\n/**\n * Cache university prefill data\n */\nexport async function cacheUniversityPrefillData(universityName, data, source = 'manual') {\n  try {\n    const { error } = await supabase\n      .from('university_prefill_cache')\n      .upsert({\n        university_name: universityName,\n        data: data,\n        source: source,\n        updated_at: new Date().toISOString(),\n      });\n\n    if (error) throw error;\n    return true;\n  } catch (error) {\n    console.error('Error caching prefill data:', error);\n    return false;\n  }\n}\n\n/**\n * Upload multiple images for a university\n */\nexport async function uploadUniversityImages(universityId, imageFiles) {\n  try {\n    const uploadedImages = [];\n    const bucket = 'university-covers';\n\n    for (let i = 0; i < imageFiles.length; i++) {\n      const file = imageFiles[i];\n      const fileExt = file.name.split('.').pop();\n      const fileName = `${universityId}/image_${i + 1}_${Date.now()}.${fileExt}`;\n\n      const { error: uploadError } = await supabase.storage\n        .from(bucket)\n        .upload(fileName, file, {\n          cacheControl: '3600',\n          upsert: false,\n        });\n\n      if (uploadError) {\n        console.error('Error uploading image:', uploadError);\n        continue;\n      }\n\n      const { data: urlData } = supabase.storage\n        .from(bucket)\n        .getPublicUrl(fileName);\n\n      uploadedImages.push({\n        url: urlData.publicUrl,\n        fileName: fileName,\n      });\n    }\n\n    return uploadedImages;\n  } catch (error) {\n    console.error('Error uploading multiple images:', error);\n    throw error;\n  }\n}\n\n/**\n * Add image record to university_images table\n */\nexport async function addUniversityImage(universityId, imageUrl, caption = null, isPrimary = false, displayOrder = 0) {\n  try {\n    const { data, error } = await supabase\n      .rpc('add_university_image', {\n        p_university_id: universityId,\n        p_image_url: imageUrl,\n        p_caption: caption,\n        p_is_primary: isPrimary,\n        p_display_order: displayOrder,\n      });\n\n    if (error) throw error;\n    return data;\n  } catch (error) {\n    console.error('Error adding university image:', error);\n    throw error;\n  }\n}\n\n/**\n * Get all images for a university\n */\nexport async function getUniversityImages(universityId) {\n  try {\n    const { data, error } = await supabase\n      .from('university_images')\n      .select('*')\n      .eq('university_id', universityId)\n      .order('is_primary', { ascending: false })\n      .order('display_order', { ascending: true });\n\n    if (error) throw error;\n    return data || [];\n  } catch (error) {\n    console.error('Error fetching university images:', error);\n    throw error;\n  }\n}\n\n/**\n * Set image as primary\n */\nexport async function setPrimaryUniversityImage(imageId) {\n  try {\n    const { error } = await supabase\n      .rpc('set_primary_university_image', {\n        p_image_id: imageId,\n      });\n\n    if (error) throw error;\n    return true;\n  } catch (error) {\n    console.error('Error setting primary image:', error);\n    return false;\n  }\n}\n\n/**\n * Delete university image\n */\nexport async function deleteUniversityImage(imageId, imageUrl) {\n  try {\n    const urlParts = imageUrl.split('/');\n    const bucket = 'university-covers';\n    const filePath = urlParts.slice(urlParts.indexOf(bucket) + 1).join('/');\n\n    const { error: storageError } = await supabase.storage\n      .from(bucket)\n      .remove([filePath]);\n\n    if (storageError) {\n      console.error('Error deleting from storage:', storageError);\n    }\n\n    const { error: dbError } = await supabase\n      .from('university_images')\n      .delete()\n      .eq('id', imageId);\n\n    if (dbError) throw dbError;\n    return true;\n  } catch (error) {\n    console.error('Error deleting university image:', error);\n    throw error;\n  }\n}\n\n/**\n * Main auto-fill function triggered on tab/input\n */\nexport async function autoFillUniversityData(universityName) {\n  try {\n    // Check cache first\n    let data = await getUniversityPrefillData(universityName);\n    if (data) return data;\n\n    // Prefer Wikipedia + Wikidata for accuracy (no API keys needed)\n    const wikiSummary = await fetchUniversityDataFromWikipedia(universityName);\n    const wikidata = await fetchUniversityDataFromWikidata(universityName);\n\n    if (wikiSummary || wikidata) {\n      const merged = {\n        name: (wikiSummary?.name || wikidata?.name || universityName) ?? universityName,\n        description: wikiSummary?.description || '',\n        website_url: wikidata?.website_url || '',\n        location: wikidata?.location || '',\n        established: wikidata?.established ?? null,\n        student_count: wikidata?.student_count ?? null,\n        cover_images: wikiSummary?.cover_images || [],\n      };\n      data = merged;\n    }\n\n    // Try Google as last resort (via proxy if enabled)\n    if (!data) {\n      data = await fetchUniversityDataFromGoogle(universityName);\n    }\n\n    // Fetch images\n    if (data && (!data.cover_images || data.cover_images.length === 0)) {\n      const commons = await fetchWikimediaImages(data.name || universityName);\n      if (commons.length) {\n        data.cover_images = commons;\n      } else {\n        const unsplash = await fetchUnsplashImages(data.name || universityName);\n        data.cover_images = unsplash;\n      }\n    }\n\n    // Cache the result\n    if (data) {\n      await cacheUniversityPrefillData(universityName, data, 'wikipedia_wikidata');\n    }\n\n    return (\n      data || {\n        name: universityName,\n        description: '',\n        website_url: '',\n        location: '',\n        established: null,\n        student_count: null,\n        cover_images: [],\n      }\n    );\n  } catch (error) {\n    console.error('Error auto-filling university data:', error);\n    return {\n      name: universityName,\n      description: '',\n      website_url: '',\n      location: '',\n      established: null,\n      student_count: null,\n      cover_images: [],\n    };\n  }\n}\n\n/**\n * Get all cached universities for dropdown/autocomplete\n */\nexport async function getAllCachedUniversities() {\n  try {\n    const { data, error } = await supabase\n      .from('university_prefill_cache')\n      .select('university_name')\n      .order('university_name');\n\n    if (error) throw error;\n    return data?.map(u => u.university_name) || [];\n  } catch (error) {\n    console.error('Error fetching cached universities:', error);\n    return [];\n  }\n}\n\n/**\n * Debounce utility\n */\nfunction debounce(func, wait) {\n  let timeout;\n  return (...args) => {\n    clearTimeout(timeout);\n    timeout = setTimeout(() => func(...args), wait);\n  };\n}\n\n/**\n * Frontend integration for auto-fill\n */\nexport function setupAutoFill(inputElement, resultContainer) {\n  inputElement.addEventListener(\n    'input',\n    debounce(async () => {\n      const query = inputElement.value.trim();\n      if (query.length < 3) return;\n\n      const suggestions = await searchUniversityNames(query);\n      console.log('Suggestions:', suggestions);\n      \n      const datalist = document.createElement('datalist');\n      datalist.id = 'university-suggestions';\n      suggestions.forEach(s => {\n        const option = document.createElement('option');\n        option.value = s.name;\n        datalist.appendChild(option);\n      });\n      inputElement.setAttribute('list', 'university-suggestions');\n      inputElement.parentNode.appendChild(datalist);\n    }, 300)\n  );\n\n  inputElement.addEventListener('keydown', async (event) => {\n    if (event.key === 'Tab') {\n      event.preventDefault();\n      const universityName = inputElement.value.trim();\n      if (!universityName) return;\n\n      const data = await autoFillUniversityData(universityName);\n      if (data) {\n        resultContainer.innerHTML = `\n          <h3>${data.name}</h3>\n          <p>${data.description || 'No description available'}</p>\n          <a href=\"${data.website_url || '#'}\" target=\"_blank\">Website</a>\n          <p>Location: ${data.location || 'N/A'}</p>\n          <p>Established: ${data.established || 'N/A'}</p>\n          <p>Students: ${data.student_count || 'N/A'}</p>\n          <div>\n            ${data.cover_images\n              .map(img => `<img src=\"${img}\" alt=\"${data.name} campus\" width=\"200\" style=\"margin-right: 10px;\" />`)\n              .join('')}\n          </div>\n        `;\n      }\n    }\n  });\n}"],"names":["_ref","userProfile","loading","setLoading","useState","rows","setRows","count","setCount","page","setPage","pageSize","search","setSearch","categories","setCategories","categoryId","setCategoryId","sort","setSort","col","dir","editingId","setEditingId","selectedIds","setSelectedIds","Set","editDraft","setEditDraft","newPdf","setNewPdf","newCover","setNewCover","isMultiEditMode","setIsMultiEditMode","showCheckboxes","setShowCheckboxes","useCustomCategory","setUseCustomCategory","customCategory","setCustomCategory","confirm","showToast","useAdminUI","ADMIN_EMAILS","isAdmin","role","includes","email","isEditor","totalPages","useMemo","Math","max","ceil","load","async","fetchParams","uncategorized","data","total","fetchBooks","useEffect","fetchCategories","_unused","canEdit","row","cancelEdit","cancelMultiEdit","toggleSort","s","_jsx","children","_jsxs","className","length","style","display","gridTemplateColumns","gap","marginBottom","background","boxShadow","borderRadius","padding","color","fontSize","fontWeight","reduce","sum","r","downloads","views","comments_count","likes_count","value","onChange","e","target","placeholder","map","c","id","name","onClick","window","location","href","justifyContent","alignItems","margin","size","title","_objectSpread","author","category_id","marginTop","type","checked","width","height","cursor","htmlFor","year","publisher","message","updates","Object","keys","booksToUpdate","Array","from","cachedRow","find","cached","missingIds","filter","p","missingBooksMap","Map","allSelectedBooks","updatePromises","batchSize","get","push","updateBook","newPdfFile","newCoverFile","oldFilePath","file_path","Promise","all","console","warn","concat","error","startMultiEdit","visibleSelectedIds","some","every","overflowX","WebkitOverflowScrolling","minWidth","borderCollapse","borderSpacing","toggleSelectAll","item","fetchAllMatchingIds","then","allIds","borderBottom","colSpan","textAlign","_categories$find","has","toggleSelectRow","prev","newSet","delete","add","disabled","cover_url","src","alt","objectFit","flexDirection","pages","Date","created_at","toLocaleDateString","document","getElementById","click","border","transition","accept","_e$target$files","files","_Fragment","slice","_e$target$files2","saveEdit","language","isbn","startEdit","confirmLabel","cancelLabel","variant","deleteBook","handleDelete","min","paperCounts","setPaperCounts","fetchUniversities","counts","BATCH_SIZE","i","countPromises","uni","getPastPaperCountByUniversity","catch","forEach","_ref2","prevCounts","_row$description","_row$student_count","cover_image_url","description","established","student_count","toLocaleString","undefined","Number","updateUniversity","website_url","deleteUniversity","err","formatTimestamp","isoString","month","day","hour","minute","second","hour12","timeZoneName","faculties","setFaculties","facultyFilter","setFacultyFilter","allPaperIds","setAllPaperIds","useCustomFaculty","setUseCustomFaculty","customFaculty","setCustomFaculty","fetchPastPapers","faculty","getFaculties","downloads_count","views_count","trim","f","unit_name","unit_code","semester","exam_type","papersToUpdate","missingPapersMap","allSelectedPapers","updatePastPaper","_row$profiles","_row$profiles2","_row$profiles3","profiles","full_name","deletePastPaper","getAllAuthorsEngagementStats","limit","arguments","supabase","select","order","ascending","Authors","stats","setStats","engagementStats","setEngagementStats","searchTerm","setSearchTerm","sortBy","setSortBy","timeRange","setTimeRange","loadData","statsData","engageData","fetchStats","engageMap","stat","author_name","interval","setInterval","clearInterval","filteredAndSorted","authors","filtered","toLowerCase","a","b","authorEngageA","authorEngageB","engagement_score","bookCount","totalDownloads","followers_count","parseFloat","avgRating","localeCompare","overallStats","totalAuthors","totalBooks","totalDL","totalFollowers","totalLikes","totalLoves","totalComments","toFixed","values","loves_count","FiTrendingUp","FiBook","FiDownload","FiStar","FiUsers","MdFavoriteBorder","FiHeart","FiMessageSquare","FiSearch","idx","engage","engScore","medal","FiThumbsUp","average_rating","searchParams","useSearchParams","activeTab","setActiveTab","tabParam","React","styleTag","createElement","innerHTML","head","appendChild","remove","FiMapPin","FiFileText","FiBookOpen","Books","UniversitiesManagement","PastPapersManagement","USE_BACKEND_PROXY","searchUniversityNames","query","rpc","p_query","p_limit","wikiResults","searchUrl","encodeURIComponent","response","fetch","ok","json","titles","descriptions","urls","index","searchWikipediaUniversities","cacheUniversityPrefillData","API_URL","universities","proxyError","fetchWikimediaImages","universityName","_listJson$query","_pages$","_infoJson$query","replace","listUrl","listRes","listJson","images","fileTitles","img","Boolean","join","infoUrl","infoRes","infoJson","_p$imageinfo","_p$imageinfo$","imageinfo","url","u","test","deprioritize","fetchUnsplashImages","_data$images","downloadImageAsFile","imageUrl","fileName","Error","blob","File","source","upsert","university_name","updated_at","toISOString","autoFillUniversityData","p_university_name","getUniversityPrefillData","wikiSummary","_json$thumbnail","res","extract","cover_images","thumbnail","fetchUniversityDataFromWikipedia","wikidata","_binding$website","_binding$locationLabe","_binding$established","_binding$studentCount","sparqlQuery","binding","results","bindings","itemLabel","website","locationLabel","getFullYear","studentCount","fetchUniversityDataFromWikidata","_wikidata$established","_wikidata$student_cou","university","image","fetchUniversityDataFromGoogle","commons","unsplash"],"ignoreList":[],"sourceRoot":""}