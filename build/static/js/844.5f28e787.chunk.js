"use strict";(self.webpackChunkcampuslife=self.webpackChunkcampuslife||[]).push([[844],{2844:(e,t,l)=>{l.r(t),l.d(t,{default:()=>r});var s=l(9379),o=l(5043),i=l(5200),n=l(3488),a=l(579);const d=n.H,r=e=>{var t,l,n,r,c,p,u,x,h,v,f,y,m,g,b,j,k;let{userProfile:S,asSubmission:w=!1}=e;const[C,N]=(0,o.useState)(""),[z,I]=(0,o.useState)(!0),[T,B]=(0,o.useState)(null),[A,D]=(0,o.useState)([]),[F,P]=(0,o.useState)(!1),[W,R]=(0,o.useState)(null),[U,E]=(0,o.useState)(!1),[O,_]=(0,o.useState)(!1),[H,M]=(0,o.useState)(!1),[L,Y]=(0,o.useState)(null),[J,Z]=(0,o.useState)(null),[G,X]=(0,o.useState)(1),[q,K]=(0,o.useState)(!1),Q=12,V=function(e){Z({message:e,type:arguments.length>1&&void 0!==arguments[1]?arguments[1]:"error"}),setTimeout(()=>Z(null),4e3)};(0,o.useEffect)(()=>{W&&V(W,"error")},[W]);const $=e=>{if(!S)return!w;const t=(null===S||void 0===S?void 0:S.id)||(null===S||void 0===S?void 0:S.uid)||(null===S||void 0===S?void 0:S.user_id)||null,l=((null===S||void 0===S?void 0:S.email)||(null===S||void 0===S?void 0:S.email_address)||"").toLowerCase(),s=e.uploadedBy||e.uploaded_by||e.userId||e.user_id||null,o=(e.startedByEmail||e.actorEmail||e.startedByEmail||e.started_by_email||e.user_email||e.email||"").toLowerCase();return!(!t||!s||String(t)!==String(s))||!(!l||!o||l!==o)};(0,o.useEffect)(()=>{if(!T)return;const e=setInterval(async()=>{try{const m=await fetch("".concat(d,"/api/elib/bulk-upload/status/").concat(T.id)),g=m.headers.get("content-type");if(!g||!g.includes("application/json")){const t=await m.text();if(t.includes("<!DOCTYPE")||t.includes("<html"))return clearInterval(e),void V("Lost connection to server. Backend may have restarted.","error")}const b=await m.json();if(m.ok&&b.ok&&b.process){var t,l,o,i,n,a,r,c,p,u,x,h,v,f,y;const d=(0,s.A)((0,s.A)({},b.process),{},{stats:{total:null!==(t=null===(l=b.process)||void 0===l||null===(o=l.stats)||void 0===o?void 0:o.total)&&void 0!==t?t:0,processed:null!==(i=null===(n=b.process)||void 0===n||null===(a=n.stats)||void 0===a?void 0:a.processed)&&void 0!==i?i:0,successful:null!==(r=null===(c=b.process)||void 0===c||null===(p=c.stats)||void 0===p?void 0:p.successful)&&void 0!==r?r:0,failed:null!==(u=null===(x=b.process)||void 0===x||null===(h=x.stats)||void 0===h?void 0:h.failed)&&void 0!==u?u:0,skipped:null!==(v=null===(f=b.process)||void 0===f||null===(y=f.stats)||void 0===y?void 0:y.skipped)&&void 0!==v?v:0}});B(d),"completed"!==d.status&&"failed"!==d.status||(clearInterval(e),te())}else m.ok||(clearInterval(e),V((null===b||void 0===b?void 0:b.error)||"Failed to get upload status","error"))}catch(m){console.error("Failed to poll status:",m)}},2e3);return()=>clearInterval(e)},[null===T||void 0===T?void 0:T.id]),(0,o.useEffect)(()=>{te(),ee()},[]);const ee=async()=>{try{const e=await fetch("".concat(d,"/api/elib/bulk-upload/processes")),t=e.headers.get("content-type");if(!t||!t.includes("application/json")){const t=await e.text();if(t.includes("<!DOCTYPE")||t.includes("<html"))return void console.error("Server returned HTML instead of JSON - backend may not be running")}const l=await e.json();if(e.ok&&l.ok){const e=(l.processes||[]).map(e=>{var t,l,o,i,n,a,d,r,c,p;return(0,s.A)((0,s.A)({},e),{},{stats:{total:null!==(t=null===e||void 0===e||null===(l=e.stats)||void 0===l?void 0:l.total)&&void 0!==t?t:0,processed:null!==(o=null===e||void 0===e||null===(i=e.stats)||void 0===i?void 0:i.processed)&&void 0!==o?o:0,successful:null!==(n=null===e||void 0===e||null===(a=e.stats)||void 0===a?void 0:a.successful)&&void 0!==n?n:0,failed:null!==(d=null===e||void 0===e||null===(r=e.stats)||void 0===r?void 0:r.failed)&&void 0!==d?d:0,skipped:null!==(c=null===e||void 0===e||null===(p=e.stats)||void 0===p?void 0:p.skipped)&&void 0!==c?c:0}})}),t=(w?e.filter(e=>$(e)):e).find(e=>"running"===e.status&&e.stats.processed<e.stats.total);t&&Y(t)}else e.ok||V((null===l||void 0===l?void 0:l.error)||"Failed to list processes","error")}catch(e){console.error("Failed to check incomplete uploads:",e)}},te=async()=>{try{const e=await fetch("".concat(d,"/api/elib/bulk-upload/processes")),t=e.headers.get("content-type");if(!t||!t.includes("application/json")){const t=await e.text();if(t.includes("<!DOCTYPE")||t.includes("<html"))return void console.error("Server returned HTML instead of JSON - backend may not be running")}const l=await e.json();if(e.ok&&l.ok){const e=(l.processes||[]).map(e=>{var t,l,o,i,n,a,d,r,c,p;return(0,s.A)((0,s.A)({},e),{},{stats:{total:null!==(t=null===e||void 0===e||null===(l=e.stats)||void 0===l?void 0:l.total)&&void 0!==t?t:0,processed:null!==(o=null===e||void 0===e||null===(i=e.stats)||void 0===i?void 0:i.processed)&&void 0!==o?o:0,successful:null!==(n=null===e||void 0===e||null===(a=e.stats)||void 0===a?void 0:a.successful)&&void 0!==n?n:0,failed:null!==(d=null===e||void 0===e||null===(r=e.stats)||void 0===r?void 0:r.failed)&&void 0!==d?d:0,skipped:null!==(c=null===e||void 0===e||null===(p=e.stats)||void 0===p?void 0:p.skipped)&&void 0!==c?c:0}})}),t=w?e.filter(e=>$(e)):e;D(t)}else e.ok||V((null===l||void 0===l?void 0:l.error)||"Failed to fetch processes","error")}catch(e){console.error("Failed to fetch processes:",e)}},le=async()=>{if(C.trim()){P(!0),R(null);try{const e=(null===S||void 0===S?void 0:S.email)||(null===S||void 0===S?void 0:S.email_address)||null,t=(null===S||void 0===S?void 0:S.displayName)||(null===S||void 0===S?void 0:S.name)||(null===S||void 0===S?void 0:S.display_name)||null,l=await fetch("".concat(d,"/api/elib/bulk-upload/start"),{method:"POST",headers:{"Content-Type":"application/json","x-actor-email":e||"admin","x-actor-name":t||""},body:JSON.stringify({booksDirectory:C,skipDuplicates:z,uploadedBy:(null===S||void 0===S?void 0:S.id)||(null===S||void 0===S?void 0:S.uid)||(null===S||void 0===S?void 0:S.user_id)||null,asSubmission:!!w})}),s=l.headers.get("content-type");if(!s||!s.includes("application/json")){const e=await l.text();if(console.error("Server returned non-JSON response:",e.substring(0,500)),e.includes("<!DOCTYPE")||e.includes("<html"))throw new Error("Server error: Unable to connect to upload service. Please ensure the backend is running on "+d);throw new Error("Server returned invalid response. Status: "+l.status)}const o=await l.json();if(!l.ok){const e=(null===o||void 0===o?void 0:o.error)||"Failed to start upload";throw V(e.includes("Directory")?e:"Failed to start upload: ".concat(e),"error"),new Error(e)}o.ok&&(B({id:o.processId,status:"running",startedAt:(new Date).toISOString(),booksDirectory:C,stats:{total:0,processed:0,successful:0,failed:0,skipped:0}}),Y(null),V("Bulk upload started","success"))}catch(e){R(e.message||"Failed to start bulk upload")}finally{P(!1)}}else R("Please enter a valid books directory path")},se=e=>{switch(e){case"running":return(0,a.jsx)(i.jTZ,{className:"animate-spin",style:{color:"#00a884"}});case"completed":return(0,a.jsx)(i.YrT,{style:{color:"#00a884"}});case"failed":return(0,a.jsx)(i.yGN,{style:{color:"#ea4335"}});default:return(0,a.jsx)(i.Ohp,{style:{color:"#8696a0"}})}},oe=e=>{switch(e){case"running":case"completed":return"#00a884";case"failed":return"#ea4335";default:return"#8696a0"}},ie=e=>{if(!e)return"N/A";return new Date(e).toLocaleString()};return(0,a.jsxs)("div",{className:"panel",children:[(0,a.jsx)("div",{className:"panel-title",children:"Automatic Bulk Upload"}),(0,a.jsx)("div",{style:{color:"#8696a0",fontSize:"12px",marginBottom:"8px"},children:"Automatically scan folders for PDFs, extract metadata And then Upload    "}),L&&!T&&(0,a.jsxs)("div",{style:{background:"rgba(0, 168, 132, 0.1)",border:"1px solid #00a884",borderRadius:"4px",padding:"8px",marginBottom:"8px",display:"flex",alignItems:"center",justifyContent:"space-between"},children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{style:{color:"#00a884",fontWeight:"600",marginBottom:"2px"},children:"\ud83d\udcc2 Incomplete Upload Detected"}),(0,a.jsxs)("div",{style:{color:"#8696a0",fontSize:"13px"},children:[L.stats.processed," of ",L.stats.total," files uploaded from ",L.booksDirectory]})]}),(0,a.jsx)("button",{className:"btn primary",onClick:()=>_(!0),style:{marginLeft:"8px"},children:"Resume Upload"})]}),(0,a.jsxs)("div",{className:"panel",style:{marginBottom:"20px"},children:[w&&(0,a.jsx)("div",{style:{marginBottom:"12px",padding:"10px 12px",background:"rgba(99, 102, 241, 0.12)",border:"1px solid rgba(99, 102, 241, 0.35)",borderRadius:8,color:"#c7d2fe",fontSize:13},children:"Your uploads will be sent for admin review. They will appear to others after approval."}),(0,a.jsx)("label",{className:"label",children:"Books Directory Path"}),(0,a.jsx)("input",{className:"input",type:"text",placeholder:"D:\\\\path\\\\to\\\\your\\\\books\\\\folder",value:C,onChange:e=>N(e.target.value),disabled:F||T&&"running"===T.status,style:{backgroundColor:"#1f2c33",color:"#ffffff",border:"1px solid #333",borderRadius:"8px",padding:"10px 12px",width:"100%",outline:"none"}}),(0,a.jsx)("div",{style:{color:"#8696a0",fontSize:"12px",marginTop:"5px"},children:"Enter the full path to your folder containing PDF files (can include subfolders)"}),(0,a.jsxs)("div",{style:{marginTop:"15px",display:"flex",alignItems:"center",gap:"10px"},children:[(0,a.jsx)("input",{type:"checkbox",id:"skip-duplicates",checked:z,onChange:e=>I(e.target.checked),disabled:F||T&&"running"===T.status,style:{width:"18px",height:"18px",cursor:"pointer"}}),(0,a.jsx)("label",{htmlFor:"skip-duplicates",style:{color:"#e9edef",cursor:"pointer",userSelect:"none"},children:"Skip duplicate books (based on ISBN)"})]}),W&&(0,a.jsxs)("div",{style:{marginTop:"15px",padding:"12px",background:"rgba(234, 67, 53, 0.1)",border:"1px solid rgba(234, 67, 53, 0.3)",borderRadius:"8px",color:"#ea4335",display:"flex",alignItems:"center",gap:"10px"},children:[(0,a.jsx)(i.y3G,{size:18}),W]}),(0,a.jsxs)("div",{className:"actions",style:{marginTop:"20px",display:"flex",gap:"10px"},children:[(0,a.jsx)("button",{className:"btn primary",onClick:le,disabled:F||T&&"running"===T.status,style:{display:"flex",alignItems:"center",gap:"8px"},children:F?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(i.jTZ,{className:"animate-spin"}),"Starting..."]}):T&&"running"===T.status?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(i.jTZ,{className:"animate-spin"}),"Upload in Progress..."]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(i.aze,{}),"Start Bulk Upload"]})}),T&&"running"===T.status&&(0,a.jsxs)("button",{className:"btn",onClick:()=>E(!0),style:{display:"flex",alignItems:"center",gap:"8px",background:"#ea4335",color:"white"},children:[(0,a.jsx)(i.yGN,{}),"Stop Upload"]})]})]}),T&&(0,a.jsxs)("div",{className:"panel",style:{marginBottom:"20px"},children:[(0,a.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:"15px"},children:[(0,a.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"10px"},children:[se(T.status),(0,a.jsx)("span",{style:{color:"#e9edef",fontWeight:"500",fontSize:"16px"},children:"Current Upload Progress"})]}),(0,a.jsx)("span",{style:{color:oe(T.status),fontSize:"14px",fontWeight:"500",textTransform:"uppercase"},children:T.status})]}),(0,a.jsxs)("div",{style:{background:"#0b141a",padding:"15px",borderRadius:"8px",marginBottom:"15px"},children:[(0,a.jsx)("div",{style:{color:"#8696a0",fontSize:"12px",marginBottom:"8px"},children:T.booksDirectory}),(null!==(t=null===T||void 0===T||null===(l=T.stats)||void 0===l?void 0:l.total)&&void 0!==t?t:0)>0&&(0,a.jsxs)("div",{style:{marginBottom:"15px"},children:[(0,a.jsx)("div",{style:{width:"100%",height:"8px",background:"#1f2c33",borderRadius:"4px",overflow:"hidden"},children:(0,a.jsx)("div",{style:{width:"".concat((null!==(n=null===T||void 0===T||null===(r=T.stats)||void 0===r?void 0:r.processed)&&void 0!==n?n:0)/((null===T||void 0===T||null===(c=T.stats)||void 0===c?void 0:c.total)||1)*100,"%"),height:"100%",background:"#00a884",transition:"width 0.3s ease"}})}),(0,a.jsxs)("div",{style:{color:"#8696a0",fontSize:"12px",marginTop:"5px",textAlign:"center"},children:[null!==(p=null===T||void 0===T||null===(u=T.stats)||void 0===u?void 0:u.processed)&&void 0!==p?p:0," / ",null!==(x=null===T||void 0===T||null===(h=T.stats)||void 0===h?void 0:h.total)&&void 0!==x?x:0," files processed"]})]}),(0,a.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(120px, 1fr))",gap:"12px"},children:[(0,a.jsxs)("div",{style:{textAlign:"center"},children:[(0,a.jsx)("div",{style:{color:"#00a884",fontSize:"24px",fontWeight:"600"},children:null!==(v=null===T||void 0===T||null===(f=T.stats)||void 0===f?void 0:f.successful)&&void 0!==v?v:0}),(0,a.jsx)("div",{style:{color:"#8696a0",fontSize:"12px"},children:"Successful"})]}),(0,a.jsxs)("div",{style:{textAlign:"center"},children:[(0,a.jsx)("div",{style:{color:"#ea4335",fontSize:"24px",fontWeight:"600"},children:null!==(y=null===T||void 0===T||null===(m=T.stats)||void 0===m?void 0:m.failed)&&void 0!==y?y:0}),(0,a.jsx)("div",{style:{color:"#8696a0",fontSize:"12px"},children:"Failed"})]}),(0,a.jsxs)("div",{style:{textAlign:"center"},children:[(0,a.jsx)("div",{style:{color:"#8696a0",fontSize:"24px",fontWeight:"600"},children:null!==(g=null===T||void 0===T||null===(b=T.stats)||void 0===b?void 0:b.skipped)&&void 0!==g?g:0}),(0,a.jsx)("div",{style:{color:"#8696a0",fontSize:"12px"},children:"Skipped"})]}),(0,a.jsxs)("div",{style:{textAlign:"center"},children:[(0,a.jsx)("div",{style:{color:"#e9edef",fontSize:"24px",fontWeight:"600"},children:null!==(j=null===T||void 0===T||null===(k=T.stats)||void 0===k?void 0:k.total)&&void 0!==j?j:0}),(0,a.jsx)("div",{style:{color:"#8696a0",fontSize:"12px"},children:"Total"})]})]})]}),(0,a.jsxs)("div",{style:{fontSize:"12px",color:"#8696a0"},children:["Started: ",ie(T.startedAt),T.completedAt&&" \u2022 Completed: ".concat(ie(T.completedAt))]})]}),(0,a.jsxs)("div",{className:"panel",children:[(0,a.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:"15px"},children:[(0,a.jsx)("div",{className:"panel-title",style:{margin:0},children:"Upload History"}),(0,a.jsxs)("div",{style:{display:"flex",gap:"8px",alignItems:"center"},children:[(0,a.jsxs)("button",{className:"btn",onClick:te,disabled:q,style:{display:"flex",alignItems:"center",gap:"6px",padding:"6px 12px"},children:[(0,a.jsx)(i.jTZ,{size:14}),"Refresh"]}),A.length>0&&(0,a.jsxs)("button",{className:"btn",onClick:()=>M(!0),disabled:q,style:{display:"flex",alignItems:"center",gap:"6px",padding:"6px 12px",backgroundColor:"#ea4335",color:"white",border:"none",cursor:q?"not-allowed":"pointer",opacity:q?.6:1},children:[(0,a.jsx)(i.IXo,{size:14}),"Clear History"]})]})]}),0===A.length?(0,a.jsx)("div",{style:{textAlign:"center",padding:"40px",color:"#8696a0"},children:"No upload history yet. Start your first bulk upload above."}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"panel",style:{padding:0,overflowX:"auto",WebkitOverflowScrolling:"touch",marginBottom:"12px",minHeight:"700px"},children:(0,a.jsxs)("table",{className:"table",style:{minWidth:"100%",borderCollapse:"separate",borderSpacing:0},children:[(0,a.jsx)("thead",{children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{style:{width:"12%"},children:"Process ID"}),(0,a.jsx)("th",{style:{width:"12%"},children:"Status"}),(0,a.jsx)("th",{style:{width:"25%"},children:"Directory"}),(0,a.jsx)("th",{style:{width:"15%"},children:"Uploaded By"}),(0,a.jsx)("th",{style:{width:"10%"},children:"Successful"}),(0,a.jsx)("th",{style:{width:"8%"},children:"Failed"}),(0,a.jsx)("th",{style:{width:"8%"},children:"Skipped"}),(0,a.jsx)("th",{style:{width:"10%"},children:"Total"})]})}),(0,a.jsx)("tbody",{children:A.slice((G-1)*Q,(G-1)*Q+Q).map((e,t)=>{var l,s,o,i,n,d,r,c;const p=e.actorEmail||e.startedByEmail||e.started_by_email||e.user_email||e.email||null,u=e.startedByName||e.actorName||e.user_name||null||p||"Unknown uploader";return(0,a.jsxs)("tr",{style:{borderBottom:"1px solid #1f2c33"},children:[(0,a.jsx)("td",{style:{fontSize:"12px",color:"#8696a0"},children:(0,a.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[se(e.status),(0,a.jsx)("span",{children:e.id})]})}),(0,a.jsx)("td",{style:{fontSize:"12px",fontWeight:"500",textTransform:"uppercase",color:oe(e.status)},children:e.status}),(0,a.jsx)("td",{style:{fontSize:"12px",color:"#8696a0",maxWidth:"300px",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},title:e.booksDirectory,children:e.booksDirectory}),(0,a.jsx)("td",{style:{fontSize:"12px",color:"#8696a0"},children:(0,a.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"8px",padding:"4px 8px",borderRadius:"4px",width:"fit-content"},children:[(0,a.jsx)("div",{style:{width:"24px",height:"24px",borderRadius:"50%",backgroundColor:"#00a884",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"11px",fontWeight:"bold",color:"#fff"},children:u.charAt(0).toUpperCase()}),(0,a.jsx)("span",{style:{fontSize:"11px"},children:u})]})}),(0,a.jsx)("td",{style:{fontSize:"12px",color:"#00a884",fontWeight:"500"},children:null!==(l=null===e||void 0===e||null===(s=e.stats)||void 0===s?void 0:s.successful)&&void 0!==l?l:0}),(0,a.jsx)("td",{style:{fontSize:"12px",color:"#ea4335",fontWeight:"500"},children:null!==(o=null===e||void 0===e||null===(i=e.stats)||void 0===i?void 0:i.failed)&&void 0!==o?o:0}),(0,a.jsx)("td",{style:{fontSize:"12px",color:"#f1b233",fontWeight:"500"},children:null!==(n=null===e||void 0===e||null===(d=e.stats)||void 0===d?void 0:d.skipped)&&void 0!==n?n:0}),(0,a.jsx)("td",{style:{fontSize:"12px",color:"#e9edef"},children:null!==(r=null===e||void 0===e||null===(c=e.stats)||void 0===c?void 0:c.total)&&void 0!==r?r:0})]},e.id)})})]})}),A.length>Q&&(0,a.jsxs)("div",{className:"actions",style:{marginTop:"12px",justifyContent:"space-between"},children:[(0,a.jsx)("button",{className:"btn",disabled:G<=1,onClick:()=>X(e=>Math.max(1,e-1)),children:"Prev"}),(0,a.jsxs)("span",{style:{color:"#cfd8dc",fontSize:12},children:["Page ",G," of ",Math.max(1,Math.ceil(A.length/Q))]}),(0,a.jsx)("button",{className:"btn",disabled:G>=Math.ceil(A.length/Q),onClick:()=>X(e=>Math.min(Math.max(1,Math.ceil(A.length/Q)),e+1)),children:"Next"})]})]})]}),J&&(0,a.jsxs)("div",{style:{position:"fixed",bottom:"28px",right:"28px",maxWidth:"360px",width:"calc(100% - 56px)",background:"error"===J.type?"#3b1f20":"#12321f",color:"#fff",border:"1px solid rgba(255,255,255,0.2)",padding:"12px 16px",borderRadius:"10px",zIndex:1e4,boxShadow:"0 12px 30px rgba(0,0,0,0.35)",display:"flex",alignItems:"center",gap:"10px",transform:"translateY(0)",opacity:1,transition:"all .25s ease"},children:[(0,a.jsx)("span",{style:{display:"inline-block",width:10,height:10,borderRadius:"50%",background:"error"===J.type?"#ef4444":"#22c55e"}}),(0,a.jsx)("span",{style:{lineHeight:1.4},children:J.message})]}),U&&(0,a.jsx)("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0, 0, 0, 0.7)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999},children:(0,a.jsxs)("div",{style:{background:"#1f2c33",borderRadius:"12px",padding:"25px",maxWidth:"400px",width:"90%"},children:[(0,a.jsx)("h3",{style:{color:"#e9edef",marginBottom:"15px"},children:"Stop Upload?"}),(0,a.jsx)("p",{style:{color:"#8696a0",marginBottom:"20px"},children:"Are you sure you want to stop the upload? Progress will be saved and you can resume later."}),(0,a.jsxs)("div",{style:{display:"flex",gap:"10px",justifyContent:"flex-end"},children:[(0,a.jsx)("button",{className:"btn",onClick:()=>E(!1),children:"Cancel"}),(0,a.jsx)("button",{className:"btn primary",onClick:async()=>{if(T&&"running"===T.status)try{const e=await fetch("".concat(d,"/api/elib/bulk-upload/stop/").concat(T.id),{method:"POST",headers:{"Content-Type":"application/json"}});(await e.json()).ok&&(B((0,s.A)((0,s.A)({},T),{},{status:"stopped"})),E(!1),te())}catch(e){R("Failed to stop upload: "+e.message)}},style:{background:"#ea4335"},children:"Stop Upload"})]})]})}),O&&(0,a.jsx)("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0, 0, 0, 0.7)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999},children:(0,a.jsxs)("div",{style:{background:"#1f2c33",borderRadius:"12px",padding:"25px",maxWidth:"400px",width:"90%"},children:[(0,a.jsx)("h3",{style:{color:"#e9edef",marginBottom:"15px"},children:"Resume Upload?"}),(0,a.jsxs)("p",{style:{color:"#8696a0",marginBottom:"20px"},children:["Resume uploading from where you left off? (",(null===L||void 0===L?void 0:L.stats.processed)||0," of ",(null===L||void 0===L?void 0:L.stats.total)||0," files already uploaded)"]}),(0,a.jsxs)("div",{style:{display:"flex",gap:"10px",justifyContent:"flex-end"},children:[(0,a.jsx)("button",{className:"btn",onClick:()=>_(!1),children:"Cancel"}),(0,a.jsx)("button",{className:"btn primary",onClick:()=>{L&&(N(L.booksDirectory),_(!1),le())},children:"Resume Upload"})]})]})}),H&&(0,a.jsx)("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0, 0, 0, 0.7)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999},children:(0,a.jsxs)("div",{style:{background:"#1f2c33",borderRadius:"12px",padding:"25px",maxWidth:"400px",width:"90%"},children:[(0,a.jsx)("h3",{style:{color:"#e9edef",marginBottom:"15px"},children:"Clear Upload History?"}),(0,a.jsxs)("p",{style:{color:"#8696a0",marginBottom:"20px"},children:["This will delete all ",A.length," upload processes from the history. This action cannot be undone."]}),(0,a.jsxs)("div",{style:{display:"flex",gap:"10px",justifyContent:"flex-end"},children:[(0,a.jsx)("button",{className:"btn",onClick:()=>M(!1),disabled:q,children:"Cancel"}),(0,a.jsx)("button",{className:"btn primary",onClick:async()=>{if(window.confirm("Are you sure you want to clear all upload history? This cannot be undone.")){K(!0);try{const e=await fetch("".concat(d,"/api/elib/bulk-upload/clear-history"),{method:"POST",headers:{"Content-Type":"application/json"}}),t=await e.json();e.ok&&t.ok?(D([]),B(null),M(!1),V("Cleared ".concat(t.clearedCount||0," upload processes"),"success")):V((null===t||void 0===t?void 0:t.error)||"Failed to clear history","error")}catch(e){V("Failed to clear history: "+e.message,"error")}finally{K(!1)}}},disabled:q,style:{background:"#ea4335",cursor:q?"not-allowed":"pointer",opacity:q?.6:1},children:q?"Clearing...":"Clear History"})]})]})})]})}}}]);
//# sourceMappingURL=844.5f28e787.chunk.js.map