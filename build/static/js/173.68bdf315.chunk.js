"use strict";(self.webpackChunkcampuslife=self.webpackChunkcampuslife||[]).push([[173],{1903:(e,a,n)=>{n.d(a,{Fn:()=>r,M9:()=>c,cO:()=>u,d$:()=>m,fH:()=>p,xH:()=>s,zd:()=>o});var t=n(7488);const i="https://somalux-q2bw.onrender.com",l=!0;async function s(e){let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10;try{let{data:s,error:r}=await t.N.rpc("search_university_names",{p_query:e,p_limit:a});if(r)throw r;if(null!==s&&void 0!==s&&s.length)return s;const o=await async function(e){let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10;try{const n="https://en.wikipedia.org/w/api.php?action=opensearch&search=".concat(encodeURIComponent(e+" university"),"&limit=").concat(a,"&namespace=0&format=json&origin=*"),t=await fetch(n);if(!t.ok)return[];const i=await t.json(),l=i[1]||[],s=i[2]||[],r=i[3]||[];return l.filter(e=>e.toLowerCase().includes("university")||e.toLowerCase().includes("college")).map((e,a)=>({name:e,description:s[a]||"",website_url:r[a]||""}))}catch(r){return console.error("Error searching Wikipedia:",r),[]}}(e,a);if(o.length>0)return await Promise.all(o.map(e=>d(e.name,e,"wikipedia"))),o;if(l)try{const n=await fetch("".concat(i,"/api/university/search?query=").concat(encodeURIComponent(e),"&limit=").concat(a));if(n.ok){const e=(await n.json()).universities||[];return e.length>0&&await Promise.all(e.map(e=>d(e.name,e,"google_proxy"))),e}}catch(n){console.warn("Backend proxy unavailable:",n.message)}return[]}catch(s){return console.error("Error searching university names:",s),[]}}async function r(e){try{var a,n,t;const i=(e||"").trim().replace(/\s+/g,"_");if(!i)return[];const l="https://commons.wikimedia.org/w/api.php?action=query&format=json&origin=*&prop=images&titles=".concat(encodeURIComponent(i)),s=await fetch(l);if(!s.ok)return[];const r=await s.json(),o=(null===(n=(null!==r&&void 0!==r&&null!==(a=r.query)&&void 0!==a&&a.pages?Object.values(r.query.pages):[])[0])||void 0===n?void 0:n.images)||[];if(!o.length)return[];const c=o.map(e=>null===e||void 0===e?void 0:e.title).filter(Boolean).slice(0,50).join("|");if(!c)return[];const d="https://commons.wikimedia.org/w/api.php?action=query&format=json&origin=*&prop=imageinfo&iiprop=url&titles=".concat(encodeURIComponent(c)),u=await fetch(d);if(!u.ok)return[];const p=await u.json(),m=(null!==p&&void 0!==p&&null!==(t=p.query)&&void 0!==t&&t.pages?Object.values(p.query.pages):[]).map(e=>{var a,n;return null===e||void 0===e||null===(a=e.imageinfo)||void 0===a||null===(n=a[0])||void 0===n?void 0:n.url}).filter(e=>"string"===typeof e&&/\.(jpg|jpeg|png|webp)$/i.test(e));return m.sort((e,a)=>{const n=e=>/logo|seal|coat_of_arms|emblem/i.test(e)?1:0;return n(e)-n(a)}).slice(0,5)}catch(i){return console.error("Error fetching Wikimedia images:",i),[]}}async function o(e){if(l)try{const n=await fetch("".concat(i,"/api/university/images?query=").concat(encodeURIComponent(e)));if(n.ok){var a;return(null===(a=(await n.json()).images)||void 0===a?void 0:a.map(e=>e.url))||[]}}catch(n){console.error("Error fetching Unsplash images via proxy:",n)}return[]}async function c(e,a){try{const n=await fetch(e);if(!n.ok)throw new Error("Failed to download image");const t=await n.blob();return new File([t],a,{type:t.type})}catch(n){return console.error("Error downloading image:",n),null}}async function d(e,a){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"manual";try{const{error:i}=await t.N.from("university_prefill_cache").upsert({university_name:e,data:a,source:n,updated_at:(new Date).toISOString()});if(i)throw i;return!0}catch(i){return console.error("Error caching prefill data:",i),!1}}async function u(e,a){try{const n=[],i="university-covers";for(let l=0;l<a.length;l++){const s=a[l],r=s.name.split(".").pop(),o="".concat(e,"/image_").concat(l+1,"_").concat(Date.now(),".").concat(r),{error:c}=await t.N.storage.from(i).upload(o,s,{cacheControl:"3600",upsert:!1});if(c){console.error("Error uploading image:",c);continue}const{data:d}=t.N.storage.from(i).getPublicUrl(o);n.push({url:d.publicUrl,fileName:o})}return n}catch(n){throw console.error("Error uploading multiple images:",n),n}}async function p(e,a){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=arguments.length>3&&void 0!==arguments[3]&&arguments[3],l=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;try{const{data:s,error:r}=await t.N.rpc("add_university_image",{p_university_id:e,p_image_url:a,p_caption:n,p_is_primary:i,p_display_order:l});if(r)throw r;return s}catch(s){throw console.error("Error adding university image:",s),s}}async function m(e){try{let c=await async function(e){try{const{data:a,error:n}=await t.N.rpc("get_university_prefill_data",{p_university_name:e});if(n)throw n;return a}catch(a){return console.error("Error fetching prefill data:",a),null}}(e);if(c)return c;const u=await async function(e){try{var a;const n="https://en.wikipedia.org/api/rest_v1/page/summary/".concat(encodeURIComponent(e)),t=await fetch(n);if(!t.ok)return null;const i=await t.json();return{name:i.title||e,description:i.extract||"",website_url:"",location:"",established:null,student_count:null,cover_images:null!==(a=i.thumbnail)&&void 0!==a&&a.source?[i.thumbnail.source]:[]}}catch(n){return console.error("Error fetching from Wikipedia REST:",n),null}}(e),p=await async function(e){try{var a,n,t,i;const l='\n      SELECT ?item ?itemLabel ?locationLabel ?established ?studentCount ?website\n      WHERE {\n        ?item wdt:P31/wdt:P279* wd:Q3918;\n              rdfs:label ?itemLabel.\n        OPTIONAL { ?item wdt:P131 ?location. }\n        OPTIONAL { ?item wdt:P571 ?established. }\n        OPTIONAL { ?item wdt:P2196 ?studentCount. }\n        OPTIONAL { ?item wdt:P856 ?website. }\n        FILTER(CONTAINS(LCASE(?itemLabel), LCASE("'.concat(e,'")))\n        FILTER(LANG(?itemLabel) = "en")\n        SERVICE wikibase:label { bd:serviceParam wikibase:language "en". }\n      }\n      LIMIT 1\n    '),s="https://query.wikidata.org/sparql?query=".concat(encodeURIComponent(l),"&format=json"),r=await fetch(s);if(!r.ok)return null;const o=(await r.json()).results.bindings[0];return o?{name:o.itemLabel.value,description:"",website_url:(null===(a=o.website)||void 0===a?void 0:a.value)||"",location:(null===(n=o.locationLabel)||void 0===n?void 0:n.value)||"",established:null!==(t=o.established)&&void 0!==t&&t.value?new Date(o.established.value).getFullYear():null,student_count:(null===(i=o.studentCount)||void 0===i?void 0:i.value)||null,cover_images:[]}:null}catch(l){return console.error("Error fetching from Wikidata:",l),null}}(e);if(u||p){var a,n,s;c={name:null!==(a=(null===u||void 0===u?void 0:u.name)||(null===p||void 0===p?void 0:p.name)||e)&&void 0!==a?a:e,description:(null===u||void 0===u?void 0:u.description)||"",website_url:(null===p||void 0===p?void 0:p.website_url)||"",location:(null===p||void 0===p?void 0:p.location)||"",established:null!==(n=null===p||void 0===p?void 0:p.established)&&void 0!==n?n:null,student_count:null!==(s=null===p||void 0===p?void 0:p.student_count)&&void 0!==s?s:null,cover_images:(null===u||void 0===u?void 0:u.cover_images)||[]}}if(c||(c=await async function(e){if(l)try{const a=await fetch("".concat(i,"/api/university/details?name=").concat(encodeURIComponent(e)));if(a.ok){const n=await a.json();return{name:n.university.name||e,description:n.university.description||"",website_url:n.university.website_url||"",location:n.university.location||"",established:null,student_count:null,cover_images:n.university.image?[n.university.image]:[]}}}catch(a){console.error("Error fetching from Google via proxy:",a)}return null}(e)),c&&(!c.cover_images||0===c.cover_images.length)){const a=await r(c.name||e);if(a.length)c.cover_images=a;else{const a=await o(c.name||e);c.cover_images=a}}return c&&await d(e,c,"wikipedia_wikidata"),c||{name:e,description:"",website_url:"",location:"",established:null,student_count:null,cover_images:[]}}catch(c){return console.error("Error auto-filling university data:",c),{name:e,description:"",website_url:"",location:"",established:null,student_count:null,cover_images:[]}}}},9935:(e,a,n)=>{n.r(a),n.d(a,{default:()=>m});var t=n(9379),i=n(5043),l=n(4218),s=n(3515),r=n(4972),o=n(9738),c=n(1903),d=n(5200),u=n(9101),p=n(579);const m=e=>{let{userProfile:a}=e;(0,i.useEffect)(()=>{const e=document.createElement("style");return e.innerHTML="\n  .dropzone {\n    border: 2px dashed #374151;\n    border-radius: 8px;\n    padding: 20px;\n    text-align: center;\n    cursor: pointer;\n    transition: all 0.3s ease;\n  }\n  .dropzone:hover {\n    border-color: #00a884;\n    background: rgba(0, 168, 132, 0.05);\n  }\n  .dropzone.drag-over {\n    border-color: #00a884;\n    background: rgba(0, 168, 132, 0.1);\n  }\n  .upload-tabs {\n    display: flex;\n    gap: 8px;\n    margin-bottom: 20px;\n    border-bottom: 2px solid #374151;\n  }\n  .upload-tab {\n    display: flex;\n    align-items: center;\n    gap: 8px;\n    padding: 12px 24px;\n    background: transparent;\n    border: none;\n    color: #8696a0;\n    cursor: pointer;\n    font-size: 16px;\n    font-weight: 500;\n    transition: all 0.3s ease;\n    border-bottom: 3px solid transparent;\n    margin-bottom: -2px;\n  }\n  .upload-tab:hover {\n    color: #e9edef;\n    background: rgba(0, 168, 132, 0.05);\n  }\n  .upload-tab.active {\n    color: #00a884;\n    border-bottom-color: #00a884;\n  }\n  @keyframes spin {\n    from { transform: rotate(0deg); }\n    to { transform: rotate(360deg); }\n  }\n  .spin {\n    animation: spin 1s linear infinite;\n  }\n",document.head.appendChild(e),()=>e.remove()},[]);const[n,m]=(0,i.useState)("books"),g=(0,l.Zp)(),{showToast:h}=(0,u.v)(),[v,b]=(0,i.useState)(null),[y,x]=(0,i.useState)(null),[f,j]=(0,i.useState)([]),[w,_]=(0,i.useState)({title:"",author:"",description:"",category_id:"",year:"",language:"",isbn:"",pages:"",publisher:""}),[N,C]=(0,i.useState)([]),[k,T]=(0,i.useState)({name:"",description:"",website_url:"",location:"",established:"",student_count:""}),[P,S]=(0,i.useState)(""),[E,U]=(0,i.useState)([]),[L,A]=(0,i.useState)(!1),[I,R]=(0,i.useState)(!1),[F,z]=(0,i.useState)(null),[D,B]=(0,i.useState)([]),[O,M]=(0,i.useState)({university_id:"",faculty:"",unit_code:"",unit_name:"",year:"",semester:"",exam_type:""}),[q,H]=(0,i.useState)(!1);(0,i.useEffect)(()=>{(async()=>{try{j(await(0,s.jE)()),B(await(0,o.Hk)())}catch(e){}})()},[]);const W=e=>a=>_(n=>(0,t.A)((0,t.A)({},n),{},{[e]:a.target.value})),Y=e=>a=>{T(n=>(0,t.A)((0,t.A)({},n),{},{[e]:a.target.value})),"name"===e&&(S(a.target.value),G(a.target.value))},G=function(e,a){const n=(0,i.useRef)(null);return(0,i.useCallback)(function(){for(var t=arguments.length,i=new Array(t),l=0;l<t;l++)i[l]=arguments[l];n.current&&clearTimeout(n.current),n.current=setTimeout(()=>e(...i),a)},[e,a])}(async e=>{if(e.length<2)return U([]),void A(!1);try{const a=await(0,c.xH)(e);U(a),A(a.length>0)}catch(a){console.error("Error searching:",a)}},300),Q=async e=>{R(!0),A(!1);try{const i=await(0,c.d$)(e||k.name);var a,n;if(i)if(T({name:i.name||"",description:i.description||"",website_url:i.website_url||"",location:i.location||"",established:(null===(a=i.established)||void 0===a?void 0:a.toString())||"",student_count:(null===(n=i.student_count)||void 0===n?void 0:n.toString())||""}),i.cover_images&&i.cover_images.length>0){const e=[];for(let a=0;a<Math.min(i.cover_images.length,5);a++){const n=i.cover_images[a],l="".concat(i.name.replace(/\s+/g,"_"),"_image_").concat(a+1,".jpg");try{const a=await(0,c.M9)(n,l);a&&e.push(a)}catch(t){console.error("Error downloading image:",t)}}e.length>0?(C(e),h({type:"success",message:"Auto-filled data for ".concat(i.name," with ").concat(e.length," image(s)!")})):h({type:"info",message:"Auto-filled data for ".concat(i.name,"! But images could not be downloaded, please upload manually.")})}else{let e=await(0,c.Fn)(i.name);if(e.length||(e=await(0,c.zd)(i.name)),e.length>0){const a=[];for(let n=0;n<e.length;n++)try{const t="".concat(i.name.replace(/\s+/g,"_"),"_auto_").concat(n+1,".jpg"),l=await(0,c.M9)(e[n],t);l&&a.push(l)}catch(t){console.error("Auto image download error:",t)}a.length>0?(C(a),h({type:"success",message:"Auto-filled data for ".concat(i.name," with ").concat(a.length," image(s)!")})):h({type:"info",message:"Auto-filled data for ".concat(i.name,", but images couldn't be downloaded.")})}else h({type:"info",message:"Auto-filled data for ".concat(i.name,", but no images were found automatically.")})}else h({type:"info",message:"No data found for this university. Please enter details manually."})}catch(i){console.error("Error auto-filling:",i),h({type:"error",message:"Failed to auto-fill data. Please try again."})}finally{R(!1)}},$=e=>a=>M(n=>(0,t.A)((0,t.A)({},n),{},{[e]:a.target.value})),Z=(e,a,n,t,i)=>(0,p.jsxs)("div",{className:"dropzone",onDragOver:e=>{e.preventDefault(),e.currentTarget.classList.add("drag-over")},onDragLeave:e=>{e.preventDefault(),e.currentTarget.classList.remove("drag-over")},onDrop:e=>{e.preventDefault(),e.currentTarget.classList.remove("drag-over");const t=e.dataTransfer.files[0];t&&t.type.match(n)&&a(t)},onClick:()=>document.getElementById("".concat(t,"-input")).click(),style:{border:"2px dashed #374151",borderRadius:"8px",padding:"20px",textAlign:"center",cursor:"pointer",background:e?"rgba(0, 168, 132, 0.1)":"transparent",transition:"all 0.3s ease"},children:[(0,p.jsx)("input",{id:"".concat(t,"-input"),type:"file",accept:n,onChange:e=>{var n;return a((null===(n=e.target.files)||void 0===n?void 0:n[0])||null)},style:{display:"none"}}),e?(0,p.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",gap:"10px",color:"#00a884"},children:[i,(0,p.jsx)("span",{children:e.name})]}):(0,p.jsxs)("div",{children:[(0,p.jsx)(d.B88,{size:20,style:{marginBottom:"4px",color:"#8696a0"}}),(0,p.jsx)("div",{style:{color:"#e9edef"},children:"Drag and drop or click to browse"}),(0,p.jsx)("div",{style:{color:"#8696a0",fontSize:"0.85em",marginTop:"2px"},children:"application/pdf"===n?"PDF files only":"Image files (JPG, PNG, GIF)"})]})]});return(0,p.jsxs)("div",{className:"panel",children:[(0,p.jsx)("div",{className:"panel-title",children:"Upload Content"}),(0,p.jsxs)("div",{className:"upload-tabs",children:[(0,p.jsxs)("button",{className:"upload-tab ".concat("books"===n?"active":""),onClick:()=>m("books"),children:[(0,p.jsx)(d.H9b,{size:20}),"Books"]}),(0,p.jsxs)("button",{className:"upload-tab ".concat("campus"===n?"active":""),onClick:()=>m("campus"),children:[(0,p.jsx)(d.HzC,{size:20}),"Campus"]}),(0,p.jsxs)("button",{className:"upload-tab ".concat("pastpapers"===n?"active":""),onClick:()=>m("pastpapers"),children:[(0,p.jsx)(d.jH2,{size:20}),"Past Papers"]})]}),"books"===n&&(0,p.jsxs)("div",{className:"grid-2",children:[(0,p.jsxs)("div",{className:"panel",children:[(0,p.jsx)("label",{className:"label",children:"PDF File"}),Z(v,b,"application/pdf","pdf",(0,p.jsx)(d.QuH,{size:24})),(0,p.jsx)("label",{className:"label",style:{marginTop:20},children:"Cover Image (optional)"}),Z(y,x,"image/*","cover",(0,p.jsx)(d.fZZ,{size:24}))]}),(0,p.jsxs)("div",{className:"panel",children:[(0,p.jsx)("label",{className:"label",children:"Title"}),(0,p.jsx)("input",{className:"input",placeholder:"Book title",value:w.title,onChange:W("title")}),(0,p.jsx)("label",{className:"label",style:{marginTop:10},children:"Author"}),(0,p.jsx)("input",{className:"input",placeholder:"Author",value:w.author,onChange:W("author")}),(0,p.jsx)("label",{className:"label",style:{marginTop:10},children:"Description"}),(0,p.jsx)("textarea",{className:"input",rows:5,placeholder:"Short description",value:w.description,onChange:W("description")}),(0,p.jsxs)("div",{className:"grid-2",style:{marginTop:10},children:[(0,p.jsxs)("div",{children:[(0,p.jsx)("label",{className:"label",children:"Category"}),(0,p.jsxs)("select",{className:"select",value:w.category_id,onChange:W("category_id"),children:[(0,p.jsx)("option",{value:"",children:"Uncategorized"}),f.map(e=>(0,p.jsx)("option",{value:e.id,children:e.name},e.id))]})]}),(0,p.jsxs)("div",{children:[(0,p.jsx)("label",{className:"label",children:"Year"}),(0,p.jsx)("input",{className:"input",placeholder:"Year",value:w.year,onChange:W("year")})]})]}),(0,p.jsxs)("div",{className:"grid-2",style:{marginTop:10},children:[(0,p.jsxs)("div",{children:[(0,p.jsx)("label",{className:"label",children:"Language"}),(0,p.jsx)("input",{className:"input",placeholder:"English",value:w.language,onChange:W("language")})]}),(0,p.jsxs)("div",{children:[(0,p.jsx)("label",{className:"label",children:"ISBN"}),(0,p.jsx)("input",{className:"input",placeholder:"978-0-123456-78-9",value:w.isbn,onChange:W("isbn")})]})]}),(0,p.jsxs)("div",{className:"grid-2",style:{marginTop:10},children:[(0,p.jsxs)("div",{children:[(0,p.jsx)("label",{className:"label",children:"Pages"}),(0,p.jsx)("input",{className:"input",type:"number",placeholder:"Number of pages",value:w.pages,onChange:W("pages")})]}),(0,p.jsxs)("div",{children:[(0,p.jsx)("label",{className:"label",children:"Publisher"}),(0,p.jsx)("input",{className:"input",placeholder:"Publisher name",value:w.publisher,onChange:W("publisher")})]})]}),(0,p.jsx)("div",{className:"actions",style:{marginTop:12},children:(0,p.jsx)("button",{className:"btn primary",disabled:q,onClick:async()=>{if(v){H(!0);try{var e;const n={title:w.title||(null===v||void 0===v||null===(e=v.name)||void 0===e?void 0:e.replace(/\.[^/.]+$/,""))||"",author:w.author||"Unknown",description:w.description||"",category_id:w.category_id||null,year:w.year?Number(w.year):null,language:w.language||"",isbn:w.isbn||"",pages:w.pages?Number(w.pages):0,publisher:w.publisher||"",uploaded_by:(null===a||void 0===a?void 0:a.id)||null};await(0,s.iC)({metadata:n,pdfFile:v,coverFile:y}),h({type:"success",message:"Book uploaded successfully."}),g("/books/admin/books")}catch(n){console.error("Book upload failed:",n),h({type:"error",message:(null===n||void 0===n?void 0:n.message)||"Upload failed."})}finally{H(!1)}}else h({type:"error",message:"Please choose a PDF file."})},children:q?"Uploading...":"Upload Book"})})]})]}),"campus"===n&&(0,p.jsxs)("div",{className:"grid-2",children:[(0,p.jsxs)("div",{className:"panel",children:[(0,p.jsx)("label",{className:"label",children:"University Cover Images (Multiple)"}),(0,p.jsx)("input",{type:"file",accept:"image/*",multiple:!0,onChange:e=>C(Array.from(e.target.files)),style:{marginBottom:"10px"},className:"input"}),N.length>0&&(0,p.jsxs)("div",{style:{marginTop:"10px",color:"#00a884"},children:["\u2713 ",N.length," image(s) selected",(0,p.jsxs)("button",{onClick:()=>C([]),style:{marginLeft:"10px",color:"#dc2626",background:"none",border:"none",cursor:"pointer"},children:[(0,p.jsx)(d.yGN,{})," Clear"]})]}),(0,p.jsx)("div",{style:{display:"grid",gridTemplateColumns:"repeat(2, 1fr)",gap:"4px",marginTop:"6px"},children:N.map((e,a)=>(0,p.jsxs)("div",{style:{position:"relative",border:"2px solid #374151",borderRadius:"8px",overflow:"hidden"},children:[(0,p.jsx)("img",{src:URL.createObjectURL(e),alt:"Preview ".concat(a+1),style:{width:"100%",height:"120px",objectFit:"cover"}}),(0,p.jsx)("button",{"aria-label":"Remove image",title:"Remove",onClick:()=>C(e=>e.filter((e,n)=>n!==a)),style:{position:"absolute",top:"6px",left:"6px",width:"20px",height:"20px",padding:"2px",borderRadius:"6px",fontWeight:"bold",border:"none",cursor:"pointer",background:"#a08f8f96",color:"#111010ff",display:"flex",alignItems:"center",justifyContent:"center",boxShadow:"0 2px 6px rgba(0,0,0,0.4)"},children:"X"}),(0,p.jsx)("div",{style:{position:"absolute",top:"4px",right:"4px",background:"rgba(0,0,0,0.7)",padding:"4px 8px",borderRadius:"4px",color:"white",fontSize:"12px"},children:0===a?"Primary":"#".concat(a+1)})]},a))})]}),(0,p.jsxs)("div",{className:"panel",children:[(0,p.jsx)("label",{className:"label",children:"University Name *"}),(0,p.jsxs)("div",{style:{position:"relative"},children:[(0,p.jsx)("input",{className:"input",placeholder:"e.g., University of Nairobi",value:k.name,onChange:Y("name"),style:{paddingRight:"80px"}}),(0,p.jsx)("button",{onClick:()=>Q(),disabled:!k.name||I,style:{position:"absolute",right:"8px",top:"50%",transform:"translateY(-50%)",background:"#00a884",color:"white",border:"none",padding:"6px 12px",borderRadius:"4px",cursor:k.name&&!I?"pointer":"not-allowed",fontSize:"12px",opacity:k.name&&!I?1:.5,display:"flex",alignItems:"center",gap:"4px"},children:I?(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)(d.TwU,{className:"spin"})," Loading"]}):(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)(d.CKj,{})," Auto-Fill"]})}),L&&E.length>0&&(0,p.jsx)("div",{style:{position:"absolute",top:"100%",left:0,right:0,background:"#202c33",border:"1px solid #374151",borderRadius:"8px",marginTop:"4px",maxHeight:"200px",overflowY:"auto",zIndex:1e3,boxShadow:"0 4px 6px rgba(0,0,0,0.3)"},children:E.map((e,a)=>(0,p.jsx)("div",{onClick:()=>Q(e.university_name),style:{padding:"10px",cursor:"pointer",borderBottom:a<E.length-1?"1px solid #374151":"none",transition:"background 0.2s"},onMouseEnter:e=>e.target.style.background="rgba(0, 168, 132, 0.1)",onMouseLeave:e=>e.target.style.background="transparent",children:e.university_name},a))})]}),(0,p.jsx)("label",{className:"label",style:{marginTop:10},children:"Description"}),(0,p.jsx)("textarea",{className:"input",rows:4,placeholder:"Brief description about the university",value:k.description,onChange:Y("description")}),(0,p.jsxs)("div",{className:"grid-2",style:{marginTop:10},children:[(0,p.jsxs)("div",{children:[(0,p.jsx)("label",{className:"label",children:"Location"}),(0,p.jsx)("input",{className:"input",placeholder:"e.g., Nairobi",value:k.location,onChange:Y("location")})]}),(0,p.jsxs)("div",{children:[(0,p.jsx)("label",{className:"label",children:"Website URL"}),(0,p.jsx)("input",{className:"input",placeholder:"https://...",value:k.website_url,onChange:Y("website_url")})]})]}),(0,p.jsxs)("div",{className:"grid-2",style:{marginTop:10},children:[(0,p.jsxs)("div",{children:[(0,p.jsx)("label",{className:"label",children:"Established Year"}),(0,p.jsx)("input",{className:"input",type:"number",placeholder:"e.g., 1956",value:k.established,onChange:Y("established")})]}),(0,p.jsxs)("div",{children:[(0,p.jsx)("label",{className:"label",children:"Student Count"}),(0,p.jsx)("input",{className:"input",type:"number",placeholder:"e.g., 84000",value:k.student_count,onChange:Y("student_count")})]})]}),(0,p.jsx)("div",{className:"actions",style:{marginTop:12},children:(0,p.jsx)("button",{className:"btn primary",disabled:q,onClick:async()=>{if(k.name){H(!0);try{const e={name:k.name,description:k.description||"",website_url:k.website_url||"",location:k.location||"",established:k.established?Number(k.established):null,student_count:k.student_count?Number(k.student_count):0,uploaded_by:(null===a||void 0===a?void 0:a.id)||null},n=N[0]||null,t=(await(0,r.hQ)({metadata:e,coverFile:n})).id;if(N.length>1&&t){const e=N.slice(1),a=await(0,c.cO)(t,e);for(let n=0;n<a.length;n++)await(0,c.fH)(t,a[n].url,null,!1,n+1)}h({type:"success",message:"University added successfully with ".concat(N.length," image(s)!")}),T({name:"",description:"",website_url:"",location:"",established:"",student_count:""}),C([])}catch(e){console.error("University upload failed:",e),h({type:"error",message:(null===e||void 0===e?void 0:e.message)||"Upload failed."})}finally{H(!1)}}else h({type:"error",message:"Please enter university name."})},children:q?"Adding...":"Add University"})})]})]}),"pastpapers"===n&&(0,p.jsxs)("div",{className:"grid-2",children:[(0,p.jsxs)("div",{className:"panel",children:[(0,p.jsx)("label",{className:"label",children:"Past Paper PDF *"}),Z(F,z,"application/pdf","paper-pdf",(0,p.jsx)(d.QuH,{size:24}))]}),(0,p.jsxs)("div",{className:"panel",children:[(0,p.jsx)("label",{className:"label",children:"University (optional)"}),(0,p.jsxs)("select",{className:"select",value:O.university_id,onChange:$("university_id"),children:[(0,p.jsx)("option",{value:"",children:"Select University"}),D.map(e=>(0,p.jsx)("option",{value:e.id,children:e.name},e.id))]}),(0,p.jsx)("label",{className:"label",style:{marginTop:10},children:"Faculty *"}),(0,p.jsx)("input",{className:"input",placeholder:"e.g., Engineering, Business, Arts",value:O.faculty,onChange:$("faculty")}),(0,p.jsxs)("div",{className:"grid-2",style:{marginTop:10},children:[(0,p.jsxs)("div",{children:[(0,p.jsx)("label",{className:"label",children:"Unit Code *"}),(0,p.jsx)("input",{className:"input",placeholder:"e.g., CS101",value:O.unit_code,onChange:$("unit_code")})]}),(0,p.jsxs)("div",{children:[(0,p.jsx)("label",{className:"label",children:"Unit Name *"}),(0,p.jsx)("input",{className:"input",placeholder:"e.g., Introduction to Programming",value:O.unit_name,onChange:$("unit_name")})]})]}),(0,p.jsxs)("div",{className:"grid-2",style:{marginTop:10},children:[(0,p.jsxs)("div",{children:[(0,p.jsx)("label",{className:"label",children:"Year"}),(0,p.jsx)("input",{className:"input",type:"number",placeholder:"e.g., 2023",value:O.year,onChange:$("year")})]}),(0,p.jsxs)("div",{children:[(0,p.jsx)("label",{className:"label",children:"Semester"}),(0,p.jsxs)("select",{className:"select",value:O.semester,onChange:$("semester"),children:[(0,p.jsx)("option",{value:"",children:"Select Semester"}),(0,p.jsx)("option",{value:"1",children:"Semester 1"}),(0,p.jsx)("option",{value:"2",children:"Semester 2"}),(0,p.jsx)("option",{value:"3",children:"Semester 3"})]})]})]}),(0,p.jsx)("label",{className:"label",style:{marginTop:10},children:"Exam Type"}),(0,p.jsxs)("select",{className:"select",value:O.exam_type,onChange:$("exam_type"),children:[(0,p.jsx)("option",{value:"Main",children:"Main Exam"}),(0,p.jsx)("option",{value:"Supplementary",children:"Supplementary"}),(0,p.jsx)("option",{value:"CAT",children:"CAT"}),(0,p.jsx)("option",{value:"Mock",children:"Mock Exam"})]}),(0,p.jsx)("div",{className:"actions",style:{marginTop:12},children:(0,p.jsx)("button",{className:"btn primary",disabled:q,onClick:async()=>{if(F)if(O.faculty)if(O.unit_code)if(O.unit_name){H(!0);try{const e={title:"".concat(O.unit_code," - ").concat(O.unit_name),university_id:O.university_id||null,faculty:O.faculty,unit_code:O.unit_code,unit_name:O.unit_name,year:O.year?Number(O.year):null,semester:O.semester||"",exam_type:O.exam_type||"Main",uploaded_by:(null===a||void 0===a?void 0:a.id)||null};await(0,o.DT)({metadata:e,pdfFile:F}),h({type:"success",message:"Past paper uploaded successfully."}),M({university_id:"",faculty:"",unit_code:"",unit_name:"",year:"",semester:"",exam_type:""}),z(null)}catch(e){console.error("Past paper upload failed:",e),h({type:"error",message:(null===e||void 0===e?void 0:e.message)||"Upload failed."})}finally{H(!1)}}else h({type:"error",message:"Please enter unit name."});else h({type:"error",message:"Please enter unit code."});else h({type:"error",message:"Please enter faculty."});else h({type:"error",message:"Please choose a PDF file."})},children:q?"Uploading...":"Upload Past Paper"})})]})]})]})}}}]);
//# sourceMappingURL=173.68bdf315.chunk.js.map