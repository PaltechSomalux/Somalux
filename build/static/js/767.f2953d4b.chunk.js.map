{"version":3,"file":"static/js/767.f2953d4b.chunk.js","mappings":"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","sources":["SomaLux/Books/Admin/pages/Books.jsx","SomaLux/Books/Admin/pages/UniversitiesManagement.jsx","SomaLux/Books/Admin/pages/PastPapersManagement.jsx","SomaLux/Books/Admin/authorInteractionsApi.js","SomaLux/Books/Admin/pages/Authors.jsx","SomaLux/Books/Admin/pages/ContentManagement.jsx","SomaLux/Books/Admin/universityPrefillApi.js"],"sourcesContent":["import React, { useEffect, useMemo, useState } from 'react';\r\nimport { fetchBooks, fetchCategories, deleteBook, updateBook } from '../api';\r\nimport { useAdminUI } from '../AdminUIContext';\r\n\r\nconst Books = ({ userProfile }) => {\r\n  const [loading, setLoading] = useState(true);\r\n  const [rows, setRows] = useState([]);\r\n  const [count, setCount] = useState(0);\r\n  const [page, setPage] = useState(1);\r\n  const [pageSize] = useState(23);\r\n  const [search, setSearch] = useState('');\r\n  const [categories, setCategories] = useState([]);\r\n  const [categoryId, setCategoryId] = useState(null);\r\n  const [sort, setSort] = useState({ col: 'created_at', dir: 'desc' });\r\n  const [editingId, setEditingId] = useState(null);\r\n  const [editDraft, setEditDraft] = useState({});\r\n  const [newPdf, setNewPdf] = useState(null);\r\n  const [newCover, setNewCover] = useState(null);\r\n\r\n  const { confirm, showToast } = useAdminUI();\r\n\r\n  const ADMIN_EMAILS = ['campuslives254@gmail.com', 'paltechsomalux@gmail.com'];\r\n  const isAdmin = userProfile?.role === 'admin' || ADMIN_EMAILS.includes(userProfile?.email);\r\n  const isEditor = userProfile?.role === 'editor' || ADMIN_EMAILS.includes(userProfile?.email);\r\n\r\n  const totalPages = useMemo(() => Math.max(1, Math.ceil(count / pageSize)), [count, pageSize]);\r\n\r\n  const load = async () => {\r\n    setLoading(true);\r\n    try {\r\n      const { data, count: total } = await fetchBooks({ \r\n        page, \r\n        pageSize, \r\n        search, \r\n        categoryId, \r\n        sort\r\n      });\r\n      \r\n      setRows(data);\r\n      setCount(total);\r\n    } finally { setLoading(false); }\r\n  };\r\n\r\n  useEffect(() => {\r\n    (async () => {\r\n      try { setCategories(await fetchCategories()); } catch {}\r\n      if (userProfile) {\r\n        await load();\r\n      }\r\n    })();\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  }, [page, search, categoryId, sort.col, sort.dir, userProfile]);\r\n\r\n  const canEdit = (row) => {\r\n    if (isAdmin) return true;\r\n    if (isEditor) return true;\r\n    return false;\r\n  };\r\n\r\n  const startEdit = (row) => {\r\n    if (!canEdit(row)) {\r\n      showToast({ type: 'error', message: 'You do not have permission to edit this book.' });\r\n      return;\r\n    }\r\n    setEditingId(row.id);\r\n    setEditDraft({\r\n      title: row.title || '',\r\n      author: row.author || '',\r\n      year: row.year || '',\r\n      category_id: row.category_id || null,\r\n      language: row.language || '',\r\n      isbn: row.isbn || '',\r\n      pages: row.pages || '',\r\n      publisher: row.publisher || ''\r\n    });\r\n    setNewPdf(null);\r\n    setNewCover(null);\r\n  };\r\n\r\n  const cancelEdit = () => {\r\n    setEditingId(null);\r\n    setEditDraft({});\r\n    setNewPdf(null);\r\n    setNewCover(null);\r\n  };\r\n\r\n  const saveEdit = async (row) => {\r\n    if (!canEdit(row)) {\r\n      showToast({ type: 'error', message: 'You can only edit books you uploaded.' });\r\n      return;\r\n    }\r\n    const updates = { ...editDraft };\r\n\r\n    try {\r\n      await updateBook(row.id, { updates, newPdfFile: newPdf, newCoverFile: newCover, oldFilePath: row.file_path });\r\n      cancelEdit();\r\n      await load();\r\n      showToast({ type: 'success', message: 'Book details updated.' });\r\n    } catch (e) {\r\n      console.error('Failed to update book:', e);\r\n      showToast({ type: 'error', message: e?.message || 'Failed to update book.' });\r\n    }\r\n  };\r\n\r\n  const handleDelete = async (row) => {\r\n    if (!canEdit(row)) {\r\n      showToast({ type: 'error', message: 'You can only delete books you uploaded.' });\r\n      return;\r\n    }\r\n    const ok = await confirm({\r\n      title: 'Delete book?',\r\n      message: `Delete \"${row.title}\" and its files? This action cannot be undone.`,\r\n      confirmLabel: 'Delete',\r\n      cancelLabel: 'Cancel',\r\n      variant: 'danger',\r\n    });\r\n    if (!ok) return;\r\n\r\n    try {\r\n      await deleteBook({ id: row.id, file_path: row.file_path });\r\n      await load();\r\n      showToast({ type: 'success', message: 'Book deleted.' });\r\n    } catch (e) {\r\n      console.error('Failed to delete book:', e);\r\n      showToast({ type: 'error', message: e?.message || 'Failed to delete book.' });\r\n    }\r\n  };\r\n\r\n  const toggleSort = (col) => {\r\n    setSort((s) => (s.col === col ? { col, dir: s.dir === 'asc' ? 'desc' : 'asc' } : { col, dir: 'asc' }));\r\n  };\r\n\r\n  return (\r\n    <div>\r\n      <div className=\"panel\">\r\n        <div className=\"panel-title\">Books Management</div>\r\n\r\n        {/* Stats Summary */}\r\n        {!loading && rows.length > 0 && (\r\n          <div style={{ display: 'grid', gridTemplateColumns: 'repeat(auto-fit, minmax(150px, 1fr))', gap: '8px', marginBottom: '12px' }}>\r\n            <div style={{ background: '#1a2332', border: '1px solid #2a3f56', borderRadius: '6px', padding: '8px 12px', color: '#8696a0', fontSize: '0.85rem' }}>\r\n              <div style={{ color: '#00a884', fontSize: '1.2rem', fontWeight: '600' }}>{rows.reduce((sum, r) => sum + (r.downloads || 0), 0)}</div>\r\n              <div>Total Downloads</div>\r\n            </div>\r\n            <div style={{ background: '#1a2332', border: '1px solid #2a3f56', borderRadius: '6px', padding: '8px 12px', color: '#8696a0', fontSize: '0.85rem' }}>\r\n              <div style={{ color: '#34B7F1', fontSize: '1.2rem', fontWeight: '600' }}>{rows.reduce((sum, r) => sum + (r.views || 0), 0)}</div>\r\n              <div>Total Views</div>\r\n            </div>\r\n            <div style={{ background: '#1a2332', border: '1px solid #2a3f56', borderRadius: '6px', padding: '8px 12px', color: '#8696a0', fontSize: '0.85rem' }}>\r\n              <div style={{ color: '#FF6B9D', fontSize: '1.2rem', fontWeight: '600' }}>{rows.reduce((sum, r) => sum + (r.comments_count || 0), 0)}</div>\r\n              <div>Total Comments</div>\r\n            </div>\r\n            <div style={{ background: '#1a2332', border: '1px solid #2a3f56', borderRadius: '6px', padding: '8px 12px', color: '#8696a0', fontSize: '0.85rem' }}>\r\n              <div style={{ color: '#F44336', fontSize: '1.2rem', fontWeight: '600' }}>{rows.reduce((sum, r) => sum + (r.likes_count || 0), 0)}</div>\r\n              <div>Total Likes</div>\r\n            </div>\r\n            <div style={{ background: '#1a2332', border: '1px solid #2a3f56', borderRadius: '6px', padding: '8px 12px', color: '#8696a0', fontSize: '0.85rem' }}>\r\n              <div style={{ color: '#FFCC00', fontSize: '1.2rem', fontWeight: '600' }}>{rows.length}/{count}</div>\r\n              <div>Page Books</div>\r\n            </div>\r\n          </div>\r\n        )}\r\n\r\n        <div className=\"grid-2\" style={{ marginBottom: 6 }}>\r\n          <div className=\"panel\" style={{ padding: '6px 8px' }}>\r\n            <label className=\"label\" style={{ marginBottom: '0.2rem' }}>Search</label>\r\n            <input className=\"input\" value={search} onChange={(e) => { setPage(1); setSearch(e.target.value); }} placeholder=\"Search by title...\" style={{ fontSize: '0.9rem' }} />\r\n          </div>\r\n          <div className=\"panel\" style={{ padding: '6px 8px' }}>\r\n            <label className=\"label\" style={{ marginBottom: '0.2rem' }}>Category</label>\r\n            <select className=\"select\" value={categoryId || ''} onChange={(e) => { setPage(1); setCategoryId(e.target.value || null); }} style={{ fontSize: '0.9rem' }}>\r\n              <option value=\"\">All</option>\r\n              {categories.map(c => <option key={c.id} value={c.id}>{c.name}</option>)}\r\n            </select>\r\n          </div>\r\n        </div>\r\n\r\n        <div className=\"actions\" style={{ marginBottom: 10 }}>\r\n          <button className=\"btn primary\" onClick={() => (window.location.href = '/books/admin/upload')}>Add / Upload New Book</button>\r\n        </div>\r\n\r\n        <div className=\"panel\" style={{ padding: 0, overflowX: 'auto', WebkitOverflowScrolling: 'touch' }}>\r\n          <table className=\"table\" style={{ minWidth: '1620px', borderCollapse: 'separate', borderSpacing: 0 }}>\r\n            <thead>\r\n              <tr>\r\n                <th style={{ width: '60px' }}>Cover</th>\r\n                <th style={{ width: '300px', cursor: 'pointer' }} onClick={() => toggleSort('title')}>Title {sort.col === 'title' ? (sort.dir === 'asc' ? '' : '') : ''}</th>\r\n                <th style={{ width: '200px', cursor: 'pointer' }} onClick={() => toggleSort('author')}>Author {sort.col === 'author' ? (sort.dir === 'asc' ? '' : '') : ''}</th>\r\n                <th style={{ width: '120px' }}>Category</th>\r\n                <th style={{ width: '100px', cursor: 'pointer' }} onClick={() => toggleSort('year')}>Year {sort.col === 'year' ? (sort.dir === 'asc' ? '' : '') : ''}</th>\r\n                <th style={{ width: '100px' }}>Pages</th>\r\n                <th style={{ width: '180px' }}>Publisher</th>\r\n                <th style={{ width: '100px', cursor: 'pointer' }} onClick={() => toggleSort('downloads')}>Downloads {sort.col === 'downloads' ? (sort.dir === 'asc' ? '' : '') : ''}</th>\r\n                <th style={{ width: '80px', cursor: 'pointer', background: 'rgba(52, 183, 241, 0.1)', borderBottom: '2px solid #34B7F1' }} onClick={() => toggleSort('views')}>Views {sort.col === 'views' ? (sort.dir === 'asc' ? '' : '') : ''}</th>\r\n                <th style={{ width: '80px', cursor: 'pointer', background: 'rgba(255, 107, 157, 0.1)', borderBottom: '2px solid #FF6B9D' }} onClick={() => toggleSort('comments_count')}>Comments {sort.col === 'comments_count' ? (sort.dir === 'asc' ? '' : '') : ''}</th>\r\n                <th style={{ width: '80px', cursor: 'pointer', background: 'rgba(244, 67, 54, 0.1)', borderBottom: '2px solid #F44336' }} onClick={() => toggleSort('likes_count')}>Likes {sort.col === 'likes_count' ? (sort.dir === 'asc' ? '' : '') : ''}</th>\r\n                <th style={{ width: '100px' }}>Date Added</th>\r\n                <th style={{ width: '200px' }}>Actions</th>\r\n              </tr>\r\n            </thead>\r\n            <tbody>\r\n              {loading ? (\r\n                <tr><td colSpan={13} style={{ color: '#8696a0', textAlign: 'center' }}>Loading...</td></tr>\r\n              ) : rows.length === 0 ? (\r\n                <tr><td colSpan={13} style={{ color: '#8696a0', textAlign: 'center' }}>No data</td></tr>\r\n              ) : rows.map(row => (\r\n                <tr key={row.id}>\r\n                  <td>{row.cover_url ? <img src={row.cover_url} alt=\"cover\" style={{ width: 36, height: 48, objectFit: 'cover', borderRadius: 4 }} /> : <span className=\"badge\">No cover</span>}</td>\r\n                  <td>\r\n                    {editingId === row.id ? (\r\n                      <input className=\"input\" value={editDraft.title} onChange={(e) => setEditDraft({ ...editDraft, title: e.target.value })} />\r\n                    ) : row.title}\r\n                  </td>\r\n                  <td>\r\n                    {editingId === row.id ? (\r\n                      <input className=\"input\" value={editDraft.author} onChange={(e) => setEditDraft({ ...editDraft, author: e.target.value })} />\r\n                    ) : row.author}\r\n                  </td>\r\n                  <td>\r\n                    {editingId === row.id ? (\r\n                      <select className=\"select\" value={editDraft.category_id || ''} onChange={(e) => setEditDraft({ ...editDraft, category_id: e.target.value || null })}>\r\n                        <option value=\"\">Uncategorized</option>\r\n                        {categories.map(c => <option key={c.id} value={c.id}>{c.name}</option>)}\r\n                      </select>\r\n                    ) : (categories.find(c => c.id === row.category_id)?.name || '')}\r\n                  </td>\r\n                  <td>\r\n                    {editingId === row.id ? (\r\n                      <input className=\"input\" value={editDraft.year} onChange={(e) => setEditDraft({ ...editDraft, year: e.target.value })} />\r\n                    ) : (row.year || '')}\r\n                  </td>\r\n                  <td>\r\n                    {editingId === row.id ? (\r\n                      <input className=\"input\" type=\"number\" placeholder=\"Pages\" value={editDraft.pages} onChange={(e) => setEditDraft({ ...editDraft, pages: e.target.value })} />\r\n                    ) : (row.pages || '')}\r\n                  </td>\r\n                  <td>\r\n                    {editingId === row.id ? (\r\n                      <input className=\"input\" placeholder=\"Publisher\" value={editDraft.publisher} onChange={(e) => setEditDraft({ ...editDraft, publisher: e.target.value })} />\r\n                    ) : (row.publisher || '')}\r\n                  </td>\r\n                  <td>{row.downloads || 0}</td>\r\n                  <td style={{ fontWeight: '500', color: '#00a884' }}>{row.views || 0}</td>\r\n                  <td style={{ fontWeight: '500', color: '#FF6B9D' }}>{row.comments_count || 0}</td>\r\n                  <td style={{ fontWeight: '500', color: '#F44336' }}>{row.likes_count || 0}</td>\r\n                  <td>{new Date(row.created_at).toLocaleDateString()}</td>\r\n                  <td>\r\n                    {editingId === row.id ? (\r\n                      <div style={{ display: 'flex', flexDirection: 'column', gap: '10px', minWidth: '180px' }}>\r\n                        <div>\r\n                          <label className=\"label\">Replace PDF</label>\r\n                          <div\r\n                            className=\"file-upload-btn\"\r\n                            onClick={() => document.getElementById(`pdf-input-${row.id}`).click()}\r\n                            style={{\r\n                              border: '1px solid #374151',\r\n                              borderRadius: '6px',\r\n                              padding: '6px 12px',\r\n                              cursor: 'pointer',\r\n                              display: 'flex',\r\n                              alignItems: 'center',\r\n                              gap: '8px',\r\n                              background: newPdf ? 'rgba(0, 168, 132, 0.1)' : 'transparent',\r\n                              color: newPdf ? '#00a884' : '#e9edef',\r\n                              transition: 'all 0.2s'\r\n                            }}\r\n                          >\r\n                            <input\r\n                              id={`pdf-input-${row.id}`}\r\n                              type=\"file\"\r\n                              accept=\"application/pdf\"\r\n                              onChange={(e) => setNewPdf(e.target.files?.[0] || null)}\r\n                              style={{ display: 'none' }}\r\n                            />\r\n                            {newPdf ? (\r\n                              <> {newPdf.name.slice(0, 20)}{newPdf.name.length > 20 ? '...' : ''}</>\r\n                            ) : (\r\n                              <> Choose PDF</>\r\n                            )}\r\n                          </div>\r\n                        </div>\r\n                        <div>\r\n                          <label className=\"label\">Replace Cover</label>\r\n                          <div\r\n                            className=\"file-upload-btn\"\r\n                            onClick={() => document.getElementById(`cover-input-${row.id}`).click()}\r\n                            style={{\r\n                              border: '1px solid #374151',\r\n                              borderRadius: '6px',\r\n                              padding: '6px 12px',\r\n                              cursor: 'pointer',\r\n                              display: 'flex',\r\n                              alignItems: 'center',\r\n                              gap: '8px',\r\n                              background: newCover ? 'rgba(0, 168, 132, 0.1)' : 'transparent',\r\n                              color: newCover ? '#00a884' : '#e9edef',\r\n                              transition: 'all 0.2s'\r\n                            }}\r\n                          >\r\n                            <input\r\n                              id={`cover-input-${row.id}`}\r\n                              type=\"file\"\r\n                              accept=\"image/*\"\r\n                              onChange={(e) => setNewCover(e.target.files?.[0] || null)}\r\n                              style={{ display: 'none' }}\r\n                            />\r\n                            {newCover ? (\r\n                              <> {newCover.name.slice(0, 20)}{newCover.name.length > 20 ? '...' : ''}</>\r\n                            ) : (\r\n                              <> Choose Image</>\r\n                            )}\r\n                          </div>\r\n                        </div>\r\n                        <div style={{ display: 'flex', gap: '8px', marginTop: '4px' }}>\r\n                          <button className=\"btn primary\" onClick={() => saveEdit(row)}>Save</button>\r\n                          <button className=\"btn\" onClick={cancelEdit}>Cancel</button>\r\n                        </div>\r\n                      </div>\r\n                    ) : (\r\n                      <div className=\"actions\">\r\n                        <button \r\n                          className=\"btn\" \r\n                          onClick={() => startEdit(row)}\r\n                          disabled={!canEdit(row)}\r\n                        >\r\n                          Edit\r\n                        </button>\r\n                        <button \r\n                          className=\"btn\" \r\n                          onClick={() => handleDelete(row)}\r\n                          disabled={!canEdit(row)}\r\n                        >\r\n                          Delete\r\n                        </button>\r\n                      </div>\r\n                    )}\r\n                  </td>\r\n                </tr>\r\n              ))}\r\n            </tbody>\r\n          </table>\r\n        </div>\r\n\r\n        <div style={{\r\n          display: 'flex',\r\n          justifyContent: 'center',\r\n          alignItems: 'center',\r\n          gap: '12px',\r\n          marginTop: '24px',\r\n          marginBottom: '20px'\r\n        }}>\r\n          <button\r\n            onClick={() => setPage(p => Math.max(1, p - 1))}\r\n            disabled={page <= 1}\r\n            style={{\r\n              padding: '8px 16px',\r\n              background: page <= 1 ? '#e0e0e0' : 'linear-gradient(135deg, #00a884 0%, #008060 100%)',\r\n              color: page <= 1 ? '#999' : '#fff',\r\n              border: 'none',\r\n              borderRadius: '6px',\r\n              cursor: page <= 1 ? 'not-allowed' : 'pointer',\r\n              fontSize: '14px',\r\n              fontWeight: '600',\r\n              transition: 'all 0.2s',\r\n              opacity: page <= 1 ? 0.6 : 1\r\n            }}\r\n          >\r\n             Prev\r\n          </button>\r\n          <span style={{ color: '#cfd8dc', fontSize: '14px', fontWeight: '500', minWidth: '120px', textAlign: 'center' }}>\r\n            Page {page} of {totalPages}\r\n          </span>\r\n          <button\r\n            onClick={() => setPage(p => Math.min(totalPages, p + 1))}\r\n            disabled={page >= totalPages}\r\n            style={{\r\n              padding: '8px 16px',\r\n              background: page >= totalPages ? '#e0e0e0' : 'linear-gradient(135deg, #00a884 0%, #008060 100%)',\r\n              color: page >= totalPages ? '#999' : '#fff',\r\n              border: 'none',\r\n              borderRadius: '6px',\r\n              cursor: page >= totalPages ? 'not-allowed' : 'pointer',\r\n              fontSize: '14px',\r\n              fontWeight: '600',\r\n              transition: 'all 0.2s',\r\n              opacity: page >= totalPages ? 0.6 : 1\r\n            }}\r\n          >\r\n            Next \r\n          </button>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Books;\r\n","import React, { useEffect, useMemo, useState } from 'react';\nimport { fetchUniversities, deleteUniversity, updateUniversity } from '../campusApi';\nimport { getUniversityImages, deleteUniversityImage } from '../universityPrefillApi';\nimport { getPastPaperCountByUniversity } from '../pastPapersApi';\nimport { useAdminUI } from '../AdminUIContext';\n\nconst UniversitiesManagement = ({ userProfile }) => {\n  const [loading, setLoading] = useState(true);\n  const [rows, setRows] = useState([]);\n  const [count, setCount] = useState(0);\n  const [page, setPage] = useState(1);\n  const [pageSize] = useState(10);\n  const [search, setSearch] = useState('');\n  const [sort, setSort] = useState({ col: 'created_at', dir: 'desc' });\n  const [editingId, setEditingId] = useState(null);\n  const [editDraft, setEditDraft] = useState({});\n  const [newCover, setNewCover] = useState(null);\n  const [paperCounts, setPaperCounts] = useState({});\n\n  const { confirm, showToast } = useAdminUI();\n\n  const ADMIN_EMAILS = ['campuslives254@gmail.com', 'paltechsomalux@gmail.com'];\n  const isAdmin = userProfile?.role === 'admin' || ADMIN_EMAILS.includes(userProfile?.email);\n  const isEditor = userProfile?.role === 'editor' || ADMIN_EMAILS.includes(userProfile?.email);\n\n  const totalPages = useMemo(() => Math.max(1, Math.ceil(count / pageSize)), [count, pageSize]);\n\n  const load = async () => {\n    setLoading(true);\n    try {\n      const { data, count: total } = await fetchUniversities({ page, pageSize, search, sort });\n      setRows(data);\n      setCount(total);\n      \n      // Fetch paper counts for each university\n      const counts = {};\n      for (const uni of data) {\n        counts[uni.id] = await getPastPaperCountByUniversity(uni.id);\n      }\n      setPaperCounts(counts);\n    } finally { setLoading(false); }\n  };\n\n  useEffect(() => {\n    if (userProfile) load();\n  }, [page, search, sort.col, sort.dir, userProfile]);\n\n  const canEdit = (row) => {\n    if (isAdmin) return true;\n    if (isEditor) return true;\n    return false;\n  };\n\n  const startEdit = (row) => {\n    if (!canEdit(row)) {\n      showToast({ type: 'error', message: 'You do not have permission to edit this university.' });\n      return;\n    }\n    setEditingId(row.id);\n    setEditDraft({\n      name: row.name || '',\n      description: row.description || '',\n      website_url: row.website_url || '',\n      location: row.location || '',\n      established: row.established || '',\n      student_count: row.student_count || ''\n    });\n    setNewCover(null);\n  };\n\n  const cancelEdit = () => {\n    setEditingId(null);\n    setEditDraft({});\n    setNewCover(null);\n  };\n\n  const saveEdit = async (row) => {\n    if (!canEdit(row)) {\n      showToast({ type: 'error', message: 'You do not have permission to edit this university.' });\n      return;\n    }\n    const updates = { ...editDraft };\n\n    // Normalize numeric fields so we don't send \"\" to integer columns\n    if (updates.established === '' || updates.established === undefined) {\n      updates.established = null;\n    } else {\n      updates.established = Number(updates.established);\n    }\n\n    if (updates.student_count === '' || updates.student_count === undefined) {\n      updates.student_count = null;\n    } else {\n      updates.student_count = Number(updates.student_count);\n    }\n\n    try {\n      await updateUniversity(row.id, { updates, newCoverFile: newCover });\n      cancelEdit();\n      await load();\n      showToast({ type: 'success', message: 'University updated successfully.' });\n    } catch (e) {\n      console.error('Failed to update university:', e);\n      showToast({ type: 'error', message: e?.message || 'Failed to update university.' });\n    }\n  };\n\n  const handleDelete = async (row) => {\n    if (!canEdit(row)) {\n      showToast({ type: 'error', message: 'You can only delete universities you uploaded.' });\n      return;\n    }\n\n    const ok = await confirm({\n      title: 'Delete university?',\n      message: `Delete \"${row.name}\" and its related data? This action cannot be undone.`,\n      confirmLabel: 'Delete',\n      cancelLabel: 'Cancel',\n      variant: 'danger',\n    });\n    if (!ok) return;\n\n    try {\n      await deleteUniversity({ id: row.id, cover_image_url: row.cover_image_url });\n      await load();\n      showToast({ type: 'success', message: 'University deleted.' });\n    } catch (err) {\n      console.error('Failed to delete university:', err);\n      showToast({ type: 'error', message: err?.message || 'Failed to delete university.' });\n    }\n  };\n\n  const toggleSort = (col) => {\n    setSort((s) => (s.col === col ? { col, dir: s.dir === 'asc' ? 'desc' : 'asc' } : { col, dir: 'asc' }));\n  };\n\n  return (\n    <div>\n      <div className=\"panel\">\n        <div className=\"panel-title\">Universities Management</div>\n\n        {/* Stats Summary */}\n        {!loading && rows.length > 0 && (\n          <div style={{ display: 'grid', gridTemplateColumns: 'repeat(auto-fit, minmax(150px, 1fr))', gap: '8px', marginBottom: '12px' }}>\n            <div style={{ background: '#1a2332', border: '1px solid #2a3f56', borderRadius: '6px', padding: '8px 12px', color: '#8696a0', fontSize: '0.85rem' }}>\n              <div style={{ color: '#34B7F1', fontSize: '1.2rem', fontWeight: '600' }}>{rows.reduce((sum, r) => sum + (r.views || 0), 0)}</div>\n              <div>Total Views</div>\n            </div>\n            <div style={{ background: '#1a2332', border: '1px solid #2a3f56', borderRadius: '6px', padding: '8px 12px', color: '#8696a0', fontSize: '0.85rem' }}>\n              <div style={{ color: '#E74C3C', fontSize: '1.2rem', fontWeight: '600' }}>{rows.reduce((sum, r) => sum + (r.likes_count || 0), 0)}</div>\n              <div>Total Likes</div>\n            </div>\n            <div style={{ background: '#1a2332', border: '1px solid #2a3f56', borderRadius: '6px', padding: '8px 12px', color: '#8696a0', fontSize: '0.85rem' }}>\n              <div style={{ color: '#FFCC00', fontSize: '1.2rem', fontWeight: '600' }}>{rows.length}/{count}</div>\n              <div>Page Universities</div>\n            </div>\n          </div>\n        )}\n\n        <div className=\"panel\" style={{ marginBottom: 6 }}>\n          <label className=\"label\">Search</label>\n          <input className=\"input\" value={search} onChange={(e) => { setPage(1); setSearch(e.target.value); }} placeholder=\"Search by name or location...\" />\n        </div>\n\n        <div className=\"actions\" style={{ marginBottom: 6 }}>\n          <button className=\"btn primary\" onClick={() => (window.location.href = '/books/admin/upload')}>Add New University</button>\n        </div>\n\n        <div className=\"panel\" style={{ padding: 0, overflowX: 'auto' }}>\n          <table className=\"table\" style={{ minWidth: '1200px' }}>\n            <thead>\n              <tr>\n                <th style={{ width: '60px' }}>Cover</th>\n                <th style={{ width: '250px', cursor: 'pointer' }} onClick={() => toggleSort('name')}>Name {sort.col === 'name' ? (sort.dir === 'asc' ? '' : '') : ''}</th>\n                <th style={{ width: '300px' }}>Description</th>\n                <th style={{ width: '150px' }}>Location</th>\n                <th style={{ width: '100px', cursor: 'pointer' }} onClick={() => toggleSort('established')}>Est. {sort.col === 'established' ? (sort.dir === 'asc' ? '' : '') : ''}</th>\n                <th style={{ width: '100px' }}>Students</th>\n                <th style={{ width: '80px', cursor: 'pointer', background: 'rgba(52, 183, 241, 0.1)', borderBottom: '2px solid #34B7F1' }} onClick={() => toggleSort('views_count')}>Views {sort.col === 'views_count' ? (sort.dir === 'asc' ? '' : '') : ''}</th>\n                <th style={{ width: '80px', cursor: 'pointer', background: 'rgba(231, 76, 60, 0.1)', borderBottom: '2px solid #E74C3C' }} onClick={() => toggleSort('likes_count')}>Likes {sort.col === 'likes_count' ? (sort.dir === 'asc' ? '' : '') : ''}</th>\n                <th style={{ width: '80px', background: 'rgba(102, 187, 106, 0.1)', borderBottom: '2px solid #66BB6A' }}>Papers</th>\n                <th style={{ width: '180px' }}>Actions</th>\n              </tr>\n            </thead>\n            <tbody>\n              {loading ? (\n                <tr><td colSpan={10} style={{ textAlign: 'center', color: '#8696a0' }}>Loading...</td></tr>\n              ) : rows.length === 0 ? (\n                <tr><td colSpan={10} style={{ textAlign: 'center', color: '#8696a0' }}>No data</td></tr>\n              ) : rows.map(row => (\n                <tr key={row.id}>\n                  <td>{row.cover_image_url ? <img src={row.cover_image_url} alt=\"cover\" style={{ width: 36, height: 36, objectFit: 'cover', borderRadius: 4 }} /> : <span className=\"badge\">No cover</span>}</td>\n                  <td>\n                    {editingId === row.id ? (\n                      <input className=\"input\" value={editDraft.name} onChange={(e) => setEditDraft({ ...editDraft, name: e.target.value })} />\n                    ) : row.name}\n                  </td>\n                  <td>\n                    {editingId === row.id ? (\n                      <textarea className=\"input\" rows={2} value={editDraft.description} onChange={(e) => setEditDraft({ ...editDraft, description: e.target.value })} />\n                    ) : (row.description?.slice(0, 100) || '')}\n                  </td>\n                  <td>\n                    {editingId === row.id ? (\n                      <input className=\"input\" value={editDraft.location} onChange={(e) => setEditDraft({ ...editDraft, location: e.target.value })} />\n                    ) : (row.location || '')}\n                  </td>\n                  <td>\n                    {editingId === row.id ? (\n                      <input className=\"input\" type=\"number\" value={editDraft.established} onChange={(e) => setEditDraft({ ...editDraft, established: e.target.value })} />\n                    ) : (row.established || '')}\n                  </td>\n                  <td>{row.student_count?.toLocaleString() || ''}</td>\n                  <td style={{ fontWeight: '500', color: '#00a884' }}>{row.views || 0}</td>\n                  <td style={{ fontWeight: '500', color: '#E74C3C' }}>{row.likes_count || 0}</td>\n                  <td style={{ fontWeight: '500', color: '#66BB6A' }}>{paperCounts[row.id] || 0}</td>\n                  <td>\n                    {editingId === row.id ? (\n                      <div style={{ display: 'flex', gap: '4px', flexDirection: 'column' }}>\n                        <button className=\"btn primary\" onClick={() => saveEdit(row)}>Save</button>\n                        <button className=\"btn\" onClick={cancelEdit}>Cancel</button>\n                      </div>\n                    ) : (\n                      <div className=\"actions\">\n                        <button className=\"btn\" onClick={() => startEdit(row)} disabled={!canEdit(row)}>Edit</button>\n                        <button className=\"btn\" onClick={() => handleDelete(row)} disabled={!canEdit(row)}>Delete</button>\n                      </div>\n                    )}\n                  </td>\n                </tr>\n              ))}\n            </tbody>\n          </table>\n        </div>\n\n        <div className=\"actions\" style={{ marginTop: 6 }}>\n          <button className=\"btn\" disabled={page <= 1} onClick={() => setPage(p => Math.max(1, p - 1))}>Prev</button>\n          <span style={{ color: '#cfd8dc' }}>Page {page} of {totalPages}</span>\n          <button className=\"btn\" disabled={page >= totalPages} onClick={() => setPage(p => Math.min(totalPages, p + 1))}>Next</button>\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default UniversitiesManagement;\n","import React, { useEffect, useMemo, useState } from 'react';\r\nimport { fetchPastPapers, deletePastPaper, updatePastPaper, getFaculties } from '../pastPapersApi';\r\nimport { useAdminUI } from '../AdminUIContext';\r\n\r\n// Format timestamp to local time with timezone handling\r\nconst formatTimestamp = (isoString) => {\r\n  if (!isoString) return '';\r\n  try {\r\n    const date = new Date(isoString);\r\n    return date.toLocaleString('en-US', { \r\n      year: 'numeric', \r\n      month: 'short', \r\n      day: 'numeric', \r\n      hour: '2-digit', \r\n      minute: '2-digit', \r\n      second: '2-digit',\r\n      hour12: true,\r\n      timeZoneName: 'short'\r\n    });\r\n  } catch (e) {\r\n    return isoString;\r\n  }\r\n};\r\n\r\nconst PastPapersManagement = ({ userProfile }) => {\r\n  const [loading, setLoading] = useState(true);\r\n  const [rows, setRows] = useState([]);\r\n  const [count, setCount] = useState(0);\r\n  const [page, setPage] = useState(1);\r\n  const [pageSize] = useState(10);\r\n  const [search, setSearch] = useState('');\r\n  const [faculties, setFaculties] = useState([]);\r\n  const [facultyFilter, setFacultyFilter] = useState(null);\r\n  const [sort, setSort] = useState({ col: 'created_at', dir: 'desc' });\r\n  const [editingId, setEditingId] = useState(null);\r\n  const [editDraft, setEditDraft] = useState({});\r\n  const [newPdf, setNewPdf] = useState(null);\r\n  const [useCustomFaculty, setUseCustomFaculty] = useState(false);\r\n  const [customFaculty, setCustomFaculty] = useState('');\r\n\r\n  const { confirm, showToast } = useAdminUI();\r\n\r\n  const isAdmin = userProfile?.role === 'admin';\r\n  const isEditor = userProfile?.role === 'editor';\r\n  const totalPages = useMemo(() => Math.max(1, Math.ceil(count / pageSize)), [count, pageSize]);\r\n\r\n  const load = async () => {\r\n    setLoading(true);\r\n    try {\r\n      const { data, count: total } = await fetchPastPapers({ page, pageSize, search, faculty: facultyFilter, sort });\r\n      setRows(data);\r\n      setCount(total);\r\n    } finally { setLoading(false); }\r\n  };\r\n\r\n  useEffect(() => {\r\n    (async () => { try { setFaculties(await getFaculties()); } catch {} })();\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    if (userProfile) load();\r\n  }, [page, search, facultyFilter, sort.col, sort.dir, userProfile]);\r\n\r\n  const canEdit = (row) => {\r\n    if (isAdmin) return true;\r\n    if (isEditor) return true;\r\n    return false;\r\n  };\r\n\r\n  const startEdit = (row) => {\r\n    if (!canEdit(row)) {\r\n      showToast({ type: 'error', message: 'You do not have permission to edit this past paper.' });\r\n      return;\r\n    }\r\n    setEditingId(row.id);\r\n    setEditDraft({\r\n      faculty: row.faculty || '', unit_code: row.unit_code || '', unit_name: row.unit_name || '',\r\n      year: row.year || '', semester: row.semester || '', exam_type: row.exam_type || ''\r\n    });\r\n    setNewPdf(null);\r\n    setUseCustomFaculty(false);\r\n    setCustomFaculty('');\r\n  };\r\n\r\n  const cancelEdit = () => { \r\n    setEditingId(null); \r\n    setEditDraft({}); \r\n    setNewPdf(null); \r\n    setUseCustomFaculty(false);\r\n    setCustomFaculty('');\r\n  };\r\n\r\n  const saveEdit = async (row) => {\r\n    if (!canEdit(row)) {\r\n      showToast({ type: 'error', message: 'You do not have permission to edit this past paper.' });\r\n      return;\r\n    }\r\n    \r\n    // Use custom faculty if selected, otherwise use the one from edit draft\r\n    const faculty = useCustomFaculty ? customFaculty : editDraft.faculty;\r\n    if (!faculty) {\r\n      showToast({ type: 'error', message: 'Please select or enter a faculty.' });\r\n      return;\r\n    }\r\n    \r\n    const updates = { ...editDraft, faculty };\r\n\r\n    try {\r\n      await updatePastPaper(row.id, { updates, newPdfFile: newPdf, oldFilePath: row.file_path });\r\n      cancelEdit();\r\n      await load();\r\n      showToast({ type: 'success', message: 'Past paper updated.' });\r\n    } catch (e) {\r\n      console.error('Failed to update past paper:', e?.message || e);\r\n      showToast({ type: 'error', message: e?.message || 'Failed to update past paper.' });\r\n    }\r\n  };\r\n\r\n  const handleDelete = async (row) => {\r\n    if (!canEdit(row)) {\r\n      showToast({ type: 'error', message: 'You can only delete past papers you uploaded.' });\r\n      return;\r\n    }\r\n\r\n    const ok = await confirm({\r\n      title: 'Delete past paper?',\r\n      message: `Delete \"${row.unit_code} - ${row.unit_name}\"? This action cannot be undone.`,\r\n      confirmLabel: 'Delete',\r\n      cancelLabel: 'Cancel',\r\n      variant: 'danger',\r\n    });\r\n    if (!ok) return;\r\n\r\n    try {\r\n      await deletePastPaper({ id: row.id, file_path: row.file_path });\r\n      await load();\r\n      showToast({ type: 'success', message: 'Past paper deleted.' });\r\n    } catch (e) {\r\n      console.error('Failed to delete past paper:', e);\r\n      showToast({ type: 'error', message: e?.message || 'Failed to delete past paper.' });\r\n    }\r\n  };\r\n\r\n  const toggleSort = (col) => setSort((s) => (s.col === col ? { col, dir: s.dir === 'asc' ? 'desc' : 'asc' } : { col, dir: 'asc' }));\r\n\r\n  return (\r\n    <div>\r\n      <div className=\"panel\">\r\n        <div className=\"panel-title\">Past Papers Management</div>\r\n\r\n        {/* Stats Summary */}\r\n        {!loading && rows.length > 0 && (\r\n          <div style={{ display: 'grid', gridTemplateColumns: 'repeat(auto-fit, minmax(150px, 1fr))', gap: '8px', marginBottom: '12px' }}>\r\n            <div style={{ background: '#1a2332', border: '1px solid #2a3f56', borderRadius: '6px', padding: '8px 12px', color: '#8696a0', fontSize: '0.85rem' }}>\r\n              <div style={{ color: '#00a884', fontSize: '1.2rem', fontWeight: '600' }}>{rows.reduce((sum, r) => sum + (r.downloads_count || 0), 0)}</div>\r\n              <div>Total Downloads</div>\r\n            </div>\r\n            <div style={{ background: '#1a2332', border: '1px solid #2a3f56', borderRadius: '6px', padding: '8px 12px', color: '#8696a0', fontSize: '0.85rem' }}>\r\n              <div style={{ color: '#34B7F1', fontSize: '1.2rem', fontWeight: '600' }}>{rows.reduce((sum, r) => sum + (r.views_count || 0), 0)}</div>\r\n              <div>Total Views</div>\r\n            </div>\r\n            <div style={{ background: '#1a2332', border: '1px solid #2a3f56', borderRadius: '6px', padding: '8px 12px', color: '#8696a0', fontSize: '0.85rem' }}>\r\n              <div style={{ color: '#FFCC00', fontSize: '1.2rem', fontWeight: '600' }}>{rows.length}/{count}</div>\r\n              <div>Page Papers</div>\r\n            </div>\r\n          </div>\r\n        )}\r\n\r\n        <div className=\"grid-2\" style={{ marginBottom: 6 }}>\r\n          <div className=\"panel\">\r\n            <label className=\"label\">Search</label>\r\n            <input className=\"input\" value={search} onChange={(e) => { setPage(1); setSearch(e.target.value.trim()); }} placeholder=\"e.g., MENT 130 or Introduction to...\" />\r\n          </div>\r\n          <div className=\"panel\">\r\n            <label className=\"label\">Faculty</label>\r\n            <select className=\"select\" value={facultyFilter || ''} onChange={(e) => { setPage(1); setFacultyFilter(e.target.value || null); }}>\r\n              <option value=\"\">All Faculties</option>\r\n              <option value=\"Unknown\">Unknown</option>\r\n              {faculties.map(f => <option key={f} value={f}>{f}</option>)}\r\n            </select>\r\n          </div>\r\n        </div>\r\n        <div className=\"actions\" style={{ marginBottom: 6 }}>\r\n          <button className=\"btn primary\" onClick={() => (window.location.href = '/books/admin/upload')}>Add New Past Paper</button>\r\n        </div>\r\n        <div className=\"panel\" style={{ padding: 0, overflowX: 'auto' }}>\r\n          <table className=\"table\" style={{ minWidth: '1200px' }}>\r\n            <thead>\r\n              <tr>\r\n                <th style={{ width: '250px' }}>Unit Name</th>\r\n                <th style={{ width: '150px', cursor: 'pointer' }} onClick={() => toggleSort('unit_code')}>Unit Code {sort.col === 'unit_code' ? (sort.dir === 'asc' ? '' : '') : ''}</th>\r\n                <th style={{ width: '150px' }}>Faculty</th>\r\n                <th style={{ width: '100px', cursor: 'pointer' }} onClick={() => toggleSort('year')}>Year {sort.col === 'year' ? (sort.dir === 'asc' ? '' : '') : ''}</th>\r\n                <th style={{ width: '100px' }}>Semester</th>\r\n                <th style={{ width: '120px' }}>Exam Type</th>\r\n                <th style={{ width: '80px', cursor: 'pointer', background: 'rgba(52, 183, 241, 0.1)', borderBottom: '2px solid #34B7F1' }} onClick={() => toggleSort('views_count')}>Views {sort.col === 'views_count' ? (sort.dir === 'asc' ? '' : '') : ''}</th>\r\n                <th style={{ width: '100px', cursor: 'pointer' }} onClick={() => toggleSort('downloads_count')}>Downloads {sort.col === 'downloads_count' ? (sort.dir === 'asc' ? '' : '') : ''}</th>\r\n                <th style={{ width: '180px', cursor: 'pointer' }} onClick={() => toggleSort('created_at')}>Uploaded {sort.col === 'created_at' ? (sort.dir === 'asc' ? '' : '') : ''}</th>\r\n                <th style={{ width: '150px' }}>Uploaded By</th>\r\n                <th style={{ width: '200px' }}>Actions</th>\r\n              </tr>\r\n            </thead>\r\n            <tbody>\r\n              {loading ? (\r\n                <tr><td colSpan={12} style={{ textAlign: 'center', color: '#8696a0' }}>Loading...</td></tr>\r\n              ) : rows.length === 0 ? (\r\n                <tr><td colSpan={12} style={{ textAlign: 'center', color: '#8696a0' }}>No data</td></tr>\r\n              ) : rows.map(row => (\r\n                <tr key={row.id}>\r\n                  <td style={{ color: row.unit_name ? '#e9edef' : '#8696a0' }}>{editingId === row.id ? <input className=\"input\" value={editDraft.unit_name} onChange={(e) => setEditDraft({ ...editDraft, unit_name: e.target.value })} /> : (row.unit_name || '')}</td>\r\n                  <td style={{ color: row.unit_code ? '#e9edef' : '#8696a0' }}>{editingId === row.id ? <input className=\"input\" value={editDraft.unit_code} onChange={(e) => setEditDraft({ ...editDraft, unit_code: e.target.value })} /> : (row.unit_code || '')}</td>\r\n                  <td style={{ color: row.faculty ? '#e9edef' : '#8696a0' }}>\r\n                    {editingId === row.id ? (\r\n                      <div style={{ display: 'flex', flexDirection: 'column', gap: '4px' }}>\r\n                        {!useCustomFaculty ? (\r\n                          <>\r\n                            <select \r\n                              className=\"select\" \r\n                              value={editDraft.faculty} \r\n                              onChange={(e) => setEditDraft({ ...editDraft, faculty: e.target.value })}\r\n                              style={{ marginBottom: '4px' }}\r\n                            >\r\n                              <option value=\"\">Select Faculty</option>\r\n                              {faculties && faculties.length > 0 ? faculties.map(f => <option key={f} value={f}>{f}</option>) : <option value=\"\">No faculties available</option>}\r\n                            </select>\r\n                          </>\r\n                        ) : (\r\n                          <input \r\n                            className=\"input\" \r\n                            placeholder=\"e.g., Engineering, Business\" \r\n                            value={customFaculty} \r\n                            onChange={(e) => setCustomFaculty(e.target.value)}\r\n                          />\r\n                        )}\r\n                        <div style={{ display: 'flex', alignItems: 'center', gap: '4px', fontSize: '11px' }}>\r\n                          <input \r\n                            type=\"checkbox\" \r\n                            id={`custom-faculty-${row.id}`}\r\n                            checked={useCustomFaculty}\r\n                            onChange={(e) => {\r\n                              setUseCustomFaculty(e.target.checked);\r\n                              if (!e.target.checked) {\r\n                                setCustomFaculty('');\r\n                              }\r\n                            }}\r\n                            style={{ width: '14px', height: '14px', cursor: 'pointer' }}\r\n                          />\r\n                          <label htmlFor={`custom-faculty-${row.id}`} style={{ color: '#8696a0', cursor: 'pointer', fontSize: '11px' }}>\r\n                            Add\r\n                          </label>\r\n                        </div>\r\n                      </div>\r\n                    ) : (row.faculty || '')}\r\n                  </td>\r\n                  <td style={{ color: row.year ? '#e9edef' : '#8696a0' }}>{editingId === row.id ? <input className=\"input\" type=\"number\" value={editDraft.year} onChange={(e) => setEditDraft({ ...editDraft, year: e.target.value })} /> : (row.year || '')}</td>\r\n                  <td>{editingId === row.id ? <select className=\"select\" value={editDraft.semester} onChange={(e) => setEditDraft({ ...editDraft, semester: e.target.value })}><option value=\"\"></option><option value=\"1\">1</option><option value=\"2\">2</option><option value=\"3\">3</option></select> : (row.semester || '')}</td>\r\n                  <td>{editingId === row.id ? <select className=\"select\" value={editDraft.exam_type} onChange={(e) => setEditDraft({ ...editDraft, exam_type: e.target.value })}><option value=\"Main\">Main</option><option value=\"Supplementary\">Supplementary</option><option value=\"CAT\">CAT</option><option value=\"Mock\">Mock</option></select> : (row.exam_type || 'Main')}</td>\r\n                  <td style={{ fontWeight: '500', color: '#34B7F1' }}>{row.views_count || 0}</td>\r\n                  <td>{row.downloads_count || 0}</td>\r\n                  <td style={{ color: '#8696a0', fontSize: '12px' }}>{formatTimestamp(row.created_at)}</td>\r\n                  <td style={{ color: row.profiles?.full_name ? '#e9edef' : '#8696a0', fontSize: '13px' }}>{row.profiles?.full_name || row.profiles?.email || ''}</td>\r\n                  <td>\r\n                    {editingId === row.id ? (\r\n                      <div style={{ display: 'flex', gap: '4px', flexDirection: 'column' }}>\r\n                        <button className=\"btn primary\" onClick={() => saveEdit(row)}>Save</button>\r\n                        <button className=\"btn\" onClick={cancelEdit}>Cancel</button>\r\n                      </div>\r\n                    ) : (\r\n                      <div className=\"actions\">\r\n                        <button className=\"btn\" onClick={() => startEdit(row)} disabled={!canEdit(row)}>Edit</button>\r\n                        <button className=\"btn\" onClick={() => handleDelete(row)} disabled={!canEdit(row)}>Delete</button>\r\n                      </div>\r\n                    )}\r\n                  </td>\r\n                </tr>\r\n              ))}\r\n            </tbody>\r\n          </table>\r\n        </div>\r\n        <div className=\"actions\" style={{ marginTop: 6 }}>\r\n          <button className=\"btn\" disabled={page <= 1} onClick={() => setPage(p => Math.max(1, p - 1))}>Prev</button>\r\n          <span style={{ color: '#cfd8dc' }}>Page {page} of {totalPages}</span>\r\n          <button className=\"btn\" disabled={page >= totalPages} onClick={() => setPage(p => Math.min(totalPages, p + 1))}>Next</button>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default PastPapersManagement;\r\n","/**\r\n * Author Interactions API\r\n * Handles: followers, likes, loves, comments, ratings, shares\r\n */\r\n\r\nimport { supabase } from '../../Books/supabaseClient';\r\n\r\n// ============================================\r\n// FOLLOWERS MANAGEMENT\r\n// ============================================\r\n\r\nexport async function toggleAuthorFollow(authorId, userId) {\r\n  try {\r\n    if (!userId) throw new Error('User ID required');\r\n    \r\n    const { data, error } = await supabase\r\n      .rpc('toggle_author_follow', {\r\n        p_follower_id: userId,\r\n        p_author_id: authorId\r\n      });\r\n    \r\n    if (error) throw error;\r\n    return { success: true, isFollowing: data };\r\n  } catch (error) {\r\n    console.error('Error toggling author follow:', error);\r\n    throw error;\r\n  }\r\n}\r\n\r\nexport async function getAuthorFollowers(authorId) {\r\n  try {\r\n    const { data, error } = await supabase\r\n      .from('author_followers')\r\n      .select('id, follower_id, profiles(id, username, avatar_url), followed_at')\r\n      .eq('author_id', authorId)\r\n      .order('followed_at', { ascending: false });\r\n    \r\n    if (error) throw error;\r\n    return data || [];\r\n  } catch (error) {\r\n    console.error('Error fetching author followers:', error);\r\n    return [];\r\n  }\r\n}\r\n\r\nexport async function getFollowersCount(authorId) {\r\n  try {\r\n    const { count, error } = await supabase\r\n      .from('author_followers')\r\n      .select('id', { count: 'exact' })\r\n      .eq('author_id', authorId);\r\n    \r\n    if (error) throw error;\r\n    return count || 0;\r\n  } catch (error) {\r\n    console.error('Error fetching followers count:', error);\r\n    return 0;\r\n  }\r\n}\r\n\r\n// ============================================\r\n// LIKES MANAGEMENT\r\n// ============================================\r\n\r\nexport async function toggleAuthorLike(authorId, userId) {\r\n  try {\r\n    if (!userId) throw new Error('User ID required');\r\n    \r\n    const { data, error } = await supabase\r\n      .rpc('toggle_author_like', {\r\n        p_user_id: userId,\r\n        p_author_id: authorId\r\n      });\r\n    \r\n    if (error) throw error;\r\n    return { success: true, isLiked: data };\r\n  } catch (error) {\r\n    console.error('Error toggling author like:', error);\r\n    throw error;\r\n  }\r\n}\r\n\r\nexport async function getAuthorLikes(authorId) {\r\n  try {\r\n    const { data, error } = await supabase\r\n      .from('author_likes')\r\n      .select('id, user_id, profiles(id, username, avatar_url), liked_at')\r\n      .eq('author_id', authorId)\r\n      .order('liked_at', { ascending: false });\r\n    \r\n    if (error) throw error;\r\n    return data || [];\r\n  } catch (error) {\r\n    console.error('Error fetching author likes:', error);\r\n    return [];\r\n  }\r\n}\r\n\r\nexport async function getLikesCount(authorId) {\r\n  try {\r\n    const { count, error } = await supabase\r\n      .from('author_likes')\r\n      .select('id', { count: 'exact' })\r\n      .eq('author_id', authorId);\r\n    \r\n    if (error) throw error;\r\n    return count || 0;\r\n  } catch (error) {\r\n    console.error('Error fetching likes count:', error);\r\n    return 0;\r\n  }\r\n}\r\n\r\n// ============================================\r\n// LOVES MANAGEMENT\r\n// ============================================\r\n\r\nexport async function toggleAuthorLove(authorId, userId) {\r\n  try {\r\n    if (!userId) throw new Error('User ID required');\r\n    \r\n    const { data, error } = await supabase\r\n      .rpc('toggle_author_love', {\r\n        p_user_id: userId,\r\n        p_author_id: authorId\r\n      });\r\n    \r\n    if (error) throw error;\r\n    return { success: true, isLoved: data };\r\n  } catch (error) {\r\n    console.error('Error toggling author love:', error);\r\n    throw error;\r\n  }\r\n}\r\n\r\nexport async function getAuthorLoves(authorId) {\r\n  try {\r\n    const { data, error } = await supabase\r\n      .from('author_loves')\r\n      .select('id, user_id, profiles(id, username, avatar_url), loved_at')\r\n      .eq('author_id', authorId)\r\n      .order('loved_at', { ascending: false });\r\n    \r\n    if (error) throw error;\r\n    return data || [];\r\n  } catch (error) {\r\n    console.error('Error fetching author loves:', error);\r\n    return [];\r\n  }\r\n}\r\n\r\nexport async function getLovesCount(authorId) {\r\n  try {\r\n    const { count, error } = await supabase\r\n      .from('author_loves')\r\n      .select('id', { count: 'exact' })\r\n      .eq('author_id', authorId);\r\n    \r\n    if (error) throw error;\r\n    return count || 0;\r\n  } catch (error) {\r\n    console.error('Error fetching loves count:', error);\r\n    return 0;\r\n  }\r\n}\r\n\r\n// ============================================\r\n// COMMENTS MANAGEMENT\r\n// ============================================\r\n\r\nexport async function addAuthorComment(authorId, userId, content, parentCommentId = null) {\r\n  try {\r\n    if (!userId) throw new Error('User ID required');\r\n    if (!content || content.trim().length === 0) throw new Error('Comment content required');\r\n\r\n    const { data, error } = await supabase\r\n      .from('author_comments')\r\n      .insert({\r\n        author_id: authorId,\r\n        user_id: userId,\r\n        content,\r\n        parent_comment_id: parentCommentId\r\n      })\r\n      .select('*, profiles(id, username, avatar_url)')\r\n      .single();\r\n\r\n    if (error) throw error;\r\n    return data;\r\n  } catch (error) {\r\n    console.error('Error adding author comment:', error);\r\n    throw error;\r\n  }\r\n}\r\n\r\nexport async function getAuthorComments(authorId, limit = 50) {\r\n  try {\r\n    const { data, error } = await supabase\r\n      .from('author_comments')\r\n      .select('id, user_id, content, parent_comment_id, likes_count, created_at, updated_at, profiles(id, username, avatar_url, tier)')\r\n      .eq('author_id', authorId)\r\n      .is('parent_comment_id', null)\r\n      .order('created_at', { ascending: false })\r\n      .limit(limit);\r\n\r\n    if (error) throw error;\r\n    return data || [];\r\n  } catch (error) {\r\n    console.error('Error fetching author comments:', error);\r\n    return [];\r\n  }\r\n}\r\n\r\nexport async function deleteAuthorComment(commentId, userId) {\r\n  try {\r\n    // Verify ownership\r\n    const { data: comment, error: fetchError } = await supabase\r\n      .from('author_comments')\r\n      .select('user_id')\r\n      .eq('id', commentId)\r\n      .single();\r\n\r\n    if (fetchError) throw fetchError;\r\n    if (comment.user_id !== userId) throw new Error('Unauthorized');\r\n\r\n    const { error } = await supabase\r\n      .from('author_comments')\r\n      .delete()\r\n      .eq('id', commentId);\r\n\r\n    if (error) throw error;\r\n    return { success: true };\r\n  } catch (error) {\r\n    console.error('Error deleting author comment:', error);\r\n    throw error;\r\n  }\r\n}\r\n\r\nexport async function getCommentsCount(authorId) {\r\n  try {\r\n    const { count, error } = await supabase\r\n      .from('author_comments')\r\n      .select('id', { count: 'exact' })\r\n      .eq('author_id', authorId)\r\n      .is('parent_comment_id', null);\r\n\r\n    if (error) throw error;\r\n    return count || 0;\r\n  } catch (error) {\r\n    console.error('Error fetching comments count:', error);\r\n    return 0;\r\n  }\r\n}\r\n\r\n// ============================================\r\n// RATINGS MANAGEMENT\r\n// ============================================\r\n\r\nexport async function rateAuthor(authorId, userId, rating, review = '') {\r\n  try {\r\n    if (!userId) throw new Error('User ID required');\r\n    if (rating < 1 || rating > 5) throw new Error('Rating must be between 1 and 5');\r\n\r\n    const { data, error } = await supabase\r\n      .from('author_ratings')\r\n      .upsert(\r\n        {\r\n          author_id: authorId,\r\n          user_id: userId,\r\n          rating,\r\n          review: review || null\r\n        },\r\n        { onConflict: 'user_id,author_id' }\r\n      )\r\n      .select('*, profiles(id, username, avatar_url)')\r\n      .single();\r\n\r\n    if (error) throw error;\r\n    return data;\r\n  } catch (error) {\r\n    console.error('Error rating author:', error);\r\n    throw error;\r\n  }\r\n}\r\n\r\nexport async function getAuthorRatings(authorId, limit = 20) {\r\n  try {\r\n    const { data, error } = await supabase\r\n      .from('author_ratings')\r\n      .select('id, user_id, rating, review, helpful_count, created_at, profiles(id, username, avatar_url, tier)')\r\n      .eq('author_id', authorId)\r\n      .order('helpful_count', { ascending: false })\r\n      .order('created_at', { ascending: false })\r\n      .limit(limit);\r\n\r\n    if (error) throw error;\r\n    return data || [];\r\n  } catch (error) {\r\n    console.error('Error fetching author ratings:', error);\r\n    return [];\r\n  }\r\n}\r\n\r\nexport async function getRatingsCount(authorId) {\r\n  try {\r\n    const { count, error } = await supabase\r\n      .from('author_ratings')\r\n      .select('id', { count: 'exact' })\r\n      .eq('author_id', authorId);\r\n\r\n    if (error) throw error;\r\n    return count || 0;\r\n  } catch (error) {\r\n    console.error('Error fetching ratings count:', error);\r\n    return 0;\r\n  }\r\n}\r\n\r\nexport async function getAverageRating(authorId) {\r\n  try {\r\n    const { data, error } = await supabase\r\n      .from('author_ratings')\r\n      .select('rating')\r\n      .eq('author_id', authorId);\r\n\r\n    if (error) throw error;\r\n    if (!data || data.length === 0) return 0;\r\n\r\n    const average = data.reduce((sum, r) => sum + r.rating, 0) / data.length;\r\n    return Math.round(average * 10) / 10;\r\n  } catch (error) {\r\n    console.error('Error calculating average rating:', error);\r\n    return 0;\r\n  }\r\n}\r\n\r\nexport async function deleteAuthorRating(authorId, userId) {\r\n  try {\r\n    const { error } = await supabase\r\n      .from('author_ratings')\r\n      .delete()\r\n      .eq('author_id', authorId)\r\n      .eq('user_id', userId);\r\n\r\n    if (error) throw error;\r\n    return { success: true };\r\n  } catch (error) {\r\n    console.error('Error deleting rating:', error);\r\n    throw error;\r\n  }\r\n}\r\n\r\n// ============================================\r\n// SHARES MANAGEMENT\r\n// ============================================\r\n\r\nexport async function recordAuthorShare(authorId, userId, shareType, platform = null) {\r\n  try {\r\n    const { data, error } = await supabase\r\n      .from('author_shares')\r\n      .insert({\r\n        author_id: authorId,\r\n        user_id: userId || null,\r\n        share_type: shareType,\r\n        platform: platform || null\r\n      })\r\n      .select()\r\n      .single();\r\n\r\n    if (error) throw error;\r\n    return data;\r\n  } catch (error) {\r\n    console.error('Error recording author share:', error);\r\n    throw error;\r\n  }\r\n}\r\n\r\nexport async function getSharesCount(authorId) {\r\n  try {\r\n    const { count, error } = await supabase\r\n      .from('author_shares')\r\n      .select('id', { count: 'exact' })\r\n      .eq('author_id', authorId);\r\n\r\n    if (error) throw error;\r\n    return count || 0;\r\n  } catch (error) {\r\n    console.error('Error fetching shares count:', error);\r\n    return 0;\r\n  }\r\n}\r\n\r\n// ============================================\r\n// USER INTERACTION STATUS\r\n// ============================================\r\n\r\nexport async function getUserAuthorInteractionStatus(authorId, userId) {\r\n  try {\r\n    if (!userId) {\r\n      return {\r\n        isFollower: false,\r\n        hasLiked: false,\r\n        hasLoved: false,\r\n        userRating: null\r\n      };\r\n    }\r\n\r\n    const { data, error } = await supabase\r\n      .rpc('get_author_interaction_status', {\r\n        p_user_id: userId,\r\n        p_author_id: authorId\r\n      })\r\n      .single();\r\n\r\n    if (error) {\r\n      console.error('Error fetching user interaction status:', error);\r\n      return {\r\n        isFollower: false,\r\n        hasLiked: false,\r\n        hasLoved: false,\r\n        userRating: null\r\n      };\r\n    }\r\n\r\n    return {\r\n      isFollower: data.is_follower || false,\r\n      hasLiked: data.has_liked || false,\r\n      hasLoved: data.has_loved || false,\r\n      userRating: data.user_rating\r\n    };\r\n  } catch (error) {\r\n    console.error('Error in getUserAuthorInteractionStatus:', error);\r\n    return {\r\n      isFollower: false,\r\n      hasLiked: false,\r\n      hasLoved: false,\r\n      userRating: null\r\n    };\r\n  }\r\n}\r\n\r\n// ============================================\r\n// AUTHOR ENGAGEMENT STATISTICS\r\n// ============================================\r\n\r\nexport async function getAuthorEngagementStats(authorId) {\r\n  try {\r\n    const { data, error } = await supabase\r\n      .from('author_engagement_stats')\r\n      .select('*')\r\n      .eq('author_id', authorId)\r\n      .single();\r\n\r\n    if (error && error.code !== 'PGRST116') throw error;\r\n\r\n    return data || {\r\n      author_id: authorId,\r\n      books_count: 0,\r\n      total_downloads: 0,\r\n      total_views: 0,\r\n      average_rating: 0,\r\n      followers_count: 0,\r\n      likes_count: 0,\r\n      loves_count: 0,\r\n      comments_count: 0,\r\n      ratings_count: 0,\r\n      shares_count: 0,\r\n      engagement_score: 0\r\n    };\r\n  } catch (error) {\r\n    console.error('Error fetching author engagement stats:', error);\r\n    return null;\r\n  }\r\n}\r\n\r\nexport async function getAllAuthorsEngagementStats(limit = 100) {\r\n  try {\r\n    const { data, error } = await supabase\r\n      .from('author_engagement_stats')\r\n      .select('*')\r\n      .order('engagement_score', { ascending: false })\r\n      .limit(limit);\r\n\r\n    if (error) throw error;\r\n    return data || [];\r\n  } catch (error) {\r\n    console.error('Error fetching all authors engagement stats:', error);\r\n    return [];\r\n  }\r\n}\r\n\r\nexport async function getTopAuthors(limit = 10) {\r\n  try {\r\n    const { data, error } = await supabase\r\n      .from('author_engagement_stats')\r\n      .select('*')\r\n      .order('engagement_score', { ascending: false })\r\n      .limit(limit);\r\n\r\n    if (error) throw error;\r\n    return data || [];\r\n  } catch (error) {\r\n    console.error('Error fetching top authors:', error);\r\n    return [];\r\n  }\r\n}\r\n\r\n// ============================================\r\n// AUTHOR PROFILE ENRICHMENT\r\n// ============================================\r\n\r\nexport async function enrichAuthorWithInteractions(author, userId = null) {\r\n  try {\r\n    const stats = await getAuthorEngagementStats(author.name || author.author_id);\r\n    const interactions = userId \r\n      ? await getUserAuthorInteractionStatus(author.name || author.author_id, userId)\r\n      : null;\r\n\r\n    return {\r\n      ...author,\r\n      ...stats,\r\n      interactions\r\n    };\r\n  } catch (error) {\r\n    console.error('Error enriching author:', error);\r\n    return author;\r\n  }\r\n}\r\n\r\nexport async function enrichAuthorsWithInteractions(authors, userId = null) {\r\n  try {\r\n    return Promise.all(\r\n      authors.map(author => enrichAuthorWithInteractions(author, userId))\r\n    );\r\n  } catch (error) {\r\n    console.error('Error enriching authors:', error);\r\n    return authors;\r\n  }\r\n}\r\n","import React, { useEffect, useState, useMemo } from 'react';\r\nimport { FiBook, FiDownload, FiStar, FiSearch, FiTrendingUp, FiHeart, FiUsers, FiMessageSquare, FiThumbsUp } from 'react-icons/fi';\r\nimport { MdFavoriteBorder } from 'react-icons/md';\r\nimport { fetchStats } from '../api';\r\nimport { getAllAuthorsEngagementStats } from '../authorInteractionsApi';\r\nimport './Authors.css';\r\n\r\nconst Authors = () => {\r\n  const [stats, setStats] = useState(null);\r\n  const [engagementStats, setEngagementStats] = useState({});\r\n  const [loading, setLoading] = useState(true);\r\n  const [searchTerm, setSearchTerm] = useState('');\r\n  const [sortBy, setSortBy] = useState('engagement');\r\n  const [timeRange, setTimeRange] = useState('monthly');\r\n\r\n  useEffect(() => {\r\n    const loadData = async () => {\r\n      try {\r\n        setLoading(true);\r\n        const [statsData, engageData] = await Promise.all([\r\n          fetchStats(),\r\n          getAllAuthorsEngagementStats(100)\r\n        ]);\r\n        \r\n        setStats(statsData);\r\n        \r\n        // Create engagement stats map for quick lookup by author name\r\n        const engageMap = {};\r\n        engageData.forEach(stat => {\r\n          engageMap[stat.author_name] = stat;\r\n        });\r\n        setEngagementStats(engageMap);\r\n      } catch (error) {\r\n        console.error('Failed to load authors stats:', error);\r\n      } finally {\r\n        setLoading(false);\r\n      }\r\n    };\r\n\r\n    loadData();\r\n    const interval = setInterval(loadData, 30000); // Refresh every 30 seconds\r\n    return () => clearInterval(interval);\r\n  }, []);\r\n\r\n  const filteredAndSorted = useMemo(() => {\r\n    if (!stats || !stats.authors) return [];\r\n\r\n    let filtered = stats.authors.filter(author =>\r\n      author.name.toLowerCase().includes(searchTerm.toLowerCase())\r\n    );\r\n\r\n    filtered.sort((a, b) => {\r\n      const authorEngageA = engagementStats[a.name] || {};\r\n      const authorEngageB = engagementStats[b.name] || {};\r\n\r\n      switch (sortBy) {\r\n        case 'engagement':\r\n          return (authorEngageB.engagement_score || 0) - (authorEngageA.engagement_score || 0);\r\n        case 'books':\r\n          return b.bookCount - a.bookCount;\r\n        case 'downloads':\r\n          return b.totalDownloads - a.totalDownloads;\r\n        case 'followers':\r\n          return (authorEngageB.followers_count || 0) - (authorEngageA.followers_count || 0);\r\n        case 'likes':\r\n          return (authorEngageB.likes_count || 0) - (authorEngageA.likes_count || 0);\r\n        case 'rating':\r\n          return parseFloat(b.avgRating || 0) - parseFloat(a.avgRating || 0);\r\n        case 'name':\r\n          return a.name.localeCompare(b.name);\r\n        default:\r\n          return (authorEngageB.engagement_score || 0) - (authorEngageA.engagement_score || 0);\r\n      }\r\n    });\r\n\r\n    return filtered;\r\n  }, [stats, searchTerm, sortBy, engagementStats]);\r\n\r\n  const overallStats = useMemo(() => {\r\n    if (!stats || !stats.authors) return { \r\n      totalAuthors: 0, \r\n      totalBooks: 0, \r\n      totalDL: 0, \r\n      avgRating: 0,\r\n      totalFollowers: 0,\r\n      totalLikes: 0,\r\n      totalLoves: 0,\r\n      totalComments: 0\r\n    };\r\n\r\n    const totalBooks = stats.authors.reduce((sum, a) => sum + (a.bookCount || 0), 0);\r\n    const totalDL = stats.authors.reduce((sum, a) => sum + (a.totalDownloads || 0), 0);\r\n    const avgRating = stats.authors.length > 0\r\n      ? (stats.authors.reduce((sum, a) => sum + (parseFloat(a.avgRating) || 0), 0) / stats.authors.length).toFixed(1)\r\n      : 0;\r\n    \r\n    // Sum engagement metrics\r\n    const totalFollowers = Object.values(engagementStats).reduce((sum, stat) => sum + (stat.followers_count || 0), 0);\r\n    const totalLikes = Object.values(engagementStats).reduce((sum, stat) => sum + (stat.likes_count || 0), 0);\r\n    const totalLoves = Object.values(engagementStats).reduce((sum, stat) => sum + (stat.loves_count || 0), 0);\r\n    const totalComments = Object.values(engagementStats).reduce((sum, stat) => sum + (stat.comments_count || 0), 0);\r\n\r\n    return {\r\n      totalAuthors: stats.authors.length,\r\n      totalBooks,\r\n      totalDL,\r\n      avgRating,\r\n      totalFollowers,\r\n      totalLikes,\r\n      totalLoves,\r\n      totalComments\r\n    };\r\n  }, [stats, engagementStats]);\r\n\r\n  if (loading) {\r\n    return (\r\n      <div className=\"authors-page\">\r\n        <div className=\"authors-loading\">\r\n          <div className=\"authors-spinner\"></div>\r\n          <p>Loading authors data...</p>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className=\"authors-page\">\r\n      {/* Header */}\r\n      <div className=\"authors-header\">\r\n        <div className=\"authors-title-section\">\r\n          <h1 className=\"authors-title\">\r\n            <FiTrendingUp /> Authors Analytics\r\n          </h1>\r\n          <p className=\"authors-subtitle\">Comprehensive author performance and engagement metrics</p>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Stats Cards */}\r\n      <div className=\"authors-stats-grid\">\r\n        <div className=\"authors-stat-card\">\r\n          <div className=\"authors-stat-icon authors-stat-icon-1\">\r\n            <FiBook />\r\n          </div>\r\n          <div className=\"authors-stat-content\">\r\n            <div className=\"authors-stat-label\">Total Authors</div>\r\n            <div className=\"authors-stat-value\">{overallStats.totalAuthors}</div>\r\n          </div>\r\n        </div>\r\n\r\n        <div className=\"authors-stat-card\">\r\n          <div className=\"authors-stat-icon authors-stat-icon-2\">\r\n            <FiBook />\r\n          </div>\r\n          <div className=\"authors-stat-content\">\r\n            <div className=\"authors-stat-label\">Total Books</div>\r\n            <div className=\"authors-stat-value\">{overallStats.totalBooks}</div>\r\n          </div>\r\n        </div>\r\n\r\n        <div className=\"authors-stat-card\">\r\n          <div className=\"authors-stat-icon authors-stat-icon-3\">\r\n            <FiDownload />\r\n          </div>\r\n          <div className=\"authors-stat-content\">\r\n            <div className=\"authors-stat-label\">Total Downloads</div>\r\n            <div className=\"authors-stat-value\">{overallStats.totalDL.toLocaleString()}</div>\r\n          </div>\r\n        </div>\r\n\r\n        <div className=\"authors-stat-card\">\r\n          <div className=\"authors-stat-icon authors-stat-icon-4\">\r\n            <FiStar />\r\n          </div>\r\n          <div className=\"authors-stat-content\">\r\n            <div className=\"authors-stat-label\">Avg Rating</div>\r\n            <div className=\"authors-stat-value\">{overallStats.avgRating}</div>\r\n          </div>\r\n        </div>\r\n\r\n        <div className=\"authors-stat-card\">\r\n          <div className=\"authors-stat-icon authors-stat-icon-5\">\r\n            <FiUsers />\r\n          </div>\r\n          <div className=\"authors-stat-content\">\r\n            <div className=\"authors-stat-label\">Total Followers</div>\r\n            <div className=\"authors-stat-value\">{overallStats.totalFollowers}</div>\r\n          </div>\r\n        </div>\r\n\r\n        <div className=\"authors-stat-card\">\r\n          <div className=\"authors-stat-icon authors-stat-icon-6\">\r\n            <MdFavoriteBorder />\r\n          </div>\r\n          <div className=\"authors-stat-content\">\r\n            <div className=\"authors-stat-label\">Total Likes</div>\r\n            <div className=\"authors-stat-value\">{overallStats.totalLikes}</div>\r\n          </div>\r\n        </div>\r\n\r\n        <div className=\"authors-stat-card\">\r\n          <div className=\"authors-stat-icon authors-stat-icon-7\">\r\n            <FiHeart />\r\n          </div>\r\n          <div className=\"authors-stat-content\">\r\n            <div className=\"authors-stat-label\">Total Loves</div>\r\n            <div className=\"authors-stat-value\">{overallStats.totalLoves}</div>\r\n          </div>\r\n        </div>\r\n\r\n        <div className=\"authors-stat-card\">\r\n          <div className=\"authors-stat-icon authors-stat-icon-8\">\r\n            <FiMessageSquare />\r\n          </div>\r\n          <div className=\"authors-stat-content\">\r\n            <div className=\"authors-stat-label\">Total Comments</div>\r\n            <div className=\"authors-stat-value\">{overallStats.totalComments}</div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Controls */}\r\n      <div className=\"authors-controls\">\r\n        <div className=\"authors-control-group\">\r\n          <label className=\"authors-label\">Search Author</label>\r\n          <div className=\"authors-search-wrapper\">\r\n            <FiSearch className=\"authors-search-icon\" />\r\n            <input\r\n              type=\"text\"\r\n              placeholder=\"Search by author name...\"\r\n              value={searchTerm}\r\n              onChange={(e) => setSearchTerm(e.target.value)}\r\n              className=\"authors-search-input\"\r\n            />\r\n          </div>\r\n        </div>\r\n\r\n        <div className=\"authors-control-group\">\r\n          <label className=\"authors-label\">Sort By</label>\r\n          <select\r\n            value={sortBy}\r\n            onChange={(e) => setSortBy(e.target.value)}\r\n            className=\"authors-select\"\r\n          >\r\n            <option value=\"engagement\">Engagement Score</option>\r\n            <option value=\"followers\">Followers</option>\r\n            <option value=\"likes\">Likes</option>\r\n            <option value=\"books\">Books Count</option>\r\n            <option value=\"downloads\">Downloads</option>\r\n            <option value=\"rating\">Rating</option>\r\n            <option value=\"name\">Name (A-Z)</option>\r\n          </select>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Table */}\r\n      <div className=\"authors-table-wrapper\">\r\n        <table className=\"authors-table\">\r\n          <thead className=\"authors-table-head\">\r\n            <tr>\r\n              <th className=\"authors-table-header authors-rank-col\">Rank</th>\r\n              <th className=\"authors-table-header authors-name-col\">Author Name</th>\r\n              <th className=\"authors-table-header authors-num-col\">Books</th>\r\n              <th className=\"authors-table-header authors-num-col\">Downloads</th>\r\n              <th className=\"authors-table-header authors-num-col\">Followers</th>\r\n              <th className=\"authors-table-header authors-num-col\">Likes</th>\r\n              <th className=\"authors-table-header authors-num-col\">Loves</th>\r\n              <th className=\"authors-table-header authors-num-col\">Rating</th>\r\n              <th className=\"authors-table-header authors-num-col\">Score</th>\r\n            </tr>\r\n          </thead>\r\n          <tbody className=\"authors-table-body\">\r\n            {filteredAndSorted.length > 0 ? (\r\n              filteredAndSorted.map((author, idx) => {\r\n                const engage = engagementStats[author.name] || {};\r\n                const engScore = engage.engagement_score || 0;\r\n                const medal = idx === 0 ? '' : idx === 1 ? '' : idx === 2 ? '' : `#${idx + 1}`;\r\n\r\n                return (\r\n                  <tr key={author.id} className=\"authors-table-row\">\r\n                    <td className=\"authors-table-cell authors-rank-col\">\r\n                      <span className=\"authors-rank-badge\">{medal}</span>\r\n                    </td>\r\n                    <td className=\"authors-table-cell authors-name-col\">\r\n                      <div className=\"authors-author-name\">\r\n                        {author.name === 'Unknown' ? ' Unknown Author' : author.name}\r\n                      </div>\r\n                    </td>\r\n                    <td className=\"authors-table-cell authors-num-col\">\r\n                      <span className=\"authors-metric-plain authors-books-count\">{author.bookCount}</span>\r\n                    </td>\r\n                    <td className=\"authors-table-cell authors-num-col\">\r\n                      <span className=\"authors-metric-plain authors-downloads-count\">{author.totalDownloads}</span>\r\n                    </td>\r\n                    <td className=\"authors-table-cell authors-num-col\">\r\n                      <span className=\"authors-metric-plain authors-followers-count\">{engage.followers_count || 0}</span>\r\n                    </td>\r\n                    <td className=\"authors-table-cell authors-num-col\">\r\n                      <span className=\"authors-metric-plain authors-likes-count\">\r\n                        <FiThumbsUp className=\"authors-metric-icon\" />\r\n                        {engage.likes_count || 0}\r\n                      </span>\r\n                    </td>\r\n                    <td className=\"authors-table-cell authors-num-col\">\r\n                      <span className=\"authors-metric-plain authors-loves-count\">\r\n                        <FiHeart className=\"authors-metric-icon\" />\r\n                        {engage.loves_count || 0}\r\n                      </span>\r\n                    </td>\r\n                    <td className=\"authors-table-cell authors-num-col\">\r\n                      <span className=\"authors-rating-plain\">\r\n                        {engage.average_rating > 0 ? engage.average_rating.toFixed(1) : ''} \r\n                      </span>\r\n                    </td>\r\n                    <td className=\"authors-table-cell authors-num-col\">\r\n                      <span className=\"authors-score-plain\">{engScore.toFixed(2)}</span>\r\n                    </td>\r\n                  </tr>\r\n                );\r\n              })\r\n            ) : (\r\n              <tr className=\"authors-table-row authors-empty-row\">\r\n                <td colSpan=\"9\" className=\"authors-table-cell authors-empty-message\">\r\n                  No authors found matching \"{searchTerm}\"\r\n                </td>\r\n              </tr>\r\n            )}\r\n          </tbody>\r\n        </table>\r\n      </div>\r\n\r\n      {/* Summary */}\r\n      <div className=\"authors-summary\">\r\n        <div className=\"authors-summary-item\">\r\n          <span className=\"authors-summary-label\">Showing</span>\r\n          <span className=\"authors-summary-value\">{filteredAndSorted.length} of {overallStats.totalAuthors}</span>\r\n          <span className=\"authors-summary-label\">authors</span>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Authors;\r\n","import React, { useState, useEffect } from 'react';\nimport { useSearchParams } from 'react-router-dom';\nimport { FiBook, FiMapPin, FiFileText, FiBookOpen } from 'react-icons/fi';\nimport Books from './Books';\nimport UniversitiesManagement from './UniversitiesManagement';\nimport PastPapersManagement from './PastPapersManagement';\nimport Authors from './Authors';\n\nconst tabStyles = `\n  .content-tabs {\n    display: flex;\n    gap: 4px;\n    margin-bottom: 8px;\n    border-bottom: 1px solid #374151;\n  }\n  .content-tab {\n    display: flex;\n    align-items: center;\n    gap: 4px;\n    padding: 6px 12px;\n    background: transparent;\n    border: none;\n    color: #8696a0;\n    cursor: pointer;\n    font-size: 14px;\n    font-weight: 500;\n    transition: all 0.3s ease;\n    border-bottom: 2px solid transparent;\n    margin-bottom: -1px;\n  }\n  .content-tab:hover {\n    color: #e9edef;\n    background: rgba(0, 168, 132, 0.05);\n  }\n  .content-tab.active {\n    color: #00a884;\n    border-bottom-color: #00a884;\n  }\n`;\n\nconst ContentManagement = ({ userProfile }) => {\n  const [searchParams] = useSearchParams();\n  const [activeTab, setActiveTab] = useState('books');\n\n  useEffect(() => {\n    const tabParam = searchParams.get('tab');\n    if (tabParam === 'pastpapers') {\n      setActiveTab('pastpapers');\n    } else if (tabParam === 'universities') {\n      setActiveTab('universities');\n    } else if (tabParam === 'authors') {\n      setActiveTab('authors');\n    } else {\n      setActiveTab('books');\n    }\n  }, [searchParams]);\n\n  React.useEffect(() => {\n    const styleTag = document.createElement('style');\n    styleTag.innerHTML = tabStyles;\n    document.head.appendChild(styleTag);\n    return () => styleTag.remove();\n  }, []);\n\n  return (\n    <div>\n      <div className=\"content-tabs\">\n        <button \n          className={`content-tab ${activeTab === 'books' ? 'active' : ''}`}\n          onClick={() => setActiveTab('books')}\n        >\n          <FiBook size={20} />\n          Books\n        </button>\n        <button \n          className={`content-tab ${activeTab === 'universities' ? 'active' : ''}`}\n          onClick={() => setActiveTab('universities')}\n        >\n          <FiMapPin size={20} />\n          Universities\n        </button>\n        <button \n          className={`content-tab ${activeTab === 'pastpapers' ? 'active' : ''}`}\n          onClick={() => setActiveTab('pastpapers')}\n        >\n          <FiFileText size={20} />\n          Past Papers\n        </button>\n        <button \n          className={`content-tab ${activeTab === 'authors' ? 'active' : ''}`}\n          onClick={() => setActiveTab('authors')}\n        >\n          <FiBookOpen size={20} />\n          Authors\n        </button>\n      </div>\n\n      {activeTab === 'books' && <Books userProfile={userProfile} />}\n      {activeTab === 'universities' && <UniversitiesManagement userProfile={userProfile} />}\n      {activeTab === 'pastpapers' && <PastPapersManagement userProfile={userProfile} />}\n      {activeTab === 'authors' && <Authors />}\n    </div>\n  );\n};\n\nexport default ContentManagement;","import { supabase } from '../supabaseClient';\nimport { API_URL } from '../../../config';\n\n// API Configuration\nconst USE_BACKEND_PROXY = true; // Set to false to use direct API calls\n\n/**\n * Search for university names for autocomplete\n */\nexport async function searchUniversityNames(query, limit = 10) {\n  try {\n    // Check cache first\n    let { data, error } = await supabase\n      .rpc('search_university_names', { p_query: query, p_limit: limit });\n\n    if (error) throw error;\n    if (data?.length) return data;\n\n    // Try Wikipedia/Wikidata search as primary method (more reliable, no API key needed)\n    const wikiResults = await searchWikipediaUniversities(query, limit);\n    if (wikiResults.length > 0) {\n      // Cache results\n      await Promise.all(wikiResults.map(uni => \n        cacheUniversityPrefillData(uni.name, uni, 'wikipedia')\n      ));\n      return wikiResults;\n    }\n\n    // Try backend proxy for Google Knowledge Graph (if enabled)\n    if (USE_BACKEND_PROXY) {\n      try {\n        const response = await fetch(`${API_URL}/api/university/search?query=${encodeURIComponent(query)}&limit=${limit}`);\n        \n        if (response.ok) {\n          const data = await response.json();\n          const universities = data.universities || [];\n          \n          // Cache results\n          if (universities.length > 0) {\n            await Promise.all(universities.map(uni => \n              cacheUniversityPrefillData(uni.name, uni, 'google_proxy')\n            ));\n          }\n          \n          return universities;\n        }\n      } catch (proxyError) {\n        console.warn('Backend proxy unavailable:', proxyError.message);\n      }\n    }\n\n    return [];\n  } catch (error) {\n    console.error('Error searching university names:', error);\n    return [];\n  }\n}\n\n/**\n * Search for universities using Wikipedia API (more reliable, no API key needed)\n */\nasync function searchWikipediaUniversities(query, limit = 10) {\n  try {\n    const searchUrl = `https://en.wikipedia.org/w/api.php?action=opensearch&search=${encodeURIComponent(query + ' university')}&limit=${limit}&namespace=0&format=json&origin=*`;\n    const response = await fetch(searchUrl);\n    \n    if (!response.ok) return [];\n    \n    const data = await response.json();\n    // data[0] = query, data[1] = titles, data[2] = descriptions, data[3] = urls\n    const titles = data[1] || [];\n    const descriptions = data[2] || [];\n    const urls = data[3] || [];\n    \n    return titles\n      .filter(title => title.toLowerCase().includes('university') || title.toLowerCase().includes('college'))\n      .map((title, index) => ({\n        name: title,\n        description: descriptions[index] || '',\n        website_url: urls[index] || '',\n      }));\n  } catch (error) {\n    console.error('Error searching Wikipedia:', error);\n    return [];\n  }\n}\n\n/**\n * Get prefill data for a university by name from cache\n */\nexport async function getUniversityPrefillData(universityName) {\n  try {\n    const { data, error } = await supabase\n      .rpc('get_university_prefill_data', {\n        p_university_name: universityName,\n      });\n\n    if (error) throw error;\n    return data;\n  } catch (error) {\n    console.error('Error fetching prefill data:', error);\n    return null;\n  }\n}\n\n/**\n * Fetch university data from Google Knowledge Graph (via backend proxy)\n */\nexport async function fetchUniversityDataFromGoogle(universityName) {\n  if (USE_BACKEND_PROXY) {\n    try {\n      const response = await fetch(`${API_URL}/api/university/details?name=${encodeURIComponent(universityName)}`);\n      \n      if (response.ok) {\n        const data = await response.json();\n        return {\n          name: data.university.name || universityName,\n          description: data.university.description || '',\n          website_url: data.university.website_url || '',\n          location: data.university.location || '',\n          established: null,\n          student_count: null,\n          cover_images: data.university.image ? [data.university.image] : [],\n        };\n      }\n    } catch (error) {\n      console.error('Error fetching from Google via proxy:', error);\n    }\n  }\n  \n  return null;\n}\n\n/**\n * Fetch university summary from Wikipedia REST API\n */\nexport async function fetchUniversityDataFromWikipedia(universityName) {\n  try {\n    const url = `https://en.wikipedia.org/api/rest_v1/page/summary/${encodeURIComponent(universityName)}`;\n    const res = await fetch(url);\n    if (!res.ok) return null;\n    const json = await res.json();\n\n    return {\n      name: json.title || universityName,\n      description: json.extract || '',\n      website_url: '',\n      location: '',\n      established: null,\n      student_count: null,\n      cover_images: json.thumbnail?.source ? [json.thumbnail.source] : [],\n    };\n  } catch (e) {\n    console.error('Error fetching from Wikipedia REST:', e);\n    return null;\n  }\n}\n\n/**\n * Fetch university data from Wikidata\n */\nexport async function fetchUniversityDataFromWikidata(universityName) {\n  try {\n    const sparqlQuery = `\n      SELECT ?item ?itemLabel ?locationLabel ?established ?studentCount ?website\n      WHERE {\n        ?item wdt:P31/wdt:P279* wd:Q3918;\n              rdfs:label ?itemLabel.\n        OPTIONAL { ?item wdt:P131 ?location. }\n        OPTIONAL { ?item wdt:P571 ?established. }\n        OPTIONAL { ?item wdt:P2196 ?studentCount. }\n        OPTIONAL { ?item wdt:P856 ?website. }\n        FILTER(CONTAINS(LCASE(?itemLabel), LCASE(\"${universityName}\")))\n        FILTER(LANG(?itemLabel) = \"en\")\n        SERVICE wikibase:label { bd:serviceParam wikibase:language \"en\". }\n      }\n      LIMIT 1\n    `;\n    const url = `https://query.wikidata.org/sparql?query=${encodeURIComponent(sparqlQuery)}&format=json`;\n    const response = await fetch(url);\n    if (!response.ok) return null;\n\n    const data = await response.json();\n    const binding = data.results.bindings[0];\n\n    if (!binding) return null;\n\n    return {\n      name: binding.itemLabel.value,\n      description: '',\n      website_url: binding.website?.value || '',\n      location: binding.locationLabel?.value || '',\n      established: binding.established?.value ? new Date(binding.established.value).getFullYear() : null,\n      student_count: binding.studentCount?.value || null,\n      cover_images: [],\n    };\n  } catch (error) {\n    console.error('Error fetching from Wikidata:', error);\n    return null;\n  }\n}\n\n/**\n * Fetch Wikimedia Commons images for a university\n */\nexport async function fetchWikimediaImages(universityName) {\n  try {\n    const title = (universityName || '').trim().replace(/\\s+/g, '_');\n    if (!title) return [];\n\n    const listUrl = `https://commons.wikimedia.org/w/api.php?action=query&format=json&origin=*&prop=images&titles=${encodeURIComponent(title)}`;\n    const listRes = await fetch(listUrl);\n    if (!listRes.ok) return [];\n    const listJson = await listRes.json();\n\n    const pages = listJson?.query?.pages ? Object.values(listJson.query.pages) : [];\n    const images = pages[0]?.images || [];\n    if (!images.length) return [];\n\n    const fileTitles = images\n      .map((img) => img?.title)\n      .filter(Boolean)\n      .slice(0, 50)\n      .join('|');\n\n    if (!fileTitles) return [];\n\n    const infoUrl = `https://commons.wikimedia.org/w/api.php?action=query&format=json&origin=*&prop=imageinfo&iiprop=url&titles=${encodeURIComponent(fileTitles)}`;\n    const infoRes = await fetch(infoUrl);\n    if (!infoRes.ok) return [];\n    const infoJson = await infoRes.json();\n\n    const filePages = infoJson?.query?.pages ? Object.values(infoJson.query.pages) : [];\n    const urls = filePages\n      .map((p) => p?.imageinfo?.[0]?.url)\n      .filter((u) => typeof u === 'string' && /\\.(jpg|jpeg|png|webp)$/i.test(u));\n\n    const prioritized = urls.sort((a, b) => {\n      const deprioritize = (s) => /logo|seal|coat_of_arms|emblem/i.test(s) ? 1 : 0;\n      return deprioritize(a) - deprioritize(b);\n    });\n\n    return prioritized.slice(0, 5);\n  } catch (e) {\n    console.error('Error fetching Wikimedia images:', e);\n    return [];\n  }\n}\n\n/**\n * Fetch images from Unsplash (via backend proxy if enabled)\n */\nexport async function fetchUnsplashImages(universityName) {\n  if (USE_BACKEND_PROXY) {\n    try {\n      const response = await fetch(`${API_URL}/api/university/images?query=${encodeURIComponent(universityName)}`);\n      \n      if (response.ok) {\n        const data = await response.json();\n        return data.images?.map(img => img.url) || [];\n      }\n    } catch (error) {\n      console.error('Error fetching Unsplash images via proxy:', error);\n    }\n  }\n  \n  return [];\n}\n\n/**\n * Download image from URL and convert to File object\n */\nexport async function downloadImageAsFile(imageUrl, fileName) {\n  try {\n    const response = await fetch(imageUrl);\n    if (!response.ok) throw new Error('Failed to download image');\n\n    const blob = await response.blob();\n    const file = new File([blob], fileName, { type: blob.type });\n    return file;\n  } catch (error) {\n    console.error('Error downloading image:', error);\n    return null;\n  }\n}\n\n/**\n * Cache university prefill data\n */\nexport async function cacheUniversityPrefillData(universityName, data, source = 'manual') {\n  try {\n    const { error } = await supabase\n      .from('university_prefill_cache')\n      .upsert({\n        university_name: universityName,\n        data: data,\n        source: source,\n        updated_at: new Date().toISOString(),\n      });\n\n    if (error) throw error;\n    return true;\n  } catch (error) {\n    console.error('Error caching prefill data:', error);\n    return false;\n  }\n}\n\n/**\n * Upload multiple images for a university\n */\nexport async function uploadUniversityImages(universityId, imageFiles) {\n  try {\n    const uploadedImages = [];\n    const bucket = 'university-covers';\n\n    for (let i = 0; i < imageFiles.length; i++) {\n      const file = imageFiles[i];\n      const fileExt = file.name.split('.').pop();\n      const fileName = `${universityId}/image_${i + 1}_${Date.now()}.${fileExt}`;\n\n      const { error: uploadError } = await supabase.storage\n        .from(bucket)\n        .upload(fileName, file, {\n          cacheControl: '3600',\n          upsert: false,\n        });\n\n      if (uploadError) {\n        console.error('Error uploading image:', uploadError);\n        continue;\n      }\n\n      const { data: urlData } = supabase.storage\n        .from(bucket)\n        .getPublicUrl(fileName);\n\n      uploadedImages.push({\n        url: urlData.publicUrl,\n        fileName: fileName,\n      });\n    }\n\n    return uploadedImages;\n  } catch (error) {\n    console.error('Error uploading multiple images:', error);\n    throw error;\n  }\n}\n\n/**\n * Add image record to university_images table\n */\nexport async function addUniversityImage(universityId, imageUrl, caption = null, isPrimary = false, displayOrder = 0) {\n  try {\n    const { data, error } = await supabase\n      .rpc('add_university_image', {\n        p_university_id: universityId,\n        p_image_url: imageUrl,\n        p_caption: caption,\n        p_is_primary: isPrimary,\n        p_display_order: displayOrder,\n      });\n\n    if (error) throw error;\n    return data;\n  } catch (error) {\n    console.error('Error adding university image:', error);\n    throw error;\n  }\n}\n\n/**\n * Get all images for a university\n */\nexport async function getUniversityImages(universityId) {\n  try {\n    const { data, error } = await supabase\n      .from('university_images')\n      .select('*')\n      .eq('university_id', universityId)\n      .order('is_primary', { ascending: false })\n      .order('display_order', { ascending: true });\n\n    if (error) throw error;\n    return data || [];\n  } catch (error) {\n    console.error('Error fetching university images:', error);\n    throw error;\n  }\n}\n\n/**\n * Set image as primary\n */\nexport async function setPrimaryUniversityImage(imageId) {\n  try {\n    const { error } = await supabase\n      .rpc('set_primary_university_image', {\n        p_image_id: imageId,\n      });\n\n    if (error) throw error;\n    return true;\n  } catch (error) {\n    console.error('Error setting primary image:', error);\n    return false;\n  }\n}\n\n/**\n * Delete university image\n */\nexport async function deleteUniversityImage(imageId, imageUrl) {\n  try {\n    const urlParts = imageUrl.split('/');\n    const bucket = 'university-covers';\n    const filePath = urlParts.slice(urlParts.indexOf(bucket) + 1).join('/');\n\n    const { error: storageError } = await supabase.storage\n      .from(bucket)\n      .remove([filePath]);\n\n    if (storageError) {\n      console.error('Error deleting from storage:', storageError);\n    }\n\n    const { error: dbError } = await supabase\n      .from('university_images')\n      .delete()\n      .eq('id', imageId);\n\n    if (dbError) throw dbError;\n    return true;\n  } catch (error) {\n    console.error('Error deleting university image:', error);\n    throw error;\n  }\n}\n\n/**\n * Main auto-fill function triggered on tab/input\n */\nexport async function autoFillUniversityData(universityName) {\n  try {\n    // Check cache first\n    let data = await getUniversityPrefillData(universityName);\n    if (data) return data;\n\n    // Prefer Wikipedia + Wikidata for accuracy (no API keys needed)\n    const wikiSummary = await fetchUniversityDataFromWikipedia(universityName);\n    const wikidata = await fetchUniversityDataFromWikidata(universityName);\n\n    if (wikiSummary || wikidata) {\n      const merged = {\n        name: (wikiSummary?.name || wikidata?.name || universityName) ?? universityName,\n        description: wikiSummary?.description || '',\n        website_url: wikidata?.website_url || '',\n        location: wikidata?.location || '',\n        established: wikidata?.established ?? null,\n        student_count: wikidata?.student_count ?? null,\n        cover_images: wikiSummary?.cover_images || [],\n      };\n      data = merged;\n    }\n\n    // Try Google as last resort (via proxy if enabled)\n    if (!data) {\n      data = await fetchUniversityDataFromGoogle(universityName);\n    }\n\n    // Fetch images\n    if (data && (!data.cover_images || data.cover_images.length === 0)) {\n      const commons = await fetchWikimediaImages(data.name || universityName);\n      if (commons.length) {\n        data.cover_images = commons;\n      } else {\n        const unsplash = await fetchUnsplashImages(data.name || universityName);\n        data.cover_images = unsplash;\n      }\n    }\n\n    // Cache the result\n    if (data) {\n      await cacheUniversityPrefillData(universityName, data, 'wikipedia_wikidata');\n    }\n\n    return (\n      data || {\n        name: universityName,\n        description: '',\n        website_url: '',\n        location: '',\n        established: null,\n        student_count: null,\n        cover_images: [],\n      }\n    );\n  } catch (error) {\n    console.error('Error auto-filling university data:', error);\n    return {\n      name: universityName,\n      description: '',\n      website_url: '',\n      location: '',\n      established: null,\n      student_count: null,\n      cover_images: [],\n    };\n  }\n}\n\n/**\n * Get all cached universities for dropdown/autocomplete\n */\nexport async function getAllCachedUniversities() {\n  try {\n    const { data, error } = await supabase\n      .from('university_prefill_cache')\n      .select('university_name')\n      .order('university_name');\n\n    if (error) throw error;\n    return data?.map(u => u.university_name) || [];\n  } catch (error) {\n    console.error('Error fetching cached universities:', error);\n    return [];\n  }\n}\n\n/**\n * Debounce utility\n */\nfunction debounce(func, wait) {\n  let timeout;\n  return (...args) => {\n    clearTimeout(timeout);\n    timeout = setTimeout(() => func(...args), wait);\n  };\n}\n\n/**\n * Frontend integration for auto-fill\n */\nexport function setupAutoFill(inputElement, resultContainer) {\n  inputElement.addEventListener(\n    'input',\n    debounce(async () => {\n      const query = inputElement.value.trim();\n      if (query.length < 3) return;\n\n      const suggestions = await searchUniversityNames(query);\n      console.log('Suggestions:', suggestions);\n      \n      const datalist = document.createElement('datalist');\n      datalist.id = 'university-suggestions';\n      suggestions.forEach(s => {\n        const option = document.createElement('option');\n        option.value = s.name;\n        datalist.appendChild(option);\n      });\n      inputElement.setAttribute('list', 'university-suggestions');\n      inputElement.parentNode.appendChild(datalist);\n    }, 300)\n  );\n\n  inputElement.addEventListener('keydown', async (event) => {\n    if (event.key === 'Tab') {\n      event.preventDefault();\n      const universityName = inputElement.value.trim();\n      if (!universityName) return;\n\n      const data = await autoFillUniversityData(universityName);\n      if (data) {\n        resultContainer.innerHTML = `\n          <h3>${data.name}</h3>\n          <p>${data.description || 'No description available'}</p>\n          <a href=\"${data.website_url || '#'}\" target=\"_blank\">Website</a>\n          <p>Location: ${data.location || 'N/A'}</p>\n          <p>Established: ${data.established || 'N/A'}</p>\n          <p>Students: ${data.student_count || 'N/A'}</p>\n          <div>\n            ${data.cover_images\n              .map(img => `<img src=\"${img}\" alt=\"${data.name} campus\" width=\"200\" style=\"margin-right: 10px;\" />`)\n              .join('')}\n          </div>\n        `;\n      }\n    }\n  });\n}"],"names":["_ref","userProfile","loading","setLoading","useState","rows","setRows","count","setCount","page","setPage","pageSize","search","setSearch","categories","setCategories","categoryId","setCategoryId","sort","setSort","col","dir","editingId","setEditingId","editDraft","setEditDraft","newPdf","setNewPdf","newCover","setNewCover","confirm","showToast","useAdminUI","ADMIN_EMAILS","isAdmin","role","includes","email","isEditor","totalPages","useMemo","Math","max","ceil","load","async","data","total","fetchBooks","useEffect","fetchCategories","_unused","canEdit","row","cancelEdit","toggleSort","s","_jsx","children","_jsxs","className","length","style","display","gridTemplateColumns","gap","marginBottom","background","border","borderRadius","padding","color","fontSize","fontWeight","reduce","sum","r","downloads","views","comments_count","likes_count","value","onChange","e","target","placeholder","map","c","id","name","onClick","window","location","href","overflowX","WebkitOverflowScrolling","minWidth","borderCollapse","borderSpacing","width","cursor","borderBottom","colSpan","textAlign","_categories$find","cover_url","src","alt","height","objectFit","title","_objectSpread","author","category_id","find","year","type","pages","publisher","Date","created_at","toLocaleDateString","flexDirection","document","getElementById","concat","click","alignItems","transition","accept","_e$target$files","files","_Fragment","slice","_e$target$files2","marginTop","message","updates","updateBook","newPdfFile","newCoverFile","oldFilePath","file_path","console","error","saveEdit","language","isbn","startEdit","disabled","confirmLabel","cancelLabel","variant","deleteBook","handleDelete","justifyContent","p","opacity","min","paperCounts","setPaperCounts","fetchUniversities","counts","uni","getPastPaperCountByUniversity","_row$description","_row$student_count","cover_image_url","description","established","student_count","toLocaleString","undefined","Number","updateUniversity","website_url","deleteUniversity","err","formatTimestamp","isoString","month","day","hour","minute","second","hour12","timeZoneName","faculties","setFaculties","facultyFilter","setFacultyFilter","useCustomFaculty","setUseCustomFaculty","customFaculty","setCustomFaculty","fetchPastPapers","faculty","getFaculties","downloads_count","views_count","trim","f","_row$profiles","_row$profiles2","_row$profiles3","unit_name","unit_code","checked","htmlFor","semester","exam_type","profiles","full_name","updatePastPaper","deletePastPaper","getAllAuthorsEngagementStats","limit","arguments","supabase","from","select","order","ascending","Authors","stats","setStats","engagementStats","setEngagementStats","searchTerm","setSearchTerm","sortBy","setSortBy","timeRange","setTimeRange","loadData","statsData","engageData","Promise","all","fetchStats","engageMap","forEach","stat","author_name","interval","setInterval","clearInterval","filteredAndSorted","authors","filtered","filter","toLowerCase","a","b","authorEngageA","authorEngageB","engagement_score","bookCount","totalDownloads","followers_count","parseFloat","avgRating","localeCompare","overallStats","totalAuthors","totalBooks","totalDL","totalFollowers","totalLikes","totalLoves","totalComments","toFixed","Object","values","loves_count","FiTrendingUp","FiBook","FiDownload","FiStar","FiUsers","MdFavoriteBorder","FiHeart","FiMessageSquare","FiSearch","idx","engage","engScore","medal","FiThumbsUp","average_rating","searchParams","useSearchParams","activeTab","setActiveTab","tabParam","get","React","styleTag","createElement","innerHTML","head","appendChild","remove","size","FiMapPin","FiFileText","FiBookOpen","Books","UniversitiesManagement","PastPapersManagement","USE_BACKEND_PROXY","searchUniversityNames","query","rpc","p_query","p_limit","wikiResults","searchUrl","encodeURIComponent","response","fetch","ok","json","titles","descriptions","urls","index","searchWikipediaUniversities","cacheUniversityPrefillData","API_URL","universities","proxyError","warn","fetchWikimediaImages","universityName","_listJson$query","_pages$","_infoJson$query","replace","listUrl","listRes","listJson","images","fileTitles","img","Boolean","join","infoUrl","infoRes","infoJson","_p$imageinfo","_p$imageinfo$","imageinfo","url","u","test","deprioritize","fetchUnsplashImages","_data$images","downloadImageAsFile","imageUrl","fileName","Error","blob","File","source","upsert","university_name","updated_at","toISOString","autoFillUniversityData","p_university_name","getUniversityPrefillData","wikiSummary","_json$thumbnail","res","extract","cover_images","thumbnail","fetchUniversityDataFromWikipedia","wikidata","_binding$website","_binding$locationLabe","_binding$established","_binding$studentCount","sparqlQuery","binding","results","bindings","itemLabel","website","locationLabel","getFullYear","studentCount","fetchUniversityDataFromWikidata","_wikidata$established","_wikidata$student_cou","university","image","fetchUniversityDataFromGoogle","commons","unsplash"],"ignoreList":[],"sourceRoot":""}